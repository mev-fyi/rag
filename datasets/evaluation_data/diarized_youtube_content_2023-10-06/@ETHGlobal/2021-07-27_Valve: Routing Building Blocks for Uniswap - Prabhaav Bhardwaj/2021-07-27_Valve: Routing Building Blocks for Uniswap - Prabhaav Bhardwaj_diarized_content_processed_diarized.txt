00:00:00.330 - 00:01:16.850, Speaker A: So Valve Finance, we got a grant from Uniswap to basically identify inefficient Uniswap routes. So as everyone's familiar in this forum, uniswap has a pool where two assets are traded and the price is determined basically after a trade and arbitrages come in and either bring the price back to what it's supposed to be or pretty much, yeah. What happens with Uniswap right now with the UX and the front end is it's hard coded to go through certain tokens. So the tokens are mentioned down here. ETH USDC maker, comp a couple of reasons for that. One, these are the tokens with the most liquidity that people are able to add pairs for, and they're also the most well known tokens. Now, what happens with the front end is when a trader comes in to trade token A for token B, uniswap B two.
00:01:16.850 - 00:02:14.674, Speaker A: And just to make a note real quick, this is all on B two and not on Uniswap V three. So on Uniswap V two, what happens is even if there's an optimal route that's better, the UX will route the trade through the six hub tokens. And what happens there is the pairs that are not part of those hub tokens, the tokens there are mispriced. Then you have these vampire bots coming in and arbitraging them back to reality. And the LPs of these mispriced token pools are experiencing impairment loss. The other issue that happens with Uniswap is routing is they are focused on giving you the lowest gas fees. Now, this is great up to a certain threshold.
00:02:14.674 - 00:03:04.406, Speaker A: Let's say if you have trades less than 500 or 1000, pick a number, like a small number, this is fine because the lowest gas fees are better for that. But when you want to do a much larger trade, let's say in this example for 10,000 badger to GRT, you pay for it with a lot of slippage. So the price impact is around 14%. Because Uniswap just takes one route, they don't do any sort of order route splitting, like, for example, One Inch. So you can see in this example you got about 140,000 GRT, but one inch gives you about 160,000. What they've done is they've optimized for returns over gas. And in the next couple of slides, I'll go over that some more.
00:03:04.406 - 00:04:05.654, Speaker A: But you'll see that one Inch is a dex aggregator. So they have the luxury of using multiple protocols, in this case to give you the maximal return. Here's another chart that kind of reiterates what I've been talking about with gas fees. So Uniswap, regardless of the size of the trade, will always be the lowest gas fees because they will only take one route, usually one or two hubs. Whereas Dex aggregators, if you can see in this chart, as the order size gets larger, they start splitting it, they start using multiple protocols, and the gas fees are, of course, much larger. But this doesn't really matter when you have a large enough order that the returns will more than offset the gas fees. And we can see this in the types of trades that happen on Uniswap and One inch.
00:04:05.654 - 00:05:17.454, Speaker A: So on Uniswap, the median trade size is about 1000 and it peaks around 2000 later of last year. But on one inch there's a lot more larger trades happening. And this is a big problem for Uniswap because these are LP fees just going to different protocols where they should be on Uniswap. So the solution that we're working on is to algorithmically solve the routing inefficiencies instead of hard coding the six hub tokens and expecting to solve the 80% the problem and just kind of like not dealing with the 20% inefficiencies. What we're proposing is a solution where we traverse the Uniswap graph for all routes, regardless of hub tokens and give you multiple options to take. So our initial current grant that we're working on right now is to identify multiple routes from Token A to Token B. Regardless of the six Hub tokens, what we want to do in the future is split trades across multiple pools.
00:05:17.454 - 00:06:08.594, Speaker A: So this is exactly what One Inch does. But instead of going through multiple protocols that one inch has the luxury of, we can still do this with uniswap with the multiple routes that are available. More interesting ideas are to actually test and simulate these routes with accurate gas and liquidity information that's real time. Whereas right now we built our system using this graph back end and also crossing protocol versions. So there's a lot of liquidity moving to V three. There's still a significant amount of liquidity on V two, and with talks of uniswap deploying on layer two, liquidity is going to get further fragmented. So giving users a holistic view of where their trades will get the maximum return.
00:06:08.594 - 00:07:23.722, Speaker A: Of course, we can do more interesting order types like limit range orders, buying every month, et cetera, that the current UX just isn't able to expose. So here's a quick example of our tool. So similar to the trade that I've been talking about, from Badger to GRT, all these routes are uniswap routes that we've put together for a small enough trade for 100 Badger. Of course, uniswap route makes the most sense, but as you get larger and larger trades just by splitting the order with two routes or three routes, you're going to significantly decrease the slippage, which, as I mentioned, will more than offset the gas cost. And more importantly, all the LP fees are staying on uniswap instead of going to other competing protocols. The idea of fragmented liquidity I've mentioned, I just wanted to add more data to that. So if you look at it here right now with uniswap V two and V three, there's a lot of trading pairs that are replicated on both V two and V three.
00:07:23.722 - 00:08:14.086, Speaker A: And as you can see, the liquidity is fragmented. So just doing almost like a uniswap dex aggregating of routes, you can get a lot better returns on larger trades. And traders who want to make those types of trades don't have to go to one inch or a different deck segregator. They can do small trades to large trades, all on Uniswap. Some ideas that we've also explored is Mev protected trades. So with the advent of Flashbots, we've all been familiar with what's happening with Mev. And if you go to explore Flashbots, you will see that Uniswap V Two is the biggest contributor to MEB.
00:08:14.086 - 00:09:11.840, Speaker A: There are a bunch of different reasons. A couple like ones that I've mentioned earlier of mispricing of pools that aren't in the Hub token routes is a big reason for this. And also using Flashbots to hide your trades would greatly improve Mev protection for Uniswap users. Some future opportunities that we're exploring. One of the ones that makes a lot of sense is a unified professional interface for Uniswap traders. So similar to what Coinbase and Coinbase Pro have for professional traders, what we're thinking about is building a unified UX for Uniswap where you can view liquidity on multiple layers, layer two providers like Arbitram and Optimism. You can view it on multiple protocols, whether it's V Two or V Three.
00:09:11.840 - 00:10:01.354, Speaker A: And also the advanced features that I've mentioned before. And there's a great parallel for that with Quinta. Quinta is a team that spun out of synthetics that built a better front end, that had advanced features that the synthetics exchange just was exposing. And they're using synthetics all in the back end. Some other features that we were considering, and this is mostly for future grants. There's of course the trade generator that I just went over testing and simulating mev protected trades, the unified front end, live price and real time data. This is going to be absolutely critical when you need to make trading decisions based on the data that we're providing.
00:10:01.354 - 00:11:03.754, Speaker A: And of course, constraint editors if you want to set certain slippage gas thresholds or number of hops protocols layers as we solve the problem for traders, it just makes sense to look at the other side, the supply side with the LPs. Some of these ideas have been discussed on the uniswap discord of features that the community is looking for. Automatic position management algorithmic. I know Somalier is addressing some of this. There's also interesting nuggets like supplying only one part of the swap. So let's say you have Bao and MKR and you just have Bao in your wallet and you just want to supply that and you have to wait for some other party to supply MKR. So some ideas there are kind of what Calswap is doing with coincidence, once basically finding the other side of liquidity for you to add to the pool.
00:11:03.754 - 00:12:03.010, Speaker A: And of course, unified front end keeps coming up over and over again, whether it's the LPs or traders having a front end that allows you to view all the liquidity across different protocols and layers is absolutely critical. And then opportunities for you to invest your money. So if you are an LP today, this has been on the Twittervers, on Discord, LP on the current Uniswap interface is confusing. Where do I set my ticks, et cetera? And also which pool should I put my money in, where is the best return for my money? So those are some of the problems that we can potentially address in the future. That's all I had for the presentation. I can quickly go over our still working demo. So here what we have is just a basic interface for input and output token.
00:12:03.010 - 00:12:41.760, Speaker A: So let's say I want to go from Ave to balancer. I can put in some sort of the amount of tokens I'm exchanging, increase the number of hops, and then say this is the max amount of impact that I care about. So when I do that, it's going to return a bunch of routes. So obviously it's a small enough trade. Uniswap will be the one that will have the most optimal trade. And as you see, this animated line is indicating that this is also the trade that we recommend. Now, when you try to go to bigger trades, like I was talking about with Badger, let me just do that real quick.
00:12:41.760 - 00:13:55.800, Speaker A: So let's go from Badger to GRT, and I'll start with 100 Badger and that will show you the different routes that are possible. And again, these three routes, maybe even these four routes have pretty similar returns. But if you just flip this with two or three routes, again, you'll get a lot more return versus the gas fee you'd spend. Now, if I increase this to 1000, you'll notice that Uniswap the route will start becoming a lot worse because they're just picking the hub tokens. But yeah, this is kind of like a quick demo of what we're working on. I'll ask AC to just paste a link to the paper that we have written. So this kind of walks through the ideas that we've had, how we're thinking about it, and it has a lot more technical details of how we modeled our data and also what we're thinking about in terms of caching and scaling when this needs to go to real time.
00:13:55.800 - 00:14:24.926, Speaker A: And of course, we do mention some of the information that I went through with future potential ideas. Would love to get the community feedback on this. If you guys think that some of these ideas are great, what you're interested in, maybe there's ideas here that we haven't addressed. Would love to hear from you guys on that. That's pretty much all I have to present. Happy to answer any questions. Thank you.
00:14:24.948 - 00:14:37.190, Speaker B: That was an awesome talk and a really interesting idea. We do have a question from the chat and the question is, what happens if somebody arps one side of the LP pool with the other decks? As you're making this trade?
00:14:38.490 - 00:14:45.510, Speaker A: It's a good question. Is this from a different Dex?
00:14:47.370 - 00:14:55.658, Speaker B: I believe so. I'll ask them to clarify when they hear this in a few seconds, but the assumption is yes.
00:14:55.824 - 00:15:33.606, Speaker A: Yeah, not really sure we'll have to think about that more from our perspective, at least initially. What we have thought about is just getting better returns for users just because just doing the bare minimum because people shouldn't be going to a Dex aggregator when there's multiple routes available on Uniswap to get from Token A, token B. There are definitely edge cases that as the person is asked about that we need to address. Happy to take that offline and talk more. I think AC is also on chat so he can of course answer that.
00:15:33.708 - 00:15:56.880, Speaker B: And then we got a clarification which was yeah, the context is another decks in that, so makes sense. You showed a really interesting demo. I guess maybe a question from my end is just what are kind of the still the open problems that you haven't figured out that have different trade offs here and just sort of what does it mean for the roadmap here for this to be readily available for others to test?
00:15:57.730 - 00:17:07.560, Speaker A: Yeah, as I mentioned, I think in the earlier slide, the first part of our grant was just to identify these routes. So what we plan on doing is now that we have at least a working demo of that, we need to have more up to date data on liquidity and the price information. So we update this like about once a day. What we want to do is get closer to maybe like every 15 seconds or every couple of minutes. Eventually what we want to get to is directly connected to the JSON RPC and get real time data so you can make these trades and you can compare with Uniswap if you want to. And splitting the trades is a solved problem in a sense with how airline companies move people around. So it's going to be us just trying to figure out what will get you the best return after talking to the Uniswap team that's what they're excited about is can we get them from Token A to Token B with more of a return than what the Uniswap UX can offer?
00:17:08.730 - 00:17:28.090, Speaker B: That's awesome. And then there is another question that AC is actively answering on the chat, but I'll ask it for completeness which is can Uniswap itself be optimized so that people don't need to go to other decks or use an alternate service? What about backporting these changes or routes into the main protocol?
00:17:28.670 - 00:18:21.086, Speaker A: That's my understanding, absolutely. I think maybe it was a design decision on Uniswap's side to say, you know what, we'll just use six hub tokens and we will always optimize for gas fees so they could definitely do this. But as we've seen, they're pretty busy with V three. And an interesting point to make here is, with v three, this problem gets even more complicated because there's active and inactive liquidity routing through ticks. So would be really exciting to see how this would work with that. Our initial foray into v three is probably doing what dex aggregators like One Inch are already doing. They're just looking at what v three routes are available and just suggesting those instead of us building our own pathfinder algorithm v three.
00:18:21.086 - 00:18:34.160, Speaker A: But I think these are very straightforward optimizations that I think, of course, Uniswap could make. I'm not really sure why they would, but of course they can totally do this.
00:18:34.850 - 00:18:42.640, Speaker B: Well, I hope that answers the question from our audiences, and thank you so much for that awesome demo and presentation, and this is a super interesting problem to be working on.
00:18:43.170 - 00:18:43.580, Speaker A: Thank you.
