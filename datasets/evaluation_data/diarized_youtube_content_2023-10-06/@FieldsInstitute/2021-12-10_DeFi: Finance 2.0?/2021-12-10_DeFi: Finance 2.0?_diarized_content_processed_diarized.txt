00:00:02.240 - 00:00:12.674, Speaker A: My name is Henry Kim and we have today a speaker from Imperial College London, Louis Gudgeon.
00:00:13.694 - 00:00:14.606, Speaker B: I hope I got it right.
00:00:14.630 - 00:00:59.284, Speaker A: Sorry, I should never ask for your conversation. Okay, who is going to talk about DeFi 2.0 or DeFi Finance 2.0 online? And here as well is another co organizer for this talk, which is Andreas park from the University of Toronto. The third co organizer is Andreas Fenaris, who I think if he's not here already, will be joining us very shortly. And he's at U of T as well in electro engineering. My name is Henry Kim and I'm at the Schulich School of Business at York University before I introduce Lewis, I just want to say this talk is sponsored by Fields Institute as well as the digital currencies project at York University.
00:00:59.284 - 00:01:46.148, Speaker A: York has a new campus, Markham campus, and it has a research emphasis on fintech and some of the other people that are involved in this research project are people from this blockchain community, including Soteris Deaskos from York University as well as Poonam Piri, who's at the law school at Osgoode Joanne JCAC from York. Anyway, I promised. I promised Andres I wouldn't talk about York too much because it's a field institute thing. So that's all I'm going to say about the sponsorship. Anyway, let me get into talking about the speaker. Lewis is a fourth year PhD candidate in computer science department at Imperial College London. He's supervised by Professor William Nottenbult.
00:01:46.148 - 00:02:17.014, Speaker A: His background is primarily in economics, having first studied philosophy, politics and economics as an undergraduate, followed by an master's philosophy and economics research at the University of Cambridge. His work focuses on defi systems, particularly the design behaviors and risks of protocols for borrowing and saving, protocols for loanable funds and stable coins and I've encouraged Lewis to talk also very briefly about his other ventures, which I think you might find interesting. So anyway, Louis, with all that, please welcome to give your talk thank you.
00:02:18.794 - 00:03:05.284, Speaker B: Thank you. Well thanks very much for that introduction and it is a real pleasure to be here and to give this talk. So yeah, to add a little bit in the background. So I'm currently a fourth year PhD candidate. As was mentioned in the introduction, when I started my PhD it was really the, the very beginning of the DeFi ecosystem. At the time, I don't think the term even really existed. And over the course of doing my PhD we've just seen this real explosion in protocols in sort of on chain economic design.
00:03:05.284 - 00:04:09.062, Speaker B: It's really been just a sort of fantastic thing to watch through. Through the computer monitor exclusively. And so I'm a PhD candidate and also an operator in the DeFi space as well. I am also one of the main founders of a stablecoin project, which is called gyroscope, mentioning that only in passing. But this entire talk is focused on DeFi in general, and really wanting to answer the question, is DeFi going to amount to finance 2.0? What does that even mean? And so, to do that, my plan is as follows. So I'm going to give an introduction, really just definition of terms, so that we can all be on the same page about exactly what DeFi means.
00:04:09.062 - 00:05:11.284, Speaker B: I think that's actually, in this context, I think that is extremely important, because there is some misunderstanding that I've seen about what DeFi is. Then I want to move on to looking at the different DeFi primitives. I want to explore what the fundamental components are of DeFi protocols and explain the most important ones, and then turn to protocols. So in this section, I want to look at the different defi systems that exist in practice, talk about them to some level of detail, and try to really flesh out what is defi, at least as I see it. And then, yeah, I want to move on to security. So, looking at technical and economic security. And then finally, and this is where I really want to focus, this is on the open challenges for future research.
00:05:11.284 - 00:05:45.114, Speaker B: I think that this is for sure one of the sort of most important things, and one of the things that I wanted to stress the most in this talk is to try to sketch out what I see as, like, the future avenues for new work, and try to be as open as I can be about all of the future challenges. Because I think this is a fantastically exciting space. I think there is so much work to be done. There are relatively few people doing it. And so I wanted to spend a good amount of time on this and sort of share my thoughts.
00:05:45.734 - 00:05:53.964, Speaker A: Oh, Louis, sorry, quick question. How did you want to field questions? Luz, you want to wait till the end? How would you like the audience to ask you questions?
00:05:54.824 - 00:06:02.640, Speaker B: So I think it would be best to bunch all the questions up together at the end. So once I've.
00:06:02.792 - 00:06:26.956, Speaker C: Hello, Luis. Greetings from University of Toronto. I'm at the office. Usually this Andreas, that's how we usually do it. I think it allows the speaker to have a flow and control the time. And I think it would be better to listen to the talk. And then, of course, people can start typing questions, and then you, Henry, can go ahead and outline them and.
00:06:26.956 - 00:06:28.424, Speaker C: Thank you. For being here today.
00:06:28.964 - 00:06:47.014, Speaker A: That is Andreas Baneras, who's the other co organizer, Louis. And then, so, folks, so if you have any questions, I'll be keeping track of the chats. So I'll sort of, when all's all done and Louis is asking questions, I'll go through and sort of redress those chats that you've said. Okay, that's great. Thanks, Louis.
00:06:47.674 - 00:07:20.880, Speaker B: Perfect. Thank you. Okay, so let's. Let's get into it. So, I should say so, a lot of this talk is based on a paper that has been written with some very great co authors. And so some of the structure and some of the contents is coming out of the reflections that we had while writing this paper. So this Sok on decentralized finance.
00:07:20.880 - 00:08:28.844, Speaker B: So, yeah, my. My thanks to all of the co authors for helping with this work. So I thought it would be helpful to start actually with what DeFi is not, because I think this is something that has been, let's say, bothering me a bit, and I've observed for quite, quite a while, is this sort of conflation between Defi and just, like, blockchain financial products or something like this, or just blockchains themselves. So I wanted to be really clear that when I'm talking about DeFi or decentralized finance, this is not just equal to some amalgamation of cryptocurrencies, blockchains, or distributed ledgers. There's definitely a specific idea in DeFi that is in addition to these other concepts and building elements. So decentralized finance is really something much broader than just blockchain based finance. It's the idea of having a financial system that is completely peer to peer.
00:08:28.844 - 00:09:04.034, Speaker B: And the spine of this financial system can be something like a blockchain or some other type of distributed ledger. What we see at the moment is that a lot of the DeFi applications are indeed on a blockchain. Many, most, in fact, are on the ethereum blockchain. But DeFi itself, I think, is best thought of as something that sits on top of, um, blockchains. It's not just equivalent to the. These blockchain. This blockchain layer itself.
00:09:04.034 - 00:09:31.886, Speaker B: So when I started my study of, uh, of DeFi, when the term didn't exist, um, this essentially, uh, Defi at the time was limited to a few very specific protocols. So things like make a dao, which I think many people, uh, owe quite a bit to as an inspirational project. Others such as compound and Ava, which also.
00:09:31.950 - 00:09:36.274, Speaker C: Give me for a second, it seems some people are in the waiting room.
00:09:36.734 - 00:09:37.470, Speaker B: Okay.
00:09:37.582 - 00:09:42.174, Speaker C: And I'd meet them, so. But I don't know if I'm the super host over here. We need to.
00:09:42.214 - 00:09:44.398, Speaker A: Yes, I'm admitting them as they roll in.
00:09:44.486 - 00:09:44.798, Speaker B: Yeah.
00:09:44.846 - 00:09:46.014, Speaker C: Okay. Yeah, yeah, yeah.
00:09:46.054 - 00:09:46.350, Speaker A: Okay.
00:09:46.382 - 00:09:49.582, Speaker C: So they're not waiting. Our friends in the waiting room?
00:09:49.638 - 00:09:50.486, Speaker A: Yeah, no, they're not waiting.
00:09:50.550 - 00:09:51.030, Speaker B: All is good.
00:09:51.062 - 00:09:51.286, Speaker C: Okay.
00:09:51.310 - 00:09:52.034, Speaker A: Thank you.
00:09:53.854 - 00:10:34.794, Speaker B: Okay, so I. First, you want to talk about the properties of an idealized defi. So, the first is that DeFi is non custodial. So this means that participants have full control over their funds at any point in time. So what this means in concretely is that users operate with a private key or something like this. And owning that private key entitles them to move funds and access funds at an address. And owning to own funds just is to own the private key to those funds.
00:10:34.794 - 00:11:47.304, Speaker B: But in this setting, no one is able to control funds on the user's behalf. It is impossible to do so, or supposed to be impossible, at least. And this represents a step change from the traditional financial systems, where, of course, everything is based on the role that a custodian plays. So in a bank where the bank would look after your funds, and you trust the bank to be well behaved and not to lose the money that you've deposited with it. Of course, one of the original motivations for bitcoin, and in fact, it makes it into one of the first bitcoin blocks, is the financial crisis in 2008, where I think they take one of the Times newspaper headings and says something like, chancellor on the brink of a second bailout for banks or something like that. So the motivation of having non custodial finance and non custodial DeFi is really at the very, very core of the entire endeavor. The second property is permissionlessness.
00:11:47.304 - 00:13:36.250, Speaker B: So what this means is that anyone in the world is able to interface with financial services without being censored or blocked by a third party. So this is, again, a very powerful concept, because this means that for individuals in potentially unstable economies or in unstable regions of the world, they could access financial services such as stablecoins, but many other products as well, which would be very, very useful without needing to go through various processes that would be necessary to operate within the normal financial system. This means, in another way to phrase this, is that with a permissionless financial system, anyone can write to the blockchain, provided you have some funds for the transaction fees, anyone can modify the state of this global computer. You don't need to go through any vetting process to do that. The third property is that DeFi is in its idealized form, openly auditable. So what this means is that anyone globally, can audit the state of the system just by loading up some sort of blockchain explorer or something like this, and looking at the state of the different contracts or the different components in that system, and then verifying whether they think that these components are functioning well or not. And this is, again, something that is a real revolution in how, revolution in openness of data.
00:13:36.250 - 00:14:57.112, Speaker B: So if you think to one of the causes of the financial crisis in 2008, it was that a lot of the financial data, and for example, the amount of leverage that banks had taken on, just wasn't that widely known in this setting. Now anyone is able to audit the state of the system and verify whether things are working soundly. Finally, I think this is perhaps the most exciting property of an idealized deFi. It is that it should be composable. Composability just means that you can take different Lego like building blocks within this defi ecosystem and just arbitrarily snap them together. So you can take any two pieces of code, you can create some other piece of code that allows these two things to work together, and then you can build any type of financial products that you're able to think of, and that could possibly operate within the constraints of the underlying blockchain. But this composability is something that we really haven't seen before in finance.
00:14:57.112 - 00:15:51.620, Speaker B: This is almost entirely new property of a financial system, and it really opens up many possibilities. But as I'll talk about later, also opens up many quite serious and profound risks as well. So I wanted to talk a bit about the two views on DeFi. So this is the view of the Defi optimist. So the Defi optimist thinks that DeFi amounts to a breakthrough technological advance, offering a new financial architecture that is non custodial, permissionless, openly auditable, pseudo anonymous, and with potentially new capital efficiencies. So Defi optimist essentially looks at these idealized properties of Defi and things. This looks great.
00:15:51.620 - 00:16:46.414, Speaker B: Let's see where this goes. It sounds like we're onto something that really could be quite exciting. But then there's the view of the Defi pessimist. The DeFi pessimist has the following view. So the unregulated, hack prone defi ecosystem serves to facilitate unfettered and novel forms of financial crime. Pseudo anonymity permits cryptocurrency attackers, scammers, and money launderers to move clean and earn interest on capital. So this presentation, and I think the field of DeFi as a whole is really caught between these two different viewpoints about DeFi, whether it is something that is of clear benefit compared to the traditional finance, or whether it's something that, while introducing benefits, is also introducing new and very serious forms of crime and harm.
00:16:46.414 - 00:17:57.808, Speaker B: And, yeah, I think this is something we need to take extremely seriously. Many people are, but I think particularly for those of us who are writing software in this space, this is, this is a very, very important thing to think about and to reflect on the consequences of actions in such a globally accessible system. And so let's also just get a sense of the growth of deFi. So you can see how, since, well, this is going back to the start of 2020, but of course, you could take this even further back. I remember when I started my PhD back in 2018, this graph, everything was at very low values, 50 million or something on the axis, on the y axis. But you can see that there has been this incredible influx of capital in a whole variety of DeFi protocols that have emerged in the last two to three years. It's really being quite a spectacle to watch.
00:17:57.808 - 00:18:48.020, Speaker B: And you can see that the large components of DeFi use. The two largest are lending protocols. So this is where you have some sort of on chain capital, and you lend this out and someone can borrow it and they pay you interest, and then Dexs. So this is just on chain exchange of crypto assets. Okay, so I'm now going to turn to the primitives of DeFi. So the first thing to say is that there's this basic assumption, which touches on this point I made at the start about what DeFi is not, which is that DeFi protocols just assume and require an underlying distributed ledger layer. So, such as a blockchain, it doesn't have to be.
00:18:48.020 - 00:19:34.044, Speaker B: But this ledger layer is an input into DeFi. It is not what DeFi equates to directly. And so for that ledger layer, we assume various security properties are true, or that it's able to provide these. So mainly relating to data consistency, integrity and availability. So these four things are the main primitives. And I'll spend a few minutes just describing these components. So, the first thing in a DeFi ecosystem are smart contracts and transactions.
00:19:34.044 - 00:20:33.554, Speaker B: So what you need to imagine to kind of wrap your head around this, is that smart contracts are these programs that essentially just run and live on a blockchain, essentially. I've heard it put that way recently. I think it's a great way to describe a smart contract. It's this program that just lives on the blockchain. And is able to interact with other programs that are running on the blockchain. But what needs to be realized is that these program objects, they're not able to themselves trigger updates to states. So if you want to change things on the blockchain or nudge things along or update values in a contract, this requires some sort of transaction.
00:20:33.554 - 00:21:54.878, Speaker B: So there is in a sense no equivalent of a cron job or something like that that can just be scheduled to run within a smart contract. So these smart contract objects, specifically talking about the context of ethereum mainly here, these are written in a programming language such as solidity or Viper. They are then compiled down into the EVM bytecode and then they are deployed onto the blockchain, which is a global computer. I'm deliberately not talking about how blockchains work in detail here because I think this would be just too much material to cover. But for anyone who's a little unsure of the, say, mental model that I have of a blockchain, it's essentially just a network of different computers all running the same software to keep the same view of some global state. So many synchronized nodes, and then these program objects run on these nodes. So yeah, the second primitive are keepers.
00:21:54.878 - 00:23:16.814, Speaker B: So as I mentioned, smart contracts aren't able to internally generate these calls without some type of, say, nudge or some sort of transaction on chain. So the role of keepers are. So keepers perform this function to keep things updated or to ensure that if something has happened in the off chain world, it is updated on chain in a timely manner. So for one type of protocol, which I'll get onto shortly, these protocols are concerned with borrowing and lending of funds. And in this situation, the keepers can help with ensuring that for a loan that is about to become underwater and is about to be liquidated, these keepers can ensure that the liquidation happens in a timely manner, but that this is the role of an agent that performs this separately to the contracts that are already deployed. So the third component are oracles. So something that is important to realize is that a blockchain is operating in a silo from real world data.
00:23:16.814 - 00:24:13.034, Speaker B: So anything that's happening off chain. So for example, if you have prices on an exchange that are like a centralized crypto exchange that are relied on by a protocol, and Oracle is the way of the blockchain being able to access this off chain information. So it's essentially this import of off chain information on chain. And you can think of many different use cases where oracles are important. It's very easy to think of them. It's essentially anything where you require off chain data. And as the complexity of applications built on top of blockchains grow, it's easy to imagine oracles for weather information, oracles for essentially not just financial information, but these oracles play a critical role in the ecosystem.
00:24:13.034 - 00:25:51.670, Speaker B: And then, so the fourth component of DeFi protocol is some sort of governance mechanism. So once a contract is deployed, you might want to make updates to the parameters of that contract. Or once an entire set of contracts is deployed, you might want to upgrade certain parts of the code base, or you might want to agree on some mechanism that allows you to essentially change the system. So a governance mechanism is something that is critical in ensuring that these updates can be made in a manner that is sound. And typically what we see with many deFi protocols at the moment is that governance is actually concentrated in the hands of very few individuals operating as a multisig perhaps. And essentially these few individuals are able to control updates to parameters, deployment of new contracts, transfer of funds, these sorts of actions. But we've also seen in some cases in certain defi projects, the emergence of much more sophisticated governance mechanisms where governance is managed through a form of token Dao, where ownership of certain tokens.
00:25:51.670 - 00:26:52.424, Speaker B: So when I say tokens, you can think of this as being sort of like some type of cryptocurrency. Ownership of these tokens just is equal to some sort of voting power. So if you have a large balance of these tokens, or in fact any balance, you can vote on, vote on governance proposals in a somewhat democratic manner, and then the changes to the system are made based on, based on which votes pass and which votes don't pass, et cetera. But yeah, so governance is an extremely important primitive for DeFi protocols and these are the four main components. So if you put these things together you can get something that looks a little like Defi. Of course it would be impossible for me to explain everything in a sort of 1 hour slot and I won't attempt to do so. But at some level of simplification, these are the main components.
00:26:52.424 - 00:27:49.474, Speaker B: So now that we've talked about the main primitives, so we were at this level. So smart contracts, tokens, oracles and governance, we are now going to turn to the protocols themselves. So in this figure you can see different types of protocol that exist. So here we have on the right of the screen, examples are for exchange of assets. So this is on chain exchange of two crypto assets, loanable funds, markets, so borrowing and lending, essentially stable coins, portfolio management and then derivatives. And then I won't touch on L2 and mixes so much today. But these are also other types of protocol that we see.
00:27:49.474 - 00:28:54.884, Speaker B: So I'm going to start then with on chain asset exchange. So there are essentially. So just, so let's pause for a second and just sort of imagine the problem that we have. So what we're essentially trying to do is find a way for two parties who are not known to each other to exchange assets in a completely decentralized and peer to peer fashion, but in a way that is critically not relying on some sort of custodian to manage the settlements and order matching of some sort of trade. So of course, this problem in the centralized setting has been solved. You just go to an exchange, you trust them with your funds, they are able to store funds for you. You're then able to use their different order book matching algorithms and trade.
00:28:54.884 - 00:29:38.164, Speaker B: And this can be great. And you can have very liquid markets on these, on these, on these centralized exchanges. But then if you wanted to do this where there was no trust, well, far fewer trust assumptions you would turn to on chain exchange. And there are really two types of exchanges. So dexs, that do this decentralized exchange, there are order book dexs. So this is where you have a, as in a centralized exchange, an order book of bid and asked prices. And then there's some algorithm that enables these bids and asks to be matched.
00:29:38.164 - 00:30:13.274, Speaker B: The other option, which is new in the context of on chain asset exchange, is automated market makers. So in this situation, liquidity is essentially just provided based on algorithmic rules. And the prices themselves are, um, just that. So they are algorithmically determined and they are spat out of a formula. Essentially. This is, this is something that is a new form of asset exchange that we, we see on chain. So the, so this is the first type of, of defi protocol.
00:30:13.274 - 00:31:05.560, Speaker B: It's that for on chain asset exchange. So a second type that we have seen are loanable funds markets for on chain assets. So with loanable funds markets, what you have essentially are protocols such as compound or aaver, many others where you're able to deposit capital. So you can take some, maybe a stable coin like USDC or something along these lines. You deposit it into a smart contract and you're paid an interest rate on the capital that you've deposited. And that interest rate comes from borrowers who take this liquidity. They are willing to pay some amount for it.
00:31:05.560 - 00:31:50.534, Speaker B: And they. Yeah, and as in essentially the operation of a typical bank, this is how on chain loanable funds markets function. However, there is one critical difference which is that in the normal setting with lending, with traditional banks, loans are often uncollateralized. So you can go to your bank and say, I want a loan for â‚¬50,000. Here's my credit history, and here's my address. So if I don't pay anything back, then firstly, you'll be surprised. And secondly, you know where I live.
00:31:50.534 - 00:33:38.504, Speaker B: However, in the on chain setting, of course, we don't have access to this information. So the mechanism that has emerged to allow this on chain borrowing is to over collateralize loans, which actually is slightly strange if you think about it. This means that if you want to borrow, you first need to deposit something of more value than the amount that you're trying to borrow. So for maker Dao, for example, if you wanted to borrow against the value of ETH, you would need to over collateralize by a ratio of 150% or so compared to what you can borrow. So this is, and of course, this delta between the value of your loan and the amount of capital you've deposited is supposed to just be this buffer against shocks to prices and to provide this insurance in the decentralized setting, that if something goes wrong, the protocol is able to recover, recover its liability by just liquidating or collateral. Then there is, however, a new type of loan, which is also merged in the on chain setting, which are flash loans. So when I said that loans are over collateralized, that is typically the case, but flash loans are this special example where it is possible to borrow in a single transaction without fronting any capital at all, provided it is paid back at the end of the transaction, plus plus interest.
00:33:38.504 - 00:34:38.054, Speaker B: So then another type of defi protocol are stablecoins. So this. Yeah, certainly an area which I'm deeply familiar with, but the way to break it down is just into these five different components. But just zooming out for a second, I think the question is, well, what is a stable coin? And what know, what are you possibly trying to achieve with these constructions? Well, the idea of a stable coin is to have a crypto asset that tries to be price stable relative to some target currencies. So, for example, the dollar. And then do this through some mechanisms. So find some stabilizing mechanisms that allow you to ensure that you have this on chain asset that can always be redeemed for this value of $1, for example.
00:34:38.054 - 00:36:21.740, Speaker B: And so there are many reasons why stablecoins are an interesting field to be engaging with, not least of which is that one of the hallmarks of loss of cryptocurrency, the whole cryptocurrency space is extreme volatility in prices, which of course has attracted a great deal of speculation, but at the same time means that it is very difficult to use crypto assets as an actual means of payment, because there's this inherent fear that you could be spending. I mean, there are examples of people who spent 10,000 bitcoin on a pizza in 2009 or ten or something like that, and its worth many, many millions and most expensive pizza of all time. This is something that this sort of pattern of thought really makes very volatile crypto assets quite difficult to use. And of course as a means of preserving wealth, its also not clear that it is wise decision to store large parts of your wealth in assets where the prices are very volatile. That's taking away beliefs people have about the cryptocurrency space in general. It is just very risky to be participating in such, taking large positions like that. So that's a bit of the motivation for why stable coins are interesting.
00:36:21.740 - 00:37:52.254, Speaker B: And then these are the five main components. So some type of collateral which acts as this reserve. So you have this pool of capital, and someone has your on chain stablecoin, and they're able to go to this pool of capital and say, I have $100 worth of your stablecoin, please can I have $100? And if you've managed to put your stablecoin together properly, you get back $100. There are then agents, so stablecoin users, but also people who perform this role of absorbing the risk that is inherent in managing stablecoins, and in particular in keeping the stable coins very liquid around, very tightly around the peg. Then there's some governance mechanism so similar to that I spoke about before, some issuance mechanism for stablecoins. So the question here is, how do you actually create new units of stablecoin? Many different projects have different methods for doing this, but essentially the idea is to convert some crypto asset, like x units of some crypto asset, into y units of stablecoins, using some rule that's on chain. And then finally, there's oracles, which are very important in the stablecoin context, because when you're targeting a price feed, you really need to critically know the exchange rate against the target price itself, for example, the dollar.
00:37:52.254 - 00:38:36.082, Speaker B: So then we have another type. So protocols for portfolio management. So these you can think of as essentially just decentralized investment funds. So here, smart contracts take capital, and they can run different strategies on this capital, which can vary in complexity, but these are essentially like decentralized hedge funds for your money running on chain. But with perhaps without. Well, certainly without the full sophistication of a hedge fund off chain. And then we.
00:38:36.082 - 00:39:19.054, Speaker B: Yeah, so also the very interesting thing here is that the actual strategies themselves, you can see. So you can see them coded up on chain and you can inspect them, you can look at whether you think they're sound and safe. And this links back to the open auditability component of DeFi that I mentioned at the beginning. And then lastly we have derivatives. So this is a relatively nascent market, or field, I should say, in defi, but yeah, derivatives. So of course just contracts which are somehow deriving value based on some underlying asset. We've seen some synthetic assets.
00:39:19.054 - 00:40:23.574, Speaker B: There's also some futures have emerged, but this is not essentially, there has been relatively little development in that area, some perpetual swaps, and then also there's some market for options that's emerging as well. But this is, yeah, all quite nascent, but as is much of the rest of the ecosystem. So while I was putting these slides together, I was a little concerned that it would be a bit sort of nebulous talking about these defi protocols and what they are and these sort of creatures living on a blockchain. It might not really make any sense to anybody. So I thought it might be helpful to include just a few sort of images that demonstrate what a DeFi protocol actually looks like. So I've taken maker Dao as my example because this is certainly a project that I found most inspirational in this space. And I think really kick started much of Defi itself.
00:40:23.574 - 00:41:04.110, Speaker B: And this is what you would typically see. And I'll be very interested in the questions to hear about whether people have actually used DeFi protocols, such as makers. But so here's just the front end. So this is the website and you can. And what to think about here is that this is like a front end that is interfacing with a blockchain that is just completely sort of hidden in the background. And this is the say, ideally the sort of user friendly way to use a DeFi protocol. So you would have some of your funds in, in some wallet that you can easily access.
00:41:04.110 - 00:41:55.938, Speaker B: And then you can click on these different components and you should be able to interact with the protocol. And you can see in the background these different maker vaults that have been created. But then this is really just the front end. What does the protocol look like in terms of design? You can see for the, the core contract for maker, this is the sort of complexity that's involved in its design. And so don't worry, I'm not going to talk through all of it. I find the naming has brought me great joy throughout the last few years of the different maker components. The main auctions are the flip flop and flap auctions.
00:41:55.938 - 00:42:39.074, Speaker B: Uh, they have very sophisticated, you know, they operate, they do completely different things. Their operation is, uh, very neurosphisticated. The docs describe it far better than I should attempt in, in this talk, and it would, uh, it's not relevant for me to do so. But you can see from this diagram that this is the. So each, each of these, uh, components reflects some different aspects of a protocol, um, most often some contract that is, um, calling another. And you can see just the complexity for one protocol. And then finally, once you have the design, what does this protocol actually look like? Like, what do you end up with? And this is where we have the, the on chain components.
00:42:39.074 - 00:43:22.334, Speaker B: So this is just a snippet of the solidity code. This is written by a smart contract developer. It then gets compiled down, deployed onto the blockchain. And this is directly taken from the GitHub for the code that was deployed for the VAT contract. So I just wanted to try to make it extremely concrete what a DeFi protocol actually looks like, what it really consists in. Okay, so I'm now going to talk about the two different types of security that are very important. So the first type of security in the DeFi setting is technical security.
00:43:22.334 - 00:45:07.464, Speaker B: So what I mean by technical security is that a DeFi protocol is technically secure if it is not possible for an attacker to atomically exploit the technical structure of the protocol, any interacting protocols or the underlying blockchain, at the expense of value held by the protocol or its users. So the key distinction here is that technical security purely relates to the technical features that are true or that exist for a particular smart contract or set of smart contracts. And one thing to note is that in the context of defi, um, the transactions are atomic, which means that they either, um, execute completely or they don't execute at all and revert. And there's no state change, which means that it's possible, if there are technical problems, to generate risk free profits, because if it fails, the transaction reverse. So let's look at a few types of technical security. So one of the most famous is reentrancy. So reentrancy essentially is just when a contract, one of these program objects, is deployed on chain, it gets halfway through updating some sort of state, and then there's a call or some control is passed to some untrusted contract and it's called with enough like gas.
00:45:07.464 - 00:45:40.682, Speaker B: So like compute resources. And then this untrusted object, this other contract object, is able to just repeatedly call the sending contract and just drain the funds. So essentially it's just exploiting this like partially it's sort of this moment where the contract, your contract's guard is down and an untrusted contract is able to exploit it while it's, while it's interacting with it. And yeah, this is a real problem. So here's an example. Default. This was hacked and this was a $25 million hack.
00:45:40.682 - 00:46:21.692, Speaker B: And something to say outright is that there have been many spectacular hacks in the DeFi ecosystem. It's close to a weekly event. I think it might actually be more frequent than that. And I having seen many of the hacks in recent weeks, 25 million almost looks like they got away in quite good shape. There are many, many hacks that exceed $100 million in size. Then there's integer manipulation. So this is where due to the way that solidity, for example, handles integers, it's very easy to have underflow and overflow.
00:46:21.692 - 00:46:58.764, Speaker B: This has led to problems. Yam was a protocol that experienced a large loss of $750,000 due to a scaling mistake in a contract. And then there are logical bugs. So these are just simple programming errors. You just make a mistake and you deploy it and you don't realize. And yeah, there are many examples of this and well, BZx lost $8 million. So I want to talk about the second type of technical security risk, which are single transaction attacks.
00:46:58.764 - 00:48:03.094, Speaker B: So in this setting, it's possible to successfully execute an attack without needing to know about some other transaction that's pending. And the thing that's used by these, these attacks is the atomicity of the transaction and also the fact that contracts are composable. So two examples. Firstly, governance attacks. This is where you take a large number of governance tokens and you're able to change system parameters before the system realizes this is a single transaction attack. If you want to know more about this if fantastic blog post that was written in I believe 2019 by Mika Zoltu on Makerdao, and it was entitled something like how to turn $20 million into $340 million in, I don't know, 20 seconds or something like that. And then this actually did then go on to happen to maker.
00:48:03.094 - 00:48:58.444, Speaker B: Then the other type, single transaction attacks. So this is where an attacker is able to depress the price of one of the price feeds on chain and then exploits some other on chain element like an amm. So it just creates this price imbalance in the amm, it's unable to benefit greatly from this imbalance. And then through perhaps the sale of tokens within the pool or, or just a straightforward arbitrage, and then it's able to revert the initial imbalance that was created. So hopefully the cost can be covered in that way. Okay. And then finally, on technical security, there are transaction ordering attacks.
00:48:58.444 - 00:49:46.984, Speaker B: So the first type is, um, displacement attacks. So this, uh, well, I actually just want to provide a bit more background. So what you have to remember is that in this setting, transactions are executed in a certain order within a block. So, and the, the order in which these transactions are executed will typically depend on how much you've paid for that block space. So if you are willing to pay a large gas fee, you can get your transaction, or large transaction fee, you can get your transaction executed early on in the block. If you pay a low fee, you risk not being included in the block. But if you can set the fee at the right level, you might be included, but at the end.
00:49:46.984 - 00:51:17.634, Speaker B: So the great thing about this from the point of view of the attacker is it enables you to send two transactions, you know, when they will roughly be executed, or you can hope, and then if they're executed in this order, you can wrap them around some other transaction, that's your target transaction, and essentially manipulate the price in one direction, affect deterministically in amm, and so an automated market maker, and then run another transaction which enables you to recoup some of the costs. So these are these sandwich attacks where this target transaction is sandwiched between these two attacker transactions. So if people are particularly interested in these, we can perhaps talk about them a bit later. Okay. And then my last thing before talking about open challenges is to talk about economic security. So this is something that is a particularly acute and novel form of risk in the DeFi setting. So DeFi protocol is economically secure if it's economically infeasible to manipulate the equilibrium of incentives among all interacting agents to extract value from the protocol or its users.
00:51:17.634 - 00:52:10.894, Speaker B: So what this means is, leaving aside purely technical matters on the blockchain, a protocol is economically secure if you know that the incentives of agents in the system cannot be manipulated in such a way that they will start to act against the interests of the protocol. And this sort of exploit, these are non atomic. So this means that they don't either succeed or fail. They might or, sorry, I should say, they don't either succeed or reverse. They could fail with some cost. So this sort of transaction is not risk free ATT and CK is not risk free. So one of the ways that one of the sort of economic security mechanisms that's been used is over collateralization.
00:52:10.894 - 00:53:17.246, Speaker B: So this is what is used in the case of maker. And the idea is you have loans, these loans are over collateralized. If you have the capital that's over collateralized, these loans, if it loses value, then hopefully it doesn't lose value so quickly that by the time you've sold it, it has lost more value than the liability. If that does happen, of course it would be unprofitable for a liquidator to initiate liquidation, and that would be, from the point of view of the protocol, something of a problem, because they would not have the capital to cover their liabilities. And we saw many unfortunate effects of very, very severely negative price shocks on Black Thursday, which was in March 2020. Then there's also mine extractable value. So as I mentioned, it's possible to determine the order that these DeFi protocol transactions occur within a block.
00:53:17.246 - 00:54:48.944, Speaker B: So naturally the question emerges, well, what are the maximum ways to extract value from these blocks? And of course, DeFi applications have created many new types of MeV. Not all MEV is bad. Some of it is like in the context of liquidation, it's useful that it's possible to extract this value. But of course, in situations where MEV results in miners excluding or reordering transactions, or essentially generally causing instability, or potentially instability at the consensus layer, this can start to become quite an existential risk for the integrity of the underlying blockchain. And then we have governance risks, as well as another type of economic risk. So with governance risks, the question is, like, for those who are stewarding a protocol, what, what are their incentives? And how can we ensure that governance is incentive compatible? As I have in the first bullet point, and in DeFi, incentive compatibility has a slightly different meaning to the sort of formal definition economics. And intensive compatibility in DeFi is commonly taken to mean just that.
00:54:48.944 - 00:57:15.684, Speaker B: Governance is operating a DeFi protocol, sort of as intended, as the protocol designer intended it to be operated. And of course, the question is, for those governing the system, are their long term interests successfully being captured, or are they behaving in a way that's essentially just looking just on short term outcomes, short term payoffs and things that can lead to profit for the governors in the next few days or weeks, but the protocol itself could really be making decisions that are against its long run interest. And then finally there's market and oracle manipulation. So this is where, with oracle manipulation, firstly, so this is essentially, just if you can control the way that information is being imported into these smart contracts, then you can manipulate it, and you can potentially manipulate this to a profit. And then market manipulation. This is, of course, a problem in all financial markets, but this is particularly a problem in DeFi, where everything is there, no KYC processes, and because the system is permissionless, you can essentially control many different aspects, observe the effects of controlling these aspects, and you might be able to sort of arbitrarily inflate or deflate asset prices, knowing that this is going to have certain deterministic effects elsewhere in the DeFi protocol. Okay, so lastly, and most importantly, I want to spend a few minutes just talking about the, um, areas for DeFi, future DeFi research, and the open challenges and the things that I think are interesting and worthy of future research.
00:57:15.684 - 00:59:02.858, Speaker B: So the first major area is composability. So we've seen many attacks in DeFi have emerged as a result of being able to compose two contracts together in ways that, um, no one really anticipated were possible. So the question arises how, how can we safely compose protocols together? So how if you write a smart contract, how can you be sure that in the future it won't be able to be used in ways that you didn't imagine and couldn't have foreseen? And this, of course, is very difficult, and we have very, very basic tools at the moment, and the state of research is extremely limited in this area. One promising approach is for just program analysis tools, essentially, which are either fully automated or semi automated, where a user essentially is, or a developer is writing set of unit tests on different parts of the code base. But the problem is that these tests work in isolation from the rest of the set of contracts that are already deployed. So when you're testing, while you may test the happy path of your contract, or you might test that, even if you're integrating just with one other protocol, you might be able to be quite sure that what you're doing is sound. Of course, you won't be sure that you've covered all of the risks and tested all of the edge cases.
00:59:02.858 - 01:00:09.770, Speaker B: And this is extremely challenging. But I think one very important thing is to essentially move beyond unit tests and look also at composability tests. So secondly, and I think this is very rarely discussed in DeFi, but is of such fundamental importance, is the privacy and anonymity. So here you can see just a snapshot I took from Etherscan, which is showing on chain transactions on Ethereum. And you can see that where it says from, these are addresses. And if you're able to link one of these addresses to a real world identity, then you would be able to see everything that person had done with that address as a result of the open and permanently stored nature of the data on a blockchain. Once you know the address, you sort of have this cascade of information where you're able to just know everything.
01:00:09.770 - 01:01:28.018, Speaker B: So Ian Myers has this fantastic quote that cryptocurrency is just Twitter for your bank account, you're tweeting transactions. And this, I think, is a real problem because, of course, for individuals, there's no privacy about how much, how much funding you have on chain or what you're doing on chain and which protocols you're interacting with, which comes with potentially real security risks. And then for commerce, this is another big problem, because commerce relies on often quite secret agreements between different companies. If you started to require the payment flows between different companies, all to be entirely on chain, this is, to my mind, it's not exactly clear how this is actually very practical, because there can be good reasons for wanting to keep that information private. And then there are many other problems as well. So, scalability. So one of the notable features of using any sort of DeFi protocol at the moment is that the fees are, can be massive.
01:01:28.018 - 01:02:09.094, Speaker B: You can easily pay hundreds of dollars for single transactions or single interactions with different protocols. And I've personally heard many people say, I would have experimented more, but it just wasn't worth it. It was going to cost me $400 just to deposit $20 of capital. This is, of course, limiting innovation and the ability for people to just experiment and play around. There are, you know, there are people are working on solutions here. Layer two solutions in particular. This is not a, not a novel observation, but I think this is one of the most important aspects that DeFi needs to contend with is scalability.
01:02:09.094 - 01:03:08.976, Speaker B: There's mev minor extractable value, which can lead to consensus instability. Oracles, it would be great if we could somehow find ways to just develop ways of verifying the data we're getting off chain on chain somehow. Is there some way we can just increase the integrity of these price feeds and just be more sure that where we're relying heavily on these oracle price feeds, that they're actually correct? And then finally, governance. How can we structure governance incentives to make sure that the protocols are being stewarded properly? So just to wrap up then. So here's the question. So does defi equal finance 2.0? So the DeFi optimist, I think that might be quite positive.
01:03:08.976 - 01:04:14.810, Speaker B: The open auditability, in particular of an on chain economy. The fact that you can see everything thats going on, this is potentially a radical gear change in the amount of financial transparency we have, potentially the amount of control that we can have over our economy. You could imagine just a dashboard that shows you the health overall of this blockchain economy, and everyone would be able to trust that the data was being correctly reported. No one was able to conceal anything. But then, lastly is the view of the DeFi pessimist. So while DeFi is fundamentally and radically an open financial system, it means anyone can attack protocols, and anyone can see when an on chain protocol is unhealthy and anyone can spot bugs, and as a result, the error margins are tiny. So I just wanted to finish with this example of just how thin the margin is and how big the stakes are.
01:04:14.810 - 01:04:51.224, Speaker B: So here's an example of this hack that, well, not hack, but mistake that was made in the comptroller contracts within compound a few months ago. You can see on line 1217, there's this loan greater than sign. This should have been greater than or equal to. And as a result, this led to accidentally paying out more than $70 million of comp rewards. And this was, you know, this, this sort of bug. I contend anyone could easily make a mistake like this. It's so tiny.
01:04:51.224 - 01:05:17.254, Speaker B: And yet the mistakes or the consequences of these sorts of mistakes are so grave in this setting where there is no margin. So, yeah, I think the defi pessimist has many reasons to feel pessimistic as well. Okay. So I think that's more or less my time. So I would be delighted to take any questions.
01:05:18.754 - 01:05:20.594, Speaker A: Okay, so thank you. Thank you very much.
