00:00:05.610 - 00:00:54.362, Speaker A: Welcome to Zero Knowledge. I'm your host, Anna Rose. In this podcast, we will be exploring the latest in zero knowledge research and the decentralized web, as well as new paradigms that promise to change the way we interact and transact online. In this week's episode, James and I explore the Cosmos Stargate upgrade. We do three interviews with three different participants in the upgrade that is Zucky Munyan, Tess Reinerson, and Shahan Kechadorian. We talk about what the upgrade was all about, how it went, and what kind of changes it brought to the Cosmos tech stack. But before we start in, I want to remind you to subscribe to ZK Mesh newsletter for the latest in ZK news, research, events and jobs, and more.
00:00:54.362 - 00:01:27.686, Speaker A: The newsletter comes out monthly. Be sure to check it out. I've added the link in the show notes. I also want to say thank you to this week's sponsor, least authority. Least Authority is a security consulting company known for their dedication to pushing the limits on how to build privacy respecting solutions. They are a team of security researchers, cryptographers, and open source developers passionate about advancing the security of projects in the blockchain, cryptocurrency, and DFI space. They're known for their audits of the ETH 20 specification, protocol Lab's gossip sub protocol, Mina protocol, Blocksax investor wallet, and more.
00:01:27.686 - 00:02:18.230, Speaker A: They want to help teams improve the security of their protocol and use of cryptography, including zero knowledge proofs from design to implementation. Their independent reviews improve the security of the technology by immediately helping developers of the projects along with their users. And when the reports are published, the broader community can benefit from this shared knowledge as well. With over 50 completed public audits to date, join the growing list of audited projects to do this book a free consultation@leastauthority.com. Consult I've added the link to this in the show notes, so thank you again, least authority for supporting this podcast. Now here is James and my exploration of the Stargate upgrade. So today, James and I will be exploring the Cosmos Stargate upgrade, and we're going to do this by interviewing three different people.
00:02:18.230 - 00:02:21.030, Speaker A: First off, I want to say hi to James. Hey, James.
00:02:21.190 - 00:02:22.358, Speaker B: Hi, Anna.
00:02:22.534 - 00:02:27.242, Speaker A: And I want to introduce our first guest, Zucky. Welcome back to the show.
00:02:27.376 - 00:02:28.714, Speaker C: It's a pleasure to be here.
00:02:28.832 - 00:02:56.606, Speaker A: And Zucky, you've been on the show before. We actually have an episode that I'm going to add in the show notes where we had a full hour. We got to talk about all the work that you've been doing. Actually, at least up to that point. But since you are somebody who wears many hats, I feel like we should say that for this episode, you are going to be wearing the iclusion hat as we talk about the Stargate upgrade. So why don't you just introduce yourself and what iclusion is doing with Stargate?
00:02:56.718 - 00:03:34.106, Speaker C: Yeah, so I'm Zachy Munyan. I build blockchain protocols. I work on Cosmos and cosmos related protocols and other protocols. I'm a co founder of a company called Occlusion. I co founded it with myself, Christy Polstam, Shella Stevens, and Tony Argieri. And we started this all the way back in 2017, basically with the idea of running a validator and trying to figure out how to be a validator. We do some combination of new protocol development, running validators, supporting Cosmos and the cosmos ecosystem, consulting for other ecosystems.
00:03:34.106 - 00:03:38.258, Speaker C: And basically, the only thing that we don't do that other people do in the space is we don't run a fund.
00:03:38.344 - 00:03:50.326, Speaker A: Got it. So many hats. So let's kick this off. What exactly is Stargate? What is this upgrade, and how did you actually interface with it?
00:03:50.428 - 00:04:48.546, Speaker C: Yeah, so the history of Stargate is Cosmos underwent this sort of significant reorganization in 2020, where a lot of dev teams moved around, a lot of people moved between orgs, and we did Game of zones, which was an incentivized testnet. That was a follow up to Game of stakes, which was the first incentivized testnet. And after Game of zones, which was like sort of the big public test of IBC, I sort of had checked back in, into what was going on in Cosmos software development. And I had known that there were a lot of big changes that were planned, and that there had been a lot of engineering discussion and planning and work. And what I realized in the Cosmos SDK process, like, in the process of doing game of zones, is, I was like, oh, there is no way to ship IBC. I've always felt like a sort of somewhat almost religious obligation to ship the cosmos white paper. And I was like, we can't ship IBC.
00:04:48.546 - 00:05:41.802, Speaker C: We can't ship the cosmos white paper until without also bringing in all of these other changes. And what I realized was those changes were going to have a really dramatic impact on exchanges and validators and wallets. And all of that stuff was going to be this big, really painful upgrade that we had to do in order to ship the cosmos white paper. And so I sort of decided that we were going to take this on, that we were going to do this, that all of these upgrades were all going to get bundled together into this one big upgrade that also enabled IBC and that I was going to go and lead the charge on making sure that exchanges and wallets and validators were all ready for this big disruptive change, which is basically the biggest and most disruptive change that has ever been done on a widely integrated blockchain in the history of this industry. And that's what Stargate was.
00:05:41.936 - 00:06:06.660, Speaker A: Let's talk about this white paper, kind of like what Cosmos was and what it is now. So you mentioned IBC. I actually have done an entire episode on IBC with Crisco's. I'll add the link in the show notes to that. And IBC, as I've always understood it, is the thing that allows for this interoperability in the cosmos ecosystem to actually exist. Before this point, what was Cosmos, actually?
00:06:07.350 - 00:06:38.714, Speaker C: So Cosmos was the first sort of BFT fast, finality proof of stake blockchain. It was the first framework for building blockchains, at least one. The first framework that was sort of widely adopted for build your own blockchain. So people built their own blockchain, kava, terra band, all built their own blockchains on the Cosmos SDK. And then we were this proof of stake BFT consensus system that showed that systems like this could exist. And that was cosmos before then.
00:06:38.832 - 00:06:43.790, Speaker B: The promise of cosmos in the white paper was this Internet of blockchains, right?
00:06:43.860 - 00:06:44.282, Speaker C: Yep.
00:06:44.346 - 00:06:54.226, Speaker B: And it sounds like you're saying IBC and the Stargate upgrade are the last big push to achieve that goal that you set out to do five years ago.
00:06:54.328 - 00:07:20.326, Speaker C: Yeah. So five years ago, I helped with editing and writing and made comments on the original Cosmos white paper. And it was basically this idea of interoperable blockchains and Stargate. The Stargate upgrade happened on the Cosmos hub back in February. Completed the cosmos white paper. The Cosmos white paper is done. The software is shipped, the system is running, it's actually finished.
00:07:20.326 - 00:07:26.102, Speaker C: And it's been a big deal for me personally to have that burden lifted.
00:07:26.246 - 00:07:34.138, Speaker A: What does iclusion and yourself actually do in something like this? What does it mean to do an upgrade from where you're sitting?
00:07:34.234 - 00:08:23.866, Speaker C: So there are more than 100 exchanges that integrate with Cosmos. There are probably about a dozen different independent wallets that integrate with Cosmos. And the Cosmos hub. There are block explorers. There's like a whole ecosystem of software that is not produced by, let's say, anyone who commits code to the Cosmos repository or goes to any software development meetings or is in the discord channels. And so there's this whole peripheral ecosystem that is really fundamental to what makes a blockchain work. Why does a blockchain exist? And the way in which Cosmos sort of organically evolved in the ecosystem is there were dozens of different bespoke integrations between exchanges and wallets with Cosmos software.
00:08:23.866 - 00:08:57.686, Speaker C: And what I realized when we were doing game of zones and getting ready and trying to figure out what it would be like to launch IBC, we realized that this was going to disrupt every single one of those integrations. Yeah. And you had this sinking feeling in your stomach. You're like, fuck. And so I came up with this brand of the Stargate, and the brand of the Stargate is, we're going through this thing. There is a before and there's an after. And once we're after, everything is different, and nothing will ever be the same again.
00:08:57.686 - 00:09:15.200, Speaker C: And I thought the name would be helpful for convincing all of these different entities that they were all going to have to put hundreds of hours into their integrations, fixing the problems and the disruptions with their software that this upgrade was going to cause. And that did work.
00:09:15.650 - 00:09:23.134, Speaker B: So the name was kind of a way to sell the idea to all of these exchanges and external developers who are not part of the core team.
00:09:23.252 - 00:10:05.566, Speaker C: Yep. So essentially, you set up calls and slack channels and telegrams groups with the relevant technical person, the relevant technical content at all of these different organizations. I have an entire telegram folder of just exchanges that I'm tech supporting with Stargate. I have lots of slack channels. I have all kinds of different ways of communicating with these folks. And then you run test nets and you communicate clearly. We published, I think, like 15 weeks of weekly updates on the Stargate launch repository, where we would just update everyone and we would tell people, and then we would just get people to report back.
00:10:05.566 - 00:10:58.302, Speaker C: So one of the things Stargate was all about know, so the IBC feature is the feature for the token holders. It's the one big thing that for the token holders. What mostly Stargate was about was changing the way Cosmos works from a developer point of view. And one of the other things that we were doing is we maintained a backwards compatibility layer between the new way that transactions work and the new way that blocks works in Cosmos and the old way. And basically, a lot of this process was essentially working with the developers at various exchanges on like a trial by fire basis to get them all to tell us what is broken about what this new software and the compatibility layer doesn't work for them. And then going to the Cosmos dev teams and being like, okay, this thing is not working exchanges need it. Such and such large exchange needs it.
00:10:58.302 - 00:11:05.930, Speaker C: Can we fix this bug? Get that bug out, get a new testnet launched, get the exchange to test against the new test net, get to the next bug.
00:11:06.010 - 00:11:06.846, Speaker D: Fix that.
00:11:06.948 - 00:11:07.558, Speaker A: Damn.
00:11:07.674 - 00:11:23.766, Speaker C: And the plan was basically that we were going to land all of the exchanges and their integration issues and the software being qaed and ready and all of these pieces together on basically the same day. And that's basically what we did.
00:11:23.948 - 00:11:58.930, Speaker B: This is kind of interesting for me because at Suma, we did a significant amount of work on a Cosmos SDK module, and we are currently in the process of upgrading that to the new version of the SDK. And just to take a relatively simple extension to the Cosmos ecosystem and upgrade it is taking probably a few dozen hours. It is not surprising to me to hear that exchanges are spending hundreds of hours on this because it is much more far reaching through the tech stack than any other hard fork I've seen.
00:11:59.080 - 00:13:03.970, Speaker C: Yep. That is the reality of the situation, basically. I probably hadn't really looked very closely at what's going on in the Cosmos code base for, like, four or five months, because I've been dealing with both trying to sort of set strategic direction inside of tendermint and then leaving tendermint and then reorganizing the entire cosmos ecosystem and trying to make that, all of that work. And so game of zones happened. I sort of started to look at what is actually going on here, and I realized, oh, you guys have decided to break everything, and for all good reasons, that will make a huge difference in the future. And all of this stuff is reasonable and logical and makes a lot of sense. And any point in time in which we'd waited even longer to make these changes, they would have been harder to, you know, all in all, it was like, I'm not expressing remotely any regret into it, but the Stargate upgrade was this immense lift to try to get a very widely integrated, very complex blockchain that has lots and lots of different integrations.
00:13:03.970 - 00:13:29.360, Speaker C: The other thing about Cosmos, right, is it was Cosmos never really participated in the listing process with the team or tendermint or no one ever really went out and got Cosmos listed on any exchange. So every exchange permissionlessly decided to integrate Cosmos, and just every single exchange came up with their own completely unique integration, which has been so much fun to support.
00:13:30.850 - 00:13:49.062, Speaker A: Oh, my gosh. This sounds like such a huge endeavor. Let's do something for our listeners, though, and also for me, actually, would you define Stargate as an upgrade? Like, one upgrade, or is it a set of upgrades. Do you bundle this all into one thing? And I guess the other question is, is it over?
00:13:49.196 - 00:14:16.640, Speaker C: That was the reality of it is it was over. There is a point in which you go through the Stargate, right? You're on one side and you're on the other side. The name has really turned out to work really well. Like that visual metaphor of I'm on one side of the Stargate. The Stargate opens, I go through it, and I'm on the other side. I don't know how many people remember the TV show. It's on Netflix now, so there's, like, lots of people who can watch.
00:14:16.640 - 00:14:30.526, Speaker C: Mean, I love that TV show so much growing up. But, yeah, this metaphor of there's like a membrane and you're on the other side, and everything is different on the other side is extremely accurate.
00:14:30.638 - 00:14:32.066, Speaker A: So are we on the other side?
00:14:32.168 - 00:14:34.546, Speaker C: Yeah, we are on the other side today.
00:14:34.648 - 00:14:40.914, Speaker A: Okay, so let's go into this. So back to that question of is it one upgrade or a series of upgrades?
00:14:41.042 - 00:15:02.220, Speaker C: Yeah, it was one upgrade. It was one event. That was the realization that all of these changes that people had made or were in the process of making had to be bundled together into one big, painful change that all had to be done at once because everything was so tightly coupled together that there was no other way.
00:15:02.750 - 00:15:16.738, Speaker B: So there were a number of major features that needed to be added or refactoring or things that needed to be changed. And the decision was to bundle them all into one extremely painful upgrade and go through it all at once. Right?
00:15:16.824 - 00:15:17.460, Speaker C: Yes.
00:15:17.830 - 00:15:32.054, Speaker A: What makes it painful? I want to understand this. You describe the exchanges having to put all of these hours in, but what does one of these exchanges actually do? Don't they just kind of take new software that already exists and just spin it up?
00:15:32.172 - 00:16:39.318, Speaker C: That is not, in general, what an exchange looks like integration looks like. And it makes sense to me that very few people are familiar with this. So the first thing you can do is, if you wanted to understand what an exchange integration looks like, is Coinbase has done this Rosetta standard, right, which is essentially attempting to formalize and standardize the interface between a cryptocurrency and exchange and a blockchain piece of software, and Cosmos is working on being integrated into having a Rosetta integration. But if you look at all the exchanges, the scope of what's in Rosetta is the scope of what an exchange has to do. They have to be able to send and receive funds, manage keys, manage usually hot and cold wallets, move funds back and forth between them. Many exchanges are integrated into proof of stake systems, so they need to be able to have staking rewards, unbonding. And as your blockchain becomes more featureful, there are more opportunities for exchanges to integrate the features of your blockchain into their software.
00:16:39.318 - 00:17:29.350, Speaker C: And exchanges may choose to do anything from use the queries and RPC calls of your network that your node provides to interact with the network. Use the API that your node provides to interact with the network to write thousands of lines of code directly in the cosmos, SDK to interact with the network. Again, every single exchange pretty much has a unique version of this. The world of all exchanges to use. Rosetta sounds like amazing and magical and fantastic and would make things like something like the Stargate upgrade a lot easier because there would only be one API surface area that you had to migrate over the upgrade to. But I did not get to experience that world. I got to experience the world of everybody has unique upgrade and there are over 100 exchanges that list atoms.
00:17:29.350 - 00:17:37.854, Speaker C: I have different relationships with them and I had to help them all with random troubleshooting problems. And I'm probably still helping a bunch of them today.
00:17:37.972 - 00:18:11.354, Speaker B: This is really interesting to me, working on some of these core blockchain clients like Geth and Gaia and cello. I feel like we're targeting these at specific users, people who are independent devs, running them at home or in the cloud. And exchanges are so far outside of that class of users, they have completely different needs for a blockchain node. So it sounds like the pain point here is that Gaia itself is not serving the exchange's needs. And they have all resolved that in different ways, right?
00:18:11.392 - 00:18:11.990, Speaker C: Yep.
00:18:12.150 - 00:18:22.698, Speaker B: And so you and the know, Gaia and Cosmos developers have to go out to each exchange and help know update their bespoke setup.
00:18:22.794 - 00:18:23.386, Speaker C: Yep.
00:18:23.498 - 00:18:24.270, Speaker A: Ouch.
00:18:24.690 - 00:18:26.842, Speaker B: That sounds incredibly painful.
00:18:26.986 - 00:18:27.678, Speaker D: Yeah.
00:18:27.844 - 00:18:48.158, Speaker A: Let's talk about what's in it. What is it doing? I had Chris goes on the show, I think about a year ago, maybe it was a year and a half ago where he talked about IBC. So I know that IBC is a huge component. IBC meaning like basically the ability for these zones to actually interoperate. Thus one of the key for Cosmos.
00:18:48.174 - 00:18:49.450, Speaker C: To be an Internet of block.
00:18:49.550 - 00:19:02.374, Speaker A: Exactly. For it to become what it's sort of set out to be. It's a huge thing. But is there something else to this? Like are there other kind of key changes that would even be recognizable to an outside viewer?
00:19:02.502 - 00:20:16.834, Speaker C: Yeah. So most of these changes are designed to improve quality of life. Not really for end users of our software, like Atom holders, et cetera, IBC is probably the most atom holder facing feature of this whole system. There are a couple of other minor things that are related to how the community pool can work and stuff like that, but IBC is the big feature for token holders. Really what the focus of Stargate was is this totally reconceiving the developer experience and the node operator experience of running the Cosmos software is this is very much in the weeds. But when you write a blockchain, a big part of writing a blockchain is how data and transactions are actually written to the network and read from the network and written to disk. What are the transactions that are actually in the blocks? What do the blocks look like? And virtually every blockchain protocol Cosmos had an in house homegrown solution to.
00:20:16.834 - 00:21:22.754, Speaker C: What do the transactions actually look like? As bytes on the wire? What do the blocks actually look like? And this homegrown solution was incredible pain point for developers. And the biggest thing in Stargate was we are going to reconceive this homegrown solution into something that uses a standard format that is widely used in the entire computing industry and is no longer a unique thing to blockchains. And it kind of represents the overall goal of the direction of the cosmos sort of developer community, to make cosmos look less and less like a special, unique blockchain snowflake, produced by some weirdos and more like a standard piece of Internet infrastructure. And that change was the thing that is the reason why I had to talk to all of the exchanges and all of the wallets and all of the custodians and tell them, because what they had done is they'd all figured out their own ways of dealing with our unique blockchain snowflake software.
00:21:22.882 - 00:21:23.798, Speaker A: Got it.
00:21:23.964 - 00:22:07.142, Speaker C: And the other thing that we did that was extremely painful was we changed the entire inner workings. So every transaction that's on the network all different, but we maintained a backwards compatible interface for all of that. That is like 99% backwards compatible with the old version, allowing people to sometimes not have to do all of this upgrade all at once. But part of the reality is if you build something that is 99% compatible, you're going to run into the situation where the 1% that's not compatible is going to break interfaces for someone, and then you're going to have to deal.
00:22:07.196 - 00:23:14.330, Speaker B: With it getting into kind of how transactions and blocks are stored and transmitted between nodes. I have a bit of a personal anecdote here. Early on in my Cosmos SDK development experience, we were at a hackathon trying to put together a very simple cosmos module, and we kept running into an issue where a specific transaction would always fail. And it wouldn't just fail during processing, it would fail signature checks on the node, and we couldn't figure out why because we were building it and signing it just the same as all the others. What it turned out is that the client was sending an empty list, and when it went through the serialization and deserialization, the node was receiving instead of the empty list, nothing. So some step in there was taking what I had sent and signed, which was the empty list, and replacing it with nothingness. And that's why the signature was no longer working, is because the serialization and deserialization actually changed what we had sent.
00:23:14.480 - 00:23:49.494, Speaker C: So I have two responses to this. One is, this is weird. Edge cases is why it's better to use Internet standard software. So we have switched from Amino to Protobuff, which everyone uses, but the nightmare of Stargate is that we have maintained a lot of amino backwards compatibility. So there is actually a translation layer in the Stargate software between the new protobuff stuff and the amino stuff that has to be one for one bug compatible with the old amino stuff. And somehow this works.
00:23:49.612 - 00:23:50.520, Speaker B: I'm so.
00:23:55.130 - 00:24:13.710, Speaker C: And like, really? It goes to Aaron and the Regen team for pulling off this miracle. It's pretty amazing that this part of it went through the Stargate and we succeeded. And it was painful and it was a lot of work and a lot of hours, but also pretty amazing that we were able to pull this off.
00:24:13.860 - 00:24:26.194, Speaker B: Yeah, definitely. It's a really impressive bit of work. And I have to say that the new protobuff stuff is much nicer to work with, and I am a huge fan of outsourcing maintenance of this to Google.
00:24:26.312 - 00:24:26.980, Speaker C: Yes.
00:24:28.390 - 00:24:46.054, Speaker A: I kind of wonder, with the upgrade, like, so far, I think of this as like, it's focused mainly on the Cosmos hub, but is it also across all the zones that have been built using the Cosmos SDK? This is what I kind of want to. It did. They all have to upgrade something as well.
00:24:46.172 - 00:24:55.142, Speaker C: So in order for them to participate in IBC, to start sending tokens to participate in the Internet of blockchains, they need to upgrade to Stargate.
00:24:55.206 - 00:24:55.834, Speaker A: I see.
00:24:55.952 - 00:25:29.734, Speaker C: So that's one piece of the story. A number of zones have either upgraded to Stargate, like Akash has upgraded to Stargate, or have announced that they are going to upgrade to Stargate. There's quite a lot of demand right now for engineers who can do Stargate upgrades on Cosmos modules. So there's quite a lot of consulting going on, doing that in the work that James is doing, upgrading his Cosmos module to. So, like, in order to get the Internet of blockchains, you got to do Stargate. And by doing the Cosmos hub and doing the Cosmos hub first, we paved the way.
00:25:29.772 - 00:25:30.262, Speaker E: Right.
00:25:30.396 - 00:25:38.370, Speaker C: Every exchange that has an integration, their integration with the hub is how they is the basis for their integrations with all of the other chains.
00:25:38.450 - 00:25:38.982, Speaker A: Got it.
00:25:39.036 - 00:26:26.770, Speaker C: The other thing about Stargate is really, once we went through this and we're not going back, the Cosmos dev teams are only really building stuff for the post Stargate world. If people want the latest improvements to tendermint and the Cosmos stack, they got to upgrade to Stargate, too. The other realities of it is. Right, is, in general, all of development slowed down across the cosmos ecosystem because the Stargate upgrade was ongoing and people either didn't want to build stuff knowing that they would have to do the Stargate upgrade later or didn't want to build stuff on top of half completed versions of Stargate, which was probably not a bad decision for most people. And so now that we're on the other side of Stargate is actually a lot more scope for building stuff on top of cosmos.
00:26:26.850 - 00:26:36.214, Speaker A: That's exciting times in the cosmos ecosystem, then. Zucky, thank you so much for the interview and giving us your perspective on the Stargate upgrade.
00:26:36.342 - 00:26:37.980, Speaker C: Yeah, thanks, guys.
00:26:42.290 - 00:26:51.850, Speaker A: So now we're sitting with Tess Raynerson, who's the VP of engineering at Interchain Gamebeha and product owner for Tendermint Core. Welcome to the show, Tess.
00:26:52.010 - 00:26:53.422, Speaker E: Hi. Thank you so much.
00:26:53.556 - 00:27:06.494, Speaker A: I'd love to find out a little bit, and also, I think, to give some context to our audience, what exactly do you do as VP of engineering at interchain, and how do you exactly interface with this Stargate upgrade?
00:27:06.622 - 00:27:39.146, Speaker E: Yeah, totally. That's a good question and definitely merits a little bit of explanation. So at interchain Gambaha, we focus on basically, like, three pillars of core technology for Cosmos. One of them is tendermint core, which is the consensus engine. One of them is IBC, which everyone listening to this knows what IBC is. And then there's also Gaia, which is like the daemon that actually runs on the Cosmos hub. So it's like the software that kind of ties the Cosmos SDK together for the Cosmos hub specifically.
00:27:39.146 - 00:27:54.878, Speaker E: And I actually spend like 90 or 95% of my time focused on tendermint core. So I said I'm the product owner for it. I'm the engineering manager for that team. I also sort of do manage the managers of the other teams at interchange. Gamba.
00:27:54.894 - 00:27:55.074, Speaker C: Ha.
00:27:55.112 - 00:28:09.078, Speaker E: And sort of like work on general, I don't know, engineering management practice, for lack of a better word, for the company. But I actually really focus mostly on tendermint core, and that's where my technical passions and interests lie for people a.
00:28:09.084 - 00:28:16.998, Speaker B: Little less familiar with the architecture. Would you mind talking a little bit about the separation between tendermint core and Gaia or the Cosmos SDK?
00:28:17.094 - 00:28:55.830, Speaker E: Yeah, totally. So, I mean, if you think of them as like an infrastructure stack, basically, which is an imperfect analogy, but there is sort of this dependency direction to them. If you think of them as a stack, tendermint core is at the bottom. It is an algorithm for state machine replication. Usually when we say tendermint, we're talking about like the algorithm, which is this proof of stake consensus algorithm that also borrows heavily from academic distributed consensus algorithms. And that's actually kind of why I like it. It's like this kind of funny, very cool hybrid of sort of these ideas from blockchains and these incentivized systems, and then also this very academic, classic distributed systems thinking.
00:28:55.830 - 00:29:28.290, Speaker E: So that's one of the things I really like about it. So it's this almost agnostic protocol for replicating state. In this way, you don't necessarily even really need a blockchain or a cryptocurrency to use something like tendermint. So that's at the bottom. And it just lets you, again, replicate state from one node to another in a network. And then you have the Cosmos SDK, which actually provides an application layer on top of tendermint. So most people who are building cosmos blockchains are going to use the Cosmos SDK.
00:29:28.290 - 00:30:07.194, Speaker E: There are some other blockchain applications that use tendermint directly, but for the sake of this conversation, I'll focus on the cosmos side of things. So Cosmos is like one layer up. And the analogy that people sometimes like to make with cosmos, an aspirational analogy in many ways, but people like to say it's like rails for blockchains. It's really meant to be this framework, this tooling that makes it really easy for anyone to spin up a blockchain pretty quickly. Again, a little bit aspirational, but that's the goal, and I think it's a good one. And then Gaia, like I said, it's the daemon. So it's like literally like the software process that runs on the Cosmos hub.
00:30:07.194 - 00:30:28.310, Speaker E: So if you are trying to join the Cosmos hub, you need to run an instance of Gaia. And Gaia is built using the cosmos SDK. So you have this set of layers going up almost for, like, tenerments at the bottom. And then there's the Cosmos SDK, and then there's Gaia. Now, this does beg the question, like, where does IBC fit into all of this? Right.
00:30:28.380 - 00:30:29.800, Speaker B: I was just about to.
00:30:31.610 - 00:31:14.162, Speaker E: The natural. The natural thing to wonder. So, you know, I'll channel. Chris goes here for a moment, who's sort of the original author of IBC, and I'll point out that IBC is really like a blockchain network agnostic protocol. So when we talk about IBC as a protocol, we're really talking about the specification, the know, the protocol that has to be spoken and not the implementation. But the way that IBC is implemented for the Cosmos network is in the Cosmos SDK. So there is a module, the Cosmos SDK is comprised of all of these modules that let you do different things, whether that's staking or.
00:31:14.162 - 00:31:42.426, Speaker E: I think there's, like, account management, or I think there's even, like, different consensus modules. If you don't want to use tendermint for some know. Breaks my heart, but I understand anyway, there's an IBC module within the Cosmos SDK, and that is where IBC for the Cosmos hub is implemented. Again, that distinction is a little bit pedantic, but I think Chris would be upset with me if I didn't say it, so I'll make that really clear.
00:31:42.608 - 00:31:44.220, Speaker B: I bet he would.
00:31:45.310 - 00:32:00.130, Speaker A: I kind of want to go back. I have just another question about Gaia. I just want to take a quick step back. Is that the client, or is the client in it? It. Is it a version of the SDK, or is it a specific client software? This is what I'm not thinking about.
00:32:00.280 - 00:32:02.530, Speaker E: I think it depends on what you mean by the client.
00:32:03.990 - 00:32:13.026, Speaker A: I guess I'm thinking always in the Ethereum context of, like, you're running a geth client, you're running a node with this particular software.
00:32:13.138 - 00:32:27.980, Speaker E: I think it is. If you want to both know more about Gaia specifically and also understand the comparisons to Ethereum. I know you're talking to Shahan next, and he both comes from the Ethereum world and works all the time on Gaia. So he is your guy.
00:32:28.990 - 00:32:29.498, Speaker C: Amazing.
00:32:29.584 - 00:32:32.078, Speaker E: He will tell you conclusively. Yeah, sounds good.
00:32:32.164 - 00:32:34.878, Speaker B: Okay. Can I take a shot at an analogy here?
00:32:34.964 - 00:32:36.126, Speaker A: Go for it, please.
00:32:36.308 - 00:32:52.370, Speaker B: Tendermint core is the engine at the center of this machine. Cosmos SDK is going to be how you get the gas in and the energy or movement out of the engine, and then Gaia is the actual machine that we've built.
00:32:52.520 - 00:32:55.562, Speaker E: Yeah, I think that's a pretty good analogy.
00:32:55.726 - 00:32:58.520, Speaker B: It's not perfect. Needs work.
00:32:59.770 - 00:33:02.166, Speaker A: Maybe by the end of this episode you'll have it.
00:33:02.188 - 00:33:05.000, Speaker B: Yeah, we can reshoot later, take this part.
00:33:07.530 - 00:33:25.998, Speaker A: So let's now kind of turn our attention to Stargate and how we learned just before from Zucky how kind of his perspective on what this upgrade looked like and the kinds of work he had to do. But I'm really curious, from where you're sitting, what did this upgrade actually mean?
00:33:26.164 - 00:34:23.470, Speaker E: Yeah. So I think, especially coming from sort of like the tendermint core perspective, like kind of the lower level core engineer side of things, Stargate really represented the culmination of probably a year and a half of work to prepare the cosmos infrastructure for IBC. So I think, as some people will know, the Cosmos hub had launched in early 2019, and it launched as many systems launch as sort of like a first draft. Right. There were a lot of things that were like everyone's best guess of how the system should work and how it should be laid out and what encoding algorithm it should use for things and how it should serialize data or what data structures should be used. And some of those things turned out to not necessarily have been the right choice, which is just how this goes. That said, because this is a blockchain, it's actually very difficult sometimes to make these changes.
00:34:23.470 - 00:35:07.230, Speaker E: If we were working in a system that had immutability or didn't need to have this long, immutable, consistent history, things would be a little bit easier to change. But with blockchains, often you have to treat these kinds of changes as huge breaking changes. And so that, I think, is kind of the reason that Stargate became a whole thing. Right. The core teams had to kind of rethink a few of the assumptions that turned out to maybe not be as usable as they'd hoped or the performance wasn't there. And again, this is very natural part of software evolution. But I think one of the things that's kind of novel for blockchains versus more traditional software development is that you have to figure out things like how to get around this immutability issue.
00:35:07.230 - 00:36:06.778, Speaker E: And so I think that's kind of like. I think actually it was Zucky's idea to know we should really brand this launch because we're going to need so many people on board and all the clients are going to break and all the wallets are going to break and every valid, it's going to be a huge thing for validators. And I think a lot of that was really driven by this change to the serialization format. So basically, the first version of Cosmos and tendermint and all of that used like an in house encoding algorithm for serializing data. And it just wasn't as performant or as usable as we wanted it to be. And so there was basically a huge migration process that took a really long time, and it took many smart people working for many, many hours to make the switch over and to do it in a way that wouldn't be breaking. And so that I think, again, this is really biased as someone who's working on kind of low level, the stuff that's kind of at the bottom of the stack.
00:36:06.778 - 00:36:50.730, Speaker E: But to me, that was actually like the motivating thing for even the branding of it as Stargate and all of that. It was like, this is the thing that's so breaking. We know it's really important because this is so foundational, but it's going to be so breaking. We can't just rip the band aid off or pull the rug out from everyone. This is actually going to become something where we need everyone to buy into it together. And the amazing thing is that people like Zucky, and I think chiefly Zucky, were able to go around and really rally that support from not only all of the development teams across the ecosystem, but partners and wallets and exchanges and do all of that. I mean, it's kind of like the most boring kind of this huge branded release.
00:36:50.730 - 00:36:56.740, Speaker E: But from where I sit, that really was one of the biggest, if not the biggest, motivations for this whole thing.
00:36:57.110 - 00:37:13.160, Speaker B: Okay, I have a couple of questions about this. First, was the idea behind branding it that you couldn't rally companies and the ecosystem around a numbered release, and so we had to make this something special that people would get behind.
00:37:13.610 - 00:37:45.262, Speaker E: I don't want to say it's like, oh, people couldn't get excited about a numbered release because that makes it sound like people are frivolous or something. I think it's more that it's just confusing. It's better to have something that's tangible. And frankly, we had to change the numbered release that we thought it was going to be a couple of times. And also it was useful to have something that was a moment that we could point to and we could say, like, this is the tendermint core version that's going to support Stargate. This is the Cosmos SDK version that's going to support Stargate. And this is the Gaia version.
00:37:45.262 - 00:38:03.734, Speaker E: Those numbers are all different. So if you can kind of package them all up and say, this is the Stargate release bundle, effectively, this is the set of software that we will run when we all go through the Stargate together. If you can do that, it's just an easier story to tell because it.
00:38:03.772 - 00:38:10.120, Speaker B: Touches so many pieces. It's not just a couple releases here and there. It's an ongoing project.
00:38:10.650 - 00:38:11.590, Speaker E: Totally.
00:38:11.930 - 00:38:36.578, Speaker A: One thing we didn't get a chance to talk about with Zucky was kind of the, because what we talked about mostly with him was that he was doing a lot of communicating, exactly this thing you were saying of like, sending the message out, getting everybody together. But I'm kind of curious on the timeline, was the work already done, had a lot of the build been finished and then there was this period of communication, or was it like, communicated and then you had to work? I'm kind of curious how that happened.
00:38:36.664 - 00:39:25.486, Speaker E: There was some overlap. So I joined the project in late fall 2019, which is to say, I haven't been with it for that long. And at the time, a lot of these changes had actually already been decided, but it wasn't really clear how they were going to actually end up on the hub. So people knew they wanted to change the serialization format, or they knew that there was a path forward for IBC, or there were a few major tendermint core features that we knew we wanted to do. So there kind of was a path there. And the big question mark was like, what does it actually look like to get this onto the hub? And we had been writing the software and doing the development for several months before the communications started. But the comms phase that Zucky sort of ran and managed definitely began before the software was finished.
00:39:25.486 - 00:40:08.986, Speaker E: So he was working on rallying the troops starting in July or August of last year. I think if he said something different, he's going to remember more clearly than I did. But it was last summer, and then at that time, the tendermint core team, and again, because it's the stack, the tendermint core team has to finish their work first. Right? Again, you can start building on top of it, but you have to cut the releases in order. So the tenement core team at that time was mostly done with the work. We were wrapping up a few outstanding things, and really we were running, putting out what we call release candidates. So things that we think will be the software that will run on the hub for sort of the next major tenement release.
00:40:08.986 - 00:40:23.758, Speaker E: That process lasted a few months and we had lots of people try the RCs out, find problems, and then we go back and fix them. And so I think it was like the first week of November or maybe the end of October when we actually cut that final release for Stargate.
00:40:23.854 - 00:40:28.486, Speaker A: Was the game of zones kind of during that era, or was it after or before?
00:40:28.508 - 00:41:11.170, Speaker E: Game of Zones is actually a little bit before. Okay. And the reason that we could do that, I think, was that that was really testing the IBC piece of it specifically, which didn't depend on fully ratified changes all the way down the stack. If that makes sense, you could kind of test that piece a little bit in isolation, and that's what Game of zones is all about. That said, there were so many later testnets that know, maybe with slightly smaller prizes or a little bit less advertised, but many, many testnets were run leading up to stargate that Zucky and others, other teams also managed. And those were instrumental in finding bugs and helping us get stuff fixed.
00:41:12.150 - 00:41:40.650, Speaker B: Interesting. You mentioned that there was a lot of people feeling like they would eventually move away from amino or people wanted to do this. And I remember from being involved in Cosmos a few years back that everybody disliked Amino, but nobody was willing to do anything about it. Would you say there was like a specific person or event that turned this from mild distaste to actual action on a big scale?
00:41:42.110 - 00:42:19.094, Speaker E: I don't know that there was any single person or event. I will say that this work, when I joined the project, and I joined the project again to kind of lead tenorment core. When I joined the project, that feeling was very, very strong and the work had already begun to remove Amino and replace it with protocol buffers. So that was not my decision. I also stood by the team in that decision and I was like, this is something we're going forward with. This was not something that every single person in the ecosystem wanted. And there was a tenderament fork, briefly called tenderament classic, that had amino in it.
00:42:19.094 - 00:42:57.080, Speaker E: Still. I don't think that project is still under development, but I'll just be honest, this is not like a universally beloved decision, but it was something the team really wanted to do and I know a lot of users really wanted it too. And so I think it was helpful to have someone who was at least nominally in a leadership position. I was like brand new to the project, so what did I know? But I was nominally in a leadership position and I said, I really trust this team and I trust the way they want to execute on this. And so I think that helped. Around the same time that that decision really was ratified, that was also the time that interchange GmbH was formed. And that was another thing, too.
00:42:57.080 - 00:43:31.354, Speaker E: It's like interchange GmbH, it's a safe space for core engineering. That's the joke. And it's a place where people can make decisions like that. That might be a little bit politically unpopular, but technically correct. Obviously, I'm biased when I say that also, but that's really what it's meant to be. It's like we're kind of liberated from other initiatives that are happening in the ecosystem, and we can really just try to focus on building the best core technology that's going to serve as many people as possible. That's the mandate.
00:43:31.354 - 00:43:34.430, Speaker E: And that's really why interchange Gambaha exists.
00:43:34.590 - 00:43:36.078, Speaker B: That's a great mandate.
00:43:36.254 - 00:43:36.980, Speaker E: Thanks.
00:43:37.590 - 00:43:51.606, Speaker A: What you just described, you said there was this very short fork, but was that fork when you did the Stargate upgrade, or was that fork when you did something else in the past? Because I thought it was all bundled into this one thing.
00:43:51.788 - 00:44:16.874, Speaker E: That was something that I won't beat around the bush here. This is something that Jay Kwan, the original author of tournament, wanted to keep using amino. And so he forked the project, I think at the point at which it became clear that this amino removal initiative was going to proceed. And so I don't remember exactly when that happened. I think it was maybe about a year ago. I'm not totally sure. There's no bad blood there or hard feelings.
00:44:16.874 - 00:44:51.714, Speaker E: This is just one of those things that happens, right, in blockchain development. Sometimes you have a political disagreement or like a technical disagreement, and someone forks the code base, and sometimes those things reconcile again later, and sometimes they don't. In this case, I think from a community perspective, there wasn't an enormous amount of contention. And again, I think it also really speaks to organizing scale and also the strength of the cosmos community that there wasn't any confusion there, right. And people were like, no, we know what you want. We know that we want to move forward with Stargate. This is not a big issue in any way.
00:44:51.714 - 00:44:57.354, Speaker E: But I just mentioned this just to say sometimes there are technical disagreements, and this is how this goes.
00:44:57.472 - 00:45:00.054, Speaker A: I think when you said fork, I thought fork the blockchain.
00:45:00.102 - 00:45:25.960, Speaker E: But you just term the word fork is so overloaded. Overloaded, yeah, that's true. I'm just glad that I work in a system where we don't get the forks that are like an accident of consensus and these probabilistic proof of work type chains. So at least we don't have to worry about that kind of fork. No, I just meant a fork of the repository, a fork of the code, and of the project.
00:45:26.330 - 00:45:34.550, Speaker B: Got it. Are you worried about consensus failures between the go implementation and rust one, if that ever gets completed?
00:45:34.970 - 00:46:11.698, Speaker E: I think the rust implementation has been a great forcing factor for the whole project to get really scrupulous about the specification. And fortunately, there's a lot of other reasons to also be scrupulous about the specification. I mean, there's the usual, the table stakes. Like, if you have a good spec, then you're going to have better code. That's just table stakes. But there's also all this work that informal systems is doing to actually formally specify tendermint and then formally verify that specification. So there's lots of reasons to have an implementation and a spec that are very true to each other.
00:46:11.698 - 00:46:35.900, Speaker E: And so for that reason, because that work is happening, I'm less worried about the rust implementation and the go implementation diverging from each other. It is a risk, but there's always a risk in these consensus systems that something breaks consensus. That is our one job, right, is preventing that. And so it's something that we'll be careful about, but I'm not super worried about it at the moment.
00:46:36.510 - 00:46:44.906, Speaker B: Interesting. It's an extremely difficult job. One of the recent geth ones was caused by a shallow copy. Deep copy optimization.
00:46:45.018 - 00:46:47.920, Speaker E: Yeah. There's so many ways to screw things up.
00:46:50.450 - 00:46:51.726, Speaker B: Yes, there are.
00:46:51.908 - 00:47:07.574, Speaker A: One thing that I'm still curious about is, during this upgrade, the actual upgrade time, what was that like, in a way? What was that like in general? How was that really rolled out? And also, what was it like for you? What were you actually doing?
00:47:07.772 - 00:47:40.654, Speaker E: Oh, man. So it was extremely stressful. I'm not going to sugarcoat it. I mean, it was one of those things where I knew that it was potentially going to be all hands on deck and that people were going to be standing by for it. The scheduled upgrade time was also like 06:00 a.m. My time, which is just like a kind of a brutal, I mean, it's a global community, it's a global project. I think it was timed for the convenience of the exchanges in Asia, explicitly, for some reason, I don't know all the details there, but it's a political decision, actually, to decide when the upgrade goes.
00:47:40.654 - 00:48:18.474, Speaker E: And I drew the short stick, basically. So it was kind of this tricky timing. And I'll say from a tendermint core side, it's like our software had been pretty much stabilized and had been. We cut the Stargate version of Tendermint back in November, and the upgrade was in February. And what was actually great about that is that it gave the software some time to mature. And like I said, there are non cosmos users of tendermint, and some of them actually started using the Stargate version of Tendermint before Cosmos did. And some of them found some bugs, which was great.
00:48:18.474 - 00:48:39.902, Speaker E: And we were able to work with them to get those bugs fixed. So I'll give a particular shout out here to crypto.com. Their team surfaced a security issue and helped us test it. And they were just like fantastic partners. They were awesome. Anyway, so some things have been serviced, but on the whole, it's like this software has been around for a few months. It seems pretty stable.
00:48:39.902 - 00:49:12.346, Speaker E: It's pretty okay. And then at about 11:30 p.m. The night before the 06:00 a.m., upgrade, I got a message from someone that said, hey, I submitted a security issue to your hacker one, and it looks like it's stuck in triage. I just wanted to let you know that my private keys are all over my logs for his validator. So, like his consensus keys, they'll let you sign blocks, and also if you misuse them, the validator gets punished. Were being leaked all over his logs, and logs sometimes get shipped off to log providers.
00:49:12.346 - 00:49:57.866, Speaker E: Like a log is not a secure place. And I was like, oh God. And what had happened was that, like I said, the Cosmos SDK is a downstream dependency of tendermint core. And I'm going to get a little bit detailed here, but I think it'll be interesting to any programmer. What had happened is that the Cosmos SDK changed their logging library to something that when you passed in, an object would use reflection to look at the internals of the object. While tendermit core was using a logging library that assumed that you'd call the to string method on any object and you get the string representation. So we had in the tenement core code base this particular private key type.
00:49:57.866 - 00:50:41.446, Speaker E: And the one that we were using is like, or the one that was a problem is like local key storage, which no one really should be using in production. So it's not super secure anyway, so probably not that big of a deal, but just like a really bad vibe and look, to have these keys here. So what had happened is that tendermint core expected this thing to be stringified, and the SDK was actually looking at the object itself. And the two string method in tendermint would strip out the private key material, but if you look at the object itself, you can get that private key material. And so that's what had happened. It was this discrepancy between the logging libraries, which is like the most mundane thing you can think of, but it had this really ugly effect. It just looked catastrophic.
00:50:41.446 - 00:51:23.510, Speaker E: Even if again, you probably shouldn't be using this type of key, this file storage for your keys in production, we were like, probably someone is, if you tell programmers not to do something, they're going to do it. And so basically with about six or 7 hours on the clock, I was like, all right, we got to figure this out. And it wasn't obvious at that point when I saw this problem, that the problem was the logging library thing. It was just like, something is wrong. And so fortunately I was able to rope in a few, uh, Alexander Bez, who is known as Bez, who's a time Cosmos contributor, who's working on tender McCor now. He's in New York. So he wasn't asleep yet.
00:51:23.510 - 00:52:02.610, Speaker E: So I basically called him up and I was like, what's going on? And he and I looked at, you know, he has worked on both the cosmos and the tendermint sides. And so he was the one who was able to diagnose it because he knew both code bases really well. And then we tried to cut a new release and there had been a go release that week which broke all of our release tooling. So where our release tooling expected a different version of Go than we were using because a new version of Go had been released two days earlier. And it was just this series of unfortunate events basically that unfolded at like three or four in the morning, like 2 hours before the release happened. But you know what's wild?
00:52:02.950 - 00:52:16.262, Speaker A: You feel how much, as much as it's a technical thing, there is kind of like a right way that this works, but it is this emotional thing as well where it's like if things like this happen, it just throws off the entire process.
00:52:16.316 - 00:52:16.594, Speaker D: Totally.
00:52:16.642 - 00:52:21.514, Speaker A: It sounds like you can't just push through that stuff because it will hurt, it will do something.
00:52:21.632 - 00:52:43.230, Speaker E: Totally. And so I was up really late. Alessio, who works at Tendermint Inc. Was up really late. Shahan was up super late. Well, I guess it wasn't super late for him yet, but he still had to get up really early the next day to deal with all this stuff. And so I basically got the release done at 430 in the morning.
00:52:43.230 - 00:53:48.606, Speaker E: And then I went to bed and then I woke up at six to just see if the release had started and I was like too tired to function. So I went back to sleep, and then we did a little launch party, which was super fun, but that was like a couple of hours later, I got up for that and then I went back to bed, which is all to say that I pretty much slept through the actual Stargate release. So I had a lot of stuff to deal with right up until that point. And then it was actually amazing to look back on because the validators and the community members were so incredibly supportive of each other and of helping each other out. And there were people from core teams who were standing by and helping out with things, but there were a number of people who are community members and who are running validators, who are just like helping each other out, answering questions. I don't actually know the details of this, again, partly because I slept through it, but there were some things that just took longer with the upgrade than expected. And I think Shahan will be able to speak to, you know, people were really able to help each other out and say, like, oh, this is what worked for me.
00:53:48.606 - 00:53:55.558, Speaker E: Or like, oh, it took me 2 hours to get through this phase. Just hang in there. And that was really amazing to see.
00:53:55.644 - 00:54:12.098, Speaker B: That's an incredible story. And I have to say that I have literally had nightmares about dealing with the go module release system. So I am so sorry that you had to go through that at midnight right before a major loss.
00:54:12.134 - 00:54:43.622, Speaker E: Yeah, well, it is funny because the story is the go module system, like blockchains, has a certain aspect of immutability to it. And so if you look at our change logs and our go modules and all of that, you can actually kind of see the history of like, there's a couple release attempts that didn't happen. And so Tendermint 34 six and 34 seven are just like no op releases. Like, they just don't actually exist. They're artifacts of a failed build process or failed release process.
00:54:43.756 - 00:54:53.194, Speaker A: The story you just told, that was the actual night of the actual upgrade, but the upgrade had also been sort of delayed. That was a different thing, right? That was two weeks prior to that.
00:54:53.232 - 00:55:45.206, Speaker E: Yeah. So one of the things that, and I don't remember the exact cause of that delay, but the way that these upgrades get scheduled is someone has to submit a governance proposal, and then there's like a voting period for the governance proposal, and then two weeks after the governance proposal goes through, then the upgrade is actually scheduled to happen, basically. And I think that the first governance proposal went out, and even in that first proposal, at some point while it was live and we were waiting for the release. That was when that security issue that crypto.com found and helped the tendermoot core team out with, that was when that surfaced. So there was a date scheduled. And the thing about these scheduled upgrades is that they point to a specific commit hash on Gaia.
00:55:45.206 - 00:56:26.342, Speaker E: So everyone's committed to running, like, a specific version of the software. And if you change it, that's not part of the governance. That's not what people voted for. Right. In the case of that particular tendermint core issue that I just described, we actually were able to make the change for that in such a way that you could still run the commit hash in the proposal and it would be compatible with the patched version. And so we told people, you really should upgrade to the patched version, and you can run the one in the proposal. If you want to verify that that's what's happening, you can do that, but we recommend you run this patch one.
00:56:26.342 - 00:56:47.274, Speaker E: So that kind of seemed fine. And then I think there was another issue that emerged, I think, in Cosmos SDK or guy itself. I don't remember the details of this one, but that was one where we could not get around it in that way. And so that was why it got rescheduled. Or. It wasn't just that there was a bug. It was that there was a bug that was where patching the bug was going to be incompatible with the scheduled version.
00:56:47.322 - 00:56:47.774, Speaker A: Got it.
00:56:47.812 - 00:56:51.006, Speaker E: And so it was at that point that we said, okay, we need to restart this process.
00:56:51.188 - 00:57:12.742, Speaker A: Well, this is such. I mean, thank you so much for sharing this story of your experience kind of going through the Stargate and going through this upgrade. Our next interview is with Shahan, and we hope that in that interview, we can actually hear kind of a little bit more on that exact time of the upgrade and what's happened since. Thanks so much for your part of the story.
00:57:12.876 - 00:57:13.906, Speaker E: Yeah, my pleasure.
00:57:14.018 - 00:57:14.870, Speaker A: Congrats.
00:57:15.450 - 00:57:20.620, Speaker E: Thank you. Yeah, this was super, super fun. Thank you so much for having me. Cool.
00:57:24.750 - 00:57:33.866, Speaker A: So I want to welcome our last guest of this three part interview series, shahan, who's the Cosmos hub lead. Welcome to the show, shahan.
00:57:33.978 - 00:57:38.142, Speaker D: Thank you for inviting me to your podcast. I'm very excited to chat with you today.
00:57:38.276 - 00:57:39.934, Speaker B: We're very excited to have you.
00:57:40.052 - 00:58:14.380, Speaker A: So we've had an interview with Zucky, who shared his perspective on what was happening, like, from the perspective of occlusion, mainly. We heard from Tess about the actual Stargate launch day in some detail. Now, what we want to do with this portion of the episode is to hear from you as the Cosmos hub lead, what it was like for you to go through it and also hear a little bit about what's happened since. But before we start into that, maybe just say a few words about what you actually work on and what being the Cosmos hub lead actually means.
00:58:14.750 - 00:59:24.290, Speaker D: Sure. As in my role as Cosmos Hub lead, I'm responsible for communicating and gaining agreement on the hub roadmap from the diverse dev teams and the validators that participate with the hub. So I'm new to the role. It was around three months, four months when the Stargate upgrade was taking place. So I was quite new to the ecosystem. And what that meant was communicating a lot with the dev teams at the different layers, the tenderman team, the Cosmos SDK team, and those who had been managing the Gaia application over the years and trying to understand what exactly the upgrade required. The upgrade itself was quite straightforward on paper, and the most complex equation of this upgrade was the communication with the validators, with the dev teams, making sure everything was in sync and making sure that everybody knew what to do when this Stargate upgrade was quite intense and required the stopping of the chain, and it was a coordinated effort.
00:59:25.670 - 00:59:35.426, Speaker A: You're pretty new to this role, like you started and then very soon after were faced with this upgrade. What was that like? When did you actually start?
00:59:35.528 - 00:59:39.378, Speaker D: My start date was end of November, beginning of December.
00:59:39.474 - 00:59:40.022, Speaker A: Wow.
00:59:40.156 - 01:00:38.322, Speaker D: The first two months of my onboarding was essentially talk to as many people as I could and go through the stack. Prior to joining Cosmos, I was aware of the tendermint consensus algorithm, so I had a strong understanding of that. But it was the rest of the stack, which was a very deep and very interesting scan through code at the same time. This Stargate upgrade was a migration of old code to new code. So it was very interesting exploration. Trying to figure out which parts were old, which parts were new, and trying to answer the questions was very hard for me. But essentially my focus was on the upgrade itself and the coordination around that and the communication, making sure that all parties were aware of what their responsibilities were and making sure that if there were any issues, they would be addressed by the right parties.
01:00:38.466 - 01:00:53.422, Speaker B: I mean, that's a really interesting position to be in. You've just joined the ecosystem, you have almost no idea what's going on. You're trying to catch up to speed really quickly, and your job is to coordinate everyone all at once.
01:00:53.556 - 01:00:54.240, Speaker D: Yeah.
01:00:54.850 - 01:00:56.800, Speaker A: Did you know what you were getting into?
01:00:57.490 - 01:01:00.286, Speaker D: Yeah. My background is from the Ethereum land.
01:01:00.388 - 01:01:01.134, Speaker A: Okay.
01:01:01.332 - 01:01:54.314, Speaker D: I have a lot of expertise with enterprise blockchains and Ethereum mainet stuff. But what is different here is that the cosmos ecosystem runs a different form of consensus algorithm. So the way that the network upgrades is different than how things proceed in Ethereum land. And what I enjoy about this community is that everybody is on board and in tune, and there is an on chain governance mechanism that people participate in. So there's a lot of activity and involvement from the validators in the development, in the roadmap, in agreeing with what's coming up with the hub. So this social coordination mechanism and the onchain governance, they work very well together to signal what's coming up and introduces a fairly straightforward process amongst the parties.
01:01:54.442 - 01:02:16.520, Speaker A: When you say you're the cosmos hub lead, we learned from Tess about the different layers of the stack and the fact that Gaia is sort of the. We were kind of confused about whether you call that a client or if it's a interpretation. I don't know. And maybe you can explain a little bit exactly what is the cosmos hub and how should we understand that?
01:02:16.970 - 01:03:12.822, Speaker D: Great question. This was probably a question I didn't even know to ask in my first month. The Cosmos stack, as far as I can see, is built up of the tendermint consensus layer, which is essentially a way for validators to agree on some data. And the Cosmos SDK is the layer on top, which relies on tendermint to communicate the somewhat business logicy stuff. And then Gaia imports the Cosmos SDK and is actually the application or the client that runs the Cosmos hub, the current version of the Cosmos Hub. So essentially, tendermint is the consensus library that can operate for other business logic. And Cosmos SDK is typically the library that's used by partner chains in order to develop their own chains or zones.
01:03:12.966 - 01:03:22.286, Speaker A: But the hub also depends on it, I guess, like if you change the Cosmos SDK or add something to it, the hub could potentially use that.
01:03:22.388 - 01:04:01.398, Speaker D: That's correct, yeah. When there is a change in the underlying libraries, guy is essentially the downstream partner of these development teams, and we do some coordination. And when there is a new release, guy also will tend to have a new release. In the most recent weeks, there have been a few. There has been one upgrade security release that required some coordination in that manner. And it's straightforward to do a release, just bump the version and cut a new release. Right now, guy, as a client or application, has some functionality, mainly for on chain governance, for token transfers.
01:04:01.398 - 01:04:22.110, Speaker D: But what's coming up are some exciting modules, like a bridge with Ethereum and a decentralized exchange. And including those modules into the hub will require increasing amounts of coordination, and that's when things will get interesting. So the Stargate upgrade, as a pretty involved process was a good first step.
01:04:22.180 - 01:04:25.390, Speaker A: In that trial by fire training.
01:04:25.460 - 01:04:27.250, Speaker B: Ground getting easier from here.
01:04:27.320 - 01:04:30.690, Speaker D: Yeah, trial by fire is probably the most heard expression.
01:04:32.390 - 01:04:33.266, Speaker A: In the team.
01:04:33.368 - 01:04:33.970, Speaker D: Yeah.
01:04:34.120 - 01:04:49.020, Speaker A: So now we understand the hub, we understand how the hub interacts with the cosmos. SDK but what actually happened during the Stargate upgrade, from where you were sitting, were you just like updating Gaia the whole time, or what was it? Exactly.
01:04:49.630 - 01:05:34.566, Speaker D: So I was just sitting and watching, really. So as you heard from Tess, there was a security patch issued and guy applied an update that included that. And once the release was available, the nodes were then informed that this is the version that they would have to update to. The actual process by the validators would be they stop their client, they export their state, they migrate their state, they install the latest version of the client, and then they start their client. So just a few commands, really, but the process took some time, and I.
01:05:34.588 - 01:05:39.898, Speaker A: Bet if you have enough people, they'll find every way to do that wrong somehow. Am I right?
01:05:39.984 - 01:05:49.942, Speaker D: Yes, of course. Starting from reading or not reading documentation. Yeah, it's not supposed to read that manual like a vacuum manual.
01:05:50.086 - 01:06:14.846, Speaker A: I mean, this is really, it's very obvious that you'd have the validators doing the upgrading, and I know that that's how it worked, but it's so interesting that when you think of this hub, it's not like you updated anything. That's how I had asked it. And sorry about that. It's completely like every single validator going through the process. So for your work then is really like preparing all of that documentation and being ready to answer all the questions.
01:06:14.968 - 01:07:09.522, Speaker D: That's right, yeah. And being aware of potentially some contingencies. So if the version had to change, as it did from the original governance proposal, the original proposal had a particular commit hash of Gaia, which then changed, and the original proposal couldn't change. So there needed to be some way to communicate the version to update to. Of course, people, some folks would be, who are diehard on chain governance supporters would be like, well, I didn't vote for that version, so I'm going to stick to this version. And of course people are free to do what they want, but essentially the upgrade was very smooth. It took some time because the migration itself, some of the steps took a few hours, and it also required some time zone coordination because the validators are spread globally.
01:07:09.522 - 01:07:25.974, Speaker D: So probably after 5 hours or 6 hours, there was a majority over 50% of the validators that had upgraded. And I think it took around six and a half hours for the 66% mark to be passed.
01:07:26.022 - 01:07:30.390, Speaker A: And that's what you were looking for. I guess that was the threshold of the upgrade.
01:07:30.550 - 01:07:32.586, Speaker D: That's right, yeah, exactly.
01:07:32.768 - 01:07:36.746, Speaker A: But what happened to the folks that didn't upgrade? Are they still not upgraded?
01:07:36.858 - 01:07:47.198, Speaker D: Don't think there's a way to find out which validators are running an old version. But any validators that didn't upgrade, they wouldn't connect to the network, so they're.
01:07:47.214 - 01:07:48.274, Speaker A: Just not earning anything.
01:07:48.392 - 01:07:49.314, Speaker D: That's right, yeah.
01:07:49.432 - 01:07:50.098, Speaker A: Okay.
01:07:50.264 - 01:07:51.250, Speaker D: Yeah, they would be.
01:07:51.320 - 01:07:53.746, Speaker A: They might notice maybe.
01:07:53.848 - 01:07:55.220, Speaker D: Yeah, that's right.
01:07:56.070 - 01:08:15.500, Speaker B: Can you talk a little bit more about what makes this upgrade different from like an ETH hard fork? The typical hard fork process is that we choose a flag height at which all of the nodes smoothly switch over. What specifically made Stargate such a big deal that we had to stop the chain for 6 hours?
01:08:16.190 - 01:09:06.374, Speaker D: Yeah, it's a good question. It starts to get into the more technical aspect. The tenderman algorithm is a BFT style algorithm, byzantine fault tolerant style algorithm. And what that means is that the validators are known, and in order for the consensus to change, or the state to be able to change via this hard fork, the majority of those validators need to conduct their upgrade. In Ethereum land, a hard fork is essentially trying to convince the validators to update their client, and if they choose not to, then they can continue a separate chain. There will be a chain split, and some validators will be on the old fork and some will be on the new fork.
01:09:06.422 - 01:09:12.614, Speaker A: But when you say validators, do you mean like miners in current Ethereum, not validators in future Ethereum?
01:09:12.742 - 01:09:13.834, Speaker D: That's right. Yeah.
01:09:13.872 - 01:09:14.218, Speaker E: Okay.
01:09:14.304 - 01:09:14.754, Speaker A: Miners.
01:09:14.822 - 01:09:15.600, Speaker E: Got it.
01:09:15.970 - 01:09:17.210, Speaker A: They play the same role.
01:09:17.290 - 01:09:33.502, Speaker D: That's right. Yeah. And it's a bit interesting because staking is available in hub, but it runs a BFT style, so it is a proof of stake system, but not like Ethereum, which runs a different consensus mechanism.
01:09:33.566 - 01:09:37.110, Speaker B: Essentially Casper versus PBFt.
01:09:37.530 - 01:09:39.014, Speaker D: Yeah, that's right.
01:09:39.132 - 01:09:59.722, Speaker A: When we spoke to Tess, she shared this story of how kind of hour by hour this process was going. And there was like a bit of a hiccup, or at least optically, there was something that looked strange. I mean, she kind of mentioned you were kind of in it with her, or you were also online at this time. What was it like from your perspective, what was happening?
01:09:59.856 - 01:10:39.750, Speaker D: From my perspective, I saw a lot of devs diving into code, trying to resolve the issue, and they got that figured out very quickly. They are true experts. They are very familiar with the SDK and tendermint stack. And so from my perspective, I was just really waiting and looking for the latest release of the Tendermint or Cosmos SDK libraries. Once that release took place, it was essentially a few steps to cut a new Gaia release, to bump the versions, and then issue a new version. After that. It was essentially communicating that version to the validators.
01:10:39.750 - 01:11:49.262, Speaker D: So we have a verified validators channel on Discord, where validators were asked to keep watch on for events like these. And once that took place, we were essentially waiting for the moment time to stop the blockchain. Perhaps optimization we can do next time is for the Stargate upgrade. We had selected a time based halt versus a block height based halt, and we were trying to do that so that the time based coordination would work out more easily, so that we would know which time zones would be most affected or not, and make sure there are enough people online, because with a block based halt, it means that the time could drift. So the side effect of choosing a time based halt was that when the chain actually stopped, there were a couple of validators that had already passed the time of halt. And essentially there was this discussion of which block should be picked for the migration to occur at. So there was a very interesting voting and social coordination of.
01:11:49.262 - 01:12:05.650, Speaker D: Okay, well, there's this block that was past the halt height, and sunny pointed out very clearly, okay, any blocks after the halt height shouldn't be included in the migration. So let's pick this number. That was probably a key moment of the upgrade.
01:12:06.970 - 01:12:24.038, Speaker B: I think this is such an interesting example of how difficult it is to even talk about time in a distributed system. Your software is running on 100 nodes worldwide. Each of those computers is going to have their clock set slightly differently.
01:12:24.134 - 01:12:44.290, Speaker D: Yeah, definitely. It was very interesting. And even with the halt height set to whatever it was, and the blocks still have a few seconds to get produced. And it was very interesting to see that even with that, a majority of validators did produce an additional block past the height that time.
01:12:44.360 - 01:12:54.786, Speaker A: Okay, I was wondering about that. Was anything lost in that upgrade? What could happen? Is there like transactions that get lost sometimes or what can happen?
01:12:54.808 - 01:13:06.166, Speaker D: That's a good question. Yes. If there was a transaction that was issued in that last block when the hub was restarted, those transactions would not be included in the migration. Wow.
01:13:06.268 - 01:13:15.034, Speaker A: Can you imagine someone sent by accident tokens in a direction and then magically they were back yeah, that would be the best case scenario of something like that.
01:13:15.152 - 01:14:02.970, Speaker D: Yeah, that's right. Well, if that was for a payment that was validated for only 5 seconds, then yeah, that would be a risk. Yeah. What other things could have gone wrong? I think one of the other challenges that some of the validators ran into was in order to have robust systems, they would have a few nodes running and some nodes might be in front of their validator nodes. So because of these architectural decisions that they've made, and sometimes we have some clarity into the architectures, trying to figure out which nodes should be upgraded first, which nodes don't have to be upgraded. Those types of instructions also had to be shared prior during the upgrade.
01:14:04.110 - 01:14:12.818, Speaker B: Is this something where you had to do a little bit of a forensic examination to figure out what setup the validator was using and how to upgrade it safely?
01:14:13.014 - 01:14:56.694, Speaker D: We didn't do so much of that. I think it was, at least for the core devs, it was fairly straightforward about what had to be upgraded at what point. Essentially, if a node was acting as a validator, it had to be updated. But all other nodes did not necessarily have to be updated in that manner. They didn't have to go through the export and migration. They would just start with a new binary and then continue, and then they would sync on the new chain. But given that, with the current kind of security upgrade that happened recently, and trying to improve the process and documentation for future upgrades, there is a plan to have these playbooks for how to upgrade these validators.
01:14:56.694 - 01:16:05.330, Speaker D: What are common architectures that companies are using and providing more support as the number of validators increase, and just getting them used to this whole experience. It's fairly straightforward to run a validator in my opinion, but of course I've not run one. But there are some nuances involved, like what happens when nodes fall out of sync, what kind of hardware requirements are needed, what if we want systems to be more robust? And of course the security aspect of key management in the future. The aim of trying to do these upgrades as smoothly as possible is to try and integrate upcoming modules more regularly. This Stargate upgrade was probably a year and a half in the making, involved many organizations, and the future of the hub involves a similar set and a growing set. There's development taking place. These modules have to go through testing, getting more awareness for the validators about what they need to do and how frequently they need to do it would be very helpful.
01:16:05.330 - 01:16:13.010, Speaker D: This added functionality will increase the usage of the hub. It'll make things a lot more exciting add feature.
01:16:14.890 - 01:16:18.566, Speaker B: So hopefully the future upgrades are not quite as painful as this.
01:16:18.588 - 01:17:02.670, Speaker D: That's right. Yeah. We are exploring different mechanisms for making these upgrades smoother. And currently there are some mechanisms that try to automate some of this. There is an upgrade module that allows somebody to issue a governance proposal which would update a client based on a particular commit hash. There's also another mechanism which is being used by the IBC module that's going to be in progress to being activated. And what happens in that scenario is a module's code does get integrated into the cosmos stack, either in the SDK or tendermint or Gaia eventually.
01:17:02.670 - 01:17:18.158, Speaker D: And once that code's present, somebody can issue a governance proposal to issue a parameter change in order to activate that module. So this way people have some awareness and some mechanism to activate that module.
01:17:18.274 - 01:17:30.750, Speaker A: So what's happened since this upgrade? We've kind of described it. You just mentioned that IBC still needs to be activated. What does that actually mean? And yeah, what's happened since for you.
01:17:30.820 - 01:18:26.398, Speaker D: The IBC code essentially is part of the Gaia stack. Now, the Gaia Cosmos SDK stack, which means that modules that rely on IBC will be able to use it. And right now, even though the code is part of Gaia, what needed to happen was there needed to be an on chain flag indicating to the validators that, okay, at this point in time, IBC should be enabled for any modules that want it. So essentially somebody submitted a governance, I think it was Zaki, and submitted a governance proposal onto the hub saying, time to activate IBC, and people will have to vote on it. And in two weeks of that vote, the IBC module will look at that flag in the on chain state, and if that flag is set, then IBC will be available.
01:18:26.564 - 01:18:38.338, Speaker B: Very interesting. So one of the outcomes of this big, painful upgrade is that you've started building in more ways like this to upgrade specific parts of the system or almost turn on.
01:18:38.424 - 01:18:42.466, Speaker A: It's not even like you don't have to go through the process of upgrading anymore, I guess.
01:18:42.568 - 01:19:06.646, Speaker B: Right. And that gives you a lot more flexibility for future upgrades to put them in the code base much sooner and then activate them when they're ready. Would you expect that this is the long term direction that Cosmos upgradability is going to go, is more towards module specific and very specific governance rather than big upgrades?
01:19:06.758 - 01:20:05.946, Speaker D: I think in terms of the Stargate upgrade, the majority of those changes, as I understand them, were with respect to the underlying data format. So it was a performance optimization, it was other kinds of optimizations future upgrades could be as involved, especially if state has to evolve in order to accommodate the new modules. I wouldn't say that there's going to be one path for upgrades. I think there are numerous ways for upgrades to take place, and they should be available depending on who's involved and what kind of coordination is required. The coordinated hub upgrade, we're trying to minimize those, but at the same time, if they do need to take place because of breaking changes, we want them to take place much faster. So trying to get the export faster and some of the updates that have been applied to the software since the upgrade makes that process much faster.
01:20:06.058 - 01:20:14.180, Speaker B: So it sounds like these big coordinated state upgrades are expensive, but you're not scared of doing more of them.
01:20:14.870 - 01:20:44.630, Speaker D: Yeah, no, I'm not. No. I think these are system level admin things that should be fairly well understood. In particular, we want the validators to be comfortable with upgrading. We don't want them to think that I haven't touched this system in a year and a half. If I touch it now, something's going to happen. We want them to feel confident in the process of this coordinated mechanism, and in some cases they're also uncoordinated mechanisms.
01:20:44.630 - 01:21:34.060, Speaker D: For instance, I think it was a week or two ago, there needed to be a security patch applied, and it was required a 24 hours notice to the validators. And that 24 hours notice was essentially within 24 hours a new version of guy will be released. Please update your software and you don't have to export migrate, you don't have to go through that process and it's uncoordinated. So the validators don't have to turn off their software at the same time. They can all do it at their pace. Of course, the sooner the better, just to avoid the potential scenario where the chain halts. In the scenario where the chain would halt, if it had, a majority of the validators would have had to update their client and then the network would come back up, the chain would start back up.
01:21:35.470 - 01:21:51.246, Speaker B: We've talked a lot about adding modules to the hub and about this significant upgrade. What kind of QA processes or what other processes do modules undergo in order to ensure that they're ready to run on a globally distributed consensus system?
01:21:51.428 - 01:22:44.698, Speaker D: Great question. So we are working on a module readiness checklist that will help relay the information about the module's readiness to the community at large. In addition to the technical QA that we would expect from anything being deployed on chain, whether it's a third party audit, intensive performance testing, there are other aspects such as who are the downstream partners impacted by this? Who are the upstream partners that this module is dependent on? What kind of coordinations are required as these modules get developed. And we're working very hard to have this checklist in a very easy manner for module teams to fill out. And this complements the technical checklist that some of the dev teams in the community are working on, including region.
01:22:44.874 - 01:22:45.514, Speaker A: Cool.
01:22:45.652 - 01:22:46.754, Speaker B: That's great.
01:22:46.952 - 01:22:51.630, Speaker A: Well, Shahan, thanks for coming on the show and sharing your experience of the Stargate upgrade.
01:22:51.710 - 01:22:54.606, Speaker D: Thank you very much for having me on here. Anna and James.
01:22:54.718 - 01:23:10.314, Speaker A: James, I have a quick last question to you. Since we're wrapping up this, like, from what you've seen looking across different ecosystems over the years, how does this upgrade compare? What did you think about it now? Also, now that we've done these three.
01:23:10.352 - 01:24:01.414, Speaker B: Interviews, well, outside of the major bitcoin and Ethereum forks, I think that this is by far the largest, most distributed and best coordinated network upgrade that I've seen. I don't want to underestimate how much work goes into something like this. And to talking to several dev teams and 100 validators is incredibly difficult. Cello, my employer, we're going to be undergoing a hard fork next month or late April, early May, and it is a extremely worrying thing. We're doing all of this testing and all of this QA, and I am happy to know that it is possible and to see someone and teams that have gone through it with poise and.
01:24:01.452 - 01:24:03.554, Speaker A: Come out the other side of the. Huh?
01:24:03.602 - 01:24:05.000, Speaker B: Come out the other side.
01:24:05.690 - 01:24:06.310, Speaker A: All right.
01:24:06.380 - 01:24:09.270, Speaker D: They are in good hands with you there, James.
01:24:09.970 - 01:24:10.960, Speaker B: Thank you.
01:24:11.330 - 01:24:18.590, Speaker A: Thanks to both of you and to our previous guests for doing this episode and to our listeners. Thanks for listening.
