00:00:05.200 - 00:00:57.134, Speaker A: Hey, guys, welcome to my little talk. We did this demo a couple of weeks ago for Black Cat and urban security conference. This day's talk is going to be a bit more web3 focused, and I'm going to explain to you how the bad hackers have managed to pull off quite large heist against some of the largest crypto exchanges, including crypto.com comma bitfinex. Everyone has been hit by these attacks. So basically what we did at FhIr was to try to understand how do we protect against these types of attacks by actually researching how did they break in, how did they take over accounts, and how easy is this to actually do. So you, from a builder perspective, can actually protect against these attacks, which are happening a lot lately.
00:00:57.134 - 00:01:43.106, Speaker A: So a bit about myself. My name is Thomas Olufsen. I'm an ex hacker that I've been working with protecting computer systems for a very long time by actually breaking into and hacking them actively. The reason why we do that, it's called penetration testing, to actually bash the system. And that's now what we at Fhir are doing at web3 as well, to actually break the systems and test the security before the bad guys actually do that. I'm sort of a digital nomad, so I work mostly from Tenerife and from Sweden, and also fire is a very global company, so we work from all over the world. I'm also founder of Sect.org
00:01:43.106 - 00:02:28.120, Speaker A: Comma, which is a large scandinavian computer security conference, which teaches this. And I used to do capture the flag games, which is like legal hacking, so also won capture the flag in Las Vegas a couple of times. And ctfs are actually a very good way to actually get into hacking without ending up in jail, because you can actually go there and hack stuff legally and earn a lot of money. So except for that, I'm into climbing, diving and all other safe sports, motorcycles. And my current interest in web3 is actually going into decentralized identities. I think that's one of the space after DeFi. So just a quick bit about what we do at FiO.
00:02:28.120 - 00:02:56.462, Speaker A: So we do basically three things. We do domain intelligence and protection of domains, as well as web3 security audits and security checks. But what we're here to talk about today is that text message or two factor authentication. If you don't want to see more of the talk, you can go now. It's like it's broken. It's totally broken. But I'm going to try to prove that today by showing you guys how you actually can send your own text messages.
00:02:56.462 - 00:03:26.580, Speaker A: And do all of this proxy and bypass everything. And actually, because everyone's like, oh, you have to have two Fa. If you have two fa, you're safe. And as we've seen on some of the large exchange hacks, no, with text messages, you're not safe. You should actually force your users into other, more forms of two factor authentication because text messages are just stupid. Yeah. So, yeah.
00:03:26.580 - 00:04:02.334, Speaker A: Setting the scenes. The last couple years, there has been a lot of really big attacks where people have, like, taken over accounts. They have sort of emptied the account via phishing or smishing. How many of you know what smishing means? Have you heard the term smishing? Okay, smishing. How many of you have got an unsolicited text message to your phone during the last couple of days which you didn't receive? Oh, yeah, most people have because there's been an increase of like, seven times 700% over the last year in what's called smishing. And that is like phishing. Phishing links, but via SMS.
00:04:02.334 - 00:04:30.284, Speaker A: And the reason for this, it's super effective because people, for some weird reason, are much, much more likely to click an SMS message than they are in email. Because we're so used to email spam that we're like, oh, this is just email spam. It's like, oh, my God. It's an audition link. But it's like, it says, like, hey, this is from the police. You have people click because it's on their phone. And for some reason, people do believe that it's secure.
00:04:30.284 - 00:05:31.796, Speaker A: And then we've seen hackers actually using this technology to actually bypass the two factor authentication on some of these exchanges. And I got really interested because no one in the media said how they did it for obvious reasons, because maybe you don't want to teach the criminals, but then again, the criminals will know this. So we actually went through some of the larger hacks and actually looked at the evidence files and found out how they did it. And, I mean, basically, we want to research how do they do it? What were the attack vectors? What do you need to do? This is an expensive operation. Do I need to buy a small country to pull this off? Do I need to hack a telco operator, or can I do it with small means? And then again, how can we help other builders like yourself protect against this? So one of the biggest one was crypto.com that we saw getting targeted by this. Their two FA bypass exceeded 30 million in withdrawals from accounts.
00:05:31.796 - 00:06:19.586, Speaker A: Their bypass, they're forcing, of course, refunds from crypto.com. But again, not only crypto.com has been targeted by this, most exchanges have, most exchanges have now implemented controls against this because obviously it's a bad thing. So basically, SMS phishings, we are seeing a lot of them, as I say, there is a seven times increase. And the reason for this, it's really hard to verify the integrity of the sender, of the messages. People just assume that you can only send messages from your own phone number. However, that's not the case.
00:06:19.586 - 00:07:19.240, Speaker A: If you're looking into the smishing attacks that we were investigating, less than 35% actually realized that the text messages that they clicked were not from the right sender. So most people that get targeted by smishing attacks don't even understand that they have been targeted by smishing attacks. They think that their text messages are legit even though they've been hacked. So they like, hey, why is my binance account empty? They don't expect that the SMS matches were not from binance because we're so used to that being a security. And the reason for this, as I said, is that for some weird reason, it has higher implicit trust of looking at a SMS message that comes through than your emails are, because you never trust your emails. And we have seen a much higher success rate in these attacks and the mobile functionality. I'm going to do some demos of this, so we're going to see how the actual mobile works.
00:07:19.240 - 00:07:53.336, Speaker A: And the mobile providers, they've been really good at picking up these text messages, so they will actually autofill them for you. So I'm going to demo that later on. But if I spoof a text message, the browser will pick it up, autofill it for you and just log you in. It's super nice. And then we want to research, how do these hackers find my phone number? So we actually did a lot of research together with Michael Bistrom to actually find a lot of phone numbers online. So we have indexed about 22 billion leaked passwords in our database. But now we also started looking at the telephone numbers.
00:07:53.336 - 00:08:30.256, Speaker A: How many telephone numbers can we find? So we have found 1 billion telephone numbers leaked online that we can tie to an email address. So I'm going to demo that as well. So that's how the bad guys are like, oh, say, oh, this is just a very, very targeted attack. No, it's not, because like, we have your telephone number, your telephone number, your telephone number. We have like maybe a third of all telephone numbers that are active in the world are already leaked on the darknet or in data dumps. So that's like a source that just keeps giving. And basically to do this research, we did what you can call digital dumpster diving.
00:08:30.256 - 00:09:10.584, Speaker A: So we're looking through the really nice places on the Internet where you really want to go like the russian hacking forums, the leak database trading files, where a lot of hackers online actually trade in this stolen data. The stolen data has become like a commodity online. And there's so much of it that they nowadays give it away for free. If it's less than like three months old, it's not worth anything. So then you just publish it for free. So if you into like digital amsterdam, there's a lot of funny stuff you can find. And also we have all the ransomware, so we generally go and hang out where the bad guys hang out.
00:09:10.584 - 00:09:47.946, Speaker A: Especially ransomware sites. They're like people that get hacked, like local governments, they don't have very good it budget, but they do have your phone number, et cetera, and they get hacked and they can't pay. So they just publish all their data online. So we went there, scooped it up, bridge forums, and also there is like a new thing called like sales conference. Have you seen these mails? Like, hi, do you want to buy the attendee list of their breakpoint conference? I mean there is all of these lists that you can just buy. I have no idea how they get the data, but we did buy them. Some of them are accurate, some of them contains phone numbers.
00:09:47.946 - 00:10:36.014, Speaker A: So it's like, and if you collect this, if you're a threat actor, don't want to hack the crypto community, having the breakpoint attendee list with phone numbers would be a great way to actually bypass people to fa. So there is actually these dump sites, they look like this and they have like all of these dumps just free for downloads. Anyone can register here. Just green there is darknet sites, but there is also on the normal Internet and in the green there is how many leaked credentials they have. So it's like 800,000, 700 million. It's like it's quite large numbers of leaked credentials running around. So we index, as I said, 24 billion of them with about 1 billion telephone numbers.
00:10:36.014 - 00:11:07.758, Speaker A: And this is just for clop leaks is one of the ransomware groups. These are the data that's currently published now on their darknet site. So we see like, yeah, we see a lot of.com names and there is also a lot of crypto sites that are getting hacked, that's not public, that are just published on these sites with usernames and phone numbers. So that's interesting. So one of the biggest thing, we index this, facebook.com was a good giveaway.
00:11:07.758 - 00:11:53.204, Speaker A: They got hacked and they leaked 509 million, which we could extract 139 million phone numbers from Facebook verifications. IO 68 million US extended cell phone feeds, 90 million phone numbers that we can tie to email addresses, people, data labs, LinkedIn. And then we have like breakpoint, where we found 16,000 phone numbers. So I mean, these are the sources that we're looking for when building this database. So basically all your numbers are belong to us. So I am going to do a demo of this. As you see, we're coming into the demo space now.
00:11:53.204 - 00:12:17.940, Speaker A: So basically, Brian unfortunately had to go home. We've been normally using. He's our CEO, co CEO of the company. And he's a very good, like, he worked a long time in tech, so he's been on a lot of sites. He likes the Internet, so he's a very good test user. So we use his Gmail account to see how many phone numbers do we have for Brian. We have three.
00:12:17.940 - 00:12:59.264, Speaker A: And this is just also for GDPR perspective, I'm using Brian because I was permission to use him, but this is how much data we have on people and this is how quickly it is to get his phone number. So you could also do, if you want to search for Brian, you can also search for his phone number and see what other email addresses he has tied to that phone number. So you can do search phone number p. Then we see you can do another phone number. Let's take this one. What was that one I did? Yeah. So I'm going to search for this one.
00:12:59.264 - 00:13:35.404, Speaker A: And there you see he has a lot of other accounts, like Adam Gail. So we can actually tie people with multiple email addresses to one phone number. So why don't we send Brian a text message now? Because I know he's back in the US and probably one in mind. So boom. Now we sent Brian a text message saying basically the same thing as this one does. It's like Google, suspicious account activity on your account. Please verify your account, etcetera.
00:13:35.404 - 00:13:57.516, Speaker A: And obviously this doesn't go to. This goes to a site that we have set up, which proxies Google. And we can log in here with breakpoint. And I hope I cleared the cache. So I'm going to log in. And as you see, this looks really good. And this is not Google site.
00:13:57.516 - 00:14:58.852, Speaker A: This is what we have, a proxy site. So what's happened in the background here, if you look in the other tab, we actually logged in with two factor authentication, and hijacked all the login data, including the two FA password, which were sent and autofilled by the browser. The reason why we logged in now directly is did this. So I have to clear the cache for this to work because I already had a logged in session, which it did just behind, but it will autofill the two Fa password along with the session cookies and actually send it to the attacker. This is the only thing you see being targeted by this. If you click the SMS, it's like unable to sign in, you signed in, you're unable to sign in, and the hacker has your two Fa password as long as the session takes over your session from any browser. And that's like, that's how easy the attacks are.
00:14:58.852 - 00:15:37.918, Speaker A: So basically they're made up by one spoofed SMS messages, proxy servers. That automatically does a man in the middle attack between the targeted site and I have too many screens. There we go. So where we used to think about credentials as a username password or a hash, we now started thinking about credentials. Paris, like everyone. Now, how many has two FA enabled on their crypto? So today we need to start thinking about credentials and leaked credentials being username, password and telephone number. The problem is not only us doing that, the attackers are doing the same.
00:15:37.918 - 00:16:16.494, Speaker A: So if you have your username, your password, and your telephone number, you can still do these things by redirecting you and sending the telephone numbers to the sites where you know you've been leaked at. So we're currently able to detect one in ten email addresses and tie that to a phone number. In our research, yeah, when we did the slides, we had 500 million. We now have 1 billion telephone numbers indexed. But yeah, if we can do this, so can the bad guys. And I mean, this is a thing that is leading to losses. Crypto.com
00:16:16.494 - 00:16:52.220, Speaker A: says we have a small number of users reporting suspicious activity on their account. They lost 34 million from foreign 36 accounts. I wish I could say that that was a small number in my budget, but Opensea has. This has happened to multiple times as well. Of course, phishing is missing. Conjunction with NFTs has been rife, especially before the NFT tanked, we saw a lot of attacks against Opensea and where you have a fake site. And we're also tracking, like, when they register, because they register very similar domains.
00:16:52.220 - 00:17:40.450, Speaker A: You have like opene and Opensees, and you have like so many like, sites that are really similar that these smishing attacks are tied to. So they have the phone numbers. You go to Opensea, Ia instead of ie, etcetera or IO. And then they steal your two factor tokens, they steal everything and all your nfts are gone. And actually, in the funny thing that with this attack against Opensea, they actually sent out SMS in the mail to everyone saying, hey, we have a new contract address. The guys copied that email. It looked exactly, the SMS messages were exactly the same and they did a copy of the contract, just pointed it to their own address.
00:17:40.450 - 00:18:31.450, Speaker A: So everyone that went in and connected their wallet against the new Opensea contract did so to the attackers. All the NFTs are belongs to us. They came in and wiped everyone by a smishing campaign. And then after, when we wrote these slides, this happened as well. So the most popular ways of doing this, there's two things. When looking at all these big attacks, the most popular way is the, the reset password is not working as intended. So a lot of the times if we have looked at Coinbase attack, it was actually that you go in, you reset your password and then you could bypass two fa because people wasn't good enough at penetration testing the sites.
00:18:31.450 - 00:19:17.774, Speaker A: So there were ways with like these security questions. Well, they could do a password reset without actually having the two FA code, even though you had two FAA enabled, that's obviously been fixed. So the account recovery process, change of phone numbers and then again SMS injection into an already existing login. So let's say you login to buy, you first say to people like, hey, click this SMS and log into the site. Then you actually send them an SMS login and they will get the SMS and send it to you via one of these like proxy man middle. But I'll just demonstrate on Google. Actually I had the permission from Google to present that on Google.
00:19:17.774 - 00:19:47.698, Speaker A: I don't have the permission to prove it on any of the, I can't do a fake crypto exchange site because they won't let me. But Google actually let me demonstrate on Google. So this works regardless of the site and the protections we come into. Protection. And yeah, as I showed you smishing and phishing proxies against real sites, saving the session cookies and the two FA codes. And then we have had sim jacking, cloning, porting in the US. It's easier than in Europe.
00:19:47.698 - 00:20:20.640, Speaker A: You can basically just call people and say, hey, I would like to sign up for new. If I know that you have a lot of crypto. It's like I don't know your phone number. I can say, hey, I'm currently on XYZ. I love to go to T Mobile. This is my number, can you port it and I'll pay? So we have seen a lot of incidents where you actually port over. The real users, especially like high stakeholders, have had the numbers hijacked by people social engineering themselves and doing what is called like sim jacking.
00:20:20.640 - 00:20:58.454, Speaker A: So someone takes over your SIM card by saying that, I love to buy this t mobile plan. And sales people there, they shouldn't really do it, but they really want the sale. So they actually port over your number to your new line and then you can bypass two fa. So short stories, two FA is terrible for this. And even if you look at Google, if you look at the account recovery process, they're normally flawed. This is how much data from my personal account is given out. Like, oh, he has another email address, which is this, oh, he has another email address.
00:20:58.454 - 00:21:32.806, Speaker A: Oh, his phone number ends with zero. Zero. So just by initiating a password reset forgot phone number for any account, I can also tie them to the other phone numbers that we have in our database and verify them through the account recovery process. So yeah, a short history of SMS. It was actually designed in 1985. That's not a new technology. And there was some data left between the voice packets in GSM, which they decided that maybe we can do short messages here.
00:21:32.806 - 00:22:03.032, Speaker A: So basically, the first message that was sent was Merry Christmas. And that's probably what it was intended for, to like send short messages, not to have it as a security function. There is no sender verification whatsoever. There is no check from which number it comes on the network. So if you get access to the network, you can do that two ways. You can either have a phone and send it via the cable. You can use any phone, more or less, or you can use gateway providers.
00:22:03.032 - 00:22:36.724, Speaker A: There is a lot of SMS gateway providers that you can get access to. So it is technically as legal to setting your phone number to Santa Claus. So I'm going to try to show you how to send some text messages. Let me see. So let's say I want to send an SMS message to my phone. I prepared some here. So let's say I want to send a text message from Google.
00:22:36.724 - 00:23:08.154, Speaker A: Let's see if this works. Let's hope it works. It's always fun when it works. So that was Brian's, let's say here. So let's say Binance. I want to spoof binance because that's fun. And here we go, Binance.
00:23:08.154 - 00:23:46.164, Speaker A: Your account has been blocked. And this is, of course, the funny thing is this shows up. As you can see, I do have binance and this shows up in my real binance like log of messages, including my real two fa codes that actually come from Binance. So it's very hard as an end user to see that this is fake. Okay, now the domain that I've done is like demo dot smishmash.net. Dot Smishmak is what we're calling this technique. So of course this is going to be fake, but still, it's very hard for you as a user to actually see that this is not from binance, that this is actually from a fake account.
00:23:46.164 - 00:24:33.554, Speaker A: And boom, if you go there and actually log in to, I have another one which is called like crypto something which actually points right. And if you actually go there and input your details, they will be hijacked by the attacker. And I mean, obviously if you do this live, you do a better domain than like demo dot smishmash.net because you do like a domain that's very much more similar to Binance. And that's what we've seen. So yeah, can you send basically from any, so we have developed some tools and these are published as well on a public repo. So you can play with these tools as well.
00:24:33.554 - 00:25:18.034, Speaker A: So you can, as you say, just put the sender to anything you want here and just send SMS from any sender. That's how easy it is. You can link in the phishing site that hijacks the data and then login on your account. Let's see. So, and then it's like, when we're looking at this, if the guys that are doing this professionally, they don't use like just one phone that I'm using. There is a lot of fun stuff you can buy from China. We haven't had time to work, but there is like $160 you get, you see what that is? It's a lot of cables that you plug into a lot of SIM cards.
00:25:18.034 - 00:26:24.574, Speaker A: You can automate this and just run it on a professional scale. So the hackers that we're seeing, I love this one, like $508, you get like, I don't know how many phones that is, but it's literally a rack mounted phone that you can just use as a gateway and like spam SMS with basically the same thing as sending it from your phone. But they also come, they actually come with a marketing like 64 port bulk sending SMS device supporting IMI change by Atikmon and imie. That's like the sender identity of the phone. So these are chinese devices that you can reprogram to send from any device id none whatsoever. So yeah, SMS, this is what the bad guys are doing. They're buying one of these devices and then they find a dump file for one of your targeted sites and they email and send SMS to all your users and send them to a similar site.
00:26:24.574 - 00:27:16.428, Speaker A: And this is quite funny because actually this is on the sales side for these devices. They have like your Google verification code is. So this actually on the marketing material for these sites, the marketing them is like this you can do illegal activity with. So how this works in reality is you have a phished user, you have an adversary in the middle that is pointed to by this that has the decrypted password as I show you on screen and then goes to real website and actually injects it, steals all the two FA codes and the session cookies. So we already done the demos. So thank you. We have 1 minute left for questions and answers, but I'm just going to talk about protection really shortly.
00:27:16.428 - 00:28:04.152, Speaker A: There is three major ways that you can protect against this. If you're running a b, two c exchange, etcetera, recaptcha has hidden field where you can say if someone goes this, if you tried this on crypto.com today, they're using recaptcha to solve against this. There is also cloudfront cookies that will mess and show that the site is being manned in the middle attack because as you saw on the site, there is no certificate. Everyone's like oh but HTTPs, that protects me against this. We set up servers that in real time request all the new certificates via let's encrypt or free enrollment services. So there's basically no way to see this unless you have the recaptcha or the cloud front and you could sort it with course headers.
00:28:04.152 - 00:28:15.624, Speaker A: But unless you protect against these, your end users will not see that they're not on the real site because the proxy servers are so good today. Thank you very much for attending.
