00:00:01.560 - 00:00:34.794, Speaker A: Hey guys, I'm Noah Prince, head of protocol engineering at the Helium foundation. Today I'm going to tell you about how we migrated to Solana, or more informally, how we turduck into blockchain. Now first the formalities like who is Helium foundation? You can think of us like Alfred and the network is Batman. We are just a steward of the network. So we're manage to going all things, ecosystem, community. And I'm personally in charge of everything that touches Solana. So the protocol side of things.
00:00:34.794 - 00:01:09.086, Speaker A: Now, if you've been living under a rock and haven't heard us screaming about helium all over the Solana conference to kind of explain what helium is, I think it's important to start with just the headline, dollar five unlimited mobile plan. I think this is the thing most people can understand. Is it a crypto project? Yes. Is it decentralized wireless? Yes. Does anyone outside this room care? Probably not, unless it saves them tons of money. Right. So how much are you paying for your phone plan? $50 a month.
00:01:09.086 - 00:01:49.332, Speaker A: $40 a month? Dollar five is the headline. Now, helium does this by enabling anybody to become a cell phone tower, effectively. So anyone from your wife to the cafe owner down the street can put up a hotspot and then you can use that hotspot. Now, helium just now got into 5g, but it's been doing this for a while. Helium first started with an Iot network, which is a kind of low power long range signal. They say that the sun used to never set on the British Empire. No, the sun never sets on the helium Iot network.
00:01:49.332 - 00:02:39.054, Speaker A: It powers everything from smart cities to package tracking to this guy that's tracking his cat in Germany. It's insane. Now, I'm sure you're asking yourself the question, is the helium Iot network in the room with us right now? Yes, the helium Iot network absolutely is in the room with us right now. And then your next question is going to be, are people using it? Yes, there's actually tons of usage in Amsterdam. So I think when we talk about this migration, it's really important to put it into context. The story of how we got here, why we got here, is important. The story of helium is kind of a story of battling scale all the way up.
00:02:39.054 - 00:03:17.114, Speaker A: So way, way, way back in 2013, this guy named Amir and a few other people founded Skynet Labs. And they actually, they weren't doing anything with crypto. They were doing things with IoT. Back then, IoT was like the brand new hotness. Everybody was wondering all the things that it could do for the world. And they quickly ran into a problem, which was every time they wanted to deploy an IoT solution, they also had to go deploy the network. And there were just entire classes of Iot that you couldn't do, like package tracking, because you've got the package that's moving and so you don't have a network in 2019.
00:03:17.114 - 00:04:07.330, Speaker A: They kind of realized that there was this chicken and egg problem, which was that nobody really wants to use a network that has no coverage, but nobody wants to be the first hotspot on a network that has no users. So, like, how do you solve this? How do you cross this gap? And that's where DPin came in this term didn't even exist. I think helium is probably the pioneer of this. And they use tokens. They set up proper incentive systems such that the person who deployed the first hotspot, who was taking tons of risk, was able to earn more tokens for doing that. And you fast forward today, even with the mobile network, the helium network is so smart, it can tell people, hey, you should go deploy your hotspot in this area because there are tons of people using it now. These guys were crazy.
00:04:07.330 - 00:04:31.564, Speaker A: In 2019, their only option was basically ETH or build your own blockchain. Not only did they build their own blockchain, they actually put the blockchain on the hotspots themselves. These little raspberry PiS were running a blockchain. Insane. It worked. It didn't work. Once you got past a few thousand hotspots, it didn't scale.
00:04:31.564 - 00:05:18.584, Speaker A: And so in 2021, helium transitioned to its own proof of stake network, kind of similar to Solana. But even then, helium at one point had hundreds of thousands. Well, we still have hundreds of thousands of active hotspots, but I don't know the exact number. But there were a lot of them, and it started to hit scaling problems again. Now, in 2022, Solana exists, right? You have this blockchain that's just been re architected from the ground up to lower the latency, increase the throughput. It's insanely cheap, it's insanely fast. And wondering, why are we running our own blockchain? There's a lot of headaches with running your own blockchain.
00:05:18.584 - 00:06:04.324, Speaker A: And so in late 2022, the helium community historically voted to move to Solana. And that's actually where I got involved. They came to me, they were like, we want to take this l one. We want to shove it into another l one. I think most people would have been like, you're out of your mind, I asked, when do I start? So how do we do it? How do you take all of one l one state and shove it into another l one? Well, first, let's take inventory of all the stuff that was there. So there were around 430,000 active hotspots at the time. Around 760 active wallets, or not active, but 760,000 wallets at the time.
00:06:04.324 - 00:06:31.716, Speaker A: And there were also another 500,000 or so hotspots that were on chain and could get turned on at any point. Right. Someone had unplugged them or the firmware fell behind, but they were there. We needed to migrate these two and kind of within those wallets, you had a variety of different tokens. Like I had said earlier, helium is not just the Iot network. It is not just the 5g network. It is a network of networks.
00:06:31.716 - 00:07:10.924, Speaker A: What that means is that we have lots of different tokens. We have the Iot token for the IoT network, the mobile token for the mobile network, and the HNT token, helium network token, that kind of binds them all together. We also have data credits, which are kind of stable pegged, which makes it so that people can effectively pay a predictable cost to use the network. Nobody using the network wants to pay in a token that could be volatile. They want to have predictable data rates. But this was more than just a migration. You see, there was a lot of things that, on the existing l one, were just very hard to do.
00:07:10.924 - 00:08:03.114, Speaker A: Enshrining things in a blockchain is a lot harder than writing a smart contract. So by the time I had arrived, there was just a huge backlog of all the other things that they wanted. There was things like Dao governance with v tokens, this whole framework for sub network rewards, a ton of stuff. Now, this is like what I live for, right? Like, you just get dropped into a jungle and you need to hack your way out with a machete. So I think when you get tasked with a big project, your first question is, where do I start? Right? And I'm kind of an OG data infrastructure guy, so I think about things in terms of, like, data and how the data moves. So that's the very first thing I did. I was like, I need to get a mental map of everything we need to build.
00:08:03.114 - 00:08:39.874, Speaker A: And you actually see here, this is not actually what the data model ended up being, although it's pretty close. This was the very original data model that I had put together, and you can kind of see boxes drawn around this. That was where I thought the boundaries for smart contracts would be. I'm a firm believer that smart contracts should eventually be made immutable. And the only way that you can make your smart contract immutable is if it's very simple. It just does one thing and it does it really, really well. And if you're going to have a complex system like helium, and you're not going to shove it all into one contract, you're going to need a ton of contracts.
00:08:39.874 - 00:09:12.884, Speaker A: Now that led to my second problem. I'd been building on Solana for about two years, and I knew that actually the worst part of writing smart contracts on Solana was not writing the smart contract itself. Armani and anchor actually solve that problem. Smart contracts, easy JavaScript SDK for your smart contract. So anyone can actually use it so hard you end up writing thousands of lines of code for each contract. We had at the time, people were telling me the timeline was three months. We ended up doing it in six.
00:09:12.884 - 00:09:49.806, Speaker A: But that's still a really short timeline to do this kind of crazy migration. So the first order of business, how can I avoid writing an entire JavaScript SDK? And that's where we get to account resolvers. If you're an anchor, Dev, you really, really, really should look into account resolvers. I know a lot of people are ignoring it and they're just like chewing the glass of writing their contracts. This illustrates it right here. See that giant complicated instruction on the left hand side of the screen? There's a lot of stuff in there. But Solana is actually just like a graph database masquerading as a blockchain.
00:09:49.806 - 00:10:22.540, Speaker A: And the treasury management account there is like the center node of this graph. And you can pull everything else that you need from this endpoint, from that. Treasury management via has ones via PDA's and via some custom resolvers. That is the goal. Your smart contract, when you use it, you shouldn't really need to write any kind of custom SDK anchor should just work. You should be able to just pass the one account that you care about and have your endpoints be called in like three lines. So that's one of the things that we added to anchor.
00:10:22.540 - 00:10:56.986, Speaker A: If you put seeds equal true in your anchor toml, you'll get a bunch of new stuff in your IDL that tells the SDK how to do this. Now, the second thing we figured out is how is data movement going to work? This is again kind of calling back to my data infrastructure days. Push versus pool mechanics. The naive solution to all of these things is push. If I need to reward 400,000 hotspots I'm just going to send 400,000 mint transactions and mint them IoT. But that's really inefficient. And block space is expensive.
00:10:56.986 - 00:11:25.934, Speaker A: It's scarce even on Solana. You don't really want to be paying that. So instead, we do things as they're requested. We pull. When the user asks for their rewards from the oracle, the total lifetime rewards of that hotspot gets written to the chain, and then they can claim the difference between the lifetime rewards of that hotspot and the total rewards they've claimed. Kind of think of this like hitting a pinata. But this hitting of a pinata is way more efficient than us sending millions of transactions a day.
00:11:25.934 - 00:11:55.994, Speaker A: Now, the second thing you want to think about is your security and your token flow. They call it liquidity for a reason. These tokens, it's, like liquid. And these accounts, they're kind of like locks in a canal. And you want to make sure that you have proper rate limits on these things. You don't want any point for one of these accounts to get hacked or exploited, and someone drains the whole thing. Helium is a very big network, and we were going from zero to one in six months, which is insane.
00:11:55.994 - 00:12:26.834, Speaker A: And you want to make sure that your risk of any kind of exploitation is low. You don't want to put the entire network at risk. And so we created this thing. I called them circuit breakers, because it's kind of a callback to traditional finance, where exchanges will shut off when there's too much volume going through them. If the price drops by, say, 20% in an hour, it knows something's wrong, shuts off on the chain. It's a little bit harder to do that. And so you end up with rate limiters.
00:12:26.834 - 00:13:23.198, Speaker A: And so our circuit breakers are more like rate limiters, but they accomplish the same thing, which is if something's wonky and one of these accounts is getting drained or someone's minting tokens like mad, we know something's wrong, and it stops it. The second thing we had to figure out, and this is actually still a pool mechanism, was how do we run 850,000 transactions and not take Solana down? Turns out you can actually just do that right now, and Solana will be fine. But this was in April, and Solana hadn't gone that long without some downtime, so we were very worried about it. And so we actually decided to make it lazy. We made it so when somebody opened their wallet, that's when their wallet was migrated. And the other thing that we had to avoid here was double spends or not spending at all. There's kind of two problems if you're trying to send a ton of transactions.
00:13:23.198 - 00:13:50.818, Speaker A: The first problem is you send the transaction twice and that person gets paid twice, they're really happy, you're really mad. And then the other thing can happen too. You don't send the transaction, they're really mad. You're actually probably mad too. By putting this whole situation on chain, we could actually guarantee that every transaction got ran exactly once. And plot twist. We used compression to do this.
00:13:50.818 - 00:14:30.662, Speaker A: We actually compressed all of the transactions into a Merkle route where the leaves are each transaction. If you don't understand Merkle trees, it's fine. Basically what people were doing is they were saying, hey, here's the transactions I need to run. And here's the proof that it is actually part of the helium migration. And then they were able to execute it, and it would flip a bitmap to one that says, hey, this person already executed the transaction, which solved their problem of double spends, making sure that nobody gets their tokens twice. Effectively, this only possible on Solana. Can you imagine running 850,000 transactions on ETH? Holy crap.
00:14:30.662 - 00:14:55.146, Speaker A: Would have taken like ten years. And so then we really just like had to go ham. We had to rip up the floorboards. And this is where it's not just my team. It was like everybody, anyone who had ever touched helium, we have dozens of manufacturers. We had Nova labs, the Opco. Anything that touched the blockchain had to get ripped up.
00:14:55.146 - 00:15:17.574, Speaker A: We had a helium vote UI. We had applications for each manufacturer to onboard their hotspots. We had an explorer, we had a Cli, we had a wallet app. There was a ton of stuff. And basically all the APIs changed because we completely ripped out the back end. Think like taking bubblegum from hair. And actually, this was the majority of the effort.
00:15:17.574 - 00:16:13.062, Speaker A: It took maybe two or three months to write all of the contracts to migrate to Solana. And the rest of it was spent fixing the uis. This is where it's a little bit overplayed that people are saying like, oh, Solana needs move, Solana needs this, Solana needs that. You spend maybe 5% of the time actually writing the smart contracts. The rest of it is how you interface with the smart contracts. So I think the question after all of this, the big things we did to make this happen, to make it smooth, to make it happen, when people were requesting the data and not just shoving it all in at once, the question is, how did it go? What happened? And it kind of reminds me of a scene from one of my favorite movies, the Kingsman. So Eggsy asks Harry, who is the secret agent? What all these headlines are behind him at his desk.
00:16:13.062 - 00:16:39.890, Speaker A: Because they're random, they're weird. They don't seem important. Anyway, what he tells him is, these are the headlines from every time that I prevented a catastrophe. Is like, if I hadn't prevented this catastrophe, the headline would have been some horrible, horrible thing. But instead it was like a soccer game or something. So what is our headline? What was the headline from the helium migration? I'll tell you something. It was not the helium migration.
00:16:39.890 - 00:16:55.154, Speaker A: It was actually the madlidesmith. And that is something I'm very proud of. So, yeah, if you have any questions, feel free to contact us. Hello out here, foundation. I'll be walking around. Feel free to stop me anytime. Thanks, guys.
