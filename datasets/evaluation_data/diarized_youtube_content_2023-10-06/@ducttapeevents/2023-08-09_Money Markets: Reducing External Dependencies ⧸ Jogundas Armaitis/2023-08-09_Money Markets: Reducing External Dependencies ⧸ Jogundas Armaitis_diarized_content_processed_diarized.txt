00:00:02.400 - 00:00:48.754, Speaker A: So I'm talking right after a panel on regulation. And the guys there had a very nice thought. They said that one of ways to move away from CFI is regulations, but another one is basically being more decentralized. And that I liked very much. I liked that thought. Now, coming to the topic at hand, I'm going to talk about money markets and how to do away with a, at least some of external dependencies that these smart contracts typically rely on. So this talk is mostly about kind of making money markets available to more and more tokens, expanding what they apply to.
00:00:48.754 - 00:01:38.194, Speaker A: So just to be on the same page, even though we are in a DeFi conference, just to kind of set the stage of what I mean by a money market. So for me, a money market is any sort of a smart contract that takes one sort of tokens as deposits. So token a here, and after you deposit this token a into this money market smart contract, you're then able to borrow another token. So that's token b. So if a smart contract can do that, for me, it's a money market, and some of the brands that are well known in the space are Aave and compound. One of my motivations of thinking about this problem is that basically nobody understands banks. And this year, this memory of some of the banks going down in the US is still very fresh.
00:01:38.194 - 00:02:24.626, Speaker A: Even some very old people talk about it. People who are definitely not crypto balls are concerned that the public at large does not understand banks. There's not enough transparency in the space and even the regulators often do not understand what they're regulating. My kind of takeaway from this is that maybe we should move away from extremely complex systems and maybe we should move towards something that we can understand a bit easier. So I think that these defi money markets are somewhat straightforward to understand. At least the current architecture is rather straightforward. So at the center of this diagram, we have the money market.
00:02:24.626 - 00:02:53.958, Speaker A: It's right here. There are some supporting pieces around it. So the money market, in order to perform its function, it needs to know the price of the asset that is being used for collateral. So in order to know this price, the money market talks to a price oracle. But this price oracle itself is a smart contract on the blockchain. So it by default doesn't know anything. Somebody or somebody has to push this information onto this price oracle.
00:02:53.958 - 00:03:39.348, Speaker A: So that's what data providers or keepers do, they push data onto price oracles and they get paid for this. Now they don't have the data themselves, so they have to query other data sources. They can try to query markets where the asset is being traded. That's centralized exchanges or maybe decentralized exchanges here. So these decentralized exchanges, they do know the price at which the asset is being traded, and that's how the data provider gets the price, pushes it onto the price article, and that's how the money market gets to discover the price of the collateral asset. Now, if a loan goes bad, if the collateral becomes less valuable than the loan that the smart contract issued, this loan has to be liquidated. And there is a role for that.
00:03:39.348 - 00:04:25.664, Speaker A: There is a specific player in the ecosystem called the liquidator who then takes care of these bad loans. And basically that's how defi money markets work at the moment. That's how aave or compound roughly works. So one could think that, okay, it's easy to understand, so maybe it's really secure, maybe there is no problem at all. Well, that's not really the case. I mean, the attack surface of the system is very large, even though the money market itself is very much kind of a limited smart contract, there is all this infrastructure around it, and anything in this scheme can go wrong, which I indicate by these goombas all around here. So basically any of these parts can go wrong.
00:04:25.664 - 00:05:19.114, Speaker A: Somebody could corrupt the Dex smart contract and then the money market would not function correctly because, I mean, the price would be wrong, and at the end it wouldn't know if the loans are bad truly, or if they are bad just because of the Dex problems. Same goes for the price oracle smart contracts. Same goes for the off chain infrastructure like data providers, like the liquidators. And also there are all sorts of other attacks that have to be taken into consideration when it comes to moving information around. So all of these price updates, liquidations, those are transactions that can in principle be censored, they might be delayed, and that's again a problem for the money market. One might think that this is theoretical, but actually these attacks happen all the time. I mean, there have been quite a few kind of high profile attacks, even of bigger money markets.
00:05:19.114 - 00:06:19.366, Speaker A: There has been some price manipulation related to some tokens on AaVE, and people are even making GitHub repos talking about oracle manipulation attacks in general. So how does a typical attack look like? Well, I mean, very simply, and this is not a very sophisticated attack, but it has been seen in the wild. First of all, you artificially increase the price of the collateral token. So of the token a, then in the same transaction, for example, you deposit this token a as collateral into the smart contract. That is the money market. Then you borrow this other asset price, b, you are able to borrow quite a bit of it because the collateral is worth a lot. And then finally, since you know that this collateral is only worth a lot artificially, you are able to just simply run away with assets that you have borrowed and never repay your loan.
00:06:19.366 - 00:07:21.636, Speaker A: Now, this attack is possible because the money market typically does not know anything about the level of liquidity of your collateral asset. I mean, it knows the price, hopefully. Hopefully the price is up to date if everything is working correctly, but it does not know anything about the level of liquidity. And that is a huge problem, because if you want to liquidate something, there has to be enough liquidity available in the system. So this slide just shows kind of inconcrete numbers. The same attack, I won't go through it, but basically it's an illustration that it is possible to kind of go through all of the steps that I showed on the previous slide and implement this attack as a single kind of atomic transaction without risking any of the attackers funds in the end. So basically, instead of starting with your own collateral, you take a flash loan, and that is available in the market at the moment.
00:07:21.636 - 00:08:20.236, Speaker A: And then at the end of the attack, you kind of wind down the flash loan and you end up with profit, which is basically riskless. That's why people find these money markets smart contracts so attractive when it comes to looking for exploits. Well, one might conclude from the story so far that perhaps it's just an inherent kind of property of the system of finance that as soon as you start having debt, you become kind of more fragile. In the terminology of Taleb, who talks about robustness and fragility and then fragility. Maybe debt just makes you more fragile. Maybe if you have debt, there is not much you can do. You just add debt to your system, just like fractional reserve banking, and then you become vulnerable to certain types of attacks.
00:08:20.236 - 00:08:56.820, Speaker A: And maybe you should just be fine with it. Maybe you should live with it. Now, the biggest money markets go around this risk somehow. And the way they closed or try to close those risks down is they limit the assets that are available as collateral. So, for example, if I went to these two big money markets just the other day, like chose some random chain, and I mean, looked at the lists of assets available as collateral. So compound has five assets available as collateral on some chains. That's not a lot.
00:08:56.820 - 00:09:30.854, Speaker A: If you think that there are like tens of thousands of tokens in the crypto ecosystem at the moment, five is not a very large number, but that's one way to solve the problem. So only focus on collateral that has sufficient liquidity and just ignore the rest. I think that we can do much better than that. And I have a wish list. I mean, how a really nice money market would work. In particular today I'm talking about two things. So I would like this money market to have no on chain dependencies.
00:09:30.854 - 00:10:29.286, Speaker A: So I wouldn't like it to depend on any external smart contracts. And then I would like it to depend on nothing off chain. So I don't want the smart contract to depend on people like liquidators or data providers. I mean, I want this to have a very limited attack surface, and then these are the requirements that are very much applicable. There are some other items on the wish list, but I'm not going to go into detail on those ones. I think it's really possible to come up with an architecture which answers all of the items on the wish list. And one very simple mechanical way of doing it is basically taking a decentralized exchange component, taking a money market component, and then putting those two components into the same box, into the same set of smart contracts which are interacting.
00:10:29.286 - 00:11:26.860, Speaker A: This has a nice property of the money market part, knowing how much liquidity there is on the decentralized exchange part and then making its decisions accordingly. So for example, not giving out too many loans, not taking on too much debt, if the debt cannot be liquidated on the decentralized exchange part of it. The way this works, for example, is that the swaps on the decentralized exchange part then automatically do the liquidations. So then the external liquidators are not needed, and then the again, otherwise trades on the dex, update the price. So then the oracle component is not really required. And of course the liquidations on the money market side use the liquidity that is already available on the dex side. When it comes to these goombas.
00:11:26.860 - 00:12:22.632, Speaker A: I mean, the picture again is much nicer. So they, instead of residing inside various blocks of your system, these guys, these bad guys are then just walking around the outskirts. So of course they can try to attack your system nevertheless, but they then are not able to control the state of various parts of your system. They are not able to censor the information flow. Instead of that, they are just going to try to perhaps go after your users or try to find bugs in the implementation of, of your smart contracts. Now, the attack that I described beforehand is actually not possible anymore with this architecture. And again, the key reason, the deep reason for that is because the money market now knows about the liquidity that is available on the decentralized exchange.
00:12:22.632 - 00:13:50.022, Speaker A: And of course, since this is something that we are creating from the ground up, we are able to design it in a way where it's always more profitable to just take your collateral and swap it on the dexide, rather than try to design kind of a involved way where you deposit this collateral as, deposit these tokens as collateral, then you take out the loan, then you kind of run away with this loan. I mean, we can design it so that this attack is strictly less profitable than simply swapping your tokens. And that, I think is a very nice property of the system. So kind of, to summarize, first of all, currently in the market, most of the smart contracts, most of the protocols that have this functionality of using one token as collateral and giving out loans, these guys depend on external components, vast majority of them do. Now, this architecture, where they depend on this external components, this impairs security and also limits the tokens that are available as collateral. So basically, either you have low security or you have a low breadth of applications. These both are not ideal, and there is a continuum between the two.
00:13:50.022 - 00:14:25.928, Speaker A: Of course, as always. Now we think that external money market dependencies can be reduced to zero. The system can be made completely self contained, and we are not the only team working on it. There are other people doing similar work. We think that it's just a matter of twelve months or so until these novel architectures start coming on to blockchains nearest to you. So please reach out to me on Twitter or other sources if you like it. I really love discussing this topic and otherwise.
00:14:25.928 - 00:14:33.404, Speaker A: Thanks a ton for listening. Thank you. There is a question.
00:14:36.744 - 00:15:26.264, Speaker B: Thanks for presentation. So if you, if I understand correctly, the way, how you limit the price oracle manipulation is by measuring the available liquidity on the Dex. So let's say if I will manipulate the price, the liquidity will change significantly. Then if you have different price feeds, the available liquidity changes based on algorithm used by Dex. So if you have concentrated liquidity, you have a significant smaller need for having a good prices than with non concentrated liquidity schemes. And same, how do you reconcile between different mechanisms or even centralized exchanges?
00:15:26.684 - 00:16:23.192, Speaker A: Yeah, so this makes a lot of sense what you're saying. And definitely if you're thinking about protocols that have a lot of liquidity on really concentrated ticks, in the terminology of Uniswap V three, then this is not a very robust system. But again, if you look at the space of all the tokens, all the crypto tokens, currently, the guys who are going to use Uniswap V three. Mostly these are larger tokens that are already being supported by these larger money markets. What I am mostly thinking about is I am mostly thinking about these smaller tokens, which typically trade on a single uni v two pool, maybe single sushi swap pool or something like that. So instead of trading on a random non concentrated liquidity amm, they could trade on this amm and then just be able to use their token as collateral.
00:16:23.288 - 00:16:25.804, Speaker B: Okay, so what price versus do you use today?
00:16:26.924 - 00:17:06.478, Speaker A: So this is still on paper. This is not a functioning protocol for now. But the idea is to just not have any external price sources, only dexs. So only this single Dex, which has no concentrated liquidity, which is basically a vanilla amm, which is. You could criticize that because it's like fragmenting liquidity. It's kind of very inefficient in terms of how liquidity is being provided. But on the other hand, it's very robust in the sense that I can change the price and I will always know the price impact of my swap a priori, because like the liquidity is fixed before the swap, I do the swap and I know how much the price is going to change.
00:17:06.478 - 00:17:08.234, Speaker A: So that's a very useful property.
00:17:08.734 - 00:17:09.794, Speaker B: Okay, thanks.
00:17:10.214 - 00:17:10.954, Speaker A: Thanks.
00:17:11.974 - 00:17:13.114, Speaker C: Another question.
00:17:19.513 - 00:17:41.013, Speaker D: Yeah, I mean, doesn't this seem like you're just trying to, like, bootstrap liquidity in tokens that don't have liquidity? Like, isn't it like, usually the reason that all of these really small shit coins don't have a whole lot of liquidity is because the team holds the vast majority and can throw the price or can come on and borrow. Like, should a lot of these tokens have money markets? I guess would be my question.
00:17:41.633 - 00:18:20.974, Speaker A: Well, I mean, I guess it's a philosophical question, but a very nice question, Nick. So my thinking is that many of these teams, maybe they have a tiny token, maybe they are working on it, and they are already providing this liquidity themselves. Maybe they are manipulating the price and maybe they are trying to engineer some attacks or something, and that's fine. So with this protocol, they are able to try to do that. But on the other hand, the game is very transparent. So if they still want to play the game, that's fine. But I think that there are also some legitimate use cases for this sort of technology, and I think there are people who just want to do that.
00:18:20.974 - 00:18:31.794, Speaker A: So of course it's kind of a large space to explore. Nothing is sure a priori. But yeah, this is something that I appreciate exploring.
00:18:36.454 - 00:18:45.202, Speaker C: Any final question okay, in that case, a big round of applause for Ugundas. Thank you so much.
00:18:45.298 - 00:18:46.134, Speaker A: Thank you.
00:18:48.994 - 00:18:51.674, Speaker C: And we've got about five minute break and then we'll start with the next.
