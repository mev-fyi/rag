00:00:00.170 - 00:00:53.706, Speaker A: With the Shanghai Capella upgrade rapidly approaching, there is a lot of discussion about Ethereum staking withdrawals and what this means for the Ethereum ecosystem as a whole. So how do withdrawals work? What are some common misconceptions about this process? And what are the implications of enabling Ethereum stakers to withdraw their locked up ETH? You'll find answers to these questions and more in this video. Before we begin, if you want to learn more about decentralized finance and the technology behind it, make sure you subscribe to my channel, hit the bell icon and enable all notifications. Let's start with understanding how we got here and why staking withdrawals weren't enabled when Ethereum moved from proof of work to proof of stake. The transition to POS happened over multiple steps to minimize the number of big changes happening at the same time. This approach was essential, especially for an established network settling trillions of dollars of value per year. The most significant steps were the launch.
00:00:53.738 - 00:00:56.010, Speaker B: Of the beacon chain, the merge.
00:00:56.170 - 00:01:48.682, Speaker A: The launch of the beacon chain in 2020 created the foundation for the transition by creating a separate POS consensus layer running alongside the Ethereum POW chain. Launching the beacon chain earlier allowed for the accumulation of enough ETH to secure the network before settling real value transactions. It also allowed the testing of the new POS consensus model for an extended period with real funds at stake. The early network participants committed millions of ETH to secure the Ethereum POS network, despite knowing they wouldn't be able to withdraw their ETH until much later. The next big step, the Merge, united the POS consensus layer with the execution layer. This allowed for finally moving off POW and maintaining only one canonical chain, Ethereum, now secured by millions of staked ETH. The Merge was by far the largest change ever to Ethereum.
00:01:48.682 - 00:02:00.994, Speaker A: Due to the nature of the upgrade, it had to happen without any downtime. To minimize risk. The scope of the merge was reduced and no other features outside of the POW to POS switch were included as.
00:02:01.032 - 00:02:02.254, Speaker B: Part of the upgrade.
00:02:02.382 - 00:02:43.726, Speaker A: The biggest cut that had to be done impacted withdrawals, which became the focus of the upcoming Shanghai Capella upgrade. Staking withdrawals, as the name suggests, will allow stakers to withdraw their locked up ETH. Before we get any further, let's define two types of withdrawals partial and full. A partial withdrawal happens when the validator withdraws their accumulated rewards. This is an extra balance on top of the maximum effective balance of 32 ETH. A partial withdrawal can also be referred to as a rewards payment or excess balance payment. In contrast, a full withdrawal happens when the validator has completed the process of exiting and the entire balance is withdrawn.
00:02:43.726 - 00:02:58.838, Speaker A: This occurs only when the validator exits the system either voluntarily or by being forcibly removed in a process called slashing. Once enabled, staking withdrawals will be automatically distributed every few days. We'll explain the details of this process.
00:02:58.924 - 00:03:00.294, Speaker B: Later in the video.
00:03:00.492 - 00:03:53.622, Speaker A: Additionally, the withdrawal process initiates on the consensus layer, so no transaction fee is required at any of the steps. In order to start withdrawing their staking rewards, a validator will have to provide their withdrawal address only once given withdrawals affect both the consensus and execution layers of ethereum, both parts of the network must be updated. Shanghai is the name of the execution layer upgrade containing withdrawals, which are specified in EIP 48 95 and Capella is the name of the counterpart consensus layer upgrade, which will be activated at the same time. These two upgrades are sometimes also referred to as ChappellA. Now let's see how withdrawals work under the hood. In the Ethereum ecosystem, each validator has a corresponding index number. In addition, they also have two types of withdrawal credentials defined as either zero x or zero x 10.
00:03:53.622 - 00:04:37.474, Speaker A: X indicates that a particular validator doesn't have an associated withdrawal address. These credentials are derived as the hash of the BLS public key with its first byte swapped out with a zero byte, hence the name. In contrast, zero x one means that a validator provided the withdrawal address. These withdrawal credentials are represented as zero x one followed by eleven bytes of zeros, then a chosen ethereum address. In order to enable withdrawals validators with zero x zero credentials will need to sign a BLS to execution change message. This will be possible after the Capella upgrade. Once withdrawals are enabled, a validator proposing a block will scan linearly through validator indices.
00:04:37.474 - 00:04:49.862, Speaker A: To find the first 16 validators with zero x one credentials who either have a balance that exceeds 32 ETH accrued validator rewards are withdrawable have fully exited.
00:04:49.926 - 00:04:52.874, Speaker B: Validator set the linear search stops after.
00:04:52.912 - 00:05:23.666, Speaker A: Either finding 16 validators to match this criteria or after 16,384 iterations. The algorithm remembers the index at which the search stopped so the next validator proposing a block can resume from that index. After getting to the last index, the algorithm starts from the beginning index zero a good analogy here would be an analog clock where the hand on the clock points to the hour, progresses in one direction, doesn't skip any hour, and eventually wraps around to the beginning again.
00:05:23.768 - 00:05:25.822, Speaker B: After the last number is reached.
00:05:25.966 - 00:05:54.974, Speaker A: After the scan is completed, the validator creates a list of withdrawals to be included in their execution payload. Each item on the list contains the following withdrawal index a monotonically increasing index starting from zero that increments by one per withdrawal. To uniquely identify each withdrawal, validator index the index of the validator whose balance is being withdrawn. Execution Address the ETH address on the execution layer where the withdrawal should be sent.
00:05:55.172 - 00:05:57.406, Speaker B: Amount the amount in GUI to be.
00:05:57.428 - 00:06:36.870, Speaker A: Sent to execution address when building or processing a block execution layer clients will apply these withdrawals at the end of a block. As mentioned earlier, processing withdrawals do not compete with user transactions for block space. With a maximum of 16 withdrawals that can be processed in a single block. There should be a maximum of 115 200 withdrawals processed per day, assuming no missed slots. As we can see, the design of withdrawals is simple, yet extremely robust. Now it's time to discuss some common misconceptions when it comes to withdrawals. The first misconception states that when processing withdrawals, there is a difference between a full and a partial withdrawal.
00:06:36.870 - 00:07:15.058, Speaker A: In terms of priority or ordering. Both full and partial withdrawals happen when the linear scan over the validator set reaches a validator's index. The only difference is that in the case of full withdrawals, a validator must leave the exit queue and reach the withdrawable epoch before the linear scan can pick it up. Another misconception is that users will lose their rewards if they do not provide a withdrawal address. Which is not true. In case a validator forgets to provide a withdrawal address, their e three words will not be sent to the void once withdrawals are enabled. Instead, the scanner will skip validators who haven't provided the withdrawal addresses.
00:07:15.058 - 00:08:00.594, Speaker A: Also, it's important to remember that the withdrawal address cannot be changed and it's set only once. Therefore, stakers must be extremely careful when setting up the withdrawal address, ensuring they have full ownership of the address provided. There is also a lot of speculation when it comes to withdrawals. One worth mentioning is the assumption that stakers will withdraw a lot of ETH from the Ethereum ecosystem once the withdrawals are enabled. The stronger version of this argument also assumes that this will destabilize the POS Consensus Mechanism. Although we cannot fully predict how much ETH will be withdrawn over time, there are a few important counterarguments. First, most stakers are early Ethereum adopters who were brave enough to stake when it was still uncertain when the withdrawals would be enabled.
00:08:00.594 - 00:08:33.246, Speaker A: Many stakers have expressed a desire to continue staking, to support the network, and to continue earning its denominated rewards. Secondly, to ensure that the POS consensus Mechanism and the active set of validators remain stable, ethereum implemented a withdrawal queue for all validators wishing to exit. The queue limits the number of validators that can leave the ecosystem simultaneously. It's worth mentioning that the first withdrawal scan will withdraw a lot of accumulated rewards, basically since the inception of the beacon chain. Still, the subsequent ones will process a.
00:08:33.268 - 00:08:35.118, Speaker B: Much smaller amount of ETH.
00:08:35.294 - 00:09:18.714, Speaker A: There are also some important implications when it comes to withdrawals. First, enabling withdrawals will create an open twosided staking flow. Currently, the staking flow is onesided ETH can only flow into the network and never exit it. Interestingly, enabling withdrawals may incentivize even more people to stake. As they will know, they can always withdraw their ETH if needed for something else. Stakers who don't run their validators and stake with a centralized staking provider will be able to change their provider to a different one. So, for example, they can withdraw their funds from a provider that offers a lower staking rate to another provider which offers a better rate, or move from a centralized provider to a decentralized one or even run their own validator withdrawals.
00:09:18.714 - 00:10:05.866, Speaker A: You also impact liquid staking derivatives such as Lido, rocketpool and others. For example, liquid staking coins such as St, ETH or Re had a history of temporary losing their peg to the price of ETH during market turbulences. However, with the two sided staking flow, any significant discrepancy in their peg would be quickly arbitraged away. Early adopters in liquid staking and centralized staking captured a vast majority of the market, as they didn't have much competition. However, the market share of these incumbent players could see a major change once withdrawals are enabled, especially if they don't offer a competitive rate. The ability to shift freely between staking providers will benefit the ETH staking market. Enabling staking withdrawals is one of the most anticipated upgrades to Ethereum.
00:10:05.866 - 00:10:19.522, Speaker A: It will be extremely important to make sure this change is executed smoothly in order to help with testing. Validators will have several devnets and testnets available to run through the process and ion out any potential issues before going.
00:10:19.576 - 00:10:20.930, Speaker B: Live on the main net.
00:10:21.080 - 00:11:04.640, Speaker A: Withdrawals are yet another improvement, bringing Ethereum one step further towards building a sustainable, secure and decentralized future. ChappellA upgrade is expected to take place in the first half of 2023. At the time of this video, the beacon chain accumulated over 17 million ETH across over 530,000 Validators. An average balance for a Validator is just above 34 ETH, which means over 1 million ETH in accumulated rewards. It will be interesting to see how withdrawals will affect these numbers. So what do you think about Ethereum enabling staking withdrawals? Comment down below. And as always, if you enjoyed this video, smash the like button, subscribe to my channel and check out Phenomatics on Patreon to join our DeFi community.
00:11:05.010 - 00:11:05.740, Speaker B: Thanks for watching.
