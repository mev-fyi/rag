00:00:00.090 - 00:00:22.720, Speaker A: Just for the delay, we had some technical issues. Thank you for sticking around. My name is Alex Nathan. I'm a co founder and head of analytics at Metrica. And today I'm going to be talking to you about mev relays. If you're not familiar with Metrica, you can visit our platform. We have free dashboards and alerts for the community at ETH Metrica Co.
00:00:22.720 - 00:01:05.924, Speaker A: If you like what you hear today, you can follow us on Twitter at metricaco. And if you scan this QR code, you'll be able to join our discord. So, before I get the meat of the presentation, just want to say a couple of words about. Oh, I saw you were trying. You want to try again? Yeah. Before we get into the meat of the presentation, I want to say a couple of words about Metrica. So, Metrica is an operational intelligence platform for blockchain networks, and we work with a number of leading protocols like Ethereum, Solana, as well as key players in ecosystems like Lido.
00:01:05.924 - 00:02:01.480, Speaker A: Blockdemons right there. And what we do is we help all these different organizations and entities monitor blockchain networks with our analytical tools. So we provide them with alerts, APIs, dashboards, so they can monitor the performance of the network real time and be able to troubleshoot issues as fast as possible. So the agenda for this presentation is the following. So we'll start with a quick overview of the MVV supply chain as it is today, and talk about the role of relays that the relays play. Then I'll show you something that we did with a grant from Lido on monitoring the performance of Mev relays. And finally, we're going to touch on a somewhat controversial topic, which is OfA compliance and MEV relays.
00:02:01.480 - 00:02:45.370, Speaker A: So I imagine most of you have seen some version of this slide over the last few months. This is what the MEV supply chain looks in the post merge world. And compared to pre merge, there's a few different new players that emerged. So on the left, we have the searchers. There's about 100 of them, but it's kind of hard to tell precisely. And basically what the searchers do is they scan mempools and they try to find MeV opportunities like front running, sandwich attacks and so on and so forth. So searchers are very specialized bots, and that's all they do.
00:02:45.370 - 00:03:27.424, Speaker A: Once they identify the mev opportunities, then they submit bundles of these opportunities to block builders. So block builders, as the name suggests, all they do is they create blocks that are ready to be committed to the ledger there's about 120 block builders right now. Well, as you can see, there is something in between the block builders and the validators. And that is the relays. Actually, there's exactly eleven relays right now. And as you can see, relays are just an intermediary between block builders and validators. But as you can imagine, the devil is in the details.
00:03:27.424 - 00:04:33.620, Speaker A: And relays have to do a lot more than just simply relay blocks along. So how do relays exactly work? So relays constantly receive blocks from the builders that submit blocks to them. And what they have to do is go through all of these blocks and find the one with the highest mev reward for the validator. In addition to that, they have to ensure the validity of the block, that the rewards check out, that the validator preferences are respected. And then what it has to do is it has to send just the headers of the block to the proposer, the validator. The reason why it doesn't send the whole block is because otherwise it wouldn't be having proposer builder separation. And once the proposer which receives a bunch of bids from all the relays it's connected to, picks the final block, the one with the highest reward, then the relay is responsible to propose a block on the validator's behalf.
00:04:33.620 - 00:05:15.050, Speaker A: Now, there's also something that I left out of what relays do, which is they also. Well, some relays, they censor transactions based on who the sender and the receiver is. But we'll get to that in a minute. So relays essentially operate on trust, right? They're trusted by various participants in this supply chain. So validators trust that relays will get them as fast as possible, valid blocks that are profitable. And also validators expect that relays will propose a blocks on their behalf. We have seen a few cases where relays actually fail to do that.
00:05:15.050 - 00:05:57.910, Speaker A: Number two, builders trust that relays will transfer their bids as fast as possible to the validators so they can be rewarded for their work. Now this is especially important when builders and relays are not operated by the same entity. And finally, there is validators in Ethereum with regulatory obligations, and they trust that relays that claim to be compliant are actually compliant. So there's a lot of trust going around. And our motto is trust, but monitor. At the same time. We cannot blindly trust that relays are doing what they're supposed to do.
00:05:57.910 - 00:06:45.904, Speaker A: So we came up quite recently, as I said, with this lido ground, with a solution to monitor relays. And we went live with these dashboards and alerts. Last week so you can check them out and give us your feedback. So there's two sets of the solution. One is the dashboards that allow you to monitor the performance of relays in real time, and the second one is the set of alerts that will notify you if relays are not doing what they're supposed to be doing. So how does this solution work? We use something called a relay monitor. This is an open source project by Alex Stokes from the Ethereum foundation, and what a relay monitor does is the following.
00:06:45.904 - 00:07:46.516, Speaker A: So in every slot it impersonates the proposer of that slot, and then connects to all relays and collects bids from them. In addition to that, we've slightly modified the relay monitor to collect other metrics, like the round trip latency for getting the headers on the relays. And in addition to that, because latency plays a key role when you're collecting bids, we decided to deploy five instances of the relay monitors across the globe. So right now we have five relay monitors, two in the US, one in South America, one in Europe and one in the APAC region. And we keep pinging all eleven relays, collecting bids and other metrics. So all of this data ends up in our data lake, which along with our analytical capabilities, is powering our alerts and dashboards. So in terms of dashboards, we have three dashboards right now on eight Metrica dot co for MEV relays.
00:07:46.516 - 00:08:40.410, Speaker A: The first one is a relay overview dashboard, so gives you some key information, like which relays are online versus offline, the total mev blocks in real time, as well as a time series bids. We collect from relays, the total numbers and so on and so forth. The second dashboard focuses exclusively on the operational performance of relays, and here some highlights are the bids missed. So this is a very good indicator of whether a relay is actually online or offline. Another very important one is the bid faults. So as I mentioned earlier, relays are tasked with actually ensuring the validity of blocks. So with the relay monitors, we simulate what relays should be doing, and if we find that something is off, then we log a bit fault message.
00:08:40.410 - 00:09:28.756, Speaker A: And then, as I mentioned, latency is another very interesting metric. So because we have five relay monitors deployed, we can give you a median latency across all the regions, but we also give you the ability to double click on a particular region and see how relays perform in different regions. And the last dashboard is on economic performance. So we look at the reward distribution for different relays, just to know what's happening at all times. In terms of alerts, we have currently four alerts. And all these alerts have integrations with a variety of channels. So we do Pagerduty, Opsgeni, Telegram, Discord Slack, and the four relays that we went with were the following.
00:09:28.756 - 00:10:05.664, Speaker A: So consecutive missed bid alerts. So again, this is a very good indicator of whether a relay is online or offline. The second one is the bid fault. Again, checking to see that the relay is validating blocks properly. And actually, yes sir, this alert triggered for the first time in a while, and we found that a couple of relays were having trouble processing registrations. The third one is relay latency. So we've analyzed the data and we've seen that 99% of bids are sent within 240 milliseconds.
00:10:05.664 - 00:10:42.608, Speaker A: So if a relay is consistently taking longer than that, then we trigger a relay latency alert. And finally, we have the intended fee recipient alert. Again, not a very common alert, but basically what it does is if the relay sends a block where the recipient of the MEV rewards doesn't match the preferences of the validator, then we trigger this alert. And again, this one went off for the first time last week with a couple of blocks route relays. So this is the first part of the presentation. Again, would love your feedback. Go on etonmetric Co.
00:10:42.608 - 00:11:42.768, Speaker A: Check out our dashboard, sign up for alerts, and either talk to us offline, or ask us any questions on discord. Now, for the second part of the presentation, I want to talk about ofa compliance and relays. So one of the core premises of Ethereum is that Ethereum is credibly neutral, which means that Ethereum is fair, transparent, impartial, so no single entity has control over how the network operates. And after the merge, well, I guess with the merge, this changed for the first time because flashbots launched their first of a compliant relay. And again, this means that the relay was censoring transactions based on who the sender and the recipients were. And today there is more compliant relays. So blocksroute regulated Eden and block native are all compliant relays.
00:11:42.768 - 00:12:32.740, Speaker A: They are censoring transactions. But first, let's take a step back and talk about what OFAC is. So OFAC stands for the Office of Foreign Assets Control, and basically they are tasked with putting together the SDN list, the block persons list. And once a person or an entity ends up in that list, that means that us persons and businesses cannot be facilitating transactions with these businesses or individuals. Otherwise they're going to be facing fines. And the big news here was last August, OFac placed tornado cash, the famous cryptocurrency mixer on the STN list. So that immediately meant that validators that wanted to be compliant, they had to be very careful with including tornado cash transactions in the blocks they were proposing.
00:12:32.740 - 00:13:12.796, Speaker A: So the big concern was that suddenly MeV Boost was getting a lot of traction. I think around December we're getting 90% of blocks coming from MeV Boost. And it's not just that MeV Boost was gaining a lot of momentum, it's that flashboards was extremely dominant. The flashboards relay at some point was responsible for 80 plus percent of mev blocks. And since then the community has really responded. There's been a number of initiatives to try and mitigate this problem. So flashboards open source their relay and their builder.
00:13:12.796 - 00:14:13.540, Speaker A: Now validators have control over which blocks they accept with the Minbit settings. And today we have more non censoring relays. So there is seven out of the eleven relays are non censoring. So in light of all that big controversy, we decided to look under the hood and ask the question, well, are the relays that claim to be compliant? Are they actually compliant? And what we found was quite interesting. So we analyzed some data from November eigth to 2022, up until February 1, 2023. So what you can see here is the blue line is all the blocks containing tornado cast transactions from that period of time. Now, the green line is blocks containing tornado cash transactions that have been relayed by MEV relays.
00:14:13.540 - 00:15:20.120, Speaker A: And then finally the red line is blocks containing tornado cash transactions that have come through supposedly compliant relays. And you can see that from November eigth up until the end of the year, the end of 2022, well, tornado cash transactions were coming through just fine. And I think at that point the supposedly compliant relays figured out what was happening and they fixed it. But even now, you can see in January there are some spikes every now and then with transactions coming through. If you ask why this happened, our hypothesis is that on November eigth it happened that some more tornado cache addresses were blacklisted and the supposedly compliant relays never picked it up. And it took them a month and a half to fix it. So what are the key takeaways here? Relays have been called dump pipes just because they are moving blocks around, but clearly they affect many participants in the ecosystem.
00:15:20.120 - 00:16:12.788, Speaker A: And we really think that builders and validators should monitor the performance of MEV relays because the rewards depend on them. But I also want to make a comment about MeV boost and censorship in general. So we believe that MeV boost is not synonymous to censorship. And there is a blog post that my team has been working on and it's going to come out next week where we actually looked at mempool data to see can we quantify this censorship. And what we found out is that 99.5% of tornado cash transactions that are in the mempool end up on chain. So there's not a lot of censorship in terms of whether a transaction is successful.
00:16:12.788 - 00:16:59.812, Speaker A: Where there is some censorship seems to be in the waiting time. How long does the transaction, a censored transaction, stay in the mempool? And what we found out was that the median wait time for regular transactions was 8 seconds, but for non OFAC compliant transactions it was 22 seconds. So it is a big difference. It is three times more, but still the success of an non compliant OFAC transaction is not affected. So next steps. If you haven't visited our dashboards already in the past 20 minutes, please do. You can go to if Metrica come join our discord.
00:16:59.812 - 00:17:32.930, Speaker A: We'd love to hear your feedback and improve our dashboards and alerts as much as we can. As I mentioned, we have a number of blog posts coming out this week and also next week. So all our blogs are published at Blog Metrica Co and we also have a booth in Devtopia. It's further behind us, so please stop by and say hi. Thank you very much. It I.
