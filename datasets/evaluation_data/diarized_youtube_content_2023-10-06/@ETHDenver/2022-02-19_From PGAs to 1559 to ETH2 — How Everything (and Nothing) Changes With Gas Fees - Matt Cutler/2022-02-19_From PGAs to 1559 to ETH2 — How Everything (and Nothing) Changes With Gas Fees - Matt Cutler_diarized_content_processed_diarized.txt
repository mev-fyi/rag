00:00:00.090 - 00:00:32.454, Speaker A: Ah, happy east Denver. I'm so excited to be back. This is my fourth east Denver total, third in person. Because we weren't here last year, unfortunately. It's super great to see the community, and we're going to spend the next 20 minutes or so going deep into the world of gas fees. It's going to be a bit of a crash course. I move very, very quickly to try to cover as much possible, but I'm here with you for this reason, boomers and ethereums alike like to complain about gas prices, right? And it never seems to go away.
00:00:32.454 - 00:01:08.210, Speaker A: And the question is why? Because I thought we were supposed to fix it or it's going to get fixed in the future. We're going to talk today about how they work and why they work and what we can expect moving forward. So we're going to talk about the past, present and future of gas prices. So prior to EIP 1559, the original model was a very simple first price auction. You set your gas price, the miners prioritized the highest fees. There was a fixed block size with a 15 million gas limit, didn't change, and the miners received all of the fees at the end of it. Super straightforward.
00:01:08.210 - 00:01:50.686, Speaker A: It's simple, and you had one variable to worry about. Very easy, everybody got it. But there was this issue where trading bots and other systems would often go to war with each other, and they would escalate the gas price to win a certain opportunity, and this would bid up the gas price of the entire network. These are called priority gas auctions, and you can see one of them. This is a representative one here. If the gas prices for the network are low, the bots go to war, the PGA happens, it tabletops, and then it sort of declines. And if you're just a regular user doing a regular thing on your favorite defi protocol or your favorite NFT, you suffered as a result of this.
00:01:50.686 - 00:02:44.106, Speaker A: So this was the big problem with this original FPA model, where it was super difficult to figure out what you needed to do to get into the next gas, the next block, and you had these big surges, and it made the network hard to use, and people complained about gas prices. And so as a result, a lot of research went into what's known as EIP 1559, which hopefully all of you are familiar with. That significantly changed the nature of the gas market on Ethereum. And this was launched as part of the London hard fork in August of 2021. We at block native were very involved in this. We were one of the first, if not the first, to support it at the London hard fork, and it introduced a whole series of changes that really, really affects the way that the network works. First, we now have dynamic block sizing, so the blocks can actually change dependent on demand.
00:02:44.106 - 00:03:21.322, Speaker A: There's three variables that go into determining gas price. A base fee, a priority fee, also called the minor tip, and what's known as a max fee, which is super disorienting for users. The base fee is the minimum inclusion for the block and is set by the network. Now, this is kind of a major change, because prior to EIP 1559, the network itself was not aware of what its gas fee was. It was totally set externally by the miners, and so the network actually starts to become self aware here. This is sort of interesting in its implications. Also, the base fee must be paid.
00:03:21.322 - 00:03:58.242, Speaker A: It doesn't matter how your transaction gets into the block. You could be a miner and you can shove it in there through a private network. You still got to pay the base fee, and the base fee must be paid in ETH. So it also establishes ETH as the core currency of the Ethereum network, which, strangely enough, was not necessarily the case up until EIP 1559. There's a lot happening here. The base fee is then burned. So the network charges the base fee and it goes away, which exerts deflationary pressure on the circulation of ETH, which should, in theory, increase price as network activity increases.
00:03:58.242 - 00:04:30.818, Speaker A: And then finally, the priority fee, which is set by the user, is paid to miners. So you have these two variables, base fee set by the network, priority fee set by the user. The base fee gets burned, the priority fee goes to the miner. Got it? It's more complicated. Now, we talked about paying that. The base fee has an algorithm which is targeting 50% full blocks. So the variable block size is zero to 30 million in this model.
00:04:30.818 - 00:05:12.878, Speaker A: But if a block is 100% full, the base fee will increase by the maximum in the next block of twelve and a half percent. So block to block, the most that the base fee can increase is twelve and a half percent. If that block is 100% full, it'll go up by twelve and a half percent. Similarly, the most the base fee can be reduced in between blocks is minus twelve and a half percent. But it only does that with a 0% full block. Empty blocks, which are now a thing miners actually mine blocks that have no transactions in them. When the base fee goes out of control, there's no demand, and the base fee goes down by twelve and a half percent.
00:05:12.878 - 00:05:52.874, Speaker A: Blocks are empty. When you set your priority fee, you will always be charged that that is guaranteed to go to the miner. It's technically optional, but generally it needs to be at least two guay and you set this max fee, but you're almost never charged the max fee. And this is super disorienting for users because they put this number in that says the maximum amount your transaction is going to be charged, but that's what you're authorizing. It's sort of like a credit limit in a way, and only under very specific network conditions will your max fee actually go into effect. However, setting the max fee incorrectly can reduce transaction performance and predictability. So this max fee thing is a little bit confusing.
00:05:52.874 - 00:06:59.730, Speaker A: The big risk is the base fee is the minimum price you set for inclusion in the next block. So let's say the base fee is 50, and you're like, great, I'm going to price my transaction at 50. But before your transaction can get included, the base fee rises to 55. Your transaction is therefore underpriced and is not a candidate for inclusion. There's no way your transaction can get into a block until the base fee comes back down to the 50 that you set it at. So what you want to do is set a max fee that has a safety factor in it that basically can account for, hey, what happens if the base fee goes up? So this whole thing about max fee setting is a little bit tricky. In the world of EIP 1559, the common heuristic is your max fee should be twice your base fee plus your priority fee, with the idea being if you double the base fee, you're covered for the next six blocks, because at a maximum rate of increase, the base fee will double in six blocks.
00:06:59.730 - 00:07:55.974, Speaker A: But what's disorienting for the user is now the transaction looks like it's going to be super expensive, and then the transaction gets on chain and we don't celebrate to say, hey, you paid way less than your max fee. So we work with folks across the ecosystem all the time, and it's interesting how persistently confusion on what the max fee actually represents when it comes into play. Why you want to set it different ways is actually part and parcel of what's going on. So I really encourage everybody to get familiar with these concepts as part of the current network with EIP 1559. So the good news with EIP 1559 is we have variable block sizes so the network can adapt. It's much easier to estimate what's going to happen because it's not supposed to move around so much, and we have this deflationary pressure on the network, there are other benefits to EIP 1559 transactions, also called type two. One, they actually tend to cost less.
00:07:55.974 - 00:08:35.486, Speaker A: If you're submitting a transaction that's type zero, the old model, on average, you pay about 14% more. Okay, now, do users care about overpaying for gas? Absolutely, they do. So we highly encourage whatever you're building to be type two or EIP 1559 compliant so that your users don't overpay unnecessarily. Two. An unexpected side effect is type two transactions tend to go on chain slightly faster. So by having type two transactions, they get included slightly faster than type zero transactions. So another benefit of being EIP 1559 compliant.
00:08:35.486 - 00:09:15.982, Speaker A: Now, however, in the wild, these factors interplay with each other in interesting and unexpected ways. And so this is some real world data from an NFT launch, galaxy eggs on September 14 of 2021. And here's what the base fee did during this galaxy eggs NFT launch. So the NFT launches, everybody's super excited surge of transactions in the network, and we can see the base fee is going up. We have full blocks at the 12.5% rate up, and then it gets to about 2002 500 guay kind of tabletops, and then it descends down. Okay, nice.
00:09:15.982 - 00:09:43.106, Speaker A: Smooth, algorithmic, and predictable. But remember, under EIP 1559, there are two factors which you have to include. You have your base fee and your priority fee. What was going on with the priority fee? Oh, interesting. So basically, we saw this huge surge in the minimum priority fee. Minimum in the block, the bottom of the block, right? These big jumps. That's 2000 guay.
00:09:43.106 - 00:10:15.186, Speaker A: And the time here is sort of set to the beginning. If I overlay these two, look at this. When the base fee is low, the priority fee goes high, and as the base fee increases, the priority fee declines. They interact with each other. There's actually an algorithm at play here, the algorithm of EIP 1559. And there's the psychology of the users who are trying to participate in the NFT drop. And these two combined to look like this.
00:10:15.186 - 00:10:44.102, Speaker A: This was the actual network conditions during this drop. And if we combine them, what does that look like? It's the exact same tabletop we had before. Rapid rise, flat across the top, and a decline. So even under EIP 1559, priority gas auctions are still a thing. They just have more variables. They're a little less likely to occur. But we must pay attention to what's going on with the network.
00:10:44.102 - 00:11:36.186, Speaker A: We must be aware that there can be sudden changes in the conditions to get transactions included, and that the psychology and these algorithms interact in ways that are often not obvious. And this is probably the most important element that we pay attention to when it comes to predicting gas fees is it's pretty easy to predict the algorithms. It's incredibly hard to predict the psychology and what's coming. So there's some cons here. There's some changes coming with the merge that we believe will change some of the psychology. And this psychology changes will therefore have impacts on the state of the gas marketplace. So here's another interesting thing, that today, even after all this time of EIP 1559 being on main net, still only 75% of transactions are type two.
00:11:36.186 - 00:12:09.638, Speaker A: So fully 25% of transactions on Ethereum are overpaying by about 14% on average. They're getting included slower. The network has to do more work. So we still have work to do to drive adoption of type two and make EIP 1559 completely transparent through the whole network. You guys with me so far? I told you this is going to be a crash course, right? So we went through the beginning of where we started, fpas first price auction, and that turned into PGA priority gas auction. We reboot the model. We moved to EIP 1559.
00:12:09.638 - 00:12:52.930, Speaker A: We now have three variables at play. How those variables get expressed in which you're actually going to get charged become a lot less clear. So the EIP 1559 is more efficient, it's more predictable, but it's harder to understand. Okay, so as we look ahead, what's coming next is the merge. So what's going to change with gas fees during the merge? So estimate mid this year, coming up pretty quick, Ethereum mainet will merge with the beacon chain. And you know what? Almost nothing changes. We still have dynamic block sizing, we still have base fee priority, max fee, but instead of a minor tip, it now becomes a validator tip.
00:12:52.930 - 00:13:36.898, Speaker A: We still have the base fee set by the network, priority fee set by users. It's still burned, and the validators are going to receive the priority fee. Now, I won't go too far into this, but the validator model and the deflationary pressure should increase as a result of the merge. So the good news is, once you learn EIP 1559, you're going to be well prepared for what's coming with the merge. However, there's this change, and this change is very subtle, but we think this change is going to be worth paying attention to, and it takes a little explaining. And this change is known as fixed block times. So today, under the current system, proof of work, you have variable block times.
00:13:36.898 - 00:14:21.438, Speaker A: The network targets about 13 and a half seconds per block on average. But we all know a block can be confirmed in 1 second or 60 seconds, that there's actually no way to know when the next block is going to be confirmed. It's completely unknowable. And so therefore, if you're trying to get into the next block, you don't know when the block is going to happen. So every millisecond is equally valuable as the next millisecond because everyone's trying to get in the next block. Nobody knows when that block is going to get confirmed, and everybody competes equally through a consistent time horizon. That time is basically flat and linear, and transactions flowing into the transaction pool or the mem pool can happen at any time.
00:14:21.438 - 00:15:24.286, Speaker A: But there's this subtle change which is coming with the merge. And under proof of stake, blocks will be confirmed every 12 seconds like clockwork. And so what does that mean? That means not all milliseconds are equal anymore. Because if I'm trying to get something on chain and I want to make sure I get it and someone doesn't beat me to it, when am I going to transmit my transaction? Am I going to transmit my transaction in the first 2nd after the block was confirmed, or am I going to wait to second eleven, maybe second eleven and a half? So when I transmit the transaction, all my competitors out there have a smaller time window to respond. And so what's significant here is this will impact intrablock transaction velocity. Today, in the current proof of work model, we have a constant velocity. All milliseconds are equal.
00:15:24.286 - 00:16:23.186, Speaker A: As we move to proof of stake, as we move to fixed block times, we will have this surge effect where the second or two before the block gets confirmed, more transactions will flood into the pool. There'll be tighter time horizons for various automated systems to compete with each other. There'll be a rush to lower and lower latency infrastructure in order to detect and respond. And we believe that this will have an impact on gas fees. Right? Because the nature of transactions flowing in and out will be different. But the question is, what change? What's going to happen? And the answer is, nobody knows yet, right? There are researchers who are working on this, and what we're going to have to do is look at this theory and compare it to the reality that what we saw with the launch of EIP 1559 was a bunch of new behavior we hadn't seen before, like the interaction and interplay between the priority fee and the base fee. Under periods of rapid congestion.
00:16:23.186 - 00:17:16.242, Speaker A: And I believe, we believe at block native we will see some similar new phenomena post merge that will affect the entire network and the nature of the gas fee marketplace. So this is super fun, this is super interesting, and it is super meaningful. Oh, there's another thing, looking past the merge where we look towards sharding, which will increase block space. And we have a hint of what might happen here by looking at l two and sidechain smart contract transaction volumes. So this chart, real quick, it shows the blue is smart contract transactions and the orange is just simple transfer transactions. On ethereum mainnet, this line is the polygon side chain, simple transactions, just simple transfers. And this is polygon sidechain smart contract transactions.
00:17:16.242 - 00:18:09.318, Speaker A: So where we have polygon side chain, where we have more reduced gas fees, where we have more block space, theoretically what we see is significantly more smart contract transaction volume. So as we look ahead to sharding, which will be 2023 time horizon, we may see massive increases in overall smart contract transaction volume. So there's this thing that happens which is, look, if we just had enough block space, the gas prices would go down. It's sort of like saying if we just had enough highways, there would be no traffic, right? It turns out that as you add highways, you add traffic because more people will travel. And so similarly, as we look to add block space, there's this going to be corresponding increase in demand for that block space, and this will still matter. So are we going to be talking about gas fees next year? Probably. Are we going to be talking about gas fees after that? Probably.
00:18:09.318 - 00:18:28.382, Speaker A: Are we going to be talking about gas fees ten years in the future? Probably. Why? Because block space is valuable. And so in the past, gas fees mattered. In the present, right now, gas fees matter. And in the future, gas fees are going to matter. So we all have to pay attention to that. So this meme isn't going to change.
00:18:28.382 - 00:19:02.646, Speaker A: We're all going to still be talking about this. And what we need is continued research and we invite people in. We at block native publish real time data on the state of the gas marketplace. We encourage you to check that out, incorporate that, find new things, look through historic blocks. There's tons of interesting stuff happening here. We believe we can improve the user experience so users have a better idea of what they can expect for what their transactions are going to cost, where they should put transactions on a side chain or l two to have less, and what the outcomes are going to be. And that fundamentally, with more capable infrastructure, we can improve the transaction experience across the board.
00:19:02.646 - 00:19:14.554, Speaker A: And as we do. So we're here to help. Check out our gas estimator, check out our gas API. We're blocknative.com. And this has been super fun. I'm Matt Cutler. Really appreciate your time and attention, and please have a great rest of East Denver.
00:19:14.554 - 00:19:23.230, Speaker A: Okay, thanks, everybody. That was amazing. Thank you. Thank you, thank you.
