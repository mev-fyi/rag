00:00:10.340 - 00:00:23.400, Speaker A: Very happy to introduce my colleague at Columbia, CMAC Molemi, who's in the business school there. He's going to be talking about automated market making and loss versus rebalancing, including some more recent work involving trading fees.
00:00:23.980 - 00:01:08.324, Speaker B: Thanks Tim. I'm glad to be here today. I'm going to talk today about some joint work with number of co authors, Tim included. So it won't be new for him, but hopefully new for the rest of you before I launch into it, just by way of background because hopefully be meeting with a bunch of you throughout the week to tell you a little bit about me. My background is I'm basically an applied mathematician. My PhD is in electrical engineering and on the methodology side, I'm pretty interested in things like stochastic control, approximate dynamic programming, reinforcement learning and so on. That said, I teach in a business school, so the main kind of applications I think about are related to finance.
00:01:08.324 - 00:02:00.168, Speaker B: So in particular things like quantitative trading, high frequency trading, market microstructure, and these days blockchain. So one way to I think view this talk is this is sort of ideas from microstructure and black shoals applied in a novel context which is automated on market makers. Which kind of brings me to my second point, just to calibrate a little bit. How many people know what a constant function market maker is? Most of you. So most people know how uniswap v two say works. Okay, so there's some of that stuff in there because I wasn't sure, but I'll try to go through it relatively quickly. So what I'm going to talk about today are sort of fundamental questions involving the economics of liquidity provision of being a liquidity provider in an automated market making protocol like uniswap or curve or whatever.
00:02:00.168 - 00:03:25.744, Speaker B: And kind of the high level motivating questions are things like how can we measure performance of liquidity providers? How do we decide whether providing liquidity in one of these pools is a good strategy, either X post analyzing past performance or ex ante thinking about making a future investment. How does that performance depend on things like the dynamics of the asset that's being traded, characteristics of the pool, maybe even characteristics of the blockchain that the pool is operating on top of. And ultimately the real eventual goal is how can we improve these AMM designs in a way that improves the economics from the perspective of liquidity providers, therefore allowing them to provide more liquidity and get more gains from trade and more social welfare and so on and so forth. So what I'm going to talk about is a combination of two papers. I'm not going to get through all the details, obviously, but I just want to point out that if you are interested in the details, they are both available on my website or on archive. Okay? So as a starting point, let's talk about the way people in industry, in practitioners, usually sort of talk about things like AMMS and thinking about investing in an AMM. This is a screenshot from Uniswap.
00:03:25.744 - 00:04:09.616, Speaker B: V. Two ETH USDC pool. And on this screenshot you see a bunch of things. This pool had about $125,000,000 in assets in the past 24 hours, $20 million traded and it generated about $66,000 in fees during that period. So usually the way people sort of talk about it is they do a yield calculation or an APY, an annual percentage yield or something like that. They say, look, if you're making $66,000 a day on a pool that's valued $125,000,000, what is that as a percentage? Well, if you annualize that, that turns out to be 19%. So that looks like a real good juicy number and looks sort of sort of quite attractive.
00:04:09.616 - 00:04:24.824, Speaker B: And our starting point is that maybe this is not the right model or not the right way to think about a liquidity provision in the sense that when you look at fees here, you're kind of ignoring things like adverse selection costs, which are quite important.
00:04:24.942 - 00:04:25.464, Speaker C: Right.
00:04:25.582 - 00:04:57.888, Speaker B: So our kind of view and what we'll establish through this talk is at a high level we can think of the profit or loss of a liquidity provider. What I'm going to call an LP is it's going to have three components. The first component is market risk, right? If you are a LP in this pool, this pool owns a lot of ethereum tokens, right? And the price of ethereum goes up and down every day, sometimes a lot, right? So maybe one large component of whether you're going to make or lose money is simply your long ethereum.
00:04:57.984 - 00:04:58.388, Speaker C: Right?
00:04:58.474 - 00:05:17.028, Speaker B: And so that's what I'm going to call market risk, right? And in some ways that's the dominant source of profit and loss. But in some ways it's not interesting. It's not interesting in the first direction because if that's the thing that we really care about, the price movements of something like ethereum, it can potentially be hedged.
00:05:17.124 - 00:05:17.384, Speaker C: Right?
00:05:17.422 - 00:05:51.968, Speaker B: If you own ethereum by virtue of being an LP in AMM, you could simultaneously enter into a short contract and profit if the ethereum price falls by trading on a centralized exchange. So that's one reason we're sort of not so interested in this. The second reason we're not so interested in this is because that's sort of a different question. Like will ethereum price go up or go down? I don't know. Maybe interesting to some, but I don't have particular views on that. What I am interested in, and what I do have views is how is investing in an AMM different than just owning ethereum?
00:05:52.064 - 00:05:52.420, Speaker C: Right?
00:05:52.490 - 00:07:09.036, Speaker B: And in order to understand that we're going to subtract the market risk part, the part that comes from just owning ethereum and what we're going to end up with is if you do what's called delta hedging in the options pricing language, right? Again, you hedge away this risk. The profit that you're left with is this trading fee income that we saw below. However, you have to charge yourself something called adverse selection, right? Adverse selection is a universal concept throughout market making. And basically the idea is some fraction of the time you're trading against people who have more or better information than you and X Post, you're going to regret those trades, right? So this paper basically can be thought of as a Black Shoal style model to sort of quantify this and in the end understand what are the drivers of whether or not the liquidity provider is a maker or lose money. In particular, we're going to have a Black Shoal style formula for adverse selection costs. It's going to highlight again those components that drive these returns, particularly things like the volatility of the asset, the curvature of the pool, how the trading fees are done and so on. And quantitatively, it's simple enough that we can actually bring it to data.
00:07:09.138 - 00:07:09.452, Speaker C: Sorry.
00:07:09.506 - 00:07:24.800, Speaker D: So the hedging cost of removing the market risks are going to affect the economics of the liquidity providers. So the reason why you're ignoring it is because if you're a liquidity provider in centralized exchange, you have to apply the same costs.
00:07:25.220 - 00:08:21.188, Speaker B: So what hedging costs are you talking about the Delta? Because you're delta hedging on a central and there might be costs to that. So in my model, I'm sort of ignoring that for the purposes of this model. In the real world context, I imagine most of the people who are someone who may want to be a market maker also may be a market maker on a centralized exchange, right? And they can just sort of add this risk to their overall risk book. And if you're already making markets on a centralized exchange, it's quite possible that you could do this hedging in a very low cost way. But I'm going to assume that the hedging is costless for the purposes of this talk. Okay, so what are our contributions? We're going to look at Delta hedged. Lppnl, right? We're going to see that once you Delta Hedge against, once you short enough of the risky asset, that's equivalent to the risk you're hold.
00:08:21.188 - 00:09:45.872, Speaker B: What you're left is the fee income stream and lever. And lever is that adverse selection cost, right? It stands for loss versus rebalancing. It'll become clear a little bit later where that terminology comes from. And the idea is that this is a form of slippage, right? So in the sense that if you have an AMM that's on chain, it's not updating its price unless there are trades. But out there, let's say in centralized markets, on coinbase or on binance or whatever, the prices are updating continuously, right? As the prices update, let's say the price goes up on binance arbitragers or in crypto parlance searchers, they will notice that, right? And they will buy at the stale price on the AMM, sell at the higher price on the centralized exchange, and they will make money right? And of course, this is a zero sum trade between the AMM LPs and the Arbitragers. So any money that the Arbitrageurs make comes from the pockets of the LPs, right? So this is the adverse selection because the pool does not know the current price and there are Arbitragers who do know the current price and are exploiting it. Our contribution is to identify that and give a close form expression, right? In particular, the rate at which the LP will sort of bleed away money to these Arbitrageures is a product of two things.
00:09:45.872 - 00:10:20.892, Speaker B: There shouldn't be a half there. I have a second term. It's something to do with the characteristics of the assets, namely its price variance and then something to do with the pool, namely what we'll see the marginal liquidity in the pool at that price. So we get a nice formula that expresses the adverse selection cost. We can verify that formula empirically. In other words, we will compute the delta hedged P l without a model and we will see it matches the predictions of our model. And we can sort of think of that in terms of guiding a downstream AMM design.
00:10:20.892 - 00:11:12.680, Speaker B: Now, this isn't the end of the story, of course, because the way we derived this adverse selection cost, we imagined arbitragers who are continuously monitoring the pool and are trading against it but are not paying the trading fees, right? Again, recall the pool has trading fees. I'll be more explicit about that. We did that as kind of a simplification. But in reality the Arbitrariers do pay trading fees and that's a friction on their trading. And at the same time this formula was also derived. Assuming that Arbitragers can trade continuously and reality on a blockchain, actually it's literally a discrete time system. In some sense, you can only trade when blocks are generated, right? So these are two frictions on the ability of Arbitragers to trade.
00:11:12.680 - 00:12:12.856, Speaker B: That lever idea does not capture. And so as an extension, what we've done is we've been able to analyze what the arbitrager profits are, assuming that they pay fees. And in addition, in a world where you only trade at times when blocks are generated according to a poisson process, what we find in that setting is in a particular asymptotic regime, I'll become clearer about the Arbitrage profits are simply the quantity lever I defined before. Again, this idealized quantity of trading continuously and not paying fees, but scaled down by the probability that an arbitrager arrives. Or let's say the instant a block is generated, that the pool is mispriced enough that a trade can occur, right? So we sort of thin down the amount of money the Arbitragers make by the fraction of time that they're able to trade. And this depends on simple, easy to understand quantities. Like, for example, gamma.
00:12:12.856 - 00:13:11.248, Speaker B: Here is the fee level. Sigma square root of delta t is a typical price movement over the inner block time and so on. So we have nice expressions there. What we also see is that once there are fees in the Flask block regime, if we imagine delta T here, the time between blocks shrinking to a zero, also the Arbitrage profits shrink. You can kind of see it in that expression there. But what that immediately suggests is from the perspective of minimizing how much is paid to Arbitrars from minimizing this type of mev faster blockchains will work better according to the square root rule. And finally we end up with this really interesting result where we have a lever again, how much money is paid out in an idealized setting and it turns out that is roughly equivalent to how much the ARBs pay net of fees, plus that the fees that they pay.
00:13:11.248 - 00:13:27.548, Speaker B: So in other words, we can think of introducing fees as this quantity lever is going to be conserved. If there are no fees, it goes all to the ARBs. If we start introducing fees, what happens is we start shifting some of that away from the Arbitrage profits and more towards the LPs.
00:13:27.744 - 00:13:38.676, Speaker E: What's the intuition that why does lever go away when I guess why do profits go down as the block regime gets fashioned?
00:13:38.708 - 00:14:06.432, Speaker B: I'll get to that. That's a very good question, though. Okay, so that's the high level picture. Just to show you that this is sort of practical and immediately yields sort of insight and so on and is indeed very simple. This is the same slide I showed before. Again, the fees would suggest that you're going to make 19% annually. Our model, if you apply it to a constant product market, says that well, no, there's this adverse selection cost.
00:14:06.432 - 00:14:29.028, Speaker B: Also it takes the value sigma squared over eight, where sigma is the volatility. Why sigma squared over eight? Well, we'll see during this talk. But if you plug in the numbers, it says, well, over this period, if this was the volatility, you should have lost around $40,000 in terms of adverse selection costs. So in reality, maybe you made quite a bit less than was advertised at the beginning.
00:14:29.124 - 00:14:29.480, Speaker C: Right?
00:14:29.550 - 00:14:51.200, Speaker B: So again, we'll see a much more systematic empirical analysis. But this is kind of the idea. Okay, so I'm going to start with the model. I'm going to assume that there are two assets and we can do more than two. This is without a loss of generality. So my running example will be a pool where there's a risky asset. I denote in general with x.
00:14:51.200 - 00:15:29.400, Speaker B: And so we can imagine that that's ethereum and there's a cash or numera asset which we can assume is some US dollar coin. I'll call that y. So we're going to be dealing with a pool that trades a risky asset against cash. I'm going to assume that interest rates are zero just so I don't have to write the R everywhere and that's without loss of generality. And I'm going to assume that there's a process p of T. This is the market price of that risky asset in terms of the numerair. And this is what I imagine the price to be on an infinitely deep centralized exchange, let's say binance.
00:15:29.400 - 00:16:08.520, Speaker B: And that's going to be the place where in my model price discovery occurs. And so I'm going to need a model for this market price. And so I'm just going to use the basic Black Scholes model. In other words, I'm going to assume that the returns are approximately normal. And the way you would write that as a stochastic differential equation is you'd say that the instantaneous return has two things. It has a drift term, right? And then it has sort of a brownian term, a volatility times a brownian increment. And this is sort of the standard Black Scholes type of modeling assumption.
00:16:08.520 - 00:16:56.810, Speaker B: So now I'm going to describe how the constant function market makers work. It sounded like most people are pretty familiar, so I'm going to go through this relatively quickly. The idea of a constant function market maker is that you start out with a bonding function, f, which specifies an invariant in quantities of reserves of the two assets, the risky asset x and the cash asset y. So that is that invariant curve F of x y equals L. And so for example, the most common example is to have F be the product function that is a constant product market maker. And the way these works is initially the pool starts at some point. Here the LPs endow the pool with reserves, let's say x zero y zero and is at that point.
00:16:56.810 - 00:18:00.060, Speaker B: And after the pool is endowed with these assets, the pool will allow users to come in and trade. And any trade is permitted so long as you stay on the invariant curve. So for example, over here, if we start at the purple dot and move over to the user, moves us over to the green dot. Over here, what they are doing is they are withdrawing the cash asset and contributing the risky asset, right? So this is somebody selling ETH to the pool and getting this quantity of USD in return to it. So the average price they pay is going to be simply the ratio of those two or the slope of that line in the triangle. That's how the mechanism works. And so one thing to kind of notice is if we shrink the amount that's traded and make these points close to each other, if I'm at a particular point and I look at the instantaneous slope, this is kind of the spot price.
00:18:00.060 - 00:18:51.484, Speaker B: This is the slope. There is the quantity to trade an infinitesimal quantity of that asset, right? It's simply shrinking that triangle to be a tangent line. And in addition to trading the risky asset for cash or vice versa, there is a proportional fee also collected on the traded quantity. So for example, uniswap v two, you collect 30 basis points on the contributed asset. So there's oftentimes a fee. So that's kind of the basic structure in terms of doing analysis. Sort of a very important object in order to understand this structure is something we call the pool value function.
00:18:51.484 - 00:19:25.348, Speaker B: So the idea of the pool value function v of P, it's going to take as an input a price. And this is, let's say, the price of the asset on the centralized market. And what it will tell you is the value of the CfMM reserve holdings. When the price is P. How does it do that? Out of all the sets of x and Y that are feasible that satisfy this invariant, it finds the combination with minimal value. Why minimal value? Again, we're looking at this from the perspective of the pool owner. They're trading against traders.
00:19:25.348 - 00:20:10.680, Speaker B: Traders will try to trade against this pool to maximize their gains from trade. And because that immediate trade is zero sum, what will happen is they will move the pool in a configuration where its value is minimized, right? So because you're in an adversarial environment and as the price changes, traders will trade against you to try and make the most money possible. When they're making money, it's minimizing the value of the assets in the pool. So this minimization problem becomes important, right? And so the idea here is, if I know the external value of the asset is P, and I know that there's a trader who's willing to trade against the pool and can also trade at that external value of the P, they will push the pool into a configuration where that's an optimal solution to this optimization program.
00:20:10.830 - 00:20:11.336, Speaker C: Right?
00:20:11.438 - 00:20:52.500, Speaker B: So we're also going to make an assumption that the optimal solution always exists and that things are smooth and so on. This is typically always satisfied. So again, just to give sort of a little bit of a running example, these are just very simple algebraic calculations. If you had a uniswap v two, a constant product pool, if you plugged in XY equals L into that constraint and you did your sort of undergrad kind of calculus, you would get that what are the reserves in the risky asset and in the cash asset given the price?
00:20:52.570 - 00:20:52.804, Speaker C: Right?
00:20:52.842 - 00:21:35.088, Speaker B: This would be the XY that minimized that and we would also get the value of the pool, right? So again, here, these relatively simple algebra, I just want to illustrate that these aren't particularly complex calculations. I do want to make two other points. Also, if you look at this x star, again, this is the holdings of the risky asset as a function of its price. What you'll observe is that this decreases at a rate of one over the square root of price, right? So in other words, as the price of the asset goes up, what will happen is that Arbitragers will buy the asset from the pool and the pool will hold less of the asset and it will occur at that rate.
00:21:35.254 - 00:21:35.824, Speaker C: Right.
00:21:35.942 - 00:21:48.576, Speaker B: This is going to be a very important object. And because of that description, we call it the demand curve for the risky asset. Now this is the demand of the LPs for the risky asset because at every price level they're going to hold this much.
00:21:48.698 - 00:21:48.984, Speaker C: Right.
00:21:49.022 - 00:22:17.344, Speaker B: So we're going to come back to it because that's quite important. Second point I want to make is that constant product market makers, they have this very interesting property that if you look at how much is held in the risky asset versus how much is held in cash because the risky asset is valued by price P. If I want to value this in dollars, I multiply this by P, and it turns out it's holding the exact same value in dollars in the risky asset in cash. That's actually a really special property.
00:22:17.462 - 00:22:17.744, Speaker C: Right.
00:22:17.782 - 00:22:33.796, Speaker B: And that's actually, I think, what makes this very nice. It's not that the constant product is easy is a good formula. It's that this behavior of holding, of balancing to hold the same dollar amount in two assets, that is a very nice behavior. Yes.
00:22:33.898 - 00:22:53.176, Speaker D: So in the model, are you assuming that liquidity providers are not reacting by removing liquidity? Because it seems like that if they anticipate significant adverse selection, they might maybe choose to remove liquidity and that may affect also the trading costs and the quantities.
00:22:53.368 - 00:23:16.000, Speaker B: So I'm going to assume you're looking at a horizon where you've committed to provide liquidity for that horizon and you're not going to revisit it till the end of the horizon. So I'm going to assume that there's no minting and burning of LP shares when I show you the empirical results. Obviously in the real world there is minting and burning and we'll account for that. But for purposes of the model, I'm going to assume the liquidity provision is static.
00:23:16.900 - 00:23:22.836, Speaker A: You're also going to calculate the instantaneous lever. Right. So it'll just be with respect to whatever capital L is at that time, right?
00:23:22.938 - 00:23:23.684, Speaker B: That's right.
00:23:23.802 - 00:23:27.376, Speaker A: So in some sense you could imagine they're coming and going and you're just focused.
00:23:27.408 - 00:23:33.590, Speaker B: You just have to have the snapshot of time exactly. At the end. It's going to be an instantaneous result.
00:23:34.040 - 00:23:45.180, Speaker A: The other thing I'll say is I really wish we could turn back the clock to 2018 and get everybody to think about uniswap in terms of this equal value split property as opposed to x y equals K. Yeah, much more natural.
00:23:47.040 - 00:24:06.016, Speaker B: Okay, so that's all the preliminaries. Let me talk about lever. So imagine we have a stylized market with two types of traders. We have these arbitrageures. These are agents which are sophisticated. They're able to trade either in the CfMM pool or on a centralized exchange. They're continuously monitoring the market.
00:24:06.016 - 00:24:36.616, Speaker B: They have infinite arbitrage capital available. And so what they will do is they will ARB those CfMM prices until they're equal to prices on the centralized exchange. And in particular, they do this because we're going to assume that they're not paying fees, right? We're going to come back to that. But for now, they're not paying fees. So they'll force the prices to be equal because that's profit maximizing for them. On the other hand, there's going to be noise traders. These are traders that only trade on the CFFM.
00:24:36.616 - 00:25:25.148, Speaker B: They trade for Idiosyncratic reasons in particular, they have no information about prices anywhere or future prices or anything. They do pay fees and we're going to collect that cumulative stream of fees in this variable called fee. And if you think about it, if you're an LP, there's only two sources of money. There's the reserves in the pool and there's the stream of fees. So your profit and loss after time P is the change in value of the pool plus the fees that you've earned cumulatively over that time. And by the argument that I just made, the value of the pool has got to be given by that pool value function evaluated at the current price, right? Why? If it was anything different than that, some arbitrager would jump in and trade until those two reports to be the same.
00:25:25.314 - 00:25:25.644, Speaker C: Right?
00:25:25.682 - 00:26:03.608, Speaker B: Because this is the only point at which Arbitragers cannot make any money if the current price is PT. Okay, so we'd like to try to analyze this. We're going to focus on the change in value of the pool. We're going to ignore the fees that are collected for a second. And in order to understand how the pool changed in value, we're going to define something called a rebalancing strategy that motivates the name loss versus rebalancing. And the idea of the rebalancing strategy is it's going to hold the same positions in the risky asset. In other words, it's going to do the same trades in terms of the quantity of risky asset as the other pool does.
00:26:03.608 - 00:26:11.256, Speaker B: However, instead of trading against Arbitragers that are arriving, it's going to directly trade against at the centralized price.
00:26:11.358 - 00:26:11.672, Speaker C: Right?
00:26:11.726 - 00:27:02.536, Speaker B: So to just be a little bit more formal about that, initially this is going to be a self financing trading strategy. Initially it holds the exact same amount of ETH and USD as the pool. And what happens is as time evolves at every point in time, it matches the position of the risky asset in the pool and it does so in a way that's self financing, right? So you're not injecting money or taking out money of this trading strategy, right? So if you sort of think about it, if you're not putting in or taking out money, the only way you can make or lose money is because of fluctuations of the risky asset. So the value of the pool at the end is going to be its initial value plus like each interval of time. How much of the risky asset do you have and then what does the price do over the next delta T. And if you sort of take the continuous time limit, you can write that as an edo integral.
00:27:02.648 - 00:27:02.924, Speaker C: Right.
00:27:02.962 - 00:27:27.250, Speaker B: So the value of this rebalancing portfolio is simply the initial value of the pool plus the quantity of risky asset that the pool holds integrated against the price changes that occur. Okay, so loss versus rebalancing, as the name suggests, is how much is the pool worth? Less than the rebalancing value. Oh, sorry.
00:27:27.860 - 00:27:33.140, Speaker E: I guess it doesn't really matter what's the assumption on the movement of the price is. It just like a martingale.
00:27:33.560 - 00:27:36.256, Speaker B: So I assumed it's a geometric brownie in motion.
00:27:36.288 - 00:27:37.350, Speaker E: Okay, cool. Sorry.
00:27:39.980 - 00:28:18.880, Speaker B: So not a Martingale but a nice process. And so this is the main result. The main result is that, first of all, this thing is always positive. It's positive and it's increasing. So you're always losing more and more money to these arbitrageures, right? And moreover, we have a closed form expression for it. So if I look at how fast it's increasing, the derivative of this process, it increases as a product of a formula I showed you earlier, which is one sort of the quadratic variation or the price variance. This has to do with the asset, right? The dynamics of the asset.
00:28:18.880 - 00:28:55.824, Speaker B: And then the second thing has to do only with the pool, and that is the marginal liquidity at the price. So why do I call this marginal liquidity? Recall that X star was the demand curve. It's how much the pool is going to hold in the risky asset at a given price, P, right? So the derivative with respect to P, that's how much the holdings are going to change if I make an infinitesimal price move around P. So I'm going to interpret this derivative as kind of the instantaneous or marginal liquidity at that price, right? It's how much is going to get traded in order to sort of move through that price.
00:28:56.022 - 00:28:56.384, Speaker C: Right.
00:28:56.422 - 00:29:19.728, Speaker B: So it's a product of these two. I'm going to quickly walk you through where this comes from because it's actually quite intuitive. One other thing I'll point out, probably many of you have heard of impermanent loss. That is not this. It is different. It is related to impermanent loss. I would rather not talk about impermanent loss, but I'm happy to sort of take it offline.
00:29:19.728 - 00:30:02.580, Speaker B: But maybe one way to sort of think about this is this is impermanent loss done rigorously, but happy to come back to that if someone wants to talk about that. Okay, so let me give you some intuition for where this loss comes from. So suppose we start out at the pool. And so here I have the Y asset and the X asset, and the blue is the invariant curve. And I'm starting out when prices are P, which is tangent at point A, right? So when prices are P, the pool is in a state at point A. Suppose the external prices drop from P. To P minus DP So P minus DP is this line over here, and that is passing through point B.
00:30:02.580 - 00:30:44.450, Speaker B: So the ARBs are going to show up here. They're going to see it's at point A, but the right price is over there, and they're going to trade against it until it moves to point B. So how much will they trade? They will trade a quantity DX, and the starting price in the pool is P. The ending price is P minus DP. As they trade through that whole range, the average price that they're going to get is actually half the price change. It's the average of exactly the average of the two endpoints. And so what's the profit and loss of the Arbitrageur, they sold at this price on the AMM, they bought at this price on the external market.
00:30:44.450 - 00:31:19.420, Speaker B: So what they made is they made half the price change on the amount that they traded. But we know that if they want to move the price a small amount, the derivative of X with respect to P tells us how much asset they're going to trade. So I can write this DX. I can write it as DX DP times DP. I get a DP squared, right? So now this is my expression. And so now I have the marginal liquidity here times the square of the price change. And for those of you who know Stochastic calculus, this is simply the quadratic variation.
00:31:19.420 - 00:32:03.180, Speaker B: The square of an infinitesimal price change is simply that is where the formula comes from. So you can see again, over a small instant in time, the price moved by DP, the ARB traded against it profited by this much. If we want to see how much we lose to ARBs overall, we simply integrate this over time. And that's the formula I gave you before. So it's very mechanically showing how loss is being incurred. Okay, so going back to I'm thinking about the P L of the LP. What I had written before was the P L of the LP is accumulated fees plus the change in reserve pool value.
00:32:03.180 - 00:32:47.000, Speaker B: The theorem I just had says this is the P L of the rebalancing strategy minus lever. So that's just plugging in theorem. Now, if I sort of look at this and I look at this term, this term is something integrated against prices. This is price risk. So what I can do is I can delta hedge. I can take it at every instant, S, take exactly this quantity and take a negative position on the centralized exchange in that size. And by doing that, I will fully hedge this and I will come up with a delta hedged PNL again, exactly as in the black Scholes model, where my income is coming from the fees and my costs are coming from the lever.
00:32:47.000 - 00:33:09.344, Speaker B: So this is exactly what I advertised to you at the beginning. This is the LP p l decomposition. This is the market risk. This is a trading fee income. This is adverse selection cost. I just want to show you some numbers that this works if I do this for uniswap v two. Again, the formulas I had before I had the demand curve was x star of p is L over root p.
00:33:09.344 - 00:34:09.920, Speaker B: If I want to compute the rate at which these losses are being generated, this is the formula I had before. And what's nice about geometric mean bonding functions, for example, constant product is that the amount you're losing to lever is proportional to the value of the pool. And in particular, you lose money at a rate sigma squared over eight times the value of the pool. So this is where the sigma squared over eight at the beginning of the talk comes from. So again, sigma is a volatility. So if I plug in like a volatility of 5%, this suggests that uniswap v two pool should be losing about three basis points a day on its value due to this adverse selection cost. So for example, if the trading fees are 30 basis points, which is ten times that, it suggests that you need to turn over around 10% of the pool in terms of actual trades in order to make enough money to balance this adverse selection.
00:34:10.260 - 00:34:10.732, Speaker C: Yeah.
00:34:10.806 - 00:34:16.580, Speaker E: This section you're kind of including the arbitraries in people who pay fees, right? Because some of the volume on the.
00:34:16.730 - 00:34:18.016, Speaker B: I am including the arbitrary.
00:34:18.048 - 00:34:18.244, Speaker C: Yeah.
00:34:18.282 - 00:35:07.204, Speaker B: So some of that is going to be from people who in fact maybe a lot of it. Let me show you a slightly more systematic analysis and then we'll talk about the impact of fees. So here's the empirical test. We had this equality exactly on the slide before. On the left side is the delta hedged P l, which is the actual P l minus the P l of taking the same positions on the centralized exchange. On the right side we have a fees minus lever. And if I look at the left side, I can compute this without any model, right? For the Lppnl, I can go to the ethereum blockchain, I can pull the events for that pool and I can directly measure how much the pool value is increasing or decreasing properly, accounting for mints and burns and stuff.
00:35:07.204 - 00:35:48.944, Speaker B: So that's just accounting to compute the LP p l, the delta hedging P-L-I can't delta hedge in continuous time, but I can imagine discreetly delta hedging like maybe once every minute, once every 5 minutes, once every know whatever. And again, I can do that without any kind of model. So the left side is model free. On the right side I have my fee income that's also model free. I simply look on chain and see what was paid in terms of fees. And the only place I have a model is that last lever expression. And there, because this is a constant product pool, I'm simply going to look at what was the volatility on that day, and I'm going to say it'sigma squared over eight times.
00:35:48.944 - 00:35:51.888, Speaker B: The value of the pool is how much I'm going to lose to lever.
00:35:51.984 - 00:35:52.292, Speaker C: Right?
00:35:52.346 - 00:36:32.940, Speaker B: So if the left side of this is close to the right side of this, it says that lever is accurate, at least in the sense of measuring Lppnl. So when you actually do this, the kind of questions we want to understand if the formula is accurate, we also want to understand if lpng is actually attractive. So here's an analysis on one year of data from August 2021 to August 2022. We're looking at the uniswap V two wrapped ETH USDC pool. And also we need centralized exchange prices, so we're going to get those from finance. There's a lot going on here, but let me walk you through it. This is the pool I showed you a screenshot of earlier.
00:36:32.940 - 00:36:59.732, Speaker B: This pool has, let's say, a couple of hundred million dollars of assets at any given time. If you look at the blue curve, that's the total cumulative PNL of the pool, right? So over this interval, at some point it was up $80 million. At some point it was down $40 million. It ends up maybe down $10 million. That blue curve, first of all, it loses money, but it's entirely unclear what's going on if you just look at the raw PNL. And that's because this pool owns an incredibly risky asset. It owns ETH.
00:36:59.732 - 00:37:33.556, Speaker B: And ETH can move up or down 20% in a single day, right? So just looking at the blue curve is not really giving us a sense of what's going on. When I start to look at these other curves, what I'm doing here is I'm delta hedging. I'm removing that market risk to try and get a clear sense of, is this pool making or losing money? I'm doing it at different frequencies. I start out delta hedging once a day. I could do it more frequently, once every 4 hours, once every hour, 5 minutes, 1 minute. And all of those curves are down there. You can see that actually this pool is kind of steadily making money.
00:37:33.556 - 00:38:20.304, Speaker B: And if you can hedge frequently, even at potentially a very high sharp ratio, right. So again, what's going on is the market risk here obscures kind of everything. Once you start delta hedging and you take away the market risk, you can see what's going on. And at the end of fees, minus lever, it's just in the middle there. So it's actually pretty reasonable in terms of the kinds of actual returns you get if you try to estimate your hedged PNL in a model free way. Going back to the point of is this pool attractive or not? This pool appears attractive if you can hedge, and that's a big if there's maybe hedging costs and so on that I haven't factored in. It looks like there is a high single digit return available in this pool.
00:38:20.304 - 00:38:46.460, Speaker B: This kind of result is not universal. We haven't looked at all kinds of pools, but for example, looking at the five basis point uniswap V Three pool, that pool seems to systematically lose money while this one is systematically making money. So I think there's interesting cross sectional questions to ask in terms of what pools are doing well and what pools aren't. But in all the cases we've looked at, fees minus lever is a reasonable approximation of the overall pina.
00:38:49.120 - 00:38:52.350, Speaker A: What's your current hypothesis about the V two V three difference?
00:38:52.960 - 00:39:44.344, Speaker B: I think too many people provide liquidity in V three because it's more capital efficient. So I think there's excess liquidity provision and I think that's why that pool loses money. I think the fact that V Three loses money, I feel like that's sort of broadly known on Twitter. I think the fact that V Two makes money is maybe not broadly known, but also at the same time, this is a very capital inefficient strategy. So maybe that dissuades a lot of people from doing something like this. Okay, so my assumption so far has been that when the arbitragers come and they pick off the stale prices in this pool, that they're not paying fees. We did that for tractability, but in reality, of course they do pay fees, and fees can be potentially a significant friction, right? And so it's important to understand how that is going to impact the amount of mev that they can pull from the pool.
00:39:44.344 - 00:40:19.064, Speaker B: So let's add fees. Let's imagine we have a proportional fee given by Gamma. Like, let's say Gamma is 30 basis points. Now, I'm going to have two prices. I have PT, the same external market price I have before, but I have to separately track Ptilde, T, the implied price of the pool. And that's because these two are no longer always equal, right? Because there's now a friction, it costs money for the arbitrager to trade on this pool. It won't necessarily equate all these two prices, right? And so we're going to sort of keep track of that by keeping track of the mispricing between the pool and the external market through this variable Z.
00:40:19.102 - 00:40:23.384, Speaker D: Of T. Question sorry, I missed previously then the source of the fees was.
00:40:23.502 - 00:40:39.856, Speaker B: Driven by noise traders here, like what I did before. I wasn't specific about that. So fees are collected. It's going to turn out a lot of it is coming from arbitragers. We'll see that in the second part of the talk. But here I just see the fees on chain. I don't know where it came from.
00:40:39.878 - 00:40:46.370, Speaker D: Okay, so you didn't take a stand on what's, the fraction of noise traders versus arbitrariars at this, right?
00:40:47.380 - 00:41:40.836, Speaker B: Okay. So if you sort of think about it, if ZT is the mispricing and I have a fee given by Gamma, I'm only going to trade if the mispricing exceeds the fee, right? So if, for example, the mispricing is above gamma. What that would mean is that the pool of asset is undervalued by more than gamma. I would trade against that until it reaches exactly gamma. At that point it's no longer profitable for me to trade because even though I can make a spread of gamma trading it, I'm also paying a fee of gamma, right? Similarly, if the mispricing is below negative gamma, an arbitrager can come in and push it to negative gamma. But they're not going to push it beyond that because at that point they're not making any money. Or if you show up and the fee is in the middle of this interval, you're not going to trade because the mispricing is too small for the fees that you have to pay.
00:41:40.836 - 00:43:08.076, Speaker B: So if you sort of think about this, if you have these arbitragers continuously monitoring and they sort of push this thing back when it hits the boundary, what you're going to end up with is you're going to end up with this processes of reflected Brownian motion, right? And that's actually a problem because if you know a little bit about reflected Brownian motion if I have reflected Brownian motion on an interval, it spends fraction zero of its time on the boundaries of the interval and the boundaries of the interval are the only times that the arbitrager can make money, right? So in a way I'll show formally a little bit later. In fact, if I write this model above here, the ARB profits are zero, right? So now of course we know that there are real arbitragers in the world. They're called searchers and presumably they make money because they haven't gone out of business. So my assumption would be if they exist in the real market and they don't exist in my model, probably something's wrong with my model, right? And so the thing that's wrong with the model here is the assumption of continuous trading, right? You can't continuously trade. You can only really trade at instances of block generation and that's going to be quite important for reasons we're going to see in a second. So in order to add fees, we also simultaneously have to add the fact that we can only trade discreetly at instances that blocks are generated. So I'm going to make an assumption, I'm going to assume that the blocks are generated according to a poisson process, right? And that poisson process is going to have rate lambda so delta t, which is lambda inverse.
00:43:08.076 - 00:43:35.416, Speaker B: That's going to be, we're going to calibrate that to be the mean inner block time, mean time between blocks. So for proof of work, this is perfect. I mean proof of work is fairly poisson, certainly at this kind of timescales. For proof of stake, it seems like 99% of proof, or at least everyone I've seen has deterministic inter block times. So this is not the right model for proof of stake. Nevertheless, it's a model we can make progress with. So that's what we're going to do.
00:43:35.416 - 00:44:05.580, Speaker B: So we're going to assume that blocks are generated according to a poisson process. We're going to assume that ARBs can only trade at block generation times. I mean, that is the reality. That's the only time you can change the state on a blockchain. We're also going to assume that there's perfect competition between ARBs, right? That there's a lot of them, they have a lot of capital, so on and so forth. There's no barriers to entry. So in that setting, when an ARB arrives, if the mispricing is greater than gamma, ZT minus is the mispricing the instant before they arrive.
00:44:05.580 - 00:44:13.988, Speaker B: If it's bigger than plus gamma, again, they'll trade down to gamma. If it's less than minus gamma, they'll trade up to minus gamma in the middle. They won't do anything.
00:44:14.154 - 00:44:14.628, Speaker C: Right?
00:44:14.714 - 00:45:02.260, Speaker B: This is how the ARBs behave. And I think it's important to note that the ARBs are behaving myopically. They behave like this because when you get to that point, there's zero marginal profit. And this is coming from the perfect competition. If there was only one ARB, if it was a monopolist, this may not be optimal. You may want to wait for larger price changes before you trade because of the presence of the fee, but because there's many ARBs, if I see that the opportunity exists gamma and an ARB doesn't trade, some other ARB will take it, right? So the fact that there's perfect competition forces these ARBs to sort of trade myopically according to this rule. And so if an ARB arrives at an instant, the mispricing jumps according to this rule.
00:45:02.260 - 00:45:22.432, Speaker B: Other instances of time. Well, I define Z of T to be the log price difference. And I can apply edo's formula and I can see that it would drift diffusively, right. Because p of t is a diffusion. It's log normal. It's diffusing around Ptilde. T is constant as long as there's nobody arriving to trade at the pool.
00:45:22.432 - 00:45:45.312, Speaker B: So the log price is also going to diffuse around. So this ZT is a jump diffusion process. These are the jumps. That's the diffusion. I'm going to make an assumption this is not important, but makes the formulas a lot easier. I'm going to make the assumption that the drift is equal to half the variance and that will make this random walk driftless. It'll make this a symmetric random walk.
00:45:45.366 - 00:45:45.680, Speaker C: Right.
00:45:45.750 - 00:46:18.108, Speaker B: Again, this is not critical. We have the more complex formulas in the paper, but it reduces the algebraic complexity a lot. Okay, so just to kind of illustrate what this looks like, we can imagine here ZT is the mispricing. This band, gamma minus gamma around zero defines the no trade region. On the horizontal axis is time. And each of these red dots, which hopefully you can see, corresponds to the arrival of an arbitrageur. Sorry, the instant a block is generated excuse me.
00:46:18.108 - 00:46:38.444, Speaker B: And so you can see what's going on here initially, the price kind of diffuses. Here we have an arbitrager arriving, but kind of nothing happens there because there's no trade to be done. On the other hand, here we have an arbitrager arriving or block being generated and the price instantly jumps up there because here, when the block was generated, the mispricing exceeded the fee to trade.
00:46:38.572 - 00:46:38.828, Speaker C: Right.
00:46:38.854 - 00:46:45.700, Speaker B: So you have this process that's going to generally diffuse when ARBs arrive. If it's outside this band, it's going to jump to the nearest point of the band.
00:46:46.120 - 00:46:46.676, Speaker C: Yes.
00:46:46.778 - 00:46:49.508, Speaker E: You said the red dots are when blocks are generated.
00:46:49.604 - 00:46:50.008, Speaker B: Yes.
00:46:50.094 - 00:46:55.130, Speaker E: And arbitragers are always searching. Or are they?
00:46:56.300 - 00:47:01.060, Speaker B: My mental model is imagine the arbitrager is vertically integrated with a builder.
00:47:01.140 - 00:47:01.336, Speaker C: Right.
00:47:01.358 - 00:47:38.398, Speaker B: So my mental model is whoever's going to build the next block, he has in his mind that he's going to do an arbitrage trade the instant before he proposes that block, he puts in the right Arbitrage trade. So he's kind of continuously monitoring it, always adjusting his Arbitrage trade for what would be the right trade if that block was generated right now. Okay. So the nice thing about this is we can actually solve for everything in closed form. So in particular, this mispricing process, z of T, it's not going to blow up, it's not going to go off to infinity. It's ergotic, it's going to have a stationary distribution. And the stationary distribution is going to look like this.
00:47:38.398 - 00:47:51.134, Speaker B: There's going to be this region in the no trade region, it's going to have a uniform distribution. And outside the no trade region, this is where ARBs can profitably trade. It's going to fall off exponentially.
00:47:51.262 - 00:47:51.650, Speaker C: Right.
00:47:51.720 - 00:48:14.890, Speaker B: And if you think about this, this sort of makes sense for those who are familiar with normal reflected Brownian motion. That's the way reflected Brownian motion works. Also, it has a uniform distribution in the interval that's being reflected. So that uniform part based on that intuition makes some sense. The fact that these are falling off exponentially. They're falling off exponentially with rate sigma square root of delta T. Right.
00:48:14.890 - 00:48:16.780, Speaker B: And that also makes sense because.
00:48:18.510 - 00:48:18.874, Speaker C: After.
00:48:18.912 - 00:48:32.958, Speaker B: A block is generated, I'm always within this interval. And if I somehow manage to end up outside this interval, probably I was close to the edge and the amount I can move is kind of sigma square root of delta T roughly over delta T period.
00:48:33.054 - 00:48:33.458, Speaker C: Right.
00:48:33.544 - 00:48:53.190, Speaker B: So this is the distribution and critically, the probability that you end up in one of these regions that a block is generated. And in that instance, there is a trade for the arbitrager is given by a very simple formula, which again, just depends on the fee, the volatility and the time between blocks.
00:48:54.010 - 00:48:54.760, Speaker C: Right.
00:48:55.130 - 00:49:04.870, Speaker B: So I can sort of illustrate that the way to interpret this formula would be this would be the fraction of blocks that contain an Arbitrage trade at the top of the block.
00:49:05.030 - 00:49:05.546, Speaker C: Right.
00:49:05.648 - 00:49:50.442, Speaker B: And plugging in fixing the daily volatility at 5%, which is a reasonable number for something like ethereum. I can try sort of various fees and various inner block times. And you can see, for example, if I have a 30 basis point fee and like I'm on ethereum blockchain with 12 seconds in between blocks, I get about 12% of blocks, have an arbitrage trade versus if I jump down to 5%, you get 45%, something like that. But of course that's only the first part of it. We'd also like to know not only how often are they trading, but how much money are we losing to them. And so I'm going to go through that now. So I'm going to define ARB of T to be the cumulative arbitrage profits over zero T.
00:49:50.442 - 00:50:14.062, Speaker B: So this is a jump process, right? Every time an arbitrager arrives, this moves up positively some amount. Maybe it moves up zero if the arbitrager can't make a trade. But it's never moving down. It's only staying the same or moving up. And it's also only moving at instances where ARBs arrive. This is a jump process. And if I want to think about how fast this is growing, the usual technique we use to think about jump processes is we think about their intensity.
00:50:14.062 - 00:50:55.934, Speaker B: We think about how fast is it going to grow over a short period if I take out all the randomness. So here I'm looking at the expected arbitrage profits over an interval from zero to T relative to that size of the interval and I'm going to shrink it to zero. This is going to be the intensity of arbitrage profits. And our theorem is that as Delta T goes to zero, so as blocks are occurring more and more frequently, which is the correct regime? The arbitrats are given by this formula. Plus stuff that's smaller than order square root. Of Delta T. And I'm not going to ask you to sort of think about the algebra real time, but just take my word for it.
00:50:55.934 - 00:51:53.742, Speaker B: This is about lever plus something small. If you recall the lever formula, if this was just Y star prime, that would be like the demand curve in the riskless asset and I multiply by a P and I'd get the lever formula. But for now, just trust me that this is a lever formula plus an order gamma correction. For gamma small, this is basically a lever. So what I'm left with is a lever times the probability of trade and then a lower order things, right? So again, up to my approximation, this sort of suggests that once fees are in place, what's going to happen is that lever still exists. It's simply just going to get scaled down by the fraction of time an arbitrager can show up and actually collect the fee. Moreover, we see as delta T gets small if the fee rate is greater than zero.
00:51:53.742 - 00:52:10.502, Speaker B: If this gamma is nonzero, this is going to be an expression that's order square root of delta T. Right. So in other words, how much money we lose to arbitrageures is order square root of delta T, we'll lose less. The fact or the blockchain? Now, what is the intuition for this?
00:52:10.556 - 00:52:10.774, Speaker C: Right?
00:52:10.812 - 00:52:53.686, Speaker B: That was a question from earlier. The intuition is you should think about the arrival of blocks and what intensity that occurs with that's. Something about the intensity of competition between arbitragers, right? If arbitragers are arriving more and more frequently, they're competing over smaller and smaller price discrepancies and they're making less and less money. And we saw in the continuous time limit, I argued intuitively, if they're continuously monitoring and their fees, they will make nothing. That's the limit where they sort of fully compete away everything, right? But again, even absent the continuous time limit, their profits are ordered delta t. There is a discontinuity here, right? So if I plug in, gamma equals zero. If I have literally zero fees, then the block time doesn't matter.
00:52:53.686 - 00:52:57.426, Speaker B: You lose roughly the same amount to the arbitragers.
00:52:57.458 - 00:52:57.750, Speaker C: Right.
00:52:57.820 - 00:53:02.790, Speaker B: But this is kind of the relevant regime here because the fees are positive.
00:53:05.130 - 00:53:13.446, Speaker A: You're sort of going back and forth between two interpretations of the arrivals, right? One in terms of just block generation and one in terms of just ARB arrivals.
00:53:13.558 - 00:53:13.786, Speaker C: Yeah.
00:53:13.808 - 00:53:34.226, Speaker B: I view those as synonymous. Yeah, I should make that clear because the ARBs can only trade at instances where blocks are generated and I assume they're monitoring that process continuously. Right. They're part of the consensus process. Right, or at least monitoring it. So I'm assuming that ARBs arrive when blocks are generated and vice versa because.
00:53:34.248 - 00:53:46.406, Speaker A: There'S kind of two axes of competition, right? One is just when there is a window of opportunity, then you're sort of assuming that there's multiple people competing for it, like the myapic assumption comes from it.
00:53:46.428 - 00:53:46.614, Speaker E: Right.
00:53:46.652 - 00:53:54.174, Speaker A: And then the second competition, which you just mentioned only on this slide, is kind of the distance between how frequently that window.
00:53:54.242 - 00:53:54.474, Speaker C: Right?
00:53:54.512 - 00:53:58.010, Speaker B: So if they're more frequent, they're competing over smaller opportunities.
00:53:59.070 - 00:54:02.410, Speaker D: And how are these changes going to affect the revenue from fees?
00:54:03.230 - 00:54:35.746, Speaker B: Okay, so that's the next part. I can do the same analysis. This is a little bit different than the fees I had before. The fees I had before were all fees here. Now I'm going to focus on the fees paid just by arbitrage yours, right? And again, that's going to be a jump process. So I'm going to do the same thing. I'm going to look at its intensity, we get another expression and I'm not going to parse that for you, but I'll just jump to the punchline, which that the amount of fees paid is approximately lever times one minus the probability of trade.
00:54:35.858 - 00:54:36.182, Speaker C: Right?
00:54:36.236 - 00:55:00.666, Speaker B: So if I put those two results together, this is how much the ARBs are making money, how much money they're making net of profits is lever times PTRADE. What are the fees that they're paying that are included in that is lever times one minus P trade. So this kind of looks like here, like lever, is a conserved quantity and it is indeed the sum of how much money the ARBs make net of fees, plus what the fees are that they pay into the pool.
00:55:00.778 - 00:55:01.150, Speaker C: Right.
00:55:01.220 - 00:55:49.740, Speaker B: So in other words, we can sort of think of imposing a fee as redirecting some of this lever away from the top bucket, which is how much money do the ARBs make into the second bucket, which is fees that the ARBs pay into the pool and in continuous time limit. They end up paying all those fees into the pool. So they're making nothing. Okay. So those are the main theoretical results. What I do want to point out is that we analyzed a specific model, a specific model with a certain fee and so on. Our hope is that this technique can be applied to analyze other models and variations of sort of the base AMMS.
00:55:49.740 - 00:56:14.384, Speaker B: And the goal here should be to minimize the arbitrage profits, right? Arbitrage profits are like a zero sum cost paid to intermediaries. And so by reducing them, we're going to increase the gains from trade, which is going to be more trade possible on the part of the noise traders and thus we're going to improve social welfare. And so the goal should be to come up with designs that mitigate that.
00:56:14.422 - 00:56:14.672, Speaker C: Right?
00:56:14.726 - 00:56:53.408, Speaker B: So one immediate thing is run a faster blockchain, right? If you run ten x faster, you'll pick up a factor of square root of ten in terms of a reduction of arbitrage profits. Right. Other types of things we can think about are maybe more complicated rules for setting fees. Maybe we can think about not just a proportional fee, but maybe other types of nonlinear fees. We can think about dynamic fees. We saw that there was a strong dependence of either arbitrage profits or lever on volatility. So it reasons, for example, that when volatility is higher, the fees should be higher than when volatility is low.
00:56:53.494 - 00:56:53.936, Speaker C: Right.
00:56:54.038 - 00:57:03.356, Speaker B: And volatility, even within the same pair of assets in the data, can vary by a factor of ten over a year. For example, the data set I have.
00:57:03.398 - 00:57:03.652, Speaker C: Right.
00:57:03.706 - 00:57:26.216, Speaker B: So one can think about rules to sort of optimally set fees. We feel that we have the base ingredient to do that and that we understand the cost and how that evolves. The part that we don't have an understanding of is our theory right now would say, okay, set the fees very high and then the arbitragers aren't going to make money off you.
00:57:26.238 - 00:57:26.472, Speaker C: Right?
00:57:26.526 - 00:57:32.668, Speaker B: But that's not satisfying because also the noise traders won't trade against you. If you have a very high fee pool, no one will trade and you'll make no money.
00:57:32.754 - 00:57:33.148, Speaker C: Right?
00:57:33.234 - 00:57:53.296, Speaker B: And so the other side that we need is we need to understand the sensitivity of noise traders to things like the effective spread and. So on and think about leveraging that to set optimal fees. We can also think about other things. For example, the whole source of this loss is that the pool does not know what the fair price is. Maybe if we had Oracles, things would be better.
00:57:53.398 - 00:57:53.712, Speaker C: Right.
00:57:53.766 - 00:58:18.040, Speaker B: And the pool could adjust its price without an arbitrager taking money from the pool. And there's sort of also different ideas to think about monetizing that. For example, might there be mechanisms where we do something like we auction the right to be a very low cost arbitrager and try to recover some of the money that the arbitragers will make?
00:58:18.190 - 00:58:24.460, Speaker A: When you say more complex fee rules there, are you thinking more about when you're collecting from traders or Redistributing to LPs?
00:58:26.000 - 00:58:29.336, Speaker B: No, I'm thinking of collecting from traders. I'm viewing the LPs as one aggregate.
00:58:29.368 - 00:58:31.272, Speaker A: Entity so that's still prorata to the LPs.
00:58:31.336 - 00:58:32.356, Speaker B: Prorata to the LPs.
00:58:32.408 - 00:58:33.010, Speaker C: Yeah.
00:58:33.380 - 00:58:48.710, Speaker A: Then on the faster blockchains thing, I mean, that is a more nuanced conversation to be had there, probably. Right. For example, you kind of have to believe the price process if the actual price process was more of like a jump process.
00:58:50.360 - 00:58:51.636, Speaker B: That's a fair point. Yeah.
00:58:51.658 - 00:58:59.256, Speaker A: So I would call that speculative. Maybe it's true, but I feel like we need to do more work there.
00:58:59.438 - 00:59:00.730, Speaker B: That's a good point.
00:59:02.060 - 00:59:02.810, Speaker C: Yeah.
00:59:03.500 - 00:59:18.412, Speaker E: The noise traders may also not be so time worried. So you might have a possibility of saying if you want to trade in the next second your fees are higher than if you want to trade over the next day or two.
00:59:18.466 - 00:59:49.530, Speaker B: Yeah, absolutely. And I think that's a great class of mechanism which is underexplored. I think in traditional financial markets people do do that to some degree. I mean, the dominant way, for example, institutional investors accumulate positions in the stock market is they leave algorithmic orders over time. And if you're not in a rush, you can leave your order over a long period of time and effectively you get in at a lower price. But in some way it would be nice to have a mechanism where you could directly signal, hey, I don't have information. I'm willing to trade slowly, give me a better price.
00:59:49.530 - 00:59:52.200, Speaker B: I think that's a very interesting direction.
00:59:55.390 - 01:00:00.494, Speaker E: The adjust fees based on market generation kind of assumes that the LPs are static over time.
01:00:00.532 - 01:00:00.734, Speaker B: Right.
01:00:00.772 - 01:00:13.518, Speaker E: Because they should dynamically adjust the amount of liquidity based on volatility as well. Then I'm just trying to think if you assume that the LPs in this.
01:00:13.604 - 01:00:17.090, Speaker B: Model are totally non the LPs are static right now.
01:00:17.160 - 01:00:25.682, Speaker E: They're totally stacked. If they adjust based on market conditions, like, the fees in some ways can be set stack. Like if you think LPs are like.
01:00:25.736 - 01:00:50.330, Speaker B: Watching the pool, I'd have to think about that. I'm not sure because I think there's a certain amount of adverse selection that occurs. Okay, so stylized fact is that, again, in traditional financial markets, the analogous thing to a fee is a bid ask spread. And so stylized fact is it scales with volatility. Right. And so I think it's not just how much you're participating. I think people blow out their prices.
01:00:50.330 - 01:00:52.106, Speaker B: I'm not sure.
01:00:52.288 - 01:00:55.274, Speaker E: Yeah, because I was thinking of it also like people blow out the spread.
01:00:55.322 - 01:01:02.062, Speaker B: When the volatility but that's not what so if you pull from, like, by adjusting how much you're investing in the pool, that doesn't achieve that effect.
01:01:02.196 - 01:01:11.694, Speaker D: Yeah, but in the sense the biddock spread increases during times of volatility, it's kind of like reflecting almost dynamic transaction costs.
01:01:11.742 - 01:01:11.906, Speaker C: Right.
01:01:11.928 - 01:01:15.886, Speaker D: So the transactions costs are going to adjust to the volatility.
01:01:16.078 - 01:01:17.042, Speaker B: That's what you want.
01:01:17.096 - 01:01:19.810, Speaker D: Yeah, exactly. So that exists in the no.
01:01:19.880 - 01:01:30.214, Speaker B: Okay, so let me be more precise. From, like, I guess, standard microstructure theory. What you'd expect is the bid ask spread for an infidesimal trade to widen if it's more volatile, even for an infinitesimal trade.
01:01:30.262 - 01:01:30.570, Speaker C: Right.
01:01:30.640 - 01:01:37.370, Speaker B: So by adjusting the curve, you could adjust the bid ask spread for a large trade, but not an infinitesimal trade.
01:01:38.750 - 01:01:43.838, Speaker E: So you talked about adjusting for market risk by Hedging against ETH or something.
01:01:43.924 - 01:01:44.174, Speaker C: Right.
01:01:44.212 - 01:02:02.110, Speaker E: So can you think of hedging against LVR? By potentially taking a consensus position, you are a block builder, and that's why when you're building the block, you can take arbitrage profits yourself, which you would have lost, or just an LP.
01:02:02.190 - 01:02:08.998, Speaker B: Yeah. So if you can always be the one who does the arbitrage trades, you will not suffer lever. Your lever will be zero.
01:02:09.084 - 01:02:09.478, Speaker C: Right.
01:02:09.564 - 01:02:22.518, Speaker B: Now, but the question is, how do you gain that? So one proposal I sort of didn't dive into here, but the idea here is suppose you give one person the right to trade with no fees.
01:02:22.614 - 01:02:22.970, Speaker C: Right.
01:02:23.040 - 01:02:27.926, Speaker B: If that person can trade with no fees, in some sense they're going to have priority over other arbitragers.
01:02:27.958 - 01:02:28.154, Speaker C: Right.
01:02:28.192 - 01:02:36.938, Speaker B: Because if I'm paying a 30 basis point fee and you're not paying any fee, and the mispricing is ten basis points, you can trade that and make money. I can't.
01:02:37.034 - 01:02:37.342, Speaker C: Right.
01:02:37.396 - 01:02:56.226, Speaker B: So you could auction off the right to be whitelisted and to trade with no fees, and presumably because that's valuable, you could monetize some of the lever. So I think there are sort of ideas like that. But I think, yes, if the LPs themselves could adjust the prices and take the arbitrage profits, there would be no lever. The question is, what is a mechanism that achieves that?
01:02:56.328 - 01:02:59.540, Speaker E: And one way they can do that is by becoming like, builders themselves.
01:02:59.910 - 01:03:01.982, Speaker B: But then presumably they have to compete with other builders.
01:03:02.046 - 01:03:02.660, Speaker C: Right.
01:03:03.590 - 01:03:11.370, Speaker E: Basically, they're competing with other builders, but they'll still get some per percentage of the arbitrage profit that will reduce their LVR.
01:03:12.270 - 01:03:15.942, Speaker B: Sure, but I feel like that's sort of almost orthogonal.
01:03:16.006 - 01:03:16.570, Speaker C: Right?
01:03:16.720 - 01:03:20.294, Speaker B: I mean, anybody could choose to be an arbitrager and get some percentage of that lever.
01:03:20.342 - 01:03:20.940, Speaker C: Right.
01:03:22.030 - 01:03:23.580, Speaker B: All right, thank you.
