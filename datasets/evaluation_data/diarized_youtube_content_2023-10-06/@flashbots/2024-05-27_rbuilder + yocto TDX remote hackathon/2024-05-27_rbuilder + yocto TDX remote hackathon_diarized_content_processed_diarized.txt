00:00:01.480 - 00:00:04.486, Speaker A: You also want to record a call or is the YouTube recording fine?
00:00:04.510 - 00:00:10.354, Speaker B: It's going to be seven twenty p. I think that's fine. All right.
00:00:12.894 - 00:00:14.114, Speaker C: All right, we're live.
00:00:15.214 - 00:00:30.078, Speaker B: Cool. I'm going to make you host Twitter. Let me know if I should come back. I'm not sure. I'm not super proficient in Zoom. Maybe someone else would want to take over that. I don't know what I need to do as a host.
00:00:30.078 - 00:00:38.994, Speaker B: So it's mainly if you want to stop the live stream. Okay. All right.
00:00:39.934 - 00:00:42.874, Speaker C: Will it stop automatically after we finish the zoom call?
00:00:43.654 - 00:00:49.198, Speaker B: Yeah, but you might want to stop for some reason.
00:00:49.366 - 00:00:50.434, Speaker A: All right, cool.
00:00:50.934 - 00:00:53.434, Speaker B: Can you stop and start again?
00:00:54.744 - 00:00:56.176, Speaker A: Unfortunately not.
00:00:56.320 - 00:01:01.684, Speaker B: Okay, cool. All right, bye.
00:01:02.104 - 00:01:02.512, Speaker C: Thank you.
00:01:02.528 - 00:01:03.124, Speaker A: Fred.
00:01:12.024 - 00:01:14.204, Speaker C: Do we expect any more people to join?
00:01:17.064 - 00:01:51.784, Speaker B: Well, there's a few more people invited, but I think some of them will join. And later on. Okay, so now I'm screen sharing? No, I'm not.
00:01:53.004 - 00:01:59.464, Speaker A: You do? Yeah, we can see your screen.
00:02:00.284 - 00:02:56.624, Speaker B: We have a few topics that we can work on. From the top of my head I thought about four different topics. One of course is the running r builder inside the YoctotDX VM image, and there's different steps to get there. I've collected all these in linear, but there's also this sub notion that's describing it. I think also a very fun task would be to enable the Bob Yocto TDX Vm image. We really don't need much here, just need to figure out how we can insert the ssh keys to the image. And then I would also like to ask the question of how can we keep this configuration separate from the r builder configuration.
00:02:56.624 - 00:04:07.064, Speaker B: This will require a bit more deeper understanding and knowledge of Yocto, and it's more addressed here in this way. Like if we want to have explore reproducible builds, can we like, what is an easy way to set up the project? Like if you can want to tell other people, look, you can come to the same image as ours, these are the steps, and currently we're far from that. I mean, there's only one Yocto project on the server, we're using that one, but there's not even a manual how to get to that same state. So I think that's something we could look at, but it's more of an advanced thing. So I would probably concentrate on these three and then maybe at some point later on we can look at exploring this reproducible part. Is there any preferences? What do you want to work on first?
00:04:09.984 - 00:04:48.034, Speaker C: I think one and two both require the prerequisite a TDX Vm. Right. So and the third one as well. So maybe we just start with getting ourselves familiar with Yocto and the images building process. And then all of them, all these three are just the expansion on what goes into the VM.
00:04:48.454 - 00:05:56.458, Speaker B: Okay, yeah, that sounds like a good idea. So I made some notes. I think it's best if I could have a terminal on the side and guide you through it. Let me see if I can get that working. Just, I'm just gonna share the whole screen. Yeah, I think that works. So let's start from the beginning.
00:05:56.458 - 00:07:13.064, Speaker B: So we have this base level directory and it contains the pokey distribution of Yocto. So Yocto is the build system and pokey is a reference distribution. I just started from there because it's easy. They have several templates especially there's one that's like a minimal Linux VM and I've modified that to fit our needs. And then if you want to just start like how can I build it? Let's first start with this one. You go into this directory, you source the build environment and then you can bit back the CVM image. And initially this will take a huge amount of time but since I've already built it it's not going to take that much time.
00:07:13.064 - 00:08:17.344, Speaker B: And it's just adding, you know, it's just compiling all of the binaries, all of the dependencies and then creating an image and. Yeah, that's it. And once that's done you, you can find these image, you can find the created images in this directory and then I'll, once I finish I can explain to you exactly what the different steps are to get to the image. Are there questions so far so we can answer something while we're waiting?
00:08:17.964 - 00:08:21.036, Speaker A: Yes, I have small question. Can you hear me? Actually?
00:08:21.140 - 00:08:22.052, Speaker B: Yep, I can hear you.
00:08:22.068 - 00:08:53.564, Speaker A: Yeah, perfect, perfect. So maybe this will come later. But when you are building this image, how do we configure it? The configuration should probably happen beforehand before building it. Where do we configure to which? Remove the stuff that we don't need and to make it as minimal as possible. Is that possible here or is it already fixed? This is the steps, binaries and dependencies that should be included and that's it.
00:08:56.854 - 00:09:37.548, Speaker B: There's a lot of places where you can configure this. I think ideally at some point we come to a place where we know exactly what we want to configure and then provide one single config file where you provide all the configuration and then from there on it spreads throughout the project and places the configuration and specific environment variables of different files. But at this moment we're not at that point. So I can show you a few places where you can configure stuff. I'm going to do that after I show you how this image directory looks like.
00:09:37.716 - 00:09:41.024, Speaker A: Yeah, cool.
00:09:47.004 - 00:10:33.484, Speaker B: So everything under built temp directory basically is stuff that has been, that contains built dependencies or binaries or stuff like that. So I think the important one is the final, let's see. Oh, I remember now. At some point we unpacked one of the images and so now we have a root file system here as well. And I didn't clean it up. Okay, there must be a VMDK image somewhere. So that's a vic image.
00:10:33.484 - 00:11:06.554, Speaker B: This one is important. This one you can boot with chemo. And then there's the VHD. So basically the vic is the final image and then the VHD is a conversion to another image that you can boot with azure. And before that vic you have the, you need to have the image. Rom must be around here somewhere as well. Well you have the, you have the kernel image.
00:11:06.554 - 00:11:35.814, Speaker B: There's a root fs, I think the root of his. No, that's, that's actually the final image. But somewhere most awesome. The. Ah yeah, here you have the inner drama fest. So I think that's, these are the main parts and they construct the whole image. I can give you an example here.
00:11:35.814 - 00:12:08.644, Speaker B: This one, this file describes the fe disk image partitioning. So you can also see how it's built up. So let's have a look at this one. Sorry, are you also having this copy paste issue with notion that you have to really wait a few seconds until it actually takes the thing that you selected?
00:12:10.984 - 00:12:14.164, Speaker C: Yes, I think yes, it's super annoying.
00:12:14.784 - 00:12:55.104, Speaker B: Okay, so it basically creates two partitions. One is the, the Fe boot partition image and that contains the unified kernel which is the kernel plus the edit Ram disk and the system deboot binary which basically acts as an Fe loader. If you have questions here, if you don't know what an Fe loader is or stuff like that, then just ask and I can explain.
00:12:56.924 - 00:13:00.144, Speaker C: Wait, why is there system d? Something.
00:13:01.244 - 00:14:00.534, Speaker B: The system d boot isn't just an FE loader. It's not system d itself. It's just a small binary that acts as an Fe loader. So basically the boot process is you have Ufei booting and then that looks for an Evi loader which is systemdboot data started and then as a next step, this one will start the unified kernel image, which will start the kernel, unpack the ram disk and continue. And then there is one partition which is the SDA partition. There's nothing on it we're not writing at this moment. It's just a placeholder for in future, once we boot the image, we want to repartition this SDA to make it bigger, then encrypt it, and then we can place our stuff there.
00:14:00.534 - 00:15:08.394, Speaker B: But for now that's just a place folder. You need to have the bootloader configuration, which also contains the kernel command line, which I think is important because I want with the kernel command line, I would want to explore whether it's possible to add additional parameters to the kernel command line without having to rebuild the whole image. That's interesting for the bob use case where you could add an SSH public key to the command line, possibly. I don't know if the kernel will complain if you supply it with a parameter that it doesn't know, but once the image is booted you can read from the kernel command line and you can extract the public key. And then. Yeah, if you don't need to change the image for that, you would have one single image for all bob builder images. So that would be interesting.
00:15:08.394 - 00:15:47.034, Speaker B: One way to approach it, but yeah, so that's how the image looks like. And how do you configure it? So there's several ways and several points where you configure stuff. You start off initially in the conflocal, so that's your local configuration file, and there's several things you can configure. Like for example, here's a go Ethereum version, you could configure that, but.
00:15:50.374 - 00:15:50.662, Speaker A: So.
00:15:50.678 - 00:16:54.594, Speaker B: There'S lots of stuff, like which machine do you want to build for SAv, SMP or TDX, which distro. There's, normally there's the QMU distro, but for us it's the confidential VM distro of course, and it goes on. So these are custom configurations, but the rest you see here is pretty much standard and can go and read through and try to understand what each configuration does. So that's the local one. Yeah, but I think maybe it's better to show you like to solve one problem and then you can see what different configurations are touched and how that fits together. I think it's better if I, if I do this, then I'm just explaining different configuration files because you won't remember anyways afterwards.
00:16:58.454 - 00:16:59.634, Speaker C: Yeah, I agree.
00:17:07.974 - 00:17:48.938, Speaker B: Yeah. So once the image is built. You can start it locally on QEmu. Having a bit of trouble because I can't see what I'm typing. Can I minimize this one? Okay, this is the issue we faced during the hackathon, the other one in Spain. But we can just skip this for now. We need to figure out what's causing this.
00:17:48.938 - 00:18:19.294, Speaker B: It actually has the bootloader. So if we exit the fe shell, go into the boot manager, and boot the Qemu hard disk, it will continue. This doesn't happen if you run it on azure. This is just a local issue, which I'm just fine to just skip fixing it for now. Then you're at the boot prompt. You can log in as root and you can play around with it. But there's still networking missing.
00:18:19.294 - 00:19:00.580, Speaker B: And basically the reason for that is Gimu wants to configure the networking via kernel command line. But because we've passed in the whole image rather than just the, the kernel and the boot image. Sorry. The inner drum disk, it can't do that. So it's expecting a static IP address, but the image itself doesn't know which one. So you just have to manually configure the whole thing. I just wrote the small script and it works right away.
00:19:00.580 - 00:19:43.486, Speaker B: So if we ping, we have network connection. Yeah. Okay, so now we're, so now we started the TDX VM locally. It's not within the cloud. We can discover this part as well, like pushing it to the cloud and starting it there. But I would love to do development instead. Yeah.
00:19:43.486 - 00:20:40.748, Speaker B: Another part, like reproducible builds. We want to check the PCR values of the TPM, like whether they are the same as the image that we're compiling. And that's also important for reproducible builds. Like, is the, is the kernel the same, is the inner dram disk the same? And the whole package together. And there's some scripts located here. Sorry. They basically give you the measurements for the PCR.
00:20:40.748 - 00:20:57.724, Speaker B: Twelve, four and nine. I can't remember exactly which ones they are, but I think it's command line, kernel and roundisc or something like that. Well, we can, we can figure this out. So that's pretty much the intro. Do you have any questions?
00:21:03.424 - 00:21:25.784, Speaker C: Can we. Yeah, I just pasted the, the, the flags for chemo to avoid configuring the network statically. Can I maybe try to supply this because it worked for me locally?
00:21:32.404 - 00:21:36.224, Speaker B: Sorry, I didn't get this one. Can you, can you explain what you did? Exactly.
00:21:37.164 - 00:21:48.084, Speaker C: So these are the flags that you can pass to chemo command because you probably don't pass any network related commands.
00:21:49.824 - 00:22:13.924, Speaker B: There's, there's network related commands that are being passed. There's a whole tap interface that's been created, but it's configured static. It doesn't have DHCP server as part of the configuration and that's why you need to give it a static ip address. It's pretty much the whole thing of getting networking running within the VM.
00:22:15.624 - 00:22:35.874, Speaker C: Yeah, but with the flags that I provided I was able to, well, basically chemo it seems, spins up a DHCP server so it auto configures the network. That's just a minor kind of comment.
00:22:36.374 - 00:22:44.254, Speaker B: Is that, did you pass that as part of the run chemo or did you pass, did you have a different one?
00:22:44.414 - 00:23:00.394, Speaker C: I have, I just run it directly with kimu system binary. I don't use run qumo, but I have been using this for my build root builds, not Yokto, but I think they are configured similarly because it should be default configuration.
00:23:01.744 - 00:23:03.244, Speaker B: Okay, let's try this.
00:23:03.824 - 00:23:24.364, Speaker C: Because run chemo is a wrapper script, right? So you maybe can just add it to the script. No, I think.
00:23:36.124 - 00:23:54.144, Speaker A: Regarding this start issue that we are getting with run Quemo, I think there was also like a flag that you can set with run Qumo where you can provide the path to the ife boot on the start. So you don't have to do this manually every time, right? Or am I, am I missing.
00:23:56.154 - 00:25:29.934, Speaker C: Regarding the EFi boot, I think the issue here is that run an UEFI compatible image, you have to have the UEFI subsystem instead of bioS. Yes, it is provided as part of the separate image and it supports provisioning so called EFI variables. So these EFi variables are the ones that control the boot process and select the boot device, et cetera, et cetera. So you should be able either to provision this Efi variables directly through a command line, which I don't know how to do exactly. Or I was able to do this without a separate EFi bootloader, but instead using so called Efi stub, which is a feature of a Linux kernel. So it pretends to be UEFI loader and you don't need to do any specific disk layout, etcetera. It just works.
00:25:29.934 - 00:26:12.264, Speaker C: I'm not sure about, not sure about the internals, but it places itself on the boot partition and you don't need to configure any variables. So I think it just somehow uses the default ones. Again, it was the case for build root, but maybe not the case with Yocto. So basically to fix our issue with Yocto, I think we just need to provide provision a UEFI variable to explicitly say where the bootloader is.
00:26:16.284 - 00:26:34.264, Speaker B: It did work at some point, right? I mean the first time we started it and when I was using it last year, I never had these issues, but I think this just is so we're sorry, we're talking about the fact that when we boot it up it doesn't find the boot, the right parameters, is that correct?
00:26:37.844 - 00:27:35.074, Speaker C: Not the boot parameters, but specifically the EFI variables that needs to be supplied to a bootloader. So it's the one, it's the variables that the UeFi image baked, usually baked into the motherboard, which you configure through the UEFI bios. It is these particular variables that motherboard supplies to a bootloader in the very, very initial boot stage. So because we don't have a, because we are virtualizing and we don't have a hardware Wi Fi chip on the motherboard, we need to supply these variables ourselves manually to a chemo command.
00:27:35.574 - 00:27:45.646, Speaker B: Yeah, I think, I mean this is, I don't know, takes like 2 seconds to skip all the stuff. So I think it's fine to just skip it for now. It's not, yeah, it's totally fine for.
00:27:45.670 - 00:27:46.234, Speaker C: Now.
00:27:48.094 - 00:28:00.574, Speaker B: But yeah, so your commands actually did work. So I, where did I begin? It did add another device.
00:28:02.794 - 00:28:10.842, Speaker C: Yeah. Because there are probably two now in the run chemo wrapper script itself. And then we added another one.
00:28:10.978 - 00:28:43.872, Speaker B: Exactly. And so I did have to do a small change in this file because, so I changed these two lines. But this one we don't need. This one is they have a backslash here. And I don't know why the script fails here and I don't know why it's having a backslash here. Maybe we should just provide a patch that removes this one. But it looks like it's some kind of configuration because it's also here.
00:28:43.872 - 00:29:22.494, Speaker B: So I changed, I took away this, restarted the script and then I have an IP address here and I can ping outside. And DNS resolving is also working. So I'm going to add that as another way of doing it. Okay, so what do you, what do you want to start with?
00:29:28.634 - 00:29:30.234, Speaker C: Yeah, go ahead mo, sorry.
00:29:30.274 - 00:29:32.734, Speaker A: No, I didn't want to interrupt you start.
00:29:34.714 - 00:30:16.394, Speaker C: I think one kind of common use case that we are going to base with is how do we install packages into the image. So it's a base image, but we probably want some, I don't know, SsH client there or SSH server or wireguard server or basically any other third party binary that we want to add to the image. We probably need to make it as part of the base image.
00:30:19.294 - 00:30:38.784, Speaker B: The pokey distro itself already provides a few stuff things, and all of that is going to be saved within the inner drum disk because we don't have a disk itself. We were booting from inner drum and that's it. We're not going to mount a disk. So, and that's the place where you want to configure stuff.
00:30:47.564 - 00:31:27.494, Speaker A: So if understood you correctly, it's adding, it's adding the third party binaries directly in the initrum and not in the disk image of the image itself. Or how has it been done? Because I was trying with the TDX canonical VM last Friday, sorry, last Wednesday on a way how to add it. Like for example add binaries inside the image, inside the initram. And it's not so straightforward compared to injecting it inside the disk image itself and then executed through systemd files or manually or whatever. So how it's been done here?
00:31:27.834 - 00:32:16.528, Speaker B: Yeah, here basically you build your, you built all the applications you want to have inside and then you put inside. So that's how you do it here. Yeah, that's where inside of the inner drum disk there's two, so Yocto has two different stages. It's built the inner drum disk and then it's going to build the whole disk. Like the SDA you remember from the boot partitioning there was one partition SDA, which was a placeholder. Usually there you put your whole built image which is then you put the inad round disk and then you mount the actual image and I think then you discard the inner drum disk. But here we just boot into innerm disk and we don't have the whole image.
00:32:16.528 - 00:32:56.194, Speaker B: But Yocto still wants to build it because it's used to not only having initial, but so I'm saying this because there's another file where you can actually configure the disk image and it's applications and dependencies. But this file here is the one that configures the yenod ram disk and its dependencies and here we need to add it. So if we want to have curl we add it here. If we want to have ssh we add drop here. And all the other things like flower was the binary that we had.
00:32:59.454 - 00:33:00.434, Speaker A: Interesting.
00:33:00.974 - 00:33:11.114, Speaker C: By the way, isn't initramfs a thing that loads before the kernel and then passes the control to kernel?
00:33:13.534 - 00:33:19.194, Speaker B: No, I don't think so. I think you start the kernel and the kernel will populate in a drama fest.
00:33:21.574 - 00:33:56.190, Speaker C: Because my impression was that initramfs is a thing that is a kind of helper for the kernel because you don't want to always include all the modules and all the device handling inside the kernel itself. So any drum fs just facilitates the, let's say you're loading from a raid array and any trauma fest just facilitates the communication between the device itself.
00:33:56.382 - 00:34:43.804, Speaker B: I think the best example you have here is disk encryption. You want to start your os and you don't want to give it immediately access to the whole disk because it's encrypted, but you need to provide some kind of binaries so you can have the decryption mechanism and stuff like that. And this is then part of the init ram disk. And it will decrypt the root fs and then mount it and then discard the init ram disk. That's the idea. But you start with a kernel, you boot the kernel and at least that's my understanding. But yeah, there might be some funky binary that first populates the inner drum disk and then starts to kernel on top of that.
00:34:43.804 - 00:34:46.384, Speaker B: I don't know, but it doesn't make any difference. Right.
00:34:48.644 - 00:35:30.594, Speaker A: I have a suggestion. Could we maybe it's not, but should we make like for example, just, just to show it an example of hello word, for example binary where we want it to be directly embedded inside the NHMFs, for example the startup and executed. How would that process would look like? Imagine having a binary given by a third party and you want to run it embedded here. So what's the step should be done in this. That would be a great intro. Like you have this binary and what steps. Now what should I do? I want to embed it and execute the VM or create an image.
00:35:31.534 - 00:36:11.060, Speaker B: That's basically the steps you would do if you want to have reth or the rbuilder inside. Exactly. There's different ways. Ideally at some point we will definitely build ref and the rbuilder as part of the Yocto build process. But currently we're experiencing issues with some external c dependencies and it's just not building straight out of the box. So we can just add a binary and we've done that as part of the Spain Austelek Hackathon. So it's an easy task.
00:36:11.060 - 00:36:26.944, Speaker B: We can just copy the flower directory and change some stuff. So this is easy. We can do that. Yeah. Do you still have the rest binary that's built without external dependencies.
00:36:28.204 - 00:36:36.924, Speaker A: I can do it quickly, it's just a simple, I don't have it now on my hand, but I can build it for you and send it to you if you want.
00:36:37.084 - 00:36:53.784, Speaker B: Yeah, you could send it into the server and then we can take it from there. Is everyone okay if we do this as a first example, I think it fits well. It gives you a feeling like you understand something.
00:36:56.324 - 00:36:59.220, Speaker A: Can you give me which server you want to be on so I can.
00:36:59.252 - 00:37:06.148, Speaker B: Build it directly there, that's the, this one.
00:37:06.316 - 00:37:10.820, Speaker A: Is it the DX zero that we are running now on the arbiter or which one?
00:37:10.972 - 00:37:15.544, Speaker B: No, it's this one here. It's the old server hosted on.
00:37:16.244 - 00:37:23.994, Speaker A: This is the Grameen dev that I was. Okay, this is where we were experimenting. Grameen and Holisky, if I'm not wrong.
00:37:25.854 - 00:37:27.354, Speaker B: Yeah, I think so. Yeah.
00:37:28.094 - 00:37:34.794, Speaker A: Yes, I'm on it. All right, I'm gonna, I'm gonna pull res and unbuild it for you there.
00:37:37.494 - 00:39:04.480, Speaker B: Okay, I'm gonna, I'm gonna take this step to explain a bit more. So there's different layers in Yocto, and layers start with meta and then whatever is containing that layer like we have in this example we have the metaconfidential compute layer which includes all the configuration necessary to build a confidential VM disk image. And there's another custom layer which is meta Evm which contains all the configuration to build stuff like EVM nodes and which is specifically for Ethereum or Ethereum builders and stuff like that. So we're going to change that into this directory and into recipe nodes, which contains all the recipes for stuff that we want to build. There's already a rest project, but this one doesn't work. So we're just going to copy the flower plot project to reffin. And this will be the folder where we configure, just uploading, just adding the rest binary which we have built reproducibility via some other build mechanism.
00:39:04.480 - 00:39:11.144, Speaker B: And then we're just going to add the binary here. We don't need the JSON stuff.
00:39:14.124 - 00:39:14.412, Speaker A: We.
00:39:14.428 - 00:39:26.864, Speaker B: Don'T need the flower binary, and this is going to be named breath.
00:39:27.884 - 00:39:59.874, Speaker A: So if I understood you correctly here, you have to put inside this folder meta, evm or recipe notes. You create another folder with the binaries that you want to include, which includes the binary plus this manifest like file like the dot bb. And do we know how this like bb looked like and how to configure it? Like does it like. Okay, is it like a sandbox where you write what services you need to expose for this binary or what is it?
00:40:00.574 - 00:40:48.310, Speaker B: Well, WBB stands for bitbake. It's a bitbag recipe. And bitbag is just basically a tool with which you can build applications. It's mostly used in the embedded Linux ecosystem, which is also why it's used in Yokto. And it's huge and large and I would have to explain a lot of stuff and I don't know a lot of stuff, but for now we can just look at this file and it will tell us exactly what we need. So I'll give you an example. So there's the license parameter which is for us right now just closed, because that's the easiest way to configure it.
00:40:48.310 - 00:42:10.778, Speaker B: If we have to configure the license as well, it's going to take some time, so we're just going to leave it closed. File extra paths from the top of my head I think it's regarding these. So there's some source Uri and for this one we want to have, instead of the flower binary, we want to have the rest binary. These are the three files we don't need. I don't think we need this one, we're just going to leave it and then there's an install script which installs the binary into what is bind here. Well it's been a long time, I don't know exactly what it does, but I think it places the rest binary into the user bin or something like that. And then we need to skip some stuff because usually it expects like the output, the binary, it expects a debugger binary which hasn't been stripped and during the build process it will do all this stuff.
00:42:10.778 - 00:43:10.814, Speaker B: But because you're already supplying us with one, we're just going to skip these steps and yeah, I think that's pretty much, I can't read the upper one. I think that's just a description. Is that sufficient for you to understand what it does? So you have to give it some source, which for us it's just the, it's just the binary itself, we don't have any source and you have to do you have to install it in some way usually. Like if you look at other examples I can give you one for Go Ethereum. This one just includes a include file. So let's have a look at the include file. Sorry.
00:43:10.814 - 00:44:02.814, Speaker B: Yeah, so imagine this is the bitbig file, the BB file, so you have a description homepage license. This is the actual outward look in the end find the license, you define the license checksums and then you inherit some stuff. Like for this example, you inherit go mod, which gives you all the things that you need to build go binaries. You want to install the geth command. I don't know what this one does. You give it some linker flags. You need to define some stuff for reproducible builds, and rdpens are basically stuff that, so that's reverse depends.
00:44:02.814 - 00:44:41.538, Speaker B: Like these are any dependencies that you need during the build process. And for some reason it needs bash for the build processes. And they do compile during network means that you want to have networking enabled during compiling, which by default is not enabled with Bitbank. But because go is special and you need to download your dependencies during the compile time it's enabled. So that's another way of doing a bit back file. The rust version, that's different. Yeah, yeah.
00:44:41.586 - 00:44:47.818, Speaker A: This is not the bb file, this is dot in. Okay, so this is, but that's just.
00:44:47.866 - 00:45:30.324, Speaker B: Because, so dot in is like a generic file that I'm, if you see, you see here, there's different BB files, like for the def version of go, Ethereum, and then for the builder version, and then for the def version of the builder. So in each, all in all of them, I'm including the ink file. Okay. And then I'm defining some special stuff. Like, okay, I'm giving you a different example because that's, so let's look at the builder. So let's look at this one here. I'm changing some stuff.
00:45:30.324 - 00:45:51.564, Speaker B: Like I'm changing the source Uri, I'm giving it some patches and stuff like that. But it starts with somewhere. It would need to include the ink file, but I can't see it because is it somewhere on top? Because I can't see the first two lines.
00:45:52.184 - 00:46:11.064, Speaker A: The first two lines are go install and go import. Go install is a repo of the geth and the import is GitHub flashbot builder, which is the flashbots g builder. We also didn't see these two lines. Interesting.
00:46:11.104 - 00:46:17.584, Speaker B: Okay, so it includes this one. Okay, yeah, I see.
00:46:18.164 - 00:46:44.120, Speaker A: So it's kind of importing another file inside of it. Okay, cool. I see. I noticed that your src Uris, you have to specify each file separately. Is there a way where you can do it recursively? Like you provide a directory and it takes everything in it just for the sake of, like if you have a huge configuration that you have to add, do you have to add them manually, one by one?
00:46:44.232 - 00:46:46.684, Speaker B: I tried to use wild cards. It didn't work.
00:46:46.984 - 00:46:59.204, Speaker A: Okay, never mind. Anyway, for the sake of time, I pulled the repository. I had to fix something, but now it's built. I will move the binary now to the home directory. You should be able to see it shortly.
00:47:00.424 - 00:47:02.524, Speaker B: So you're going to move it here.
00:47:03.344 - 00:47:05.704, Speaker A: Move it under home directory, just right.
00:47:05.744 - 00:47:08.324, Speaker B: You can move it right into here if you want to.
00:47:09.654 - 00:47:17.550, Speaker A: Okay, let me see if it's there. Let me move it to that path that you tell me.
00:47:17.662 - 00:47:25.194, Speaker C: Frieder, Frieder, can you try to move this zoom over low?
00:47:26.054 - 00:47:28.694, Speaker B: Okay, I'm going to try it now because it's really annoying.
00:47:28.814 - 00:47:34.794, Speaker C: Can I just, you just can point at it and it should be, you should be able to move.
00:47:38.204 - 00:48:00.344, Speaker A: Okay. Shit. Sorry, I moved it wrong and now I will remove something. I sent a folder to do something shortly. All right, so you can check now.
00:48:01.904 - 00:48:04.364, Speaker B: Okay, so this one should just execute.
00:48:05.704 - 00:48:14.164, Speaker A: It should we can do ldd and see if it's even statically built. We can check beforehand.
00:48:15.664 - 00:48:21.444, Speaker B: Yeah, great. Okay, so it's rest now I think I configured it.
00:48:23.824 - 00:48:27.684, Speaker A: Yes. I named it like this because it will conflict with the name of the folder.
00:48:34.104 - 00:49:03.374, Speaker B: Okay. So if everything is configured correctly. Oh, sorry. Wow. So I can hide the meeting controls, but if I press escape, which I need for Vim, it's appearing again and then I can change the first sentence which I wanted to do. Okay, let's just leave it as that.
00:49:04.874 - 00:49:06.254, Speaker A: You can use nano.
00:49:08.594 - 00:50:02.314, Speaker B: Yeah, maybe I can move it. Okay. I can't move it. All right, so if we bitbake red bin, this should actually work. But let's see, nothing provides redbin. Maybe we need to add it at some point, at some stage in the layer directory.
00:50:12.074 - 00:50:24.098, Speaker A: Could it be that the binary should be the same name as the service that you named it, the rest bin or like because the guests.
00:50:24.146 - 00:50:34.298, Speaker B: Oh, I see, yeah. Okay. It doesn't. Okay. Because, yeah, I actually need to name the bitbacking file Rathbin. Okay.
00:50:34.466 - 00:50:37.274, Speaker A: Yes, it.
00:51:08.034 - 00:52:35.098, Speaker B: Okay, looks better. Okay, so now we can build it. Now it's somewhere like as a package. And now we need to add it to the ED ROM file, if you remember this one. So now we're building the image, the VM image. And once that's done we can, well hopefully that's done and then we can start QMU and then we can check whether actually starting or not. And as a next step we could also add rbuilder mo.
00:52:35.098 - 00:52:39.498, Speaker B: Do you think you can provide us with an rbuilder?
00:52:39.666 - 00:52:49.894, Speaker A: Yes, let me fetch that. Let me fetch that and send it to you to the same. Oh, can you create folder for that? For the rbuilder bin so I can send it to there as well?
00:53:10.174 - 00:53:25.168, Speaker B: If the inner ramifications size has been too large, let's see if we can just throw stuff out. I think we can. We will need this one and just.
00:53:25.216 - 00:53:27.084, Speaker C: Increase the max size.
00:53:27.584 - 00:53:28.364, Speaker B: Yeah.
00:53:50.284 - 00:54:04.564, Speaker A: Yeah. I need to create a GitHub authentication token because it's private, it might take some time.
00:54:04.724 - 00:54:28.260, Speaker B: No, you don't need to do that. There's a way where you can add your ssh key to your ssh. I mean you're authenticating to GitHub with the ssh key and you can add that to your remote ssh session. Then you don't need to have the private GitHub token.
00:54:28.452 - 00:54:59.004, Speaker A: I think I already did this, but it still asked me for that. Let me try again then. Maybe I misclicked something. Let me check. Permission denied. For some reason my public key is not allowed. Maybe because I have many ssh keys and I'm working on the work laptop.
00:54:59.004 - 00:55:10.504, Speaker A: Anyway, I'll do it quickly. No worries. Or maybe you can pull it for me and then I can do the building if it's faster. If you're already set up for that.
00:55:10.584 - 00:55:12.004, Speaker B: Okay, let me try that.
00:55:13.544 - 00:55:34.636, Speaker A: If not, it's no problem. Generating a token is not hard, is it?
00:55:34.700 - 00:55:35.664, Speaker B: Rbuilder.
00:55:36.404 - 00:55:37.584, Speaker A: Rbuilder private.
00:55:40.164 - 00:55:41.584, Speaker B: Rbuilder and then private.
00:55:42.964 - 00:55:44.864, Speaker A: You are saying the repo, right?
00:55:45.204 - 00:55:48.584, Speaker B: Yeah. What was the repo's name? Do you know?
00:55:48.924 - 00:55:50.584, Speaker A: Rbuilder private.
00:55:59.464 - 00:56:01.284, Speaker B: I don't have access to this one.
00:56:01.744 - 00:56:38.704, Speaker A: Okay, I will. I created another token. No worries. I just renewed my token and I'll use it instead. Yeah, I pulled it. Let me build it quickly. And it's building.
00:57:02.624 - 00:57:45.844, Speaker B: Okay, so let's switch back to this tab. It's built successfully so we can run chemo and see if we can start with. No, there's an issue. 1 second. Do you see the error? I don't see the error.
00:57:46.864 - 00:57:48.600, Speaker A: Warning. Couldn't run.
00:57:48.632 - 00:57:53.724, Speaker B: Bit bake minus erville. Okay, I need. Oh okay.
00:58:01.284 - 00:58:12.904, Speaker A: Can you, can you somehow exclude the r builder for now for the bitpeg command? Or why is it taking the arbiters and we didn't bake arbiter in it yet.
00:58:14.244 - 00:58:27.164, Speaker B: It was just parsing for that binary because it just looked through all the configuration files and I didn't find it and that's why I threw an error. Just, I just touched the file that fixed the problem.
00:58:28.344 - 00:58:29.124, Speaker A: Cool.
00:58:31.584 - 00:58:37.664, Speaker B: Okay, so yes, awesome.
00:58:37.744 - 00:58:56.354, Speaker A: So I assume can you write which rest like the which command and rest. I want to see where are they being installed, the binaries that you are baking in them inside. Like which, which are where? Yeah, maybe where same. Yeah. So they are being installed under user bin. Interesting.
00:58:58.774 - 00:59:06.794, Speaker B: Yeah that's just, this is probably just some, it's this.
00:59:09.214 - 00:59:10.514, Speaker A: Bin directory.
00:59:13.854 - 00:59:17.876, Speaker B: Binder is probably bin and d is user.
00:59:18.030 - 00:59:19.324, Speaker A: The user. Yeah.
00:59:20.064 - 00:59:39.804, Speaker B: And if you want to know exactly why that is the case, there is this interesting trick. You can just check out the single page yahoo documentation. So that's a single page. So you can control f and then let's just.
00:59:42.144 - 00:59:42.884, Speaker A: Call.
00:59:45.084 - 00:59:49.464, Speaker B: Maybe find some explanation for the.
01:00:02.724 - 01:00:07.304, Speaker A: Okay, can you tell me again where do you find this? I mean the single page.
01:00:10.154 - 01:00:56.422, Speaker B: Do you all have the TDX hackathon? I'm going to share it. And there you would go to this intro yocto TDX Vm like finding your way around the Yocto TDX project and then. Sorry no it's not here. It's, it's, it's in reference. It's, it's below that single page documentation. It's this one.
01:00:56.598 - 01:00:57.674, Speaker A: Cool, thanks.
01:00:58.534 - 01:01:05.642, Speaker B: But yeah. From, I can't find one right now. Yeah, I mean, you know, we kind.
01:01:05.658 - 01:01:15.934, Speaker A: Of know you should be able now to see the binary where you are now in your binary in your terminal.
01:01:17.034 - 01:01:18.054, Speaker B: It's still.
01:01:22.074 - 01:01:24.002, Speaker A: There. It is arbuilder.
01:01:24.058 - 01:01:25.814, Speaker B: It's not executable. Right.
01:01:26.234 - 01:01:31.674, Speaker A: It is, it should be. Did I copy the wrong one?
01:01:33.134 - 01:01:35.474, Speaker B: Maybe it's because I touched the file before.
01:01:39.534 - 01:01:44.834, Speaker A: Can you check exactly? Yeah.
01:01:45.454 - 01:01:47.314, Speaker B: Okay cool, cool.
01:02:16.474 - 01:02:27.704, Speaker A: So you have to run bitbake for each binary to create here under the recipes and, and then you run the bitbig again for the CVM image to create the whole image with all those.
01:02:29.044 - 01:03:04.524, Speaker B: No, that was an unnecessary step. I just did it to verify that it works. But if you provide this as part of the, if you provide it as part of the initromfs dependencies then it will automatically build it because it's a dependency. So we can add it here.
01:03:09.984 - 01:03:16.592, Speaker A: Ah, so it builds it directly so we don't need to build it like what you just did. Bit big. Rbuilder bin.
01:03:16.728 - 01:03:20.324, Speaker B: Yeah, I see. Interesting about the helmet.
01:03:21.384 - 01:03:37.728, Speaker A: Yeah. Does this create here in the output the measurement of the final image or. No, this is a separate thing.
01:03:37.856 - 01:03:46.150, Speaker B: No, but we could add it, we could add a script that outputs the measurement as part of the build process, which would be really nice.
01:03:46.342 - 01:03:46.694, Speaker A: Yes.
01:03:46.734 - 01:03:53.302, Speaker B: Or at least create a file that, that contains the measurements. I think that would be even better.
01:03:53.478 - 01:04:09.694, Speaker A: Yeah, this is an interesting point because for TD export what I understood now for the home from the whole documentations are you need to boot it first in order to fetch the measurement of that image.
01:04:11.114 - 01:04:16.174, Speaker B: However I've seen, is that the case, do you actually need to boot it to fetch?
01:04:17.194 - 01:05:24.966, Speaker A: If I understood correctly from the TDX canonical GitHub repository, yes, you need to do the, you need to boot it and run the scripts there in order to fetch the measurement. But I've seen, I have seen scripts, for example for the AMDs evs NP where you can fetch the measurement without booting the image. So I don't know how does it work? Maybe it relies on the TDX module or I mean the TD module, that's why you need to boot it. But I'm not sure. So there should be a way where you can simulate that and create the measurement without booting. But yeah, it's just a thing that I want to explore and see if we can do this because it would be great to do it without booting because to make a reproducible build where others can reproduce it themselves, see the measurement and then compare it with a deployed one, they should be able also to create the measurement. Right? So we don't assume that everyone has a TDX machine there to be able to run and create the measurement.
01:05:25.150 - 01:06:38.034, Speaker B: I mean, there's another thing I wanted to show you. So this is the cctest rights. So that could actually be a TDX Vm. And then where did I store this? 1 second. And then here you have a check TDX guest shell script that's checking for things you would need to check if you want to be sure that you're running in a, in a guest. Yes, all of these, if I run them on, on azure, on the Azure TDX machine they just, I mean.
01:06:40.214 - 01:06:40.478, Speaker A: Do.
01:06:40.486 - 01:06:42.954, Speaker B: You know what the Ccel tables are?
01:06:44.094 - 01:06:49.274, Speaker A: Ccel tables, I don't know what they stand for.
01:06:53.394 - 01:07:26.562, Speaker B: I figured this out because I wanted to like this devtdx get. It's the one that you're using to get your TDX report. Yes, I think this is, and it's not there now if I run this image without, I think if I run this image without TDX support, it doesn't work on Azure, but for some reason they just removed all of the stuff. So I mean maybe it's just because it's a public preview, but there's still a lot of stuff missing.
01:07:26.738 - 01:07:37.450, Speaker A: Yes. Can you go up in this directory that you opened? I think the CDX tools in general, this repo is decommissioned from their side. If you go to the main it's decommissioned.
01:07:37.482 - 01:07:57.004, Speaker B: It's decommissioned, but I'm looking at the TDX 1.5 branch, which is not the default one. And I thought because they, they have been working on this three months ago. So they decommissioned it. Yes, but there's still some very interesting stuff. So recommend having a look at it.
01:07:58.184 - 01:08:00.724, Speaker C: And it's not available even with Sudo.
01:08:01.784 - 01:08:08.404, Speaker B: No, you can also, a funny thing is you can also mock prop TDX guest.
01:08:09.504 - 01:08:12.244, Speaker A: So it exists somehow it exists.
01:08:12.884 - 01:08:26.372, Speaker B: It's not even a module. I think it's part of the kernel itself. Yeah, it's just not, I mean if I look, I searched for TDX guest as a model but I couldn't find it. So.
01:08:26.468 - 01:08:28.864, Speaker A: Yeah, interesting.
01:08:30.364 - 01:08:31.224, Speaker B: Okay.
01:08:31.724 - 01:08:49.994, Speaker A: But if you open to the X canonical GitHub repository, you would see there, there are other scripts that you can do talk and get attestation measurement from within the XVM.
01:08:50.114 - 01:08:51.294, Speaker B: Did you try these?
01:08:51.914 - 01:09:13.664, Speaker A: Not yet, but I think Andrew did and he was able to. This is set up the guess. Yes. So you can, this is how to set it up. And then there's another folder there which is called autistic station outside and it's responsible for setting up the attestation for the guest and then calling it.
01:09:19.764 - 01:09:25.224, Speaker B: Okay, so it's checking for an MSR. Let's try this one.
01:09:32.984 - 01:09:36.204, Speaker A: I think set is just to take the environments variable.
01:09:45.704 - 01:09:48.084, Speaker C: Let's run this as root.
01:09:48.464 - 01:10:05.384, Speaker A: As root. Now you'd be able pseudo. Yeah.
01:10:06.524 - 01:10:08.384, Speaker B: Zero is production.
01:10:09.204 - 01:10:12.104, Speaker A: If it's zero then it's production, which is correct.
01:10:12.684 - 01:10:22.684, Speaker B: Yeah. Okay. I'm still not super convinced.
01:10:26.704 - 01:10:28.080, Speaker C: What does it mean exactly?
01:10:28.192 - 01:10:33.564, Speaker B: Production, I mean it's a production TDX VM I guess, but yeah.
01:10:35.904 - 01:10:43.844, Speaker A: Yeah, it's, you can compare to, if I, if I assume correctly, you can compare to simulation and non simulation mode in SGX.
01:10:44.424 - 01:10:56.524, Speaker B: Yeah, we probably would need to go into the TDX documentation. Documentation and check out the msrs. And if this aligns then yeah, I would start to be convinced.
01:10:57.584 - 01:11:07.164, Speaker A: Yeah. But yeah, this is not the measurement. So the measurement part. Yeah. I still need to look into this or maybe Andrew, if he joins later he can shed some lights.
01:11:07.584 - 01:11:24.884, Speaker B: Yeah, that's true. Okay, so let's go back here. It compiled successfully, we can start it again and I don't know if that makes sense, but we can just check if our builder works as well.
01:11:28.904 - 01:11:33.124, Speaker A: I think eight gigs is not enough eventually, but. Yeah, let's see.
01:11:34.984 - 01:11:39.284, Speaker B: Yeah. Do you want to actually sync it?
01:11:39.744 - 01:12:00.454, Speaker A: Yeah, of course not. This is the next question here. So imagine now we are running them and let them sync together. Now here is the arbiter going to sync the whole stuff inside the ram, or is there anything mounted as a disk there? Like how does it look in Yocto at this point?
01:12:00.754 - 01:12:33.794, Speaker B: You only have, this is only random. So that's it? No, and Ramdisk takes, it's configured to take half of the memory available. We have a lot of memory available on this machine, so we can actually run it all in RAm. But there is, let's see. Yeah, SDA is available, but it's only, it's very small.
01:12:34.774 - 01:12:41.274, Speaker A: Interesting. Ls maybe you can run ls minus la or.
01:12:41.974 - 01:12:53.230, Speaker B: Yeah, it's small. It's very small. We can increase that, but maybe we can ask QMU to add another disk.
01:12:53.422 - 01:13:04.344, Speaker A: Okay, so I see like you have three directories with 3.9 gigs, but you just started the machine with eight gigs. Is there something here wrong or is this somehow they're sharing?
01:13:05.204 - 01:13:30.234, Speaker B: So I started the machine with 8gb of memory and ram disk. If you just mount a RAM disk by default, it will provide the half of the amount of memory as. Yeah, so that's basically what you're seeing. Whenever something is mounted as RAM disk, it's just being provided half the amount of memory.
01:13:33.254 - 01:13:38.874, Speaker A: But the sum of all of them together is much more than eight. That's what I meant, I meant. So how to interpret this?
01:13:40.734 - 01:13:47.326, Speaker B: My guess is if you put, if you, if you fill all of them, you will crash at some point.
01:13:47.350 - 01:13:48.834, Speaker A: Okay, I see.
01:13:49.854 - 01:13:53.514, Speaker B: All right, probably not crash, but you can write, you can continue writing.
01:13:53.884 - 01:14:10.544, Speaker A: Yeah. And the mounting stuff of the disk and so on is not a bit big issue, it's a QMO command. Right? Like if you want to mount a hard disk at the startup of the image or is it something in the bitbake that you can include and be part of the attestation as well?
01:14:11.044 - 01:14:26.684, Speaker B: Well there's this SDA placeholder which is part of the image itself and I don't even know if you can, you can write to this, it will change the image. We can try that. Let's try it.
01:14:36.264 - 01:14:44.368, Speaker A: But you have to do it from within. Like can't you do it in the, in the bitbake manifest file that you are creating the image with?
01:14:44.416 - 01:15:07.010, Speaker B: Like you could, but it doesn't make any sense because you want to increase the size eventually. At this point it's very small, but if you boot azure VM and give it a disk of, I don't know, two terabytes or something like that, at that point you could increase the size of SDA and the size of the second partition.
01:15:07.202 - 01:15:15.624, Speaker A: Yeah, I see. So you kind of provide a cloud init file where you can do this dynamically, this dynamic configuration after boot, right?
01:15:18.404 - 01:15:24.384, Speaker B: Yeah, I think, I'm not sure if I understood your question correctly, but I think so.
01:15:25.764 - 01:15:37.332, Speaker A: So if understood correctly you can provide cloud init within your image. So upon booting your image it does some kind of dynamic configuration for your image after booting. Yeah, I'm not sure.
01:15:37.468 - 01:15:49.558, Speaker B: Yeah, I wouldn't provide cloud in it because it's just opens a really big hole into your vm. But we can do it as part of a script, we can resize the whole thing.
01:15:49.726 - 01:16:06.810, Speaker A: Yes. This was my follow up question is how is this part, what's the cloud init is doing? Is it this dynamic configuration would be part of the attestation or probably not because it's been done afterwards. I don't know how we would, the.
01:16:06.842 - 01:16:21.494, Speaker B: Configuration of the disk image is part of the attestation because the configuration will happen as part of a script which is inside of the TCB. The script is inside of the disk and then you can attest that.
01:16:22.754 - 01:16:35.674, Speaker A: But you are testing the script, you are not testing what the script is installing afterwards, you are just testing what the script is doing but not what the real installed one are not being attested, like the version for example.
01:16:35.834 - 01:16:46.290, Speaker B: But why like what do you want to install with the script? It's a custom script that just mounts the partitions mounted and encrypt them.
01:16:46.442 - 01:17:23.288, Speaker A: You are correct. Yeah, I was thinking differently. I was using it in a different way. I'm not using yocto, I was creating images through some scripting and I wanted to do through cloud init to do the installation of my binaries and so on. And then I found out that this is not the perfect way because attestation would be basically you're just attesting that this script is installing the binaries that you want and not really what the binaries verging are and so on. But yeah, you're correct. You would use it here only for making the disk and so on and probably the encryption, disk encryption.
01:17:23.288 - 01:17:26.004, Speaker A: Maybe we should take a look at this.
01:17:29.604 - 01:18:15.132, Speaker C: I think what we should also consider is if we are doing anything dynamically on the startup or throughout the lifecycle of the VM, then, well, specifically for installing the binaries, then we should also specify the checksum of every binary that we install. If it's a third party binary and we don't compile this directly, we just include all the checksums for all the binaries that we install, let's say during the boot process so that just by looking at the provisioning script one can tell what's going to be installed. Exactly.
01:18:15.308 - 01:18:52.784, Speaker B: Well you're going to do that anyway. If you're checking, like if you're checking the ram disk, the hashtag of the ram disk, you're going to check whatever is inside. We just need to provide a way to get to that same image. And that's more like a configuration issue where you provide the whole configuration with one single command that will fetch all the different parts, compile them to an image, and if that matches up, you have the same code running.
01:18:53.444 - 01:19:40.810, Speaker A: Yes. And not to mention this process would be hard then for upgradability of the stuff. Like in case you want to upgrade your binary, that you just started your image or booted image, then it would be hard to do this in a testable way. Right. If I'm not wrong then, because then you would have to update also your dynamic configuration and probably you need to reboot the image in order to make it detestable with the new upgraded version of the binaries. So maybe you should think about this. But yeah, I was more or less thinking about using this dynamic cloud init thingy in order to do the disk encryption and using the ceiling key of the TDX.
01:19:40.810 - 01:20:24.620, Speaker A: So basically that this init file, upon booting it will be fetching the TDX ceiling key from within the TDX enclave like the TDX version machine, and then does the encryption disk encryption and also automating it in case the TDX machine gets rebooted by Azure as happened to us last weekend. Because yeah, suddenly the disk is not mounted anymore and for mounting it you would require the key again. So if we use the ceiling key of the reproducible TD module, then basically we can overcome this issue, I think, in my opinion. But yeah.
01:20:24.652 - 01:20:27.864, Speaker B: Does anyone have an idea how we can get to the ceiling key?
01:20:28.444 - 01:20:39.884, Speaker A: I think Andrew will post it. Yeah, Andrew posted something in the channel. I haven't done this yet as well, but it's also on my agenda. But yeah, it just came.
01:20:40.784 - 01:20:43.804, Speaker C: What is linky exactly.
01:20:46.944 - 01:20:49.244, Speaker A: Frieder, what do you want to take?
01:20:49.944 - 01:20:52.688, Speaker B: Please go ahead. I'm gonna create a ticket for this one.
01:20:52.856 - 01:21:48.784, Speaker A: So I haven't done it with the, with the, with the TDX yet. I know it in the GX world. So the ceiling key is the key. That's part, let's say the way where the enclave would be able to have like each enclave, based on its setup and configuration, it has a unique ceiling key. That it can use in order to seal data outside the enclave in a cryptographical way. So basically the untrusted side would not be able to inspect the data because they are encrypted with that ceiling key. And the ceiling key is only in a quotation known to the enclave itself, because based on its measurement and the way that you configured your enclave, this ceiling key is then generated upon booting the enclave.
01:21:48.784 - 01:23:09.206, Speaker A: If you want to transfer now this knowledge to the TD world, basically your reproducible TDX VM would generate, based on the way you configure it and its measurement, it can also generate a, known for it, a unique TDX seeding key that it can use potentially to do some encryption on untrusted side, which is the disk, because for the TDX, everything that is not in the memory is not considered trusted. So if you put some stuff on the disk, if your application is writing to the disk, then what's written on the disk should be encrypted. And then you would, in this case, probably you can consider either generating key pairs from within your application, like RAM memory, or you can use the TDX ceiling key, which would be reproducible, because since your image is always this measurement, and you can make sure that the TDX ceiling key is identical each time you request it with the, and the GX world, you can request it with the e get key, I think, instructions and, yeah, I hope that, I hope I was able to explain it in a, in an easy way, has been.
01:23:09.230 - 01:23:20.906, Speaker C: That if you rebuild the VM and the. Does it mean that if you rebuild the VM, it will change the encryption.
01:23:20.970 - 01:24:14.522, Speaker A: Key if you rebuild the VM and modify it, so it has different measurement? Yes, yes, yes, I think it would. Maybe here, Frieda can correct me if I'm wrong, however, ceiling, in SGX, there are two types of ceiling. You can use the measurement, the key that is extracted from the measurement. And there is another way where you can use the key that extracted from the Mister signer. So the mister signer and enclave word, all the enclaves that are signed by the same signer or measurement signer could read and decrypt this data. So yeah, either you use the unique one for each enclave, which basically based on their measurement, or you use based on the signer of those enclaves, which basically all these enclaves that are signed by the signer can decrypt these data. And in the TDX, I'm not sure.
01:24:14.522 - 01:24:22.570, Speaker A: So yeah, here Frieder is sharing a screen regarding the ceiling. Maybe they have here some description it's.
01:24:22.602 - 01:24:24.974, Speaker B: Not super obvious at this moment.
01:24:25.434 - 01:24:39.314, Speaker A: The TDX model supports sign TD's and co keys. So there they have also sign TD's and CL keys. So I assume they have also the same same to separation and TDG measurement. Get key get and.
01:24:42.374 - 01:25:01.658, Speaker C: But the point here is you don't need to supply any secret whatsoever to a VM image somehow, but it will still be able to use the encryption key based on the measurement. Measurement, yes, exactly.
01:25:01.706 - 01:25:32.184, Speaker A: This is the idea of it. So this key is not known to anyone besides the enclave itself or here in this case. In this scenario is TD VM itself. So it's not known. It cannot be leaked unless you explicitly try to leak it or you are getting attacked by some side channel attacks that was able to somehow circumvent it. But this is different topic.
01:25:34.084 - 01:26:14.484, Speaker C: Okay. I mean, I think none of us at this point understand how exactly. Well, I can understand how it would work for a single build. So you do the VMware station, but then let's say you add another binary or you just change exact one bit of something inside the VM and then that station will be different. And now the, the key, the previous key, because we have to reuse the same key for decrypting the volume. We are not going.
01:26:15.024 - 01:26:31.738, Speaker B: Yeah, at this point you're going to lose all your data, which is fine because a software update means you have to discard your existing VM and you need to restart one. And that needs to sync again.
01:26:31.906 - 01:27:01.884, Speaker A: Yes. Or there is another process which is called dcv recovery and the key rotation mechanism if you want to somehow recover your data. But yeah, as Frieder mentioned, you should consider each time you update your binary for security reasons, you should consider. Yeah, do fresh start because otherwise. Yeah, but you would be exposing it to attacks. Or.
01:27:04.624 - 01:27:08.764, Speaker C: But then this encrypted volume, what do we need it exactly for?
01:27:09.124 - 01:27:25.108, Speaker A: So in this case you would need encrypted volume in case you have a state. For example, in this case, if you are working on an archive node where the state is, I think the last of my knowledge was 2.4 or 3.3 gigs terabytes.
01:27:25.236 - 01:27:27.908, Speaker C: No, no, the archive is now twelve terabytes or something.
01:27:27.956 - 01:27:58.088, Speaker A: Or twelve terabytes. All right, so let's go for 1212 terabytes. I don't think. Yeah, starting to the XVM with twelve terabytes. Let's assume if that's feasible, twelve terabytes of ram. Putting all the states in memory is probably going to become an issue, like a scalability issue. So you would put the state in disk, but we want also to keep the states the access to this case integrity and confidentiality protected.
01:27:58.088 - 01:28:02.874, Speaker A: So in this case you would require to do an extra step which is the disk encryption.
01:28:03.034 - 01:28:07.330, Speaker C: Why do we need the state encryption?
01:28:07.362 - 01:29:14.524, Speaker A: Because. Yes, because then if you don't do the encryption, you would be making it like the x's on these and writing and reading on the state be accessible to the hypervisor or the OS or the administration. So the admin can see what you actually currently now writing into and reading from the whole time and can inspect what you are doing. And based on your access pattern and what you are doing inside there can basically infer, infer a lot of information from your current. So basically it can even if you have some proprietary algorithm that is accessing some data regularly, you don't want to show this access and writing basically because you can infer your proprietary algorithm way of what is doing and do reverse engineering potentially and be able. I know it's a hard thing to do, but still then you make it feasible if you don't do encryption and add Oram potentially in order to make it more secure or hardened for such attacks.
01:29:16.384 - 01:29:17.124, Speaker C: But.
01:29:23.564 - 01:29:37.144, Speaker A: So yeah, just adding layers of security more or less just to make the life harder for the attackers that are trying to do some malicious or curious attacks.
01:29:39.404 - 01:29:56.688, Speaker C: But will it be too much of the exposure if we not encrypt the state disk and we don't write anything to it? So only read?
01:29:56.856 - 01:30:36.658, Speaker A: Yeah, only read only. You can also conduct attacks such as basically access pattern. Each time you read the hypervisor can drop some pages from the memory tables and see each time you access it there is a page page fault and can read which exact pages you are executing regularly. And from that gain some knowledge that they should not gain. But then you can consider Orm for that. So for read only you can consider different mechanisms to defend besides encryption. In this case probably encryption is not really necessary.
01:30:36.658 - 01:31:36.558, Speaker A: If you're confident, let's state it like this. If confidentiality here is not an issue for you and integrity is anyway it's only in read only state. So you cannot write. So you would require different protection mechanisms such as Oram to defend against pattern attacks. So it's always way you have to study the requirements of your, of your application and see which scenario now is applicable for you. Like do you, do you need confidentiality here? If yes, do encryption, do you need integrity because you don't want to see to let the hypervisor inject into your state stuff, then you would also need your also encryption and probably mercury state checking inside. And do you need protection against access pattern? You would require an Oram and different mechanisms against such access pattern attacks.
01:31:36.558 - 01:32:03.306, Speaker A: There are timing attacks that were then cache timing attacks that were mitigated through micro benchmarks from intel themselves and such as like. Yeah, there are many kind of types of attacks that site trans and this would require its own session so I think that's. Yeah, that's not divert from that and sorry for taking the whole time.
01:32:03.370 - 01:32:05.850, Speaker C: No, no thank you. Thank you for the explanation.
01:32:06.002 - 01:32:20.854, Speaker B: We can like one way we could skip this is if we would patch breadth to not keep a chain history and just keep the current state. And this one we can just keep in memory. Then we don't need any disk access.
01:32:24.254 - 01:32:27.754, Speaker C: Can we just make a ram disk and say it's a disk?
01:32:28.454 - 01:32:49.354, Speaker B: Yeah, but we don't have enough memory for that. I mean we would need at least 1, we don't have enough for that. But if we only keep the state which is 500gb, we can do that. But the history will not fit in there.
01:32:50.734 - 01:32:58.634, Speaker C: But we don't need an archive node. Right. We just need the latest lock, current lock.
01:32:59.174 - 01:33:06.514, Speaker B: It's still, it's rethink configured to keep the whole chain history. And that's already 500 gigs, something like that.
01:33:07.334 - 01:33:10.314, Speaker A: I think 1.1 terabytes if I'm not wrong.
01:33:11.454 - 01:33:31.624, Speaker B: Yeah, that's the whole thing. But, but only the chain history I think is about half of that. And the rest, the other half is the state which we might be able to reduce. There's some things we can definitely improve.
01:33:32.764 - 01:33:48.604, Speaker C: Yeah. Even if you set pruning to one because by default I think it's 1000. Now if you would say we configure ret with pruning set to one.
01:33:50.424 - 01:33:52.564, Speaker B: Yeah, we can try something like that.
01:33:54.424 - 01:34:08.144, Speaker A: Did you, did you try this now for testing purposes now feeder to show like rest and our builder and the TDX machine that you just created. You wanted to show this like not syncing it, but just to show them running side by side.
01:34:09.644 - 01:34:19.784, Speaker B: Do you think it makes sense? I mean I would rather work on a script that starts them up directly. I mean we could start them and at the same time write the script.
01:34:22.564 - 01:34:40.064, Speaker A: How would we. That's a good question. How would you make now with Bitbake to add, to add commands that to run specific binaries on the startup of the machine so you don't require Ssh like we want eventually, potentially at the end to have an image without any SSh access. Right.
01:34:40.684 - 01:34:43.664, Speaker B: Yeah, let's see, let's have a look.
01:34:44.084 - 01:34:54.024, Speaker C: I think we need an init system of some kind. I was thinking about OpenRC, which is a lightweight init system.
01:34:56.224 - 01:35:24.366, Speaker B: I think we already have OpenRC, so there's already this directory and then has different nscripts and we do have it. Let me check. No, it's SySV, init sysp, bit dated.
01:35:24.510 - 01:35:29.794, Speaker C: I mean maybe it's still supported, but it's like very old.
01:35:33.614 - 01:35:35.514, Speaker B: How is it different to init RC?
01:35:42.094 - 01:35:51.454, Speaker C: I don't have an answer. I don't know. Let me just quickly check.
01:36:02.554 - 01:36:08.386, Speaker A: I mean, I mean if it fulfills the purpose, what we need it for, then it doesn't matter, right?
01:36:08.530 - 01:36:10.934, Speaker B: Yeah, I think we can just keep it for now.
01:36:13.854 - 01:36:38.874, Speaker C: Yeah, I'm just saying for the sake of security reasons, whether it's still well supported. And how much do we add to the tcp by installing CC init? But yeah, for now we definitely can get.
01:36:46.874 - 01:36:53.974, Speaker B: Okay, so it's part of the bitbake recipe.
01:37:00.754 - 01:37:08.874, Speaker C: So you want to write the startup script for ref and our builder, right?
01:37:12.854 - 01:37:28.314, Speaker B: Yeah, exactly. And yeah, I see here it's part of the, it's part of the bitback script. So let's see.
01:37:31.274 - 01:37:32.934, Speaker C: Let'S ask chat GPT.
01:37:44.114 - 01:38:07.194, Speaker B: Okay, so we need to copy this one here and then. So it's part of the install. So let's see. Yeah, so we're taking.
01:38:09.214 - 01:39:04.554, Speaker C: Does bitbake support overlaying file system? Like instead of declarative, instead of, instead of coding it as a script, we can just create a directory, a router, fs layout on your work machine so that it will just copy this skeleton onto the image. Let's say we could, instead of doing CP of the, the CCV init script, we could just place it into RC D directory and bitbake will just copy it into the resulting image.
01:39:06.334 - 01:39:25.414, Speaker B: I think we can do that, but does it make sense for me, this init script is a part of, of this rest binary. If you want to install ref, it will come with an init script and it should take care of installing the init script at the correct directory.
01:39:27.074 - 01:39:33.426, Speaker A: Where does this init script comes from? Like what? You are currently adding the cp. You're copying an init from cpu?
01:39:33.450 - 01:39:37.734, Speaker B: Yeah, we're going to add it now. We're going, it's not, it's not there yet.
01:39:38.114 - 01:39:39.018, Speaker A: Ah, okay.
01:39:39.106 - 01:39:52.874, Speaker B: Okay, see, just copying whatever we need. Like, but we actually also need this one. Yeah, in case that doesn't exist yet.
01:39:53.414 - 01:39:55.034, Speaker A: Yeah, you have to install it.
01:39:55.374 - 01:40:00.034, Speaker B: I need to install the directory and what else.
01:40:02.774 - 01:40:04.182, Speaker A: Seems to be it?
01:40:04.358 - 01:40:06.574, Speaker B: I'm wondering. This one is.
01:40:11.674 - 01:40:15.894, Speaker A: Maybe you can go to the file the updaterc t.
01:40:24.114 - 01:40:26.254, Speaker B: Okay, so we need this one as well.
01:40:26.714 - 01:40:27.854, Speaker A: What does it do?
01:40:28.914 - 01:40:35.872, Speaker B: The update RC class uses to safely install an initialization script on behalf of the package.
01:40:36.048 - 01:40:36.924, Speaker A: I see.
01:40:48.184 - 01:40:59.824, Speaker B: Okay, anything else? Yeah, this one as well.
01:41:02.324 - 01:41:03.264, Speaker A: Which one?
01:41:03.844 - 01:41:12.424, Speaker B: These two. In its inner script name and parameters, it will be started on startup.
01:41:19.844 - 01:41:23.624, Speaker A: So we are naming this init script the same as the binary itself.
01:41:25.404 - 01:41:30.820, Speaker B: Yeah, why not? You have any complaints?
01:41:31.012 - 01:41:36.224, Speaker A: It's a bit confusing. That's a, it shouldn't, it wouldn't complain I would say, but yeah.
01:41:39.764 - 01:41:41.704, Speaker B: I'm open to suggestions.
01:41:43.284 - 01:42:03.664, Speaker A: No, I was just like wondering if there were some kind of conventions like such as like I don't know, binary that ended with like bin and scripts, sc or something like this would be much more humanly readable. But this should work for now. I would say it wouldn't make much a difference, right?
01:42:04.684 - 01:42:10.584, Speaker B: No, it doesn't make any difference, but you're right. Just wondering, should I give it like breadth in it?
01:42:11.364 - 01:42:18.188, Speaker C: No, I think the convention is just to use the name of the binary, at least from what chargpity is suggesting.
01:42:18.356 - 01:42:20.284, Speaker A: Okay, interesting.
01:42:24.624 - 01:42:26.044, Speaker B: This is all the same.
01:42:26.344 - 01:42:44.004, Speaker C: Okay, so, so yogta is already kinda has all the options for creating the init script, right? So you just pass two parameters and that will create the init script for you.
01:42:44.344 - 01:42:57.034, Speaker B: No, we, no, now we need to create the end of script. That's the next step. I'm just going to copy the one I have. Sorry.
01:42:58.814 - 01:43:05.194, Speaker A: I would wonder if they have a command that creates a template in its script that you can then take and work upon.
01:43:06.534 - 01:43:07.834, Speaker B: No, I don't think so.
01:43:08.174 - 01:44:12.114, Speaker A: Okay. Sad, maybe question for later to be answered. But when doing all of this and you have now your final version of your all bitbake configuration for the whole image, it is in any way reproducible in the sense that each time you build this image, it will always be the same. Or are there components that are non deterministic that could lead to different measurement each time you build? Like, such as, I don't know, there were at some point I read somewhere that in each image there are some components that are mounted or configured inside your virtual machine that might lead to non determinism and they include some data like timestamps and such stuff. This is not the, not the case here. Is the generated image always reproducible, is always the same.
01:44:12.974 - 01:45:05.724, Speaker B: I tested this and I can confirm this, but I haven't tested it on different machines. So there might be some stuff where it's using local binaries to build like a local linker or local Cc or stuff like that. And that might change it, as far as I understand, Yocto, it shouldn't, but I've seen in the case of rust binaries that it does building rust binaries, but that's not an unofficial project. So maybe they have some different convention here. Yeah, but yeah, regards to timestamps and stuff like that, I've checked and it's, this is not the case. It's really taking out everything.
01:45:06.384 - 01:45:08.364, Speaker A: That's great. That's great to hear.
01:45:11.384 - 01:45:29.144, Speaker B: There's also, that's the script to start, start the geth node. Most of the, we don't need anything of it, so I'm just gonna. We can use these test secret keys and stuff like that. Still keep them?
01:45:30.244 - 01:46:01.404, Speaker A: Yeah. I mean, potentially you would need something similar to a. For rest, right? Like some commands are similar to rest apart and some of them are not. Should I share with you something we need, should I share with you the way where you start? Rest like which, which commands that you pass? The rest here?
01:46:01.784 - 01:46:02.524, Speaker B: Yeah.
01:46:03.624 - 01:46:05.604, Speaker A: Okay. Let me fetch them for you.
01:46:12.344 - 01:46:13.204, Speaker C: Okay.
01:46:25.724 - 01:46:27.384, Speaker A: Why should I post it for you?
01:46:28.164 - 01:46:30.944, Speaker B: I don't know yet. No idea.
01:46:32.844 - 01:46:34.584, Speaker A: I'll post it here in the chat.
01:46:35.684 - 01:46:44.082, Speaker B: Do you want to take over? I think that would be interesting if you could because. Okay.
01:46:44.218 - 01:46:45.174, Speaker A: I'm not sure.
01:46:45.754 - 01:47:03.134, Speaker B: What do you think? You want to try this? I mean, it's just basically. Well, I have a better idea. Let's first start the VM and see whether we can get Rhett starting and then we can just paste the command we're using in here.
01:47:05.434 - 01:47:10.114, Speaker A: Yes. What do you mean by command we are using?
01:47:13.534 - 01:47:19.034, Speaker C: Yeah, I mean we still need to provide some default flags.
01:47:19.974 - 01:47:33.044, Speaker A: Yeah. I shared with you the commands that you pass to the rest node if you want. Or let me, let me provide everything. Here you go. It.
01:48:59.044 - 01:49:03.716, Speaker B: There'S two. Which one is the right one? You sent two things.
01:49:03.780 - 01:49:10.144, Speaker A: The second one, because the first one was without the node command, like, okay.
01:49:12.884 - 01:49:14.184, Speaker B: This is for what?
01:49:14.724 - 01:49:16.682, Speaker A: For rests forest.
01:49:16.858 - 01:49:22.214, Speaker B: For which. For which is it Mainnet?
01:49:23.074 - 01:49:24.570, Speaker A: Yes, this is Mainnet.
01:49:24.722 - 01:49:27.214, Speaker B: Maybe can we do Halski?
01:49:27.514 - 01:49:46.194, Speaker A: For Halski? Let me check how to fetch this for Halski. I think I would tell you how to do it. 1 second. Let's just. So to run it with Halski, you just write minus, minus chain Halski.
01:49:46.974 - 01:49:47.874, Speaker B: Okay.
01:49:50.814 - 01:49:54.814, Speaker A: But probably you need a lighthouse as well. You don't have a lighthouse there?
01:49:54.974 - 01:49:59.394, Speaker B: No, we need, we need to start one somewhere.
01:50:00.254 - 01:50:01.074, Speaker A: Yep.
01:50:02.974 - 01:50:05.034, Speaker B: Somebody wants to over the task.
01:50:07.794 - 01:50:09.814, Speaker C: Can I just run it on the same node?
01:50:11.034 - 01:50:12.334, Speaker B: Yeah, sure.
01:50:16.074 - 01:50:22.454, Speaker A: So creating also a recipe for lighthouse, you mean, or what do you mean on the same node?
01:50:23.594 - 01:50:24.374, Speaker C: Yes.
01:50:24.794 - 01:50:31.770, Speaker B: I wouldn't run it inside of the VM. It's not necessary to have it there. It's bulk.
01:50:31.962 - 01:50:38.454, Speaker A: Yes, because I wouldn't. Yeah. If it's not security critical, we can keep it out.
01:50:41.994 - 01:50:47.094, Speaker C: Yeah, I can try to start it on the host.
01:50:47.834 - 01:50:50.734, Speaker A: I can keep it on the same machine though. Yeah.
01:50:54.634 - 01:50:59.274, Speaker C: I'm not sure though if VM has access to the host.
01:51:00.094 - 01:51:18.554, Speaker A: That's a good question. Is there where? There, I think. Yes. This is a Qaemo command that can open the host for it. Right. I remember recall there was a command that you passed to Qamo when you on the startup where you pass the host, like start the bridging.
01:51:19.094 - 01:51:21.262, Speaker B: I think it does have access to the host.
01:51:21.438 - 01:51:23.954, Speaker A: Yeah, yeah. To give it access to the host.
01:51:26.194 - 01:51:32.254, Speaker B: It's. Where's the gateway?
01:51:35.354 - 01:51:37.774, Speaker C: Just write ip route.
01:51:43.034 - 01:51:45.574, Speaker B: Okay, let's see if I.
01:52:13.974 - 01:52:19.384, Speaker C: There's actually already lighthouse service on the host. It just.
01:52:19.424 - 01:52:27.004, Speaker A: Yes, it's running. Is it. Let me check. Is it mainnet? Yeah, we need it for.
01:52:28.464 - 01:52:30.324, Speaker C: Okay, I will make another one.
01:52:31.144 - 01:52:39.284, Speaker A: I mean, you can reuse it. I think we can just change the. Change the configuration to run Holsky, right?
01:52:40.424 - 01:52:43.304, Speaker C: Yes, but I will, I prefer to.
01:52:43.684 - 01:53:02.116, Speaker A: Create a new one. Wait second, I think I have Holsky lighthouse there on this machine because I was doing Halski tests. Let me check. Should be there called Halsky Lighthouse or something like this under the system defiles.
01:53:02.260 - 01:53:04.424, Speaker C: Yeah, it's lighthouse. Halsky service.
01:53:04.884 - 01:53:40.504, Speaker A: Yeah. You can reuse this? I can run it? Yeah, we can immediately run that actually. But we need to change the ports to make it to the default ports because I added one to each one of them because I was running one for the vanilla Holosky and one for the SGX Holosky. So I had to add one to each port number like the local host, as you can see. I can. Let me do this for you.
01:53:43.284 - 01:53:52.864, Speaker C: Wait, but execution endpoint should be, should be referring to the rest node, right?
01:53:56.884 - 01:53:57.984, Speaker A: What do you mean?
01:53:59.224 - 01:54:04.484, Speaker C: So the lighthouse pushes the updates to the rest node?
01:54:04.864 - 01:54:12.724, Speaker A: Well, it pushes it to a specific part, if I'm not wrong. And then the light. This should be configured on the rest side. Yeah.
01:54:13.384 - 01:54:28.004, Speaker C: Yes, but then it means that the host should also have access to a VM because right now we only check. Now we only checked that VM has access to the host but not vice versa.
01:54:28.164 - 01:54:37.024, Speaker A: Yes. Let me check this. Can you show me your IP address in the VM filter so I can ping it?
01:54:37.364 - 01:54:39.504, Speaker C: Ten O 215.
01:54:42.244 - 01:54:48.184, Speaker A: 215. Now I cannot ping it from outside. From the host.
01:54:49.524 - 01:54:51.148, Speaker B: You can ping it from outside.
01:54:51.316 - 01:54:54.784, Speaker A: No, that's dropping all the packets.
01:54:56.604 - 01:54:58.424, Speaker B: Can you ssh to it?
01:54:59.324 - 01:55:16.258, Speaker A: Ssh as a root. What's the user root root at? Ten. Okay, rt already said no, I cannot ssh. So I think it's a qemo command. So what you, what you open?
01:55:16.396 - 01:55:23.834, Speaker B: Okay, 1 second. Oh, we can fix this, no problem. I just have to take the different networking solution.
01:55:24.134 - 01:55:25.514, Speaker A: Yes. Which is.
01:55:27.174 - 01:55:31.234, Speaker B: I'll have to restart the VM. Just checking if I have anything.
01:55:32.294 - 01:55:33.834, Speaker A: Yeah, no worries.
01:55:35.094 - 01:55:45.214, Speaker C: You should also expose the listening address to 100 215 on the ref.
01:55:46.314 - 01:56:12.444, Speaker A: I will, I will change the one, the light holosky instead. Like I will return them back to normal. I will remove the ones. No worries. If you recall, we added to each part, we added one prepended one. I will remove these and put them back to the original parts. So basically you wouldn't have to do any changes there.
01:56:12.864 - 01:56:13.792, Speaker B: Okay.
01:56:13.968 - 01:56:41.324, Speaker A: All right, I'm restarting the Lighthouse holoski. Okay, it started right now on the host. Yeah, it's running but we should also.
01:56:41.364 - 01:56:42.556, Speaker C: Check the execution endpoint.
01:56:42.620 - 01:56:53.864, Speaker B: Right, but I changed, so the IP address has changed. So it's now this is the IP address of the VM.
01:56:56.244 - 01:57:02.094, Speaker A: What did you do? Changes right now. Like to. In order to make it open to the outside. Did you do something different?
01:57:02.754 - 01:57:14.614, Speaker B: Yes, I used a different network device which was configured by the run qumu.
01:57:17.234 - 01:57:44.154, Speaker A: Interesting, because this is probably also important for the whole setup potentially or for the onboarding. Let me ping what you just created and see if we can reach it. Ping. I can ping it.
01:57:47.774 - 01:57:50.314, Speaker C: Are you going to change the execution endpoint?
01:57:52.594 - 01:57:58.534, Speaker A: Lighthouse holeski service where, which exit, which one exactly are you talking about?
01:57:58.914 - 01:58:04.974, Speaker C: The flag execution endpoint. It should reference the ip of the rest node.
01:58:07.594 - 01:58:29.644, Speaker A: I cannot open it because I think you are already being edited. Okay, 1 second. All right, so I'm looking at it right now. Which one? Check my execution endpoint is the localhost eight. Ah yeah, it should be the address of the. All right, let me see the address again. It was 192168.
01:58:29.644 - 01:58:46.424, Speaker A: What was the rest? 7.27.2 and then under 8551 or no, rest was different, right? Or am I wrong?
01:58:46.804 - 01:58:50.384, Speaker B: No, it's 8551. I have the config.
01:58:50.684 - 01:58:53.372, Speaker A: All right, cool. Then this should.
01:58:53.428 - 01:58:55.824, Speaker B: Oh, and you need this.
01:58:58.004 - 01:58:59.420, Speaker C: JWT secret.
01:58:59.572 - 01:59:00.304, Speaker B: Yeah.
01:59:02.684 - 01:59:06.052, Speaker A: Maybe share it in the chat and then I will change it.
01:59:06.228 - 01:59:07.224, Speaker B: 1 second.
01:59:31.304 - 01:59:35.780, Speaker A: Just to be sure those secrets are not important, right? Like these private keys.
01:59:35.932 - 01:59:40.784, Speaker B: No, they're already on GitHub. For anyone's listening, you don't have to type them down.
01:59:41.244 - 01:59:51.384, Speaker A: All right, cool, cool. Did you share with me this JVT secret somewhere?
01:59:52.124 - 01:59:53.424, Speaker B: Yeah, it's in the chat.
01:59:56.324 - 02:00:01.544, Speaker A: Okay. For some reason, my chat does not update correctly. Okay, cool. I will change it.
02:00:06.204 - 02:00:10.064, Speaker B: Let me know when you restart it and I'll give it a try.
02:00:11.804 - 02:01:33.364, Speaker A: Give me one sec just to fetch where it is being located. 1 second. I need to restart the daemon reload. I have triggered the restart command, but it's. Yeah, it should be restarted now. Jordan control, what IP address did you put for your rest? For the. You cannot use probably the localhost for the lighthouse, right?
02:01:34.224 - 02:01:43.694, Speaker B: No, for the rest, I don't need to provide the lighthouse because lighthouse connecting directly to ref. But for the R builder, we need to provide. Provide an IP address.
02:01:44.154 - 02:01:50.254, Speaker A: I see, an IP address. No, wait, second, an IP address for our builder.
02:01:51.074 - 02:01:58.894, Speaker B: No, the R builder needs an IP address for the lighthouse because it's asking for something that it needs during the block building process.
02:01:59.394 - 02:02:01.254, Speaker C: I'll check that for you.
02:02:01.954 - 02:02:06.894, Speaker B: But yeah, I don't need it right now. Is it running?
02:02:07.634 - 02:02:08.854, Speaker A: It's running, yeah.
02:02:14.774 - 02:02:17.234, Speaker B: Okay, how do we see that whether they are connected?
02:02:17.734 - 02:02:47.604, Speaker A: You open lighthouse now on the host you do journal control minus a few and you can see if they are starting to sync between each other or there are some kind of this service. Lighthouse holoski. No, no, not this one. Yeah, but it's not moving which means they're not connected yet.
02:02:52.704 - 02:02:58.884, Speaker B: It's also. It's also syncing because.
02:03:01.374 - 02:03:10.894, Speaker A: Yeah, there was before. Yes, but we started guess with it. Actually not. Right. Should I remove the databases and.
02:03:11.054 - 02:03:11.794, Speaker B: Yes.
02:03:12.214 - 02:03:15.274, Speaker A: Yeah, I'll try this. Let me see.
02:03:17.894 - 02:03:27.614, Speaker B: You can just add purge DB as an option. It's probably better because we're going to. Yeah, better add purge DB to the service. You want me to do that?
02:03:28.434 - 02:03:58.302, Speaker A: Okay, let me add this command then. Okay. Minus, minus, minus minus purge db. How? It's just minus, minus purge minus db. Or what's exact command is sS purge dB. Okay, cool. Then I will restart it.
02:03:58.302 - 02:04:27.854, Speaker A: Let me just demon reload. And now we can do journal control. Yeah, they started a new one. It's downloading a genesis state.
02:04:29.514 - 02:04:51.274, Speaker B: How big is Selesky? Like the. Not the consensus, but the execution client. Does anyone know again, how big Goleski execution client database. Like, how big is the Holeski rest database?
02:04:51.774 - 02:05:00.194, Speaker A: I'm not sure, I don't recall. You mean what type of database, if it's pebble or.
02:05:01.574 - 02:05:06.966, Speaker B: We received a port choice update. So it's working, is it?
02:05:07.070 - 02:05:11.874, Speaker A: Because for me it's still not moving the lighthouse.
02:05:14.904 - 02:05:27.604, Speaker B: If there's a fork choice update. Maybe, maybe that was before we stopped it and restarted it. Maybe that's the reason. Yeah, maybe now it's still, maybe it's still syncing.
02:05:31.504 - 02:05:56.304, Speaker A: Not sure. It stopped at info block. Production disabled. And since then not moving. But it would be interesting to know if they are connected to each other somehow. You try to ping, to ping the host from within the machine. Right.
02:05:58.364 - 02:06:02.444, Speaker C: I mean, I think it's still starting, so we just need to wait maybe.
02:06:02.484 - 02:06:20.084, Speaker A: Yeah. All right. While waiting, should we talk about the different approach in order to make this networking work for both directions other than this, or is this the solution, not what you did? Like is it a hack around or.
02:06:21.304 - 02:06:34.644, Speaker B: It'S just for, it's just for the local devnet environment. So it's just back yet. The Azure VM should work out of the box.
02:06:35.304 - 02:06:43.764, Speaker A: All right, cool. So we should. Too much effort in the networking part, if I understood you correctly.
02:06:44.424 - 02:06:46.564, Speaker B: Yeah, just executing the script.
02:06:47.024 - 02:06:47.688, Speaker A: Cool.
02:06:47.816 - 02:06:56.184, Speaker C: But then on Azure it's not going to be, I mean, we should have lighthouse running somewhere on some other vm.
02:06:57.764 - 02:06:59.504, Speaker B: Yes, yes.
02:07:01.924 - 02:07:06.504, Speaker A: Okay, now it's, now it's moving. The lighthouse is moving.
02:07:07.364 - 02:07:10.904, Speaker B: Okay. Yeah. On the rest node as well.
02:07:11.644 - 02:07:15.824, Speaker A: Cool. Yeah, they started syncing. Nice. This is nice.
02:07:17.124 - 02:07:31.834, Speaker B: So I stopped the rest node again because. Because now we want to configure the script in such way that the next time we start the VM, it would start ret automatically. Right?
02:07:33.334 - 02:07:36.314, Speaker A: Yes. So basically kind of a systemd file.
02:07:37.174 - 02:07:38.634, Speaker B: Yeah. Okay.
02:07:38.974 - 02:07:41.714, Speaker A: Can't we actually file. Sorry.
02:07:42.534 - 02:07:48.928, Speaker C: Before we move on? Actually, lighthouse cannot reach out to the rest.
02:07:48.976 - 02:07:52.004, Speaker B: Not because I stopped it again.
02:07:52.784 - 02:07:54.204, Speaker C: Okay. Okay. Sorry.
02:07:56.704 - 02:07:57.640, Speaker B: Okay.
02:07:57.832 - 02:08:09.424, Speaker A: All right, so back to the question. Is there a way to do system d file and baked image? Like to pass it inside and to be part of the image?
02:08:09.544 - 02:08:12.448, Speaker C: There is not going to be a system, dude.
02:08:12.486 - 02:08:19.972, Speaker A: Okay. There is not going to be a system d. Is there any. Something similar to system d with this vineet?
02:08:20.028 - 02:08:21.664, Speaker C: That's what we are going to use.
02:08:22.004 - 02:08:29.852, Speaker B: That's a script like the script you're seeing right now, which I'm sharing is sort of the system, the equivalent of init script.
02:08:29.908 - 02:08:43.504, Speaker A: Okay. It makes sense because you were following it with Jonah control from within the vm. So I was like assuming that this is a system d or something like this, but yeah. Cool.
02:08:47.804 - 02:09:11.884, Speaker B: Okay, so the SySV init gives us the start stop demon binary is, it's, I'm not sure if it says v init, but we have the start stop demon binary. That's usually the way you do. This is v init scripts and this is how you would start the rest node.
02:09:18.344 - 02:09:24.484, Speaker A: So this is the ns file that you have to provide for each baked binary that you want to add, right?
02:09:26.224 - 02:09:30.564, Speaker B: Yeah, sort of. We have to adapt it, but yeah.
02:09:31.704 - 02:09:41.164, Speaker A: And why you are not adding the rest name binary before the node like to execute it or where does it know that this is for rest?
02:09:41.464 - 02:09:44.484, Speaker B: It's the demon.
02:09:45.224 - 02:09:53.124, Speaker A: Ah, you are providing it up in the past. I see, sorry, in the demon. Yeah, I see, I see, I see, I see, I see, cool.
02:09:55.044 - 02:10:11.304, Speaker B: And another thing we're doing is we remounting the temp fs. Normally you do 50%, but we want 90% so we have more headroom for increasing.
02:10:11.884 - 02:10:12.780, Speaker A: You are mounting this.
02:10:12.812 - 02:10:24.484, Speaker B: Normally the temp fs only provides you with 50% of the memory and we don't, we want probably more than 90%. But now for testing. It's okay.
02:10:24.644 - 02:10:25.384, Speaker A: Yeah.
02:10:29.044 - 02:10:34.900, Speaker B: Anything else? Yes.
02:10:34.932 - 02:10:48.574, Speaker C: So are these the commands, this mount and. Yeah, this echo is important because we are doing, if you're going to do it is a start.
02:10:50.114 - 02:10:58.370, Speaker A: Yeah, yeah. I would assume also like to be not mounting the 90% of the next 90%. Imagine.
02:10:58.402 - 02:11:05.014, Speaker B: No, it's. Did you repeat the question? I'm not sure if I understood correctly.
02:11:06.354 - 02:11:19.868, Speaker A: If the commands that are being executed are then potent. So it means like if you run remount, it's not remounting the night h 290 percent of the previous 90% that you already remounted, is that correct? What you mean? Yeah, artyom.
02:11:19.996 - 02:11:31.424, Speaker C: Yeah, yeah. Because with this type of scripts, we should be careful not to introduce any side effects into the start command.
02:11:32.284 - 02:11:42.804, Speaker B: No, it's taking the whole size of the memory and then it taking a 90% chunk of the whole memory.
02:11:43.904 - 02:11:46.244, Speaker A: So yeah, item potent. Cool.
02:11:47.744 - 02:12:26.852, Speaker B: And actually, what I said earlier, if you have multiple tempo fests which are mounted with 50% and they are all getting written full, it's not good. Like if you're lucky, you just cannot continue writing, but most likely you're just going to crash the system because what will the system do? The memory is getting full and doesn't know how to, how to deal with it. Right. So there's something that we should maybe take care of. I don't know how, but is there.
02:12:26.868 - 02:12:35.824, Speaker A: A way to enable swapping in this case? Like if also the VM, if it over exceeds that, does swap, like is there a flag for swapping.
02:12:38.724 - 02:12:43.252, Speaker B: No, I haven't enabled swapping yet and I would be careful to do it anyway.
02:12:43.308 - 02:12:50.704, Speaker A: Yes, of course. But in general, like does the Yocto images allow or is this not really Yocto related issue?
02:12:51.444 - 02:13:19.494, Speaker B: I think there's not yocto related issue, but you need to configure it somehow. Swapping, I mean it's just, you can write a script, just need to swap on binaries which you might have. Yeah, it's come, it comes as part of, probably comes as part of is it busy box? Maybe probably busy box.
02:13:22.074 - 02:13:27.154, Speaker A: Where is, where is or which one of the two so would work.
02:13:29.054 - 02:13:31.754, Speaker B: It's not, I can't find, I used it.
02:13:32.334 - 02:13:36.114, Speaker A: Can you use which, which you used to which.
02:13:39.694 - 02:13:47.102, Speaker B: Okay, yeah, busybox.
02:13:47.238 - 02:13:57.894, Speaker A: Busybox. Can you give a short introduction of what Busybox is for the people who are not familiar with Busybox?
02:13:58.834 - 02:15:09.062, Speaker B: So Busybox provides you with most of the, like most of the very common tools you would want to have in a Linux system, like for example the swap on, but also copy and a shell and stuff like that. And it does so by providing one single binary. And all of the different commands are inside this busybox and it will automatically detect how you executed it. So if I run swap on, it will look inside this binary, it will realize, okay, I've been started using swapon and then it will direct to the code that's defined as swapon. So you have one single binary that provides a lot of different commands like copy move, a shell, but also swapon and other important Linux stuff. I think we will most likely also use it. I mean it's not necessary.
02:15:09.062 - 02:15:22.504, Speaker B: Eventually we could skip needing a shell and busy box. We could just start the R builder directly, but we're still in development phase.
02:15:28.564 - 02:16:13.524, Speaker A: Thanks for the explanation. Yeah, probably all of these unnecessary tools later for the production ready image would be removed, so would be interesting to see. But we would still be needing somehow a way where we can do health checks if the image that we just deploy is really running the binaries, because since we don't have any potential access sh. Access into it and so on, how would you be making sure that the rest that you ran or any, any third party binary is actually running and not crashing in a loop or something?
02:16:16.104 - 02:16:18.632, Speaker C: We just need to ship the locks somewhere.
02:16:18.688 - 02:16:20.088, Speaker B: Yeah, yeah.
02:16:20.176 - 02:16:35.682, Speaker A: So the locks which should be also somehow sanitized in such a way not exposing too much critical data. This is also next topic that should be put in mind.
02:16:35.818 - 02:16:39.426, Speaker C: I remember we just agreed to delay the logs for a few minutes.
02:16:39.610 - 02:17:03.674, Speaker A: Yeah, in this use case scenario, delaying the logs would be basically because then sooner or later they will become public anyway. But for. I mean, in general, like for a general use case where we are discussing running third party binaries in a. In a te way, sandboxed, then we should figure out a way how to do the logging, not to log everything.
02:17:06.374 - 02:17:10.714, Speaker B: Yeah. Okay. So it's working.
02:17:12.934 - 02:17:14.154, Speaker C: On the first try.
02:17:14.974 - 02:17:16.274, Speaker B: On the first try.
02:17:19.673 - 02:17:20.453, Speaker A: Sick.
02:17:23.593 - 02:17:28.313, Speaker B: Okay, I have to take a five minute break. Five to ten minutes. Is that okay?
02:17:28.473 - 02:17:34.385, Speaker A: We can. We can make a break. You can stop it, and then we can continue after lunch if you want, if all of you agree.
02:17:34.569 - 02:17:36.937, Speaker C: Yeah. I also would like to have lunch.
02:17:37.105 - 02:17:37.973, Speaker A: Me, too.
02:17:38.633 - 02:17:43.453, Speaker B: So then let's make a bigger break. Like, what do you say? Half an hour?
02:17:43.793 - 02:17:47.733, Speaker A: Yes. Still three. We can resume if you are all okay with this.
02:17:49.013 - 02:17:55.125, Speaker B: How do you do that? Like, what are we going to do with the recording?
02:17:55.309 - 02:18:11.593, Speaker A: So I assume that if we go out now, it will close. So if we all ditch the meeting, it will turn shut down. And then we have to contact again Fred to start a new session for us. So probably it's going to be two sessions.
02:18:12.733 - 02:18:13.437, Speaker C: I can.
02:18:13.565 - 02:18:14.103, Speaker A: Part two.
02:18:14.173 - 02:18:20.084, Speaker C: I can just stay here so that we don't restart the session. And I mean, me too.
02:18:20.124 - 02:18:21.784, Speaker A: I can also stay here and just.
02:18:22.244 - 02:18:23.944, Speaker B: Stay because I have the.
02:18:25.684 - 02:18:40.963, Speaker C: Okay, can we just like put a banner, like, we will be back in 40 minutes and just.
02:18:41.863 - 02:18:51.683, Speaker A: Or maybe Frieder, once you do the pause, you can share screen with one image. Yeah, exactly. Say we are coming back at 15.
02:18:56.383 - 02:18:58.683, Speaker B: Okay. Where the heck.
02:19:03.343 - 02:19:05.944, Speaker A: See you later. It.
03:01:48.004 - 03:01:49.544, Speaker B: Mythos. Can you hear me?
03:01:57.644 - 03:01:59.024, Speaker A: Is anyone back?
03:02:01.764 - 03:02:02.596, Speaker B: Yeah.
03:02:02.780 - 03:02:14.174, Speaker A: Oh, yeah. Nice. I see some drawers. Owings.
03:02:18.754 - 03:02:34.654, Speaker B: I think we're just waiting for our team. Maybe Andrew. I see that Andrew has joined, but I can't. There's no microphone sign with him, so he might not be locked in yet.
03:02:35.914 - 03:02:44.164, Speaker A: Interesting. I mean, I don't see microphone beside me. And you as well, probably. He's just not muted.
03:02:46.864 - 03:02:52.004, Speaker B: Okay. I do see a microphone side on your side, so.
03:02:52.304 - 03:02:56.644, Speaker A: Interesting. Okay, then he's just a listener.
03:03:00.104 - 03:03:24.224, Speaker B: I mean, we can. Maybe we should wait a few more minutes. Maybe somebody wants to. Sure. But I'll take the time to introduce Miltos. So really nice that he can join Miltos. He's a friend of mine and he's actually.
03:03:24.224 - 03:03:59.284, Speaker B: I would even call him a Yocto expert. He's been working on Yocto stuff professionally, and I told him that we're doing some work on Yocto. And he said he can have a look at running or compiling the rust binaries with Yocto so we don't have to have this additional step that we just implemented of compiling the binaries outside and then putting them into the built image already in compiled state.
03:04:00.544 - 03:04:14.444, Speaker A: I have a question here. What difference does it make if you let Yakutou do the compiling or you just do it on a separate way and script it just to put the final binary there. Is there a big difference?
03:04:15.624 - 03:05:19.874, Speaker B: Well, the end result, there's not really a big difference, but it does make a big huge devx difference. If you compile it outside, put it back inside, and then also the reproducibility part of it. We have to figure out how we can reproduce the binaries in a deterministic way. With the October, I believe with Yocto, I mean, it comes with like if you compile a Yocto image, it doesn't only compile the, I think it doesn't only compile the dependencies which go inside of the image, but it compiles the whole dependency tree. So it also compiles the stuff that needs, that you need for compilation. That's why you get reproducibility so easily. You basically, you have a very deterministic build system from the start.
03:05:19.874 - 03:06:05.584, Speaker B: So that would be really nice to have rust working there as well. Yeah, but again, this rust bin project, this layer which we're using right now, it's not an official layer, and they're doing some stuff differently. Like they're taking the C compiler from the host system, which I would expect not to do in any case, because that really destroys the reproducibility of the whole process because I mean, everyone uses a different host system and everyone has a different C compiler there. So this is what I'd be concerned about.
03:06:05.904 - 03:06:23.256, Speaker A: Is there a way we can dockerize this process completely? Like shift this Yocto building stuff to a docker image, and then basically it will be then reproducible because everyone will be running the same env.
03:06:23.360 - 03:06:35.020, Speaker B: In this case, yeah, there is a Yocto images that I think there's some Yocto Docker images so we don't have to build it ourselves.
03:06:35.212 - 03:07:28.522, Speaker A: That's great. I mean, this is a step forward to reproducibility, I would say. But yeah, as you mentioned. Now I'm interested in the question. So you mentioned that the octo baking, the dependencies, the treat of dependencies from the root till like down, does this mean like these dependencies are potentially diversioning, they are taking some kind of information from the host that is compiling them that might affect the reproducibility in this case. So for example, I can give you an example when for example, yogto is compiling some rust code using cargo, I would assume, or maybe not, maybe you can correct me here, but if they are using cargo in the background, cargo is actually using some kind of host versions of the dependencies that are currently installed and so on. Yada yada.
03:07:28.522 - 03:07:40.738, Speaker A: Does this mean this is the same for Yokto or is it, are you defining the versioning as well before you are compiling your rust binary there, for example, I.
03:07:40.786 - 03:07:43.410, Speaker B: Sorry, I couldn't follow your. Yes.
03:07:43.482 - 03:08:00.336, Speaker A: So yeah, the main question is here, are we defining specific versionings for the dependencies? Yocto is building the tree of dependencies. So for each dependency we are specifying the version.
03:08:00.480 - 03:08:03.004, Speaker B: Yes, that's exactly how it works.
03:08:03.384 - 03:08:16.484, Speaker A: Okay, cool. Then this should be easy. Interesting.
03:08:20.244 - 03:08:24.544, Speaker B: Miltus, I can see that you're trying to say something, but I don't hear you.
03:08:25.484 - 03:08:46.134, Speaker A: Your mic is not connected. You still can't hear you. Maybe you should select the right microphone. If you click on the little arrow on.
03:08:47.274 - 03:09:31.834, Speaker B: Yes, maybe if I can, I'll make you a co host. Maybe now it works. Can you try again? No, doesn't work, sorry. Okay, well, we'll see if you can get your microphone problems fixed. Yeah. So where should we continue? Should we just continue or should we give a small update? I don't know.
03:09:33.254 - 03:09:43.514, Speaker A: So the current state is we, you can give a short brief of what we achieved so far and then we can continue from there, I would say.
03:09:44.614 - 03:11:06.834, Speaker B: Okay, so yeah, currently the point where we're currently at is that we've managed to include ref and the r builder within the VM image. It's running locally on Qemu right now. And we've written a script that, a startup script, an init script that starts up breadth. And as you can see here now this is within the image, it's live syncing right now, the holeski chain. I think the next step, which is probably not that difficult, is to, oh, actually maybe it's more difficult, but the next step is to start our builder as well as part of an init script. And then we start the image, basically rest and our builder will start to sync automatically. But I think for our builder it's going to be a bit more difficult because we need to add a lot of different private stuff like the private keys.
03:11:06.834 - 03:12:35.304, Speaker B: And we also need to connect to the beacon node, which in this case we don't because the beacon node connects to rest, but our builder needs to connect to the beacon node. That's the other way around. So we need to provide it with an IP address. So that's more of the in depth state, I think the general state that we're currently at. We're trying to build a reproducible VM image with Yocto that we can then run within a confidential VM, which is currently we're using TDX as a technology and we want to have that reproducible because we want to be able to use remote attestation and prove to our users that we're actually running this code inside our vm and it's confidential. So you want to provide them with integrity guarantees that we're running this kind of code like the rest and the builder. And we want to also provide them with confidentiality guarantees that if they want to send private bundles to our builder, like private transactions, then these transactions would stay confidential and be processed within this confidential VM as part of the build process and only be released the moment the block has been sent to the relay.
03:12:35.304 - 03:13:03.044, Speaker B: I think that's a, yeah. So I'm giving an in depth and a very top level explanation. So yeah, let's, let's see if we can apply this to the r builder or do you have any other suggestions? I mean there is, there was other topics that we could have a look at.
03:13:07.554 - 03:13:33.674, Speaker C: Are we going to be able to run our builder because it will require some private keys and well, even if we able to run this, it will not produce blocks probably.
03:13:36.414 - 03:13:49.434, Speaker A: I mean for the current run we don't want it to produce blocks because we still need to sync it completely. But I would say for regarding the keys, we can generate them on spot like we can generate now some dummy keys, which is not a big issue.
03:13:51.974 - 03:14:46.874, Speaker B: I would give them as a, as an HTTP service because that's actually how cloud, and it works. At least for Azure you have an HTTP service outside of the vm. Only the VM can access that. And this HTTP service will provide you with JSON or multiple JSON config files or other kind of config files. And the cloud in it would be basically then set up the VM based on these configurations and the configurations we can supply while deploying the image on Azure. We can basically just write a script that parses a JSON object and takes whatever private or whatever secrets we need and it's done up the builder.
03:14:48.334 - 03:15:10.278, Speaker A: Can't we generate these secrets based on the ceiling key? Like for example, we use the ceiling key from within the d VM through like a cloud init, for example, script such that it uses this as a, as a parent root seed. And then we can extract whatever keys we need based from it.
03:15:10.406 - 03:15:11.834, Speaker B: We don't have the ceiling key.
03:15:12.354 - 03:15:23.146, Speaker A: Yes, exactly. I mean the final, final version would be that. Right? Like the final way. We don't want to rely on any unprotected ways of creating key pairs.
03:15:23.210 - 03:16:23.014, Speaker B: Well, I'm kind of, I'm hesitant because I mean these are, these are builder keys and so that's basically a way to publicly identify them. Also on the relay side, if we use some that are based on that specific state of the VM, then whenever we update or we choose to run a builder on a different, on a different cpu, then we'll have to, we'll basically get a different set of keys. So I would probably in the end, we also need to provide different secrets, like the auth RPC secret for connecting to the beacon. And we definitely need to provide that. We can create that on the fly or we can, but we need to somehow read it from the VM image. We nicer to use something static.
03:16:23.754 - 03:16:33.944, Speaker A: I see. I understand. The question is how to embed those secrets such a testable way and make sure that they are not leaked in the process. That is hard part.
03:16:38.324 - 03:16:54.060, Speaker C: I think we were going to use secret storage, either some cloud secret storage or vault which is hosted on our site for keeping such secrets.
03:16:54.212 - 03:17:29.764, Speaker B: The secrets we don't like, we don't need to protect these secrets from ourselves. We know these secrets and even if we provide them to the VM, we're not, we're not messing with the integrity of the VM or stuff like that. It's basically private keys that the builder will use to sign messages and stuff like that. It will still be, it will still attest to others that it's running within a TDX. So I don't think there's an issue here.
03:17:29.924 - 03:17:38.364, Speaker A: Yeah, makes sense. It only has to do somehow, like authentication that the VM doesn't take these keys from anyone, it's just from us. Because otherwise.
03:17:38.524 - 03:17:39.464, Speaker B: Exactly.
03:17:41.204 - 03:17:46.024, Speaker A: But yeah, I agree. We can do this since our keys are ours in this case. Yeah.
03:17:50.024 - 03:18:08.160, Speaker C: Okay, so let's make an init script for our builder. I can unwrap the config from our existing host and we can just put this into our init script and then regenerate the keys.
03:18:08.312 - 03:18:40.074, Speaker B: Yeah, let's do that. By the way, it's live syncing in progress and it's saying remaining blocks of one. Why is it, and this is since quite a while only one remaining block, does that mean. No, it's still syncing. So it's still live syncing. It's not synced yet?
03:18:40.974 - 03:18:55.354, Speaker A: No. I think in order to follow it completely, you can follow it on the host running, like seeing the holiski. What it's doing the lighthouse. Let me see, because there you will see more information.
03:19:00.494 - 03:19:06.734, Speaker B: It has only used three megabytes of storage yet, so there's something wrong.
03:19:08.034 - 03:19:39.230, Speaker A: So on the holiski side, it says it requires one day and 11 hours estimated time to completely sync. And the speed is eight slots per second. And it's moving slowly. So I would assume it's some kind of network bottleneck. In this case, no.
03:19:39.262 - 03:19:52.634, Speaker B: But this is for, this is for the beacon mat. Yes, the beacon client. What it does if you.
03:19:54.314 - 03:20:02.106, Speaker A: But it relies on the, on the execution layer in order to. Execution client like the rest, in order to progress. Right?
03:20:02.290 - 03:20:54.014, Speaker B: Yeah, but we already checkpoint synced to be compliant. So we gave it a checkpoint and it synced from that checkpoint to the head. And now it's applying, and now what it's doing in the background, it's syncing the whole thing. But it kind of already trusts the head. So this is just like a way to verify whether or not it should really trust the head. So if it eventually find out this doesn't match up, it would probably break my guess, at least my guess, but it's already communicating and sending beacon stuff updates for choice updates.
03:20:55.434 - 03:20:56.174, Speaker A: Yes.
03:20:58.074 - 03:21:07.614, Speaker B: What I'm, what I'm curious is why, why is it only, why is the memory only 2.9 megabytes?
03:21:08.994 - 03:21:20.194, Speaker A: Interesting. Is this part of your rest configuration that you're running it with? Like, is this putting the state there? Yeah.
03:21:38.474 - 03:21:43.986, Speaker B: Oh, it's interesting. Now here it says it's 4gb, but.
03:21:44.010 - 03:21:47.734, Speaker A: Maybe it already used the half.
03:21:52.834 - 03:21:53.170, Speaker B: Of.
03:21:53.202 - 03:21:55.266, Speaker A: Your ram that you already passed.
03:21:55.410 - 03:21:58.898, Speaker B: No, I increased, I increased them. I increased the ram.
03:21:59.066 - 03:22:00.094, Speaker A: Oh, okay.
03:22:13.534 - 03:22:18.314, Speaker B: But maybe that's a sparse file. You know how I can check sparse files?
03:22:22.534 - 03:22:24.794, Speaker A: What do you mean again?
03:22:28.304 - 03:22:40.044, Speaker B: The sparse file is a file where you say it's this big, but it's only taking part of, part of the file spaces, disk space.
03:22:42.264 - 03:22:45.752, Speaker A: It reserves the space, but it's not actually using it for fully. Yeah.
03:22:45.888 - 03:22:53.448, Speaker B: And actually I'm seeing it here because on this side it's only saying 1.8 megabytes and here it's a sparse file.
03:22:53.616 - 03:22:54.364, Speaker A: Yeah.
03:22:54.914 - 03:23:08.254, Speaker B: Okay. Yeah. I don't know. Do we want to investigate this further or should we just leave that for another moment?
03:23:09.194 - 03:23:12.774, Speaker A: Would it be a blocker for the next one? For the next task.
03:23:13.394 - 03:23:17.134, Speaker B: No, we can start the builder anyway. We'll just not be able to build.
03:23:17.434 - 03:23:22.814, Speaker A: Yeah. And that's anyway because we need to sync completely. Right. In order to be able to build.
03:23:23.314 - 03:23:25.134, Speaker B: Okay, let's.
03:23:30.874 - 03:23:33.414, Speaker A: I don't think we will be building any time soon.
03:23:36.394 - 03:23:37.374, Speaker B: Okay.
03:23:39.714 - 03:23:42.650, Speaker A: How much did you increase the memory size of this vm?
03:23:42.722 - 03:23:45.614, Speaker B: Just in 128 gigs.
03:23:45.954 - 03:24:20.010, Speaker A: I think this will be fitting for Holoski, I think because it was 18. Two gigs. Right. State something in that direction. I still have the data. Yeah. 107 gigs.
03:24:20.010 - 03:24:27.494, Speaker A: The vanilla Holiski state plus the chain data a month ago.
03:24:30.594 - 03:24:31.494, Speaker B: How much?
03:24:32.314 - 03:25:23.774, Speaker A: 107 gigs. That was to the time when I was doing experiments. So it should fit. So we're now copying the bitbake manifest for rbuilder. Right. And init as well.
03:25:25.234 - 03:25:53.236, Speaker B: Yeah. So this for the r builder. I just copied the red one. It should do the same. And I just replaced Reth with our builder. Let's have a look at the inner script. Yeah.
03:25:53.236 - 03:26:21.524, Speaker B: We can just replace here as well. Sorry. Don't really need remounting because that's. No, we don't need this one. We also don't need the JWT hex because it's not part of. We need secrets and we need these. Yes.
03:26:24.034 - 03:26:25.974, Speaker A: You mainly need three secrets.
03:26:33.394 - 03:26:34.134, Speaker B: Three?
03:26:35.114 - 03:26:47.874, Speaker A: Yes. It was relay secret key, optimistic relay secret key and coinbase secret key for the wallet that signs the transfer.
03:26:47.914 - 03:26:51.164, Speaker B: We don't need. We don't need. It would work without it.
03:26:51.944 - 03:26:52.804, Speaker A: Okay.
03:26:55.944 - 03:26:56.724, Speaker B: Yeah.
03:26:58.464 - 03:27:03.004, Speaker A: It should be named not rest. Right. It should be. Our builder provides our builder.
03:27:03.464 - 03:27:04.484, Speaker B: That's true.
03:27:12.064 - 03:27:27.408, Speaker A: And then description should be arbuilder. It's not really node. Right. Builder. R builder. Builder. Yes.
03:27:27.408 - 03:27:40.804, Speaker A: Rossbuilder. Yeah. Should I fetch for you the commands to start this?
03:27:41.604 - 03:27:43.508, Speaker C: I already pasted in the chat.
03:27:43.676 - 03:27:47.464, Speaker A: Oh, okay. That's cool.
03:27:49.964 - 03:27:55.384, Speaker C: And I'm now preparing the config file.
03:27:56.124 - 03:28:20.048, Speaker A: Yeah. The config file should be copied in at the startup. This is also an interesting question. How do you do in a bit big copying file from, from the current setup that you're creating inside the virtual machine to be put in a specific path like mounting a specific file to the, to the image? Is there, is there such a way to do this?
03:28:20.216 - 03:28:23.560, Speaker B: Sorry, I really didn't understand your question. Could you rephrase?
03:28:23.752 - 03:28:40.788, Speaker A: Okay, so if I have a config file that I need to start my binary that I gave you to put inside the image, how would you mount that file inside that image or not really mount, copy it. And how would you bake it inside?
03:28:40.876 - 03:28:52.264, Speaker B: Can we copy it like the init file just. Yeah, can we do that? Or is there something all static or is there something we need to.
03:28:52.564 - 03:29:02.588, Speaker A: You have to pass that like as a start execution for your binary. For example, when you run proprietary binary and the first command should be the path to that configuration file.
03:29:02.636 - 03:29:07.344, Speaker B: Yeah, I understand. But the config itself, is it static or do we need to change stuff?
03:29:07.724 - 03:29:21.148, Speaker A: It takes. No, it's static so far, but it takes stuff from the environment variables. For example, if you have some environment variables, let's say relay secret key in the environment, it reads it from there.
03:29:21.316 - 03:29:27.244, Speaker B: Okay, that's cool. No problem. Yeah. Then we can just static one and we just copy it over like the init file.
03:29:28.344 - 03:29:40.024, Speaker A: Okay, where do we do the copy of init file? It's in the different. It's here actually. Should be here somewhere. The copying or not.
03:29:40.184 - 03:29:48.896, Speaker B: No, I mean we. It will be part of the. I'll show you. 1 second.
03:29:49.040 - 03:29:52.624, Speaker A: Yeah, yeah, this is the init file. So all good.
03:29:56.804 - 03:30:00.164, Speaker B: Config. I mean config, exactly.
03:30:00.204 - 03:30:01.024, Speaker A: You have to.
03:30:01.604 - 03:30:06.812, Speaker B: Etc. Config, something like that.
03:30:06.988 - 03:30:10.864, Speaker A: Yeah, exactly. All right, so we change this.
03:30:12.204 - 03:30:27.514, Speaker C: Well I just shared with you a config. Can you. In the DM. In the in slug DM. Can you please check if there is no sensitive info in it? Cleaned it up, but maybe I left out something.
03:30:27.974 - 03:30:47.324, Speaker A: Yeah, let me quickly scan it. Are you passing the right relay? Flashbuster relay for. Are we going to use this relay? No, this is relay mainnet. We should probably reuse the different relay for the configuration, but the rest looks.
03:30:47.824 - 03:30:51.324, Speaker C: Do we have even a relay for the testnets?
03:30:53.064 - 03:30:57.004, Speaker A: No, in general, like we cannot send to the. To the mainnet relay. Right?
03:30:57.744 - 03:31:01.832, Speaker C: Yes, but I mean do we, do we have a relay for the testnets?
03:31:02.008 - 03:31:07.644, Speaker A: Good question. Frida, are you aware of flashbots will provide relay for Haldesky? I think should.
03:31:08.604 - 03:31:09.384, Speaker B: Yeah.
03:31:12.004 - 03:31:37.284, Speaker A: Let me check if we have a relay. I found it. I will send it to you in the chat. Or this is the one. Or at least think so. The address is on top.
03:31:38.384 - 03:31:39.284, Speaker C: Okay.
03:31:40.104 - 03:31:44.084, Speaker A: We can change it, you can edit it in place and then.
03:31:44.584 - 03:31:55.844, Speaker C: Yeah. And other than that is this is bundle mergeable signers. That's the public key, right?
03:31:56.184 - 03:32:11.424, Speaker A: Yes. I see. We are using all the builders. Yeah, we can reduce the builders. We can only use one or the first two, but we can keep them, it's not a big issue. And the rest is. Yeah, the effect list.
03:32:11.424 - 03:32:49.694, Speaker A: We should provide also the effect list. Somehow we copied and similar to what we are doing. Yes. We need to rework this because the configuration file fritter, it includes passes to other files that are potentially read by the arbuilder during initialization step, such as the OFAC file. It says like read it from, for example, backslash mount, backslash arbuilder, backslash off backlist. And we should probably have such path as either this or we.
03:32:49.774 - 03:32:55.134, Speaker B: What about, do we have a, can we provide a URL?
03:32:56.394 - 03:33:04.254, Speaker A: No, that would be great actually. So we don't have to do this manually every time actually. But maybe we should.
03:33:04.994 - 03:33:16.730, Speaker B: Why isn't there a URL yet? I mean, there must be a reason. It would be much nicer to have it URL so you never have to reconfigure it.
03:33:16.882 - 03:33:32.522, Speaker A: Yes, actually this is a good point. I was discussing this earlier that we should automate this process and it was deprioritized due to the operationalizing the TDX first. But this should be now on our agenda. I think I have a question.
03:33:32.698 - 03:33:35.074, Speaker C: Can we, can we just do this in dry run?
03:33:35.154 - 03:33:37.294, Speaker B: That was also very useful, right.
03:33:37.634 - 03:33:39.854, Speaker C: And we don't have to worry about any of this.
03:33:41.474 - 03:33:45.354, Speaker B: Sorry, I didn't get there, was artistically hard to understand you.
03:33:45.654 - 03:33:46.198, Speaker A: Sorry.
03:33:46.286 - 03:33:48.594, Speaker C: We can also use the dry run mode.
03:33:50.054 - 03:33:50.994, Speaker B: Dry run?
03:33:51.334 - 03:33:57.674, Speaker A: Yeah, for now. You mean for the arbolar dry run.
03:33:58.014 - 03:34:00.782, Speaker C: Yeah, and also there's no effect for Haloski.
03:34:00.838 - 03:34:17.574, Speaker A: You know, it's true, there is no effect for Haloski because we are discussing this like for the final, final build. So potentially we need the OFAC somehow to be inside the bitbig. All right, that's a good point. We can do it in try run for now.
03:34:20.314 - 03:34:22.978, Speaker C: But we still need a config, right? Or not?
03:34:23.106 - 03:34:55.054, Speaker A: Yes, sure, sure. Our builder won't start without config, but you can pass a parameter in the config to put it in dry run mode. As you can see, it's false. You can set it to true. And. Yeah, and the dry run validation URL, as you can see, there are some parameters there that are targeting localhost and such stuff. Maybe we can comment these out for now with the dry run.
03:34:55.054 - 03:34:56.394, Speaker A: You don't need them anyway.
03:34:57.894 - 03:34:59.874, Speaker C: Dry run validation URL, you mean.
03:35:00.234 - 03:35:20.974, Speaker A: Yes, yeah, this is another point, frieder. Some parameters inside the config, if I'm not wrong, that are specifying addresses and ports, in this case, for example, the consensus layer node address.
03:35:21.474 - 03:35:31.074, Speaker B: The config file can take environment variables, right? So we can just replace them by some kind of environment variable and then we'll.
03:35:33.134 - 03:35:53.154, Speaker A: Yeah, they have to be of course implemented in the parser inside our builder, our builder so far, if I recall correctly, from the, from the diff, the reading from the environment, I think yes, it should be working as well. But we should be double checking with Vitaly regarding this for the addresses and ports.
03:35:53.754 - 03:35:54.642, Speaker B: Okay.
03:35:54.818 - 03:36:22.914, Speaker A: Because so far I know it's like this environment. Files inside the config are for the secret keys that you have, this schema of writing and double point, like a column and the name. But yeah, you're right. If you can do this as an environment variable, then this is solved as well. These are all good points.
03:36:25.734 - 03:36:55.146, Speaker B: Okay, so I've modified the script to include the rbuilder config. It will install this under etc builder dot config. Same with of JSON. Install the file under our builder of JSON. And then where do you see ADC that says conf.
03:36:55.210 - 03:36:58.534, Speaker A: Dear, I thought the D is user.
03:37:00.954 - 03:37:31.936, Speaker B: Apparently not. Miltos. Have you fixed your, your mic yet? Maybe we can ask you a question. Yes. Can you explain to us why what? Why is it a d in front of this is configure? I imagine maybe D is root, like the first slash. The D is the new system. So the final systrote of the system.
03:37:31.936 - 03:38:11.046, Speaker B: So in that case, if you are for example, building an image, then that would be. But you can actually print all of those stuff. Let me, if you, I think do. Wait a second. Okay, so maybe just for me to try to understand this. So D is basically the directory of the final sys route, but during the build, during build time. So the is basically the whole path, which is like home freedr, home user, freezer, pokey, and so on until it gets to the final build path.
03:38:11.046 - 03:38:47.314, Speaker B: And so it's copying it into this route. Yes, you are in the correct direction. So you can actually do bitpeak minus e. Can you actually run bitpig? Yeah, you can actually run bitpig then you can. Yeah, bitpig minus e, the recipe, the rest, I don't know which recipe. And then pipe grip or air builder. Yes, and then pipe grep.
03:38:47.314 - 03:39:16.568, Speaker B: And then grep, the thing that you would like to see. In that case, maybe not d because you're gonna spit out a lot of stuff, but maybe it had another variable inside there. So it was syst. Or you can just save the output in a log file and then open it with Vim and then actually do a search so that you can actually, I will do it in that way so that you can actually see what is the values of all of this stuff. So just not pipe it then maybe save it.
03:39:16.656 - 03:39:17.224, Speaker A: Or less.
03:39:17.264 - 03:39:55.032, Speaker B: That's a good point. And yeah, okay, I've not finished my. I'll have to do a few fixes. Yeah, funny enough, I can also, I cannot also do it here myself because I also broke something. Otherwise I would have done it to tell you the exact value. But yeah, all of these values are because we say this is truth of your final image. But this image is under a specific path in your, in your installation.
03:39:55.032 - 03:40:40.404, Speaker B: So this just gets replaced by a huge path, actually. So this, this looks correct. Right. And now I can. 1 second, I wanted to, I wanted to open. We need now to find where it's exactly getting replaced. Yeah.
03:40:40.404 - 03:40:48.240, Speaker B: Okay. Does everybody. So there you see the native. Not the native.
03:40:48.312 - 03:40:48.536, Speaker A: Yeah.
03:40:48.560 - 03:41:15.284, Speaker B: So the native is from your PC. But long story short, you can just bitpeg e and I also try to save this file into an environment. Punct sh. And then I actually open it with my editor and then I really just search the word that I want and then you can really see the value that it gets during build. Yes, yes. Yeah. Export d.
03:41:15.284 - 03:41:18.024, Speaker B: Or in that case.
03:41:21.444 - 03:41:21.756, Speaker C: Does.
03:41:21.780 - 03:41:31.602, Speaker A: This mean that it takes for every, for every configuration has a different value for the d? Or what does this mean then?
03:41:31.788 - 03:42:05.272, Speaker B: If I, for example, if for example, Frida is now bit baking the project, then it's under his username. If I would bitpeg something, then it would be my username just change. And then the path would also change. So these values are changing on the fly. That's why I cannot say to you it has this specific path currently. That's a great answer. It actually answers a lot and makes things much more understandable.
03:42:05.272 - 03:42:18.004, Speaker B: So basically, d is a variable that can change and it's just based on the path where you're building your stuff? Yes, correct. Yes.
03:42:18.344 - 03:42:39.690, Speaker A: So in this Yocto one page documentation that you shared with me earlier, it says that the variables is like. Yeah. Abbreviation for destination directory, which is corresponds, which corresponds to work directory, slash image. I'm not sure what this means.
03:42:39.882 - 03:42:57.234, Speaker B: So you are currently. Urine is currently in build let dual NLS. I'm sorry? You are in currently in the build folder. I think you can then go inside the temp and then work, I think, I'm not 100% sure, but then.
03:43:00.974 - 03:43:01.334, Speaker C: Which.
03:43:01.374 - 03:43:09.234, Speaker B: Colleague just said which you said the destination. Yeah. So.
03:43:12.974 - 03:43:15.314, Speaker A: Which, which file you said?
03:43:15.854 - 03:43:17.154, Speaker B: I forgot it.
03:43:17.774 - 03:43:22.128, Speaker A: Word definition work directory image. Like backslash image.
03:43:22.256 - 03:43:56.544, Speaker B: Yeah. The work directory is the work directory of the actual bitbake package that you're currently building. So for each, so for each package that you're building, like say for example ref bin or rbuilder bin. You have your own directory and it will then copy that over. So let's see. I can try to build our builder and then we can try to find the config. Just I think it's a.
03:43:56.544 - 03:44:09.144, Speaker B: Yeah, so it's a way of understanding. So it's the recipe specific systroot. And.
03:44:31.694 - 03:44:46.966, Speaker A: I wonder if you can just add to this. Do install commands that you are putting, for example inside your bitbake. If you can do just an echo for the d and see what it is, if you understand what I mean.
03:44:47.110 - 03:45:50.114, Speaker B: Yeah, but I found it now. So it's, it's basically, it's in several places, but I would probably guess that either one of these two, and probably this one is the work directory. So this is where the, this is the specific directory for our builder bin for building it. And there's different stuff inside. Maybe. Do you have an idea what these different folders are? I mean, there's a lot, maybe it doesn't make sense. I mean there's lots of stuff like folders for package QA.
03:45:50.114 - 03:45:56.006, Speaker B: There's a lot of different build steps. But I mean, I can see the.
03:45:56.030 - 03:45:57.822, Speaker A: Image there, by the way.
03:45:57.998 - 03:46:02.086, Speaker B: Yeah, because it's copied over. It's copied over in this case.
03:46:02.270 - 03:46:15.874, Speaker A: Yeah. So I think it's inside that image. No, no, I mean backslash image. You can see it in there. So this is, as their documentation say, it's work directly backslash image.
03:46:16.374 - 03:46:23.790, Speaker B: Yeah, it seems like it's copying, it's having different, like it's, it's in three different file folders.
03:46:23.982 - 03:46:24.766, Speaker A: I see.
03:46:24.910 - 03:47:07.874, Speaker B: But yeah, we can look at each, any one of them and you see how the end, like, you'll see what eventually will be shipped to as part of the final vm image. Right. So you have the two config files in the bin. You will find probably the rbuilder binary and the init, you'll find the init script. So that's artyom. You mentioned that there's like a skeleton image or skeleton tree of this package. Something like that.
03:47:11.614 - 03:47:18.754, Speaker C: Yeah, I mean, in my build root experiments, you can just put the.
03:47:20.454 - 03:47:21.234, Speaker A: Entire.
03:47:23.014 - 03:47:33.314, Speaker C: Directory tree on your localhost in some specific directory and build root will pick this up and copy over the final.
03:47:33.814 - 03:47:37.794, Speaker B: Root of s. Okay, so this is more like an overlay, right?
03:47:38.194 - 03:47:39.614, Speaker C: Yes, it's an overlay.
03:47:39.994 - 03:47:40.894, Speaker B: Okay.
03:47:45.834 - 03:47:49.814, Speaker C: Is it the same with Yogta?
03:47:52.114 - 03:48:11.674, Speaker B: I will probably not. For me, this looks more like an actual package that I think you actually have now the option to convert this to a package that you can later install in an image, like a dev package or something similar.
03:48:13.574 - 03:48:16.514, Speaker C: Why would you want to convert this to a package?
03:48:17.734 - 03:48:46.944, Speaker B: I mean Yogto is a distribution for Linux distributions and they basically ship a minimal or some kind of standard distribution with standard packages and then you can start to install additional stuff. But that's one feature. But you can also provide it as a stand, as a default package already installed.
03:48:48.844 - 03:49:19.014, Speaker C: Yeah, I mean a package as a binary is fine and we can probably do this, but the configuration I think should be separate because we want to have mostly identical, well identical vms with identical binaries but with different configuration. And for that configuration should be separate from the package. If I understand the term package correct.
03:49:26.454 - 03:49:28.514, Speaker B: Now I'm confused, but.
03:49:35.694 - 03:49:37.514, Speaker C: What are you trying to achieve?
03:49:37.894 - 03:49:49.334, Speaker B: No, I just trying to explain to people and trying to understand myself how this works. Is there like, do you have any questions regarding this?
03:49:55.554 - 03:50:11.330, Speaker C: No, I think, I mean I shared with you the config. Are we ready to bake this into the, our image?
03:50:11.482 - 03:50:25.644, Speaker B: Well it depends on what kind of configuration. Is it static config then yes, I would prefer to just bake it in. But if it's any kind of secrets or anything that we need to dynamically provide to the image on boot, then I would do it in a different way.
03:50:29.664 - 03:51:00.294, Speaker C: Well it's a conflict. There is no secrets there and there are, there are no parameters that cannot be inferred before boot. So we can have it fully static I think, and we can bake this into the image?
03:51:03.634 - 03:51:59.134, Speaker B: Yeah, because I think the importance here is that we should put as much of configuration within the image as static because the more room you allow via configuration afterwards, you could actually open any kind of security hole. Like imagine you could, you get to find paths where the state is stored, maybe you could, then you could change the place where the state is stored rather in an unencrypted path or on disk or stuff like that. So yeah, I think the goal here is to make the most like make everything static. That doesn't need to be dynamic.
03:51:59.954 - 03:52:48.630, Speaker A: I mean it is like this, it is static in the sense that when you start our builder it reads it once and then that's it and it's set up. So even if you change it on runtime, you would require to restart our builder from scratch in order to take the new configuration that you changed during runtime, for example changing the state where it's saved. Then you would require to restart our builder. So in this case it would be noticed that the binary got restarted. So I think this is not an issue. So it is kind of a static. The only non static part of it is the way where we include the secrets, which is currently through environment variables.
03:52:48.630 - 03:52:58.894, Speaker A: But in this case, we would need to figure out another way, like from a vault or something.
03:53:01.434 - 03:53:12.334, Speaker B: Okay, well, maybe let's focus on how we can get this, how we can get the r builder running. I mean, we have the init script now.
03:53:15.774 - 03:53:19.834, Speaker C: Yes. I also shared with you the config file for the air builder.
03:53:20.454 - 03:53:21.742, Speaker B: Where can I find it?
03:53:21.878 - 03:53:23.274, Speaker C: In DM slug.
03:53:26.934 - 03:53:28.754, Speaker B: Stop sharing for a moment.
03:53:30.254 - 03:53:33.474, Speaker C: We just need to tweak some addresses there.
03:53:35.614 - 03:53:39.750, Speaker A: Did you tweak the relay address to husky?
03:53:39.902 - 03:53:40.594, Speaker B: Good.
03:53:49.834 - 03:54:00.014, Speaker A: I wonder if we need. Still need probably. We should. We still need probably the secret keys for the dry run as well. Like to provide even dummy keys, but just.
03:54:01.554 - 03:54:16.594, Speaker B: Is there anything. Is there anything that I shouldn't. There's a. I can see. Can I share my screen now looking at this config or do I need to delete stuff?
03:54:18.294 - 03:54:22.434, Speaker C: I shared this with more and satisfying.
03:54:23.054 - 03:54:36.554, Speaker A: No, sharing it for. He meant sharing it on YouTube. I'm not sure if it includes anything data that it's critical, maybe.
03:54:36.714 - 03:54:41.770, Speaker B: Matthews, can I see the s bundle mergeable signers?
03:54:41.922 - 03:54:42.858, Speaker A: Yes, exactly.
03:54:42.946 - 03:54:51.922, Speaker B: It looks like a public key. And then there is the relay, which has a. Yeah, the relay is a public key.
03:54:51.938 - 03:54:57.254, Speaker C: It's a public key. It's. I grabbed it from the site. From our site.
03:54:57.934 - 03:54:58.270, Speaker A: Yes.
03:54:58.302 - 03:55:01.754, Speaker B: Okay. Okay. All right. I think then we can share it.
03:55:12.494 - 03:55:21.794, Speaker A: I mean. Okay, before you share it. Never mind, it's already shared now. Too late.
03:55:23.374 - 03:55:31.854, Speaker C: Blocks processor URL should be set to. What?
03:55:34.874 - 03:55:36.094, Speaker B: What's URL?
03:55:36.474 - 03:55:39.654, Speaker C: Blocks processor blocks processor URL.
03:55:40.954 - 03:55:41.974, Speaker B: What is that?
03:55:43.474 - 03:55:44.494, Speaker C: I don't know.
03:55:46.714 - 03:56:29.138, Speaker A: Let me check my configuration. Ah, wait second. So mine is. Is referring to an internal Kubernetes Av's instance backslash API. I don't know what this is. Maybe we can ask Anton.
03:56:29.226 - 03:56:35.842, Speaker C: Let's just comment this out for now and see if it will start.
03:56:36.018 - 03:56:36.774, Speaker A: Yeah.
03:56:37.234 - 03:57:26.294, Speaker B: Okay. I just need to check one. So that's okay. So I'm setting the paths already. So everything is under far volatile and we're going to comment out the blocks processor URL and then we're going to start from the beginning. We don't have telemetry or. That's the telemetry that's being provided by our builder.
03:57:26.794 - 03:57:29.214, Speaker C: Yes, it's Prometheus metrics.
03:57:29.634 - 03:57:30.534, Speaker B: Okay.
03:57:32.274 - 03:57:37.024, Speaker C: We don't need this now, but we can keep it. I think it's on the default.
03:57:39.964 - 03:57:49.024, Speaker B: This is all fine, fine. Let's try.
03:58:09.984 - 03:58:11.084, Speaker A: Interesting.
03:58:14.904 - 03:58:16.724, Speaker B: Can you explain what's interesting?
03:58:18.344 - 03:58:39.144, Speaker A: I'm interested to see like if it's, if the, our builder already have a implementation, like for, for it, or it has to be specifically like is it a general way of implementation or is it specific to, to those three secrets?
03:58:39.444 - 03:58:40.384, Speaker B: Let's see.
03:58:40.764 - 03:58:47.144, Speaker A: Yeah, let's see. But you have to provide a value in an environment variables.
03:58:48.924 - 03:58:49.944, Speaker B: Yeah, exactly.
03:58:50.284 - 03:59:00.604, Speaker A: Do you, do you add the environment variables also in a bitbake file like in the bb? Is there a way to pass n variables, like to bake them inside directly?
03:59:00.764 - 03:59:01.196, Speaker B: Yes.
03:59:01.260 - 03:59:04.224, Speaker A: Or that would be also nice.
03:59:12.324 - 03:59:21.524, Speaker B: IPC is the IPC path of breadth. Where is that configured?
03:59:23.584 - 03:59:34.544, Speaker C: I think it will be the same. Should be the same. Is it always, it's by default there.
03:59:34.704 - 04:00:01.380, Speaker B: Okay, cool. It doesn't, it's not correct. What's the dry run validation URL? Do we need this one?
04:00:01.532 - 04:00:02.796, Speaker A: It's commented out.
04:00:02.940 - 04:00:03.260, Speaker C: Yeah.
04:00:03.292 - 04:00:08.904, Speaker B: Okay. Mergeable signers?
04:00:11.254 - 04:00:13.154, Speaker C: I don't know. Let's keep it.
04:00:20.654 - 04:00:45.454, Speaker B: Okay, looks good. Okay, so for the time being I would just add the cl node URL here. Do you know the port?
04:00:52.194 - 04:00:53.454, Speaker C: Just a sec.
04:01:01.014 - 04:01:05.594, Speaker A: Is it 8645 or am I wrong? I'm not sure.
04:01:05.934 - 04:01:10.234, Speaker C: No. Maybe 3350 zero.
04:01:10.774 - 04:01:12.758, Speaker A: Ah, okay. This is the different one, but it.
04:01:12.766 - 04:01:16.034, Speaker C: Should be HTTP as well, prefixed with HTTP.
04:01:23.734 - 04:01:28.854, Speaker B: What about the us relay API token? Do we need this one?
04:01:29.354 - 04:01:30.094, Speaker C: No.
04:01:31.074 - 04:01:33.974, Speaker B: So I can just remove it.
04:01:34.274 - 04:01:39.134, Speaker C: Coinbase as well. And optimistic relay as well.
04:01:40.514 - 04:01:43.294, Speaker B: Maybe we want to add them at a later point, right?
04:01:45.714 - 04:01:51.684, Speaker C: Yeah, but for now, optimistic comment down in the configuration.
04:01:57.334 - 04:02:13.794, Speaker B: Okay. Um. Relay secret key. Is this the builder secret? No. Relay secret key. Why do we need it? Which one is that? Is it builder T transaction signing key or the, or builder secret key.
04:02:14.334 - 04:02:19.524, Speaker A: This is, this, these are, I think what you're looking at are for the guests.
04:02:19.694 - 04:02:25.564, Speaker B: Exactly. But the geth builder will probably, I mean, one of these I can use, right?
04:02:25.904 - 04:02:37.684, Speaker A: Yes, I would use the secret key because the signing key is the same as the coinbase which signs the transactions from the wallet before submitting them.
04:02:38.024 - 04:02:38.924, Speaker B: Okay.
04:02:42.864 - 04:02:54.854, Speaker A: So you could use the Coinbase secret key and pass it the builder TX signing key if you want, in case the R builder starts screaming, not running because it requires that variable.
04:03:02.194 - 04:03:03.054, Speaker B: Okay.
04:03:07.794 - 04:03:14.164, Speaker A: Do you need to add also a slash after the Cl node URL since they are underneath? Exactly.
04:03:15.824 - 04:03:16.964, Speaker B: Maybe, yeah.
04:03:18.984 - 04:03:28.604, Speaker A: Anything else looks good to me. Do they need to be in quotations or not necessarily.
04:03:30.064 - 04:03:31.124, Speaker B: Which ones?
04:03:31.464 - 04:03:34.024, Speaker A: The environment variables that you are passing.
04:03:34.184 - 04:03:36.064, Speaker B: No, it's fine.
04:03:36.224 - 04:03:37.004, Speaker A: All right.
04:03:39.284 - 04:03:45.064, Speaker B: No, let's try. I doubt it will work, but.
04:03:47.284 - 04:03:53.144, Speaker A: I mean we managed to run the system vi init in one try.
04:04:06.624 - 04:04:09.644, Speaker B: Miltos, have you ever worked with baldrous?
04:04:11.304 - 04:04:15.216, Speaker A: He just left. If you ask, if you are asking him, he wrote that he has to leave.
04:04:15.400 - 04:04:17.724, Speaker B: Okay. Unfortunately.
04:04:34.764 - 04:04:47.624, Speaker A: At some point are we going to look into reducing the TCB by removing stuff from the configuration later, like from the image, or is it not on the agenda for now?
04:04:48.524 - 04:05:15.604, Speaker B: I don't think so. I don't think it will be on the agenda. I would probably do something different. Like I noticed that in terms of kernel security, a lot of the mitigations for side channels haven't been enabled because it's such a small kernel config. So this is something I would probably want to look at.
04:05:19.864 - 04:05:22.224, Speaker A: What do you mean, like by enabling them or.
04:05:22.384 - 04:05:23.284, Speaker B: Exactly.
04:05:23.944 - 04:05:27.124, Speaker A: Okay, aren't they enabled by default?
04:05:29.824 - 04:05:43.764, Speaker B: It looks like they are not with this small kernel configuration that we have like the tiny version of the VM. But we're having issues with our bitbig server.
04:06:13.344 - 04:06:14.084, Speaker A: It.
04:06:44.164 - 04:06:51.144, Speaker B: Oh, did we change something? Looks like we changed something.
04:06:53.164 - 04:06:57.504, Speaker A: Not to my knowledge. We only. Ah, you changed the arbal there.
04:06:58.084 - 04:07:19.684, Speaker B: Yeah, this is rebuilding a lot of stuff. Okay, I'll take the opportunity to take a small break. See you in two.
04:07:35.684 - 04:08:22.184, Speaker A: Oh no, something broke it.
04:08:56.144 - 04:08:57.124, Speaker B: I'm back.
04:08:58.304 - 04:09:02.964, Speaker A: Yeah, it broke at some point after you left. A second after you left.
04:09:03.424 - 04:09:10.164, Speaker B: Yeah, some pearl issue.
04:09:12.184 - 04:09:19.144, Speaker A: It says like config not found. So you were passing config sh or something?
04:09:19.524 - 04:09:22.264, Speaker C: No, there are lots of files. It does not exist.
04:09:25.084 - 04:09:42.704, Speaker B: It's still packaging. Packaging glip c. So I'm going to wait for this one and then probably the solution is to clean the package and then retry. Looks like somebody synced the repository.
04:09:45.044 - 04:09:45.944, Speaker C: Nope.
04:10:42.364 - 04:10:45.704, Speaker B: I'm trying again after cleaning the image.
04:10:49.084 - 04:10:52.004, Speaker C: Does it mean we have to rebuild everything from scratch or.
04:10:52.124 - 04:12:07.244, Speaker B: No, I don't think so. Yeah, I think if it fixed it. Yeah, it's already. I'm building the unit ram fs. It's one of the latest stages. Okay, cool. Let's see if that works.
04:12:07.244 - 04:12:17.252, Speaker B: Oh, and that even fixed somehow.
04:12:17.308 - 04:12:20.664, Speaker C: Yes. Unrecognized command stored.
04:12:21.284 - 04:12:23.384, Speaker A: What is this? Unrecognized command?
04:12:24.764 - 04:12:28.024, Speaker B: Looks like the, the init script of the r builder.
04:12:28.604 - 04:12:30.824, Speaker A: Yeah. Yes.
04:12:31.644 - 04:12:34.024, Speaker B: S 99 r builder command.
04:12:35.324 - 04:12:44.144, Speaker C: Okay, I think we just forgot some escaping or quads or something like this.
04:12:45.364 - 04:12:48.104, Speaker A: Is there a way where we can. Oh yeah, it's there.
04:12:54.884 - 04:13:04.944, Speaker B: So this is, this is our builder and for some reason it's. Before that it's.
04:13:12.184 - 04:13:23.124, Speaker C: Well, is there like a validation command for CSP in it? Oh, what's that?
04:13:30.084 - 04:13:32.624, Speaker A: Stop. It's bricked.
04:13:34.724 - 04:13:40.944, Speaker B: Okay. I know the reason. Yeah, because it's, it's a binary.
04:13:44.204 - 04:13:46.064, Speaker A: It is supposed to be a binary.
04:13:46.724 - 04:13:49.388, Speaker B: No, the, the in, it shouldn't be a binary.
04:13:49.516 - 04:13:51.060, Speaker A: Ah, the init. All right.
04:13:51.172 - 04:15:04.004, Speaker B: The Internet is a binary and that's okay. Why is it a binary? So we're copying in it and then. Yeah, here. That's it. This is where it's wrong. How big are these images? The binaries of arbuilder and retail quite big. Why is arbiter that big?
04:15:04.984 - 04:15:25.184, Speaker A: Because arbuler also uses a lot of dependencies that are, yeah, a lot of dependencies. I mean, when I build it with cargo in a static mode, it's uh, if I recall correctly, still has 1300 something dependencies in it.
04:15:25.604 - 04:15:26.704, Speaker B: That's huge.
04:15:27.084 - 04:15:48.044, Speaker A: Yep. Breath has even less, but it's still bigger. I assume that its dependencies is just simply bigger. Interesting. Now it starts directly.
04:15:48.424 - 04:15:49.204, Speaker B: Cool.
04:16:01.344 - 04:16:09.766, Speaker A: This confidential vm snapshot on this number number, is it the measurement by some chance after the snapshot?
04:16:09.950 - 04:16:21.834, Speaker B: No, this is likely one of the git commits. I see of pokey rowdy.
04:16:22.494 - 04:16:26.514, Speaker A: Okay. I thought like it's random. Each time is different. I thought.
04:16:35.754 - 04:16:46.414, Speaker B: I didn't change this line. It's the URL for the, for the boost relay and it's giving a ton of parser.
04:16:49.234 - 04:17:01.594, Speaker A: I know why, I think, because after, after you write URL, you should put it in quotation and it's not in quotation. In your, it said expected quotation is missing.
04:17:02.294 - 04:17:04.594, Speaker C: Yes, quotes are missing.
04:17:09.614 - 04:18:11.518, Speaker A: So yeah, before and after. Do you have to restart the system file or does it do it by its own?
04:18:11.566 - 04:18:20.144, Speaker B: Or I restarted and now it's giving an error. Invalid string length. After putting out the first.
04:18:23.404 - 04:18:55.494, Speaker A: Invalid string length of what exactly? I recall seeing this somewhere. It is regarding the secrets that you pass at the start, after the change. I think there are some, yeah, there are some variables that are missing and expecting in the file. I think you pass the coinbase, you pass the relay secret key, but you didn't pass the optimistic. You can pass optimistic as well. And just, you can even if you.
04:18:55.574 - 04:18:58.194, Speaker C: Want, even if you have this disabled.
04:18:59.574 - 04:19:01.034, Speaker A: What do you mean disabled?
04:19:01.774 - 04:19:04.550, Speaker C: Because we explicitly disabled optimistic.
04:19:04.702 - 04:19:13.884, Speaker A: Yeah, I think, I think I, I think at this point there are a must d, three, optimistic relay secret key and so on.
04:19:16.304 - 04:19:18.884, Speaker B: I'm just going to take this. The relay key.
04:19:21.264 - 04:20:24.804, Speaker A: Yeah, you can use the same one. And did it solve it? Actually, yeah, because here it's, well, it starts and then reads the configuration and then there is something that is missing from the configuration that tells you like invalid string length. But let me remember what was exactly the missing part. Yes, it should be part of the configuration. So can you go to the.
04:20:27.884 - 04:20:59.656, Speaker B: Yeah, I have the configuration of, I'm just going to replace the Cl node because we weren't sure whether that's going to work or not with the actual value. See if that's going to fix it. And no, it's not fixed yet. So.
04:20:59.840 - 04:21:00.216, Speaker C: Okay.
04:21:00.240 - 04:21:08.924, Speaker A: Can you open the config? Yes. Quickly, where are the three secrets? They should be here somewhere reading from the env.
04:21:09.424 - 04:21:13.364, Speaker B: There's only one secret that's being read.
04:21:13.944 - 04:21:30.584, Speaker A: That's what they meant. They should be here, the three of them, like you should, you should really write optimistic underscore relay, underscore secret underscore key and then get them from the end because the config file expects these three to be there.
04:21:31.284 - 04:21:38.184, Speaker B: So that's, there will be coinbase secret key and optimistic. Okay.
04:21:38.604 - 04:21:42.424, Speaker A: Yeah, but they have different writing like they are in.
04:21:43.314 - 04:21:45.414, Speaker B: Yeah, but they have the same.
04:21:46.074 - 04:21:55.974, Speaker A: Yes, yes, they have the same, yeah. Okay, let me fetch them for you. Maybe you can just copy paste them from the chat instead.
04:21:56.274 - 04:21:59.534, Speaker C: Yeah, I just pasted the three of them.
04:22:02.274 - 04:22:04.894, Speaker A: Yes, exactly. That's how they should look like.
04:22:07.554 - 04:22:12.984, Speaker C: Sorry about that because I removed them before sending you.
04:22:13.604 - 04:22:49.084, Speaker A: No problem. I just recalled it because I saw this issue when one of the instances crashed after the update of the binary. I mean the error message was not very helpful as well. Like the invalid string length is kind of misleading.
04:23:22.804 - 04:23:28.804, Speaker B: Hi, sorry, I just dropped out. Can you hear me?
04:23:29.424 - 04:23:30.164, Speaker C: Yes.
04:23:38.824 - 04:23:44.164, Speaker A: Do you still have, do you still have the co host rights? But it seems you are so.
04:23:47.664 - 04:23:57.124, Speaker B: But I missed, all of the messages are gone. Could you resend them? The last part?
04:23:57.984 - 04:24:18.604, Speaker A: Yes. So this is the part that you need to copy paste inside because it is expecting them to be looking like this. All of them? All three of them. Do you want me to copy all the.
04:24:19.934 - 04:24:36.794, Speaker B: No, that's enough for now, thanks. Block list file. Okay, I have the wrong block list file. Can somebody give me the block list file?
04:24:38.774 - 04:24:46.618, Speaker A: The effect, yeah, I can send it to you. Where do you want it? Let me copy, send it to your machine.
04:24:46.766 - 04:24:49.574, Speaker C: Can I just put the empty JSON array?
04:24:50.714 - 04:24:52.854, Speaker B: Yeah, maybe I can do that.
04:24:53.634 - 04:25:07.214, Speaker C: Note the square brackets. Yep. Okay.
04:25:09.674 - 04:25:22.980, Speaker A: Nova dish neuroscientist. So you still need the validation URL despite the dry run. So you can provide the validation URL and.
04:25:23.132 - 04:25:26.944, Speaker B: Yeah, how does that look like?
04:25:29.884 - 04:25:51.724, Speaker A: Ah, you cannot, wait a second. I think you cannot enable both optimistic and dry run maybe disabled. Optimistic. It is already optimistic enabled false. Then just uncomment this one since. But then we need to make sure that the address is correct.
04:25:53.064 - 04:25:55.560, Speaker B: This one, the dry run validation URL.
04:25:55.712 - 04:26:03.940, Speaker A: Yes, you can uncomment it and give it the address above that you gave 192. I think this is the host, if I'm not wrong.
04:26:04.112 - 04:26:07.692, Speaker B: This looks like, like it's a, it's a ret node.
04:26:07.828 - 04:26:09.704, Speaker A: Oh, and then you keep it localhost.
04:26:10.884 - 04:26:12.292, Speaker B: So that's correct, right?
04:26:12.468 - 04:26:15.824, Speaker A: Yeah, it should be localhost since they're both running on the same machine.
04:26:17.524 - 04:26:19.304, Speaker B: I'm gonna try this one again.
04:26:39.664 - 04:26:41.724, Speaker A: Unable to open database file.
04:26:44.984 - 04:26:53.352, Speaker C: You run it as a root user. Yeah, maybe the path does not exist. The directory should exist I think.
04:26:53.408 - 04:26:55.784, Speaker A: Yeah, it.
04:27:20.904 - 04:27:23.004, Speaker B: The database path is correct.
04:27:24.424 - 04:27:27.964, Speaker C: Is there a rest directory in the variable tile?
04:27:28.904 - 04:27:43.484, Speaker B: Yeah, you can see here. Does it, is it requiring a sync database?
04:27:45.384 - 04:27:52.664, Speaker C: I don't think so. Is there files directory also exist?
04:28:05.084 - 04:28:07.544, Speaker B: I mean this could be several things.
04:28:12.984 - 04:28:17.064, Speaker C: And it's running as root, right? The service is running as root.
04:28:17.184 - 04:28:38.804, Speaker B: Yeah, I mean there's some special, I don't know, but there's some special lock I remember required to open the database. And maybe this is not supported by this minimal Linux kernel.
04:28:40.364 - 04:28:53.264, Speaker C: No, I don't think that's the issue. Can I show the LSLA on the database directory?
04:29:10.104 - 04:29:16.204, Speaker A: I can see it's only read only, but yeah, we are running it under root, so you can, it should be able to write as well.
04:29:18.824 - 04:29:21.800, Speaker C: No, it's a read write, yes, only.
04:29:21.832 - 04:29:25.204, Speaker A: For root I think. Or only for user?
04:29:35.564 - 04:29:38.184, Speaker B: Yeah, obviously I'm rude.
04:29:39.164 - 04:30:06.804, Speaker C: Okay, can you show me the config file once again? Ah, maybe this far volatile or builder directory does not exist. The error storage path parameter.
04:30:36.324 - 04:30:37.584, Speaker B: Oh, looks good.
04:30:52.064 - 04:30:53.444, Speaker A: Looks good to me.
04:30:55.984 - 04:30:58.444, Speaker C: Yes, something is running.
04:30:59.864 - 04:31:07.324, Speaker A: Yeah, it seems to be stable, but of course it's not building anything because it's waiting for rest to sync.
04:31:09.264 - 04:31:17.484, Speaker B: Cool. Okay, I'm going to take the time to sync what we've done here with the actual config files.
04:31:17.984 - 04:31:37.744, Speaker A: Yes, maybe copy everything from the config file from within the vm and then paste it in the config file outside the nose so it'll be the same. Oh, okay.
04:31:37.784 - 04:31:46.534, Speaker B: Or this, I mean I can't access it, so I hope to do it like this.
04:31:50.114 - 04:31:56.094, Speaker A: I mean if you. No, apparently. Wasn't this the address of the host?
04:31:57.154 - 04:31:59.454, Speaker B: No, that's one. One.
04:31:59.754 - 04:32:06.114, Speaker C: Okay, but it's not two, it's 25, something like this. Ultor.
04:32:13.854 - 04:32:17.638, Speaker B: Oh, that's interesting. I didn't enable it at all.
04:32:17.686 - 04:32:30.434, Speaker A: So for me, how is it even getting the ha. Okay, I think it's.
04:32:33.554 - 04:33:06.234, Speaker B: Yeah, we didn't check the, didn't check the note. Okay, so which are the ones I want to copy.
04:33:09.054 - 04:33:13.246, Speaker A: You can use directly SCP and then get it from there to here.
04:33:13.390 - 04:33:22.310, Speaker B: Yeah, I'm just wondering, was the init that I changed or was there anything else that I changed? Yeah, we need to, we need slightly.
04:33:22.342 - 04:33:28.964, Speaker A: Changed the initial where you added the. Yeah, the keys. And.
04:34:10.523 - 04:35:15.752, Speaker B: And the other one was the configuration. Okay, and the other, what is the US relay API token? Does anyone know whether we're going to need that or can I just remove.
04:35:15.928 - 04:35:17.484, Speaker C: You can just remove it.
04:35:22.264 - 04:36:13.824, Speaker B: Good. For now. Oh, what another thing we need. I wonder why isn't. So we have this config and I'm giving it the r builder as that's the arrow storage path. Is there any, any other place also this is the only one, so maybe I just change the error storage path. Right, it's maybe into temp.
04:36:13.824 - 04:36:17.904, Speaker B: Does the r builder have a folder itself?
04:36:20.804 - 04:36:42.204, Speaker C: No, but I mean on our builders we define a working directory so it works with, it can work with relative paths, but I mean here we have to do default paths. The absolute path.
04:36:43.984 - 04:36:49.470, Speaker B: Is. Okay if I just set it to ten, should be fine.
04:36:49.632 - 04:36:53.094, Speaker C: Maybe we can just even comment this out, but I'm not sure if it will work.
04:36:53.394 - 04:36:54.294, Speaker B: Okay.
04:36:56.194 - 04:37:05.090, Speaker A: Also you created the directory somewhere, and can we include in the bitbake that this directory is created beforehand so we.
04:37:05.122 - 04:37:12.002, Speaker B: No, exactly. That's why I've changed this line here, because now we don't create a directory anymore.
04:37:12.178 - 04:37:15.673, Speaker A: All right, fair enough. It.
04:37:48.074 - 04:38:20.114, Speaker B: Yeah, that's it. No, the dry run. Hey, this took a bit longer, but that's good, I think. I hope this helps with you getting more familiar with Yocto.
04:38:23.494 - 04:38:53.562, Speaker A: Yeah, definitely. That's actually very cool. Thank you for doing this. I'm still very interested in configuring it. Like to minimize its service. Besides that file that you shared with us, where you are adding the dependencies, is there any other place where you can configure it? Or. That's the only spot where you can, there's more.
04:38:53.658 - 04:39:47.014, Speaker B: Like you can configure the whole kernel in ways you want it. Like you can give either the whole kernel config or modification files that change just a few kernel variables. Kernel config variables. I mean, what else? But I mean, the Internet ramifest is the thing that's most important. Right. Because there you put all the code, which is eventually lands on the image so that's the init ramfs, the kernel, and the rest of the boot process. I mean we have the EFI loader which is very small, so we can ignore that.
04:39:47.014 - 04:40:12.934, Speaker B: And there's the kernel and then there's the initial and there you can, you can try to reduce things more. But I think like busybox is something we probably, definitely need. Init system is also very nice, but maybe we can skip that. I think the init system is something we could probably skip and run our own, but it's also not very big. Let's start.
04:40:13.954 - 04:40:22.554, Speaker A: Is the October like configuration like TDX as your target? Is this from Yocto or is it from you?
04:40:22.594 - 04:40:42.894, Speaker B: Like you? That's what I wrote. I give a special TDX target and SAV SMP target and depending on which target you give it changes. For example the kernel configuration, which is like now it doesn't include the SCV SMP drivers, but for the TDX.
04:40:45.294 - 04:40:50.874, Speaker A: So these are your changes, like your configurations, and they were not supported by Yocto before.
04:40:51.174 - 04:40:52.154, Speaker B: Exactly.
04:40:53.694 - 04:41:20.694, Speaker A: Awesome. Because I was wondering if it's, if it's TDX aware in the sense like if you look at the TDX canonical Repo, they have some scripts that to set up the host and set up the guests. Are you doing something similar to set up the guests as well when you are doing these changes or not yet regarding for attestation and other purposes?
04:41:21.834 - 04:41:28.334, Speaker B: No, I think I was distracted by this error. Could you repeat the question?
04:41:30.474 - 04:42:26.754, Speaker A: I was wondering if you are doing when you are setting up the configuration to make it TDX aware this image, if you are doing similar to the TDX canonical part where they are copying scripts to set up the host and the guest. Like there are scripts for guest and there are scripts for host and there are also some kind of setup for attestation on host and attestation on guest. I can show you if you open the repo, if you go to the file. Guest tools, sorry, folder. Guest tools. They have here image and inside image they have this created the image and then created the image. They go through the process what they are doing here and at some point they.
04:42:26.754 - 04:42:45.606, Speaker A: Inside the vert customize. Down. Down. Yes, inside here they are copying not only these, they are copying over also some kind of files. Down. Yeah, exactly, down.
04:42:45.710 - 04:42:53.436, Speaker B: The scripts, many scripts which, sorry, I'm lost here. Down.
04:42:53.630 - 04:43:25.174, Speaker A: Yeah, yeah, it's down. It's copy in. Yeah, exactly. These scripts. And then upon starting the VM they are also executing those scripts in cloud. Init upon and then. Yeah, you see the setup sh is basically being executed and then setup sh is running these scripts that being copied over and then basically your image then will be created with all of those setup where it will be TDX aware and has the support of attestation and so on.
04:43:25.174 - 04:43:37.374, Speaker A: Okay. I was like just wondering if your changes here with a kernel configuration is doing something similar to what they are doing to enable.
04:43:37.714 - 04:44:08.714, Speaker B: For now the only TDX enablement is just, I mean I can show you. Give me 1 second. So that's, that's it. I've upped the Linux version. I've have the Yocto version, pokey version and then.
04:44:09.894 - 04:44:13.374, Speaker A: I'm sorry, where did you get this scart?
04:44:14.314 - 04:44:24.698, Speaker B: That's basically, it's like, I don't know, what are your current Ubuntu versions? It's a name for the version.
04:44:24.866 - 04:44:26.986, Speaker A: It's okay. Like focal and so on. Okay.
04:44:27.130 - 04:44:52.634, Speaker B: Yeah. And then this is the machine config definition. I think this is. Just copy it over from SCV SMD and change a few specifics. Let's see, where's the. Somewhere. I'm probably going to give it some TDX info here.
04:44:52.634 - 04:44:54.594, Speaker B: This.
04:44:57.374 - 04:45:10.034, Speaker A: Yeah, I recall, I recall Qamo could simulate the x if you are running it on a TDX host machine like enabled TDX host machine.
04:45:16.414 - 04:45:20.150, Speaker B: No, it's probably not. Here, let's look further.
04:45:20.342 - 04:45:21.154, Speaker A: Okay.
04:45:26.334 - 04:46:06.184, Speaker B: This is I think a fix due. This is just a fix to make it work. With the recent pokey image package install there's also nothing. Also just a fix. And here. Yeah, here I think these are the important ones. So within the Linux Yakto bitbake I'm defining a kernel machine, TDX, and it's compatible with a TDX machine.
04:46:06.184 - 04:46:40.244, Speaker B: And the. So if I'm, if I'm building with a TDX machine, it basically says add these kernel features. These are not TDX related, so they should be commented out and added in some other way. But those ones are definitely TDX related. You can see up here, it's basically I just copy pasted the SeV SMP, remove this part and added this part.
04:46:40.624 - 04:46:42.084, Speaker A: Yeah, makes sense.
04:46:43.224 - 04:47:04.194, Speaker B: And this is the actual TDX config of the kernel. Those are the environment variables that I've added. Yeah, that's it. That's the even part of is just fixing other stuff. So TDX enablement was very small.
04:47:05.654 - 04:47:06.634, Speaker A: That's great.
04:47:08.254 - 04:47:35.954, Speaker B: Okay, so this didn't work. No headers in static files. Check your static files path configuration. I remember I did one thing wrong and that was to give the OFAC JSON an empty list. Maybe that fixes it.
04:47:38.114 - 04:47:42.894, Speaker C: No, I think it's about the static files directory which we checked and it exists.
04:47:48.754 - 04:48:12.814, Speaker B: Okay, so maybe, oh so maybe if I rerun it now it will work because the rest, so we, there isn't a race condition here because rest probably didn't start for some reason. So maybe I need to give Reth as a dependency for our builder.
04:48:12.854 - 04:48:17.714, Speaker A: Yes. Like some similar to a system D where you say after execute, after.
04:48:18.774 - 04:48:29.934, Speaker B: Okay, I don't know how to do that.
04:48:32.474 - 04:48:33.654, Speaker C: I'm going to check.
04:48:37.594 - 04:48:38.618, Speaker B: See if it.
04:48:38.786 - 04:48:53.734, Speaker C: Is a required start header like this. You should add it to the beginning of the unit file to the service.
04:48:56.934 - 04:49:09.234, Speaker B: Give it that the trick for this. And now let's look card start. And I would put rest here.
04:49:09.894 - 04:49:11.314, Speaker C: Yes, yes.
04:49:17.694 - 04:49:21.024, Speaker B: This is for SYSV in it, right. Okay, I see.
04:49:30.334 - 04:49:35.110, Speaker A: But isn't this commented out? You have to edit right or am I wrong?
04:49:35.262 - 04:49:45.874, Speaker B: No, I think these are comments that definitely are being read. I mean it defines the default start levels and the stop levels.
04:49:46.454 - 04:49:54.968, Speaker A: Oh, okay. Should it have a dollar sign before it?
04:49:55.096 - 04:50:05.724, Speaker B: Let's have a look. So there's networking.
04:50:06.944 - 04:50:09.656, Speaker A: Yes, I would put a dollar sign before us.
04:50:09.760 - 04:50:20.984, Speaker B: Just look. I don't see a syslog here and remote fs.
04:50:49.104 - 04:51:09.024, Speaker C: Just, just keep it as is. I think the doc say it's, it can be either, whatever that means. The explicit unit name or, or a descriptive placeholder, whatever that means.
04:51:10.404 - 04:51:13.504, Speaker B: Okay. And I'll try it like that.
04:51:24.284 - 04:51:28.304, Speaker A: So you don't require the dollar sign before the thingy.
04:51:28.804 - 04:51:35.924, Speaker C: You may or may may not include this. I mean it will mean different things. But.
04:51:37.664 - 04:51:38.644, Speaker A: Interesting.
04:51:40.904 - 04:52:01.144, Speaker B: By the way, this is, this is a huge right, it's you, you have to count in the 125 or maybe even more megabytes of, of the binaries of breath and R builder.
04:52:03.204 - 04:52:15.044, Speaker A: Oh, wait a second. But I thought those only the inits what you are measuring here and not. Ah, you are the whole system. Never mind. Okay, okay. Okay. I thought you are.
04:52:15.044 - 04:52:35.204, Speaker A: Yeah, yeah that makes sense. The R builder and the R builder and rest together are almost 140 and the rest is like 235 megabytes for the rest.
04:52:40.064 - 04:53:03.754, Speaker B: Okay. The, yeah, of these 175 megabytes user takes up 165. There is seven megabytes in lib. We have some certificates.
04:53:05.134 - 04:53:09.054, Speaker A: Do we need the lips? Since all the binaries are statically built?
04:53:09.214 - 04:53:10.194, Speaker B: Probably not.
04:53:10.734 - 04:53:11.594, Speaker A: Okay.
04:53:18.474 - 04:54:10.384, Speaker B: Well part of it we need for, we do need it for f disk and I think probably some stuff like fsv size but yeah, not much and then. Yeah, but most of this is strace, we can remove. And everything you see here that's busybox. So very small breadth. Our builder's big openssl. Why do we need openssl? I don't know.
04:54:10.884 - 04:54:21.824, Speaker A: Because maybe you added it in the dependencies in a bitbake, the big file. So I was added, okay, the flower we don't need. Yeah.
04:54:22.484 - 04:54:28.464, Speaker B: And we also don't need these ones. So yeah, we can reduce some, some stuff.
04:54:28.764 - 04:54:32.404, Speaker A: Yeah, definitely. But cool.
04:54:44.144 - 04:55:02.544, Speaker B: Just see we have 3 hours left and it looks like we're almost done with this part. Hopefully. Any thoughts or wishes regarding what we should do next.
04:55:05.364 - 04:55:12.756, Speaker A: Attestation if we can somehow make it aware. Andrew? Andrew is there, I see there. Hello. Hi.
04:55:12.900 - 04:55:13.904, Speaker B: Hi Andrew.
04:55:15.004 - 04:55:32.964, Speaker D: Yeah, any progress on attestation would be cool. And I was also thinking this has gone into a bunch of the builder specific things and I'm interested in like the hello world or the trusted setup or other small examples too. And if we're going to attack hello attestation, maybe on one of those too.
04:55:36.344 - 04:56:11.736, Speaker B: Attestation. So attestation we can do, but that will require us to push the image to the cloud to verify it because it depends on azure and pushing it to the cloud is each image you create. It takes roughly 15 to 20 minutes to push it. So that's a bit not that much fun to wait for this time.
04:56:11.920 - 04:56:43.020, Speaker D: Could we try instead to poke at TDX guest device available? Yeah, you had mentioned earlier before the break that we could look through some of the scripts in canonical TDX because that's what they use to set up these guest tools on the Ubuntu image. And maybe it's possible to get some of those. Yeah, basically I think if we could get the TDX guest device to pop up in Yocto, that would most of the way.
04:56:43.212 - 04:56:51.744, Speaker B: But this is ubuntu, right? And it doesn't have the TDX guest image.
04:56:55.924 - 04:57:43.464, Speaker D: But this isn't from the, you know, this is running, I think the Amazon modified one, not the canonical TDX one that it does on the other. Like on our bare metal TDX instances, like we have a reference machine elsewhere that has the guest enclave there. But yeah, it's got a slightly different kernel and yeah, I'm surprised when you did because you did mod probe TDX. So there is a TDX module, which makes sense because it's using TDX somehow. So maybe just this guest has the wrong version or somehow has disabled or not included the relevant TDX device other than trying to compare against the Ubuntu reference that does have it versus this one in Azure. That doesn't. That's the only way I could think of to approach it.
04:57:44.244 - 04:58:25.954, Speaker B: Well, I can tell you that I've run other than Ubuntu, I've run red hat confidential vms with their image, and I've run this Yocto VM in TDX, and all of them haven't been able. With all of them, the TDX guessed at the station part. Like, the device didn't show up. And I know for a fact that the, at least this one, the VM image, it does have them included. This is actually here somewhere. Yeah, here's the TDX guest driver.
04:58:28.074 - 04:59:02.544, Speaker D: So the driver is present. Is there some way to look at log messages from the driver? I mean, how is the driver present? I mean, if it was failing because you load the driver and, you know, it crashes, then, okay, I wouldn't expect it there. But given that there is the TDX driver, but there's not any TDX guest image, that just seems surprising. And again, my point is that we have a ubuntu that does have that it, and we have this ubuntu that does not have it. So by comparing those, we might be able to figure out what it takes to make it show up.
04:59:04.644 - 04:59:34.604, Speaker B: Yeah, maybe we could. Yeah, let's look at the scripts. Let me just quickly fix this. And if we have running. No, that didn't fix it. But I mean, we can. We know what the problem is and we can look later.
04:59:34.604 - 05:00:04.304, Speaker B: Um, does somebody want to take over for. For the moment? I need to take. Take a small break. Two minutes. I'm back.
05:00:41.724 - 05:02:00.136, Speaker A: So far, this looks actually very, very interesting with the octo, if we can, our end target would be like to have this complete, reproducible build with all the binary. I think the next step would be to make it somehow in a dockerized way so basically everyone else could be able to reproduce it because I think it's still using some kind of off the host dependencies while building. So probably it should be also on the final agenda. I would be interested also, like, in what's really included. Of course. Now, there are many stuff that can be taken out, but what are the, like, this mini minimal yocto kernel? Is it the most minimum thing that we can reach to? Or is there, like, we can do more? And does it include, or can we include, or should we include the micro patches that intel provides against some attacks, side chain attacks, like the mitigation regarding Spectre and. Wait a second.
05:02:00.136 - 05:02:01.776, Speaker A: Andrew is asking.
05:02:01.840 - 05:02:03.004, Speaker D: Yeah, I added myself.
05:02:03.464 - 05:02:14.160, Speaker A: Yeah. Awesome. Yeah. So cool. So what do you think, Andrew, about the whole thing? I'm not sure if he was there from the start of the call.
05:02:14.312 - 05:02:15.928, Speaker D: Yeah, I caught up from the start of the.
05:02:15.936 - 05:02:16.296, Speaker C: Caught up.
05:02:16.320 - 05:02:19.804, Speaker D: I listened on two x speed and so I caught all of them.
05:02:20.424 - 05:02:20.712, Speaker B: Yeah.
05:02:20.728 - 05:02:43.872, Speaker D: And I loved all the discussion that you had, especially on these reproducibility and attestation topics. Oh, and you know what it takes to make it to have an end to end guarantee when you consider updating the code, because you might want to apply an update, and maybe you apply the update to the builder binary that's in the image without having to restart it necessarily. But then what is it that your attestation is giving you about?
05:02:43.968 - 05:02:44.648, Speaker A: Exactly.
05:02:44.776 - 05:02:46.204, Speaker D: Interesting discussion.
05:02:46.984 - 05:03:25.080, Speaker A: Exactly. That was also part of the discussion. So, yeah, we mentioned you when you were not there regarding if you were able to produce like a testation code from a TDX. And I told them that you did. Yep. And yeah, we were looking to it. Yeah, we were looking into it because that repository, which is decommissioned from intel, if you call it, they were using this TDX guest device, which is not anymore there.
05:03:25.080 - 05:03:29.632, Speaker A: So, yeah, that's why we mentioned that you might have more lights there that.
05:03:29.648 - 05:03:30.644, Speaker B: You can show us.
05:03:31.024 - 05:03:39.980, Speaker D: I mean, is that the case, that it's decommissioned? I mean, like deprecated? Like they're no longer. The plan is no longer to use the TDX device at all.
05:03:40.072 - 05:03:46.756, Speaker A: And that's a good question. So the repo itself, they said it's decommissioned and not being continued. So the repo.
05:03:46.820 - 05:04:17.334, Speaker D: Yeah, yeah. Well, I assume that was just moving somehow. I got that. I got that it was somehow a. What to say about it, a tech preview, and that they haven't necessarily kept the tech preview, you know, fully that ran for its thing and now it's not necessarily the way it's going, but I wasn't sure that there was a specific deprecation, you know, thing on that. I know what you mean about the. Well, I mean, and for that matter, this repo doesn't say it's decommissioned at all either.
05:04:17.334 - 05:04:29.834, Speaker D: Through this canonical TDX here, I'm only sharing my terminal window, not my whole browser, but. Okay, so this one's not decommissioned and this one makes available the device. So I'm not sure what you mean.
05:04:31.374 - 05:04:43.914, Speaker A: Yes, I mean, we tried like show these devices on one of the TDX instances on Azure, and they were not there. So that was a weird thing.
05:04:44.774 - 05:05:27.130, Speaker D: How do you build, what Ubuntu do you start from? So, I mean, I'm running from a particular version of 23 ten that has some host stuff in it. That was intel. This is on the intel software development in intel provided environment that is bare metal. So I'm on this host here and I have the ability to run my own entire thing from scratch. So I have the bare metal, this is the bare metal node then basically. But I am running their recommended starting image which has host support for TDX. This azure must be running some equivalent of, but completely opaque.
05:05:27.130 - 05:05:34.730, Speaker D: You have no idea. They don't make any claim about what is Azure running as their host kernel. That's behind the abstraction, that's part of their choice.
05:05:34.882 - 05:05:42.214, Speaker B: They're not even running Linux, it's Hyper V. They're Windows Hyperv.
05:05:46.834 - 05:06:15.554, Speaker D: When I follow the instructions for setting up a guest, there is a similar thing where it pulls a kernel or some things from some third party. So I'm not sure how to follow through those. I can try to redo what I did too, actually here I don't even see where I created the image, but there was a little build image thing here. Yes, the create TD image.
05:06:17.014 - 05:06:17.754, Speaker A: Yes.
05:06:20.014 - 05:06:46.552, Speaker D: Does this in some ways start from a different base image? Obviously the Octolinux is an entirely separate base, but for the Ubuntu that you have. Yeah, for the Ubuntu in Azure, does it start from a meaningfully different base image? Is it possible to see where it likely diverges from this, like they use a different version of the TDX driver? I'm not sure if that's, that's a good question.
05:06:46.608 - 05:07:14.734, Speaker A: I can test now actually with the ones that we are running. Let me look at it. So the one that you are running is in Ubuntu 22, not 23 for starter. And it's not the server version, it's the 2204. So it's the version. So they are definitely different. I was playing with these actually.
05:07:14.734 - 05:07:58.016, Speaker A: Maybe it would be great later if you can give me access to this bare metal if I'm allowed to, because I'm creating some kind of scripts based on this canonical and trying to make a reproducible build where I can inject binaries using this repo. So I'm building on top of it. But I was more interested in what Frieder is doing with the Yocto part because I want something minimal. But I also wanted to play around attestation and this repo was the only hope for me to test it, but I couldn't because I didn't have any hardware and Qemo didn't help me either because my machine does not support DDX. So it ended in that well, okay.
05:07:58.040 - 05:08:40.272, Speaker D: As soon as I flip off here, I'll add you to this node so you have it to test. I mean, the way that I would proceed then is maybe for how the code for. I mean, I believe that this is all just open and this is in the Ubuntu 23 ten stuff. So I'm not surprised if that's not available in the image that you have now. And that won't for Azure. And that will matter anyway if our goal is to make this available in Yokto. But if we look at how they instantiate that TDX guest device, then that can be how we go about adding it into Yokta, which is, and maybe for Azure, it's possible to run one of these, something based on this instead.
05:08:40.272 - 05:08:53.524, Speaker D: Maybe then that'll automatically have both ways of doing attestation. Yeah, definitely. Okay. Yeah. Before I close my thing, I will just show going through the attestation then.
05:09:04.244 - 05:09:05.744, Speaker B: All right, so this is.
05:09:07.484 - 05:09:09.304, Speaker D: We have that TDX cast.
05:09:09.684 - 05:09:10.348, Speaker A: Oh, cool.
05:09:10.436 - 05:10:16.464, Speaker D: And from a user directory, I can't remember where, what steps I followed. Okay, maybe this is something that's mentioned. It's just in their readme steps that I followed. I don't know about this intel trust authority stuff that seems to me like the TDX version of IAS was with Desgx and epid and stuff. Like, I think that that's one way of doing it. But then the quote library verification is better. So I think I skipped that one and just tried to get the, oh, okay, I should be looking.
05:10:16.464 - 05:10:21.054, Speaker D: Okay, I think this is, yeah, after.
05:10:21.354 - 05:10:29.974, Speaker A: If you follow their steps, the setup of the attestation, they install these under that path and then you can use it in order to generate an attestation.
05:10:30.554 - 05:10:55.814, Speaker D: Okay, so great. This is on there. And I clearly had just done make this and you can run this and probably suddenly. Great. All right. And this I don't care about because I don't think I needed those. And, yeah, so this did that whole thing and then I had the quote and then this is how I would generate these quotes.
05:10:55.814 - 05:11:26.854, Speaker D: And then I did something for parsing and looking at the quotes. Like, I remember trying to make Grammy fun of Grammy and on the guest here, but this was parsimony from the first inspection. This matched a quote format, so I'd know straight where to go from there. And then there's the quoting verification library. So that would be the next step to go for verifying those. Okay, I'll yield the screen share, but um, yeah.
05:11:28.754 - 05:11:58.334, Speaker A: Very nice. Yeah. So I don't know, like the next step, would we be able to reproduce what the TDX canonical, those scripts that are attestation parts? Could we just try to put them into Yocto and see if they would work out of the box or would they require much more work because the script seems not so large and what they are doing is not too heavy to what I saw.
05:11:59.594 - 05:12:10.164, Speaker B: Do you know what exactly is required? Like, I mean there's quite a few things running in those scripts. Yes, like installing software.
05:12:13.144 - 05:12:53.634, Speaker A: They are doing several stuff. So I didn't go through script by script because I wasn't able to reproduce the attestation. But besides installing the software, setting up the guests with attestation, you can share your screen maybe to yeah, 1 second they're adding their own software that does this libtdx attest dev and the CLI for it and then they are doing the installation in that path that Andrew just showed us under user shared doc libtdx attest dev examples.
05:12:54.374 - 05:12:57.354, Speaker B: Are you talking about this script?
05:12:58.774 - 05:14:12.612, Speaker A: Let me see your screen. Yes. So for example this is one of the scripts that is being copied into the vms through the cloud init and other the guest tools where the create TD VM and basically they copy all these scripts and then run them inside the VM as well in order to set it up after the first boot. And then afterwards you are able to use the DDX guest module and generate attestation as Andrew did. The question is now if we have now this Yocto that we bit baked and with all the binaries that we have since the start, maybe you could also add these scripts as a cloud init, for example that they are executed upon the first boot because cloud init is only executed once after the first boot and set it up to be able to generate attestations afterwards. So this would be probably the next step that we should do. See if Yocto is compatible with these libraries that they are adding here.
05:14:12.612 - 05:14:23.554, Speaker A: And if yes then that would be great. Actually then we have a minimal yocto image with attestation libraries that we can generate quote.
05:14:23.974 - 05:14:31.918, Speaker B: So you see here there's a lib TDX, a test dev. Exactly where did they get this from?
05:14:32.086 - 05:14:45.094, Speaker A: It's from the repository above that they are adding from kabul team to the X release. So if I understood this correctly, this is an in house implementation. Let me look where this is coming from.
05:14:45.594 - 05:14:48.858, Speaker B: Looks like a dev library. So it's just source code right?
05:14:49.026 - 05:14:59.174, Speaker A: Yes, it's from the canonical team by the way, like but let me check where it is coming from if it's.
05:15:00.114 - 05:15:05.494, Speaker B: What is the TDX attest binary? Is that what you just ran?
05:15:06.884 - 05:15:15.304, Speaker A: I think this is the binary that speaks to the TDX guest module that generates the station.
05:15:15.644 - 05:15:22.544, Speaker B: I don't see anything yet that's enabling the TDX attest. Sorry, the TDX get.
05:15:25.084 - 05:15:52.494, Speaker A: The device is being passed by the QMO command. And the other if you go to the guest tools folder on the left. No, on the left or here, never mind. Here too there is runtd sh. I hope I'm not wrong. Down you are running the QAMO command and you are passing some fel. Yeah exactly.
05:15:52.494 - 05:16:23.924, Speaker A: You are passing here confidential guest support to the X above then minus machine. Yeah, exactly. And here you are passing confidential guest support equal TDX and I assume this QAMO version when you pass this command. I wasn't able to run this command because my QMO didn't support it, but I assume that this is basically what is enabling the device inside the VM upon startup.
05:16:25.904 - 05:16:44.008, Speaker C: One question I don't remember. I also checked out this repository, but aren't they installing this chemo also from some patched repositories? Because I think vanilla chemo doesn't have this GDX support yet.
05:16:44.056 - 05:17:23.540, Speaker A: Yes, I mean in this report they didn't mention to install specific chemo, but I would assume yes, you would require specific patched Qemo. Maybe it is one of the setup and the setup scripts there. Setup guest sorry, setup TDX host. Maybe it's part of it where it's patching your kumo to take that patch probably and rebuild it. By the way, also line 38 object TDX. Guess this was also able to run it with this command. So I had to remove this as well in order to make my experimentation to work.
05:17:23.540 - 05:17:33.104, Speaker A: But yes, I think these two additions to the Qemo run command would make it TDX aware and run the right.
05:17:34.484 - 05:17:38.548, Speaker B: You are aware that we cannot do this on Azure because we don't have.
05:17:38.596 - 05:17:50.884, Speaker A: Yes, yes, exactly. So this is the question here of those, those setup. Okay, you are meaning in general that Azure is not enabling these for you. I wonder.
05:17:51.544 - 05:17:53.384, Speaker D: I mean, we also don't know that they're not.
05:17:53.424 - 05:17:53.600, Speaker A: Right.
05:17:53.632 - 05:17:57.324, Speaker D: It's possible that it's something on the guest side, like this is host side.
05:17:57.824 - 05:17:58.216, Speaker A: Exactly.
05:17:58.240 - 05:18:06.484, Speaker D: And it's possible that the host is doing everything sufficient and we just need to do something on the guest side to have the TDX guest device appear.
05:18:06.944 - 05:18:52.864, Speaker A: Exactly. Also to my understanding from you only can generate the attestation after you boot your machine and then generate it from within the machine. But I would like to experiment how would I generate this measurement without booting this machine? Like if I can build the image and then from outside generate the measurement, this would be actually more devx, better for the devx than just booting the image once to generate the measurement and then close it. Because I wouldn't expect everyone that is trying to use service running in tee to build reproducibly the image and then reboot it once to get the measurement and then do the attestation. This would be too much.
05:18:56.284 - 05:19:06.444, Speaker D: Yeah, I definitely think that you shouldn't have to run a TDX image and do the attestation step just to figure out what the reference reference value should be. You definitely don't have to in SGX.
05:19:07.144 - 05:19:20.564, Speaker A: Exactly. And I want to have something like that. I want to build it. If it's not even there, maybe we can look into ways to expose it if we use the specs, if they offer such a thing and we can build it on our own.
05:19:21.984 - 05:19:49.250, Speaker D: I found that there was an Ubuntu package that is Linux modules. I mean I found this pilot searching for the repo for issues in that canonical TDX repo. But I don't know, maybe it's relevant. I'm just suggesting other things that are troubleshooting that might add support for the TDX guest device guest side. So clearly TDX is there, but maybe the, maybe there's something simple to add.
05:19:49.282 - 05:19:54.202, Speaker A: The TDX guest what are you looking at Frieder?
05:19:54.258 - 05:20:27.684, Speaker B: This is interesting, the initial Linux patch for enabling TDX guest support and it's actually just talking about the report generation. And I'll give you another, just to give you an idea. So this is constellation enabling their TD expert azure. They mentioned something here.
05:20:29.184 - 05:20:38.644, Speaker C: I have the links to all the patches that intel tried or tries or is trying to upstream. I'm going to share it here.
05:20:39.984 - 05:22:05.924, Speaker B: This is what they said end of last year. Their early evaluation results is they're missing a feature which is exactly this there. It's not possible to access the TD report within Azure and that's a missing requirement for the remote attestation. And if you've read the Slack channel, like the sub messages for the attestation that I've been talking with Andrew, we figured out that you can get the TD report for the VTPM VM but you can't let so that there you can get an attestation and a quote, a TD quote for this one but you can't get it for the actual VM you're running and like Azure is just using their own remote station and telling you yes, you're running inside of a TDX VM. So that's the idea I have of it. Now I just wanted to check here this patch, whether or not we need to add anything additionally to get the TDX guest module running or how we could verify whether it's running or not.
05:22:10.984 - 05:22:43.264, Speaker A: Interesting. So if I understood correctly, this post is from end of 2023, so it's quite recent, but maybe they did some changes for that. But if not, my first thought is if we have some connections there that we can reach out and ask them. But yeah, this seems like if I understood you also correctly that it means that we are, when we are attesting that we are running there, we are basically attesting their vtpms. So basically their cloud, this kind of cloud attestation, more or less not really VM attestation.
05:22:43.924 - 05:22:58.824, Speaker B: Yeah, we're testing their vtpms and we don't have the source code for that. We might have, there's a VTPM image on GitHub that supports reproducible builds. We could check whether that's the same.
05:22:59.004 - 05:23:01.648, Speaker A: Okay, so it's kind of blind attestation even.
05:23:01.816 - 05:23:02.800, Speaker B: I'm sorry.
05:23:02.992 - 05:23:13.604, Speaker A: So it's kind of type of a blind attestation even like we are just attesting against, against an image that they created without being weaving able to inspect it. Right.
05:23:15.304 - 05:23:23.248, Speaker B: I don't understand it yet. And we definitely need someone, somebody from Azure explaining this to us because yeah, it doesn't make sense.
05:23:23.416 - 05:23:51.204, Speaker A: Yeah, it doesn't make sense for attestation purposes if it's like this. But yeah, we should definitely be able to reach to the TDX guest module to be able to generate this TD report otherwise. Yeah, this is not the way to do it. Or at least I don't see way or this is just like kind of trust me issue.
05:23:51.564 - 05:24:00.304, Speaker B: Yeah. And I just see this is the wrong patch I'm looking for. It says here support for the TD report generation already exists in the TDX driver.
05:24:01.644 - 05:24:11.012, Speaker A: Could it be possible that you're, that you have to install this driver manually on your VM machine upon boot upon like upon the first startup?
05:24:11.148 - 05:24:19.656, Speaker B: No, it's a Linux driver. And so can you tell me about.
05:24:19.680 - 05:24:41.484, Speaker D: The TDX module in the Ubuntu that you have? I'm curious if we can look up the version of it. I mean all the things that I can tell basically say looking for the TDX guest device is the main way to check if you've got the TDx driver and clearly we have some kind of TDX mod probe that's present. But I wonder if it comes with a version number or something like that.
05:24:43.184 - 05:25:02.080, Speaker B: I think this is the TDX driver. If I'm not private, it doesn't give me any errors. So my guess is, and I couldn't find it as a module. So I guess it's just, it's not added as a module, but I'm directly within the kernel.
05:25:02.232 - 05:25:08.044, Speaker D: That's just we look at the packages that are installed like for.
05:25:11.654 - 05:25:13.606, Speaker A: Well, it's.
05:25:13.630 - 05:25:25.914, Speaker D: Going to get something to search for that had TDX. But the one that I'm thinking of, I mean with the TDX or with the canonical TDX Ubuntu one, it's this Linux module's extra package.
05:25:27.214 - 05:25:28.634, Speaker B: Yeah. Let's have a look.
05:25:43.354 - 05:26:00.654, Speaker D: This is in the Sara Tdxgas shop.
05:26:05.294 - 05:26:19.834, Speaker B: I'm not going to do this on the production machine. Maybe we should do it on a different one. I don't know. This could easily mess up the whole system and then we don't have any TDX folder anymore.
05:26:21.614 - 05:26:43.324, Speaker A: Maybe, could we somehow, maybe Mateusz could, could we just run, create a new instance for TDX? Just a minimal one, not very big, and just for playing our own purposes for the attestation and breaking it and breaking it and so on.
05:26:44.304 - 05:26:46.004, Speaker B: I mean I can do that.
05:26:47.824 - 05:27:38.576, Speaker A: So yeah, let's do this. I would say let's just create a new very minimal one. We don't need 500 gigs of ram just to break it and see if we can get in this TD report or TD guest module running this would be great actually. We can manage this. Here are the images that you can select from, which is the latest one that you are able to have. Because the TD canonical start with 24 I think, or 23. Oh, the latest 22.
05:27:38.576 - 05:27:43.004, Speaker A: Interesting. See all images? Maybe they are more.
05:27:46.324 - 05:27:49.104, Speaker D: Aren't we just building our own images or we're.
05:27:49.484 - 05:27:59.664, Speaker B: No, we're just taking these ones. So there's a red hat and a ubuntu and that's it.
05:28:00.764 - 05:28:03.236, Speaker A: Could we provide. Ah, here Ubuntu 24.
05:28:03.380 - 05:28:04.544, Speaker D: I saw 24.
05:28:08.624 - 05:28:13.684, Speaker A: But it's not a server. But it's okay. We can use this, I think.
05:28:15.104 - 05:28:16.524, Speaker B: How can I use it?
05:28:18.544 - 05:28:25.844, Speaker A: By selecting the one, if you go back. There was a select. Yeah.
05:28:28.024 - 05:28:30.484, Speaker B: No, it's not compatible.
05:28:31.144 - 05:28:43.064, Speaker A: Oh wow. Okay, so these are the recently used. Is there a compatible one for confidential VM like Ubuntu confidential VM 24?
05:28:43.964 - 05:28:57.144, Speaker B: No, like I search for and no, I don't see any.
05:28:57.924 - 05:29:12.244, Speaker A: Okay, that's sad. Is there a way where we can provide them our own built image of Ubuntu? Like if we pass them this for example, the one that we just built.
05:29:13.624 - 05:29:17.688, Speaker B: Yeah, there's a possibility this possible. Yeah.
05:29:17.856 - 05:29:41.454, Speaker A: I wonder if we can follow the TDX canonical steps where we can create the TDX VM guest VM and then put it up there instead and see if that will expose the TDX guest instead. That would be. What do you think, Andro? I think that should probably allow it.
05:29:43.834 - 05:29:51.614, Speaker D: Yeah, that would be, yeah, if you just upload your own guest image and that's one of the options, then that would think of that.
05:29:53.054 - 05:30:04.154, Speaker A: Yeah, exactly. Because when we upload it there, then it will include also the setup files of the testation that they add in canonical so we can directly run them up and see what will happen.
05:30:13.694 - 05:30:30.254, Speaker B: Okay, so these are the only images that pop up with confidentiality out. If I search for confidential and this one I tested and it didn't work. So we can only, of the images available from canonical is the only one that works.
05:30:36.314 - 05:30:41.214, Speaker D: I mean, when you said you ran the 2401, did you run the setup TDX guest things?
05:30:41.674 - 05:30:48.514, Speaker B: No, it's, if I add this here, it will just say no, you cannot add it, it's not supported.
05:30:49.094 - 05:30:49.994, Speaker D: Oh wow.
05:30:50.734 - 05:30:54.434, Speaker A: Yeah, it's not confidential, not configured.
05:30:59.934 - 05:31:08.194, Speaker D: Oh wow. Okay. And presumably if we just upload our own image, it also won't. Yeah, I'm confused then.
05:31:12.854 - 05:31:30.074, Speaker A: From the canonical repo itself. So basically it's being configured. But I don't see here the option where we can upload our own image. Maybe three nose.
05:31:30.414 - 05:31:58.254, Speaker B: Yeah, there is an option, we can upload one, but that's quite a complex thing. You need to have your own image gallery, which I have configured so. But you need a vm, sorry, a vHD file. And that VHD file needs to be in a special format and yeah, we can do it, but, but it's going to take, it's going to take more time than we have left.
05:31:58.554 - 05:32:19.386, Speaker A: I see. Okay, no problem. But would be definitely like beneficial to try if we have the time for later, not today, but at some point, because it'd be interesting to see if we can achieve this on azure and expose, like expose the module.
05:32:19.530 - 05:32:22.866, Speaker B: Yeah, I mean the plan is I'm just gonna start this VM and then.
05:32:22.890 - 05:32:25.426, Speaker A: I'm gonna run the scripts directly.
05:32:25.570 - 05:32:26.294, Speaker B: Yeah.
05:32:27.434 - 05:32:42.074, Speaker A: I assume they won't work. They expect, I think somewhere I read that they expect Ubuntu 23 and above, not 22, but let me check this again just to be sure. I don't want to give false info.
05:32:46.494 - 05:32:59.738, Speaker D: I mean, there should be no problem. And well, this is running the guest image, not the, not the host. I just got confused about the difference between this and the STP.
05:32:59.826 - 05:33:22.234, Speaker A: Yeah, yeah. At some point they put requirements for this and then required for that, and then you get confused between the two. But yeah, you're right, it should be just for the host. All right, then it should be working. It.
05:33:48.594 - 05:33:49.574, Speaker B: Okay.
05:33:51.314 - 05:33:52.294, Speaker A: Let'S go.
05:34:43.754 - 05:34:45.934, Speaker B: Yeah, I just saw an issue here.
05:34:49.314 - 05:35:01.654, Speaker A: What does it say? Yeah, exactly. That's what I saw somewhere. So I'm not sure if it's gonna work out of the box now.
05:35:22.374 - 05:35:27.034, Speaker B: I'm not sure if we're gonna, if we're wasting a lot of time here because.
05:35:28.734 - 05:35:33.614, Speaker A: I mean, if it's explicitly, right.
05:35:33.654 - 05:36:12.454, Speaker B: No, I mean like, so canonical provides a Ubuntu image for TDX on Azure and it's explicitly. And if I mod prop the TDX guest, there's no error. So I'm guessing it's inside of the kernel. Let me, let me think about this.
05:36:13.434 - 05:36:16.490, Speaker A: I wonder if it's suppressed or somehow.
05:36:16.682 - 05:36:46.874, Speaker B: No, I'm just thinking what if hyper V, like what if Azure has not enabled this in their hyper V implementation of TDX? What if that's the reason why we're seeing this? What if it's the reason is actually that it's a preview and that's why we can't get the TD quotes in this way, but we have to get it in another way or something like that.
05:36:48.214 - 05:36:49.944, Speaker A: I mean, even the other way, it's.
05:36:52.934 - 05:37:04.566, Speaker B: Somehow not the VTPM quote, but maybe. Yeah, I'm not sure it's clear that.
05:37:04.590 - 05:37:14.914, Speaker D: TDX require, I mean, that attestation, you know, requires this extra support from the host, so it's not. Yeah, exactly what you suggested. Treater is, I think a very likely.
05:37:20.074 - 05:37:41.974, Speaker B: So should we go further into this path or should we just accept that we need more info and we need to talk to Azure and other people who might know, and I mean, that would save us more time and they can tell us, look, this is the case, this is what's going on. And then.
05:37:46.404 - 05:38:00.824, Speaker D: I mean, I would suggest that if we have, I mean, what we want to be able to figure out how to do is how to have the guest support in yocto anyway. So, I mean, even if we don't need Azure to go down that path.
05:38:01.204 - 05:38:01.588, Speaker A: Yes.
05:38:01.636 - 05:38:04.384, Speaker B: Well there's guest support in that, in yokto already.
05:38:06.324 - 05:38:08.452, Speaker D: Including the TDX guest device.
05:38:08.628 - 05:38:09.384, Speaker B: Yes.
05:38:12.324 - 05:38:16.428, Speaker D: Can we finish attestation on yocto? We already have the TDXguest device there.
05:38:16.596 - 05:38:16.996, Speaker B: Okay.
05:38:17.020 - 05:38:25.624, Speaker D: Yeah. Then the only thing next should be to run that sample code, which is just that with TDX test package.
05:38:26.004 - 05:38:44.240, Speaker B: The TDX guest, like the kernel driver for TDX guest is in the kernel for the octo image. But if I run it on Azure, I'm not seeing the station device but.
05:38:44.272 - 05:38:46.844, Speaker D: Being running it on one of the other hosts.
05:38:47.584 - 05:38:55.644, Speaker A: Or let's try to run it on the bare metal that Andrew has. So basically we can run it there. So already set up.
05:38:56.544 - 05:38:58.204, Speaker B: Sure. Okay.
05:39:00.544 - 05:39:27.134, Speaker A: But now you already run the script and it where like if you can see device somehow or if you can see that path that is installed, where you can go to the examples and maybe generate the quote maybe, who knows? Most probably it won't work.
05:39:27.174 - 05:39:36.054, Speaker B: But it looks like it just added some modules and some kernel configuration. I might need to reboot.
05:39:36.134 - 05:40:03.994, Speaker A: Restart. Yeah, I need to reboot. Also, another question. So you mentioned that you can do mode probe TDX guest and it doesn't crash, doesn't fault, which I saw with you earlier today. The question is if we try now from within a TDX virtual machine on Azure to use that device from like from the library that Andrew show us, would it say like device not found or would it still be.
05:40:06.014 - 05:40:06.638, Speaker B: The device.
05:40:06.686 - 05:40:15.794, Speaker A: Not there, but still like the mod probe was actually enabling it somehow but not really enabled. Okay, I see it was suppressed down.
05:40:17.534 - 05:40:18.314, Speaker B: Hmm.
05:40:20.574 - 05:40:26.334, Speaker A: I wonder what's the rational decision behind this from their side?
05:40:26.834 - 05:40:32.778, Speaker B: I don't know. We need to figure out, but I think we're wasting time here.
05:40:32.946 - 05:40:44.734, Speaker A: Yeah. All right then let's try the bare metal now since we already have a host already configured and the image is already built just to create more command.
05:40:50.774 - 05:41:32.414, Speaker B: 1 second. So this, these are the images that we have at this point. Are you able to boot vic images, Andrew, on the bare metal?
05:41:32.874 - 05:41:40.394, Speaker D: On the bare metal? Not sure how not sure.
05:41:42.974 - 05:41:51.954, Speaker B: Okay. I might be able to provide you. What do you need? Is it cue cow or something? What do you need.
05:41:56.334 - 05:42:05.534, Speaker D: To boot a TD guest from the, from the bare metal? Host? Yeah, cue cows. I think Facebook.
05:42:32.894 - 05:42:34.434, Speaker B: That's two, right?
05:42:37.094 - 05:42:38.394, Speaker D: Yeah. Kikatu.
05:43:20.194 - 05:43:27.824, Speaker B: Can you copy it over to, to your place? The bare metal, is that possible?
05:43:31.844 - 05:43:37.984, Speaker D: Yeah, I think that should work. Do you have, um. I thought I already added you on this and I know I just added mo now I'm trying to make sure he's set up.
05:43:40.604 - 05:43:50.376, Speaker A: Yeah, I recall Freedr got access to it. You got added to iteration I think, two weeks ago or one week ago.
05:43:50.520 - 05:43:55.884, Speaker B: Yeah, I remember as well. I don't think I've followed the setup.
05:43:58.784 - 05:44:07.364, Speaker A: I can share with you the command that once Andrew shared with you how to log into it.
05:44:09.624 - 05:44:13.084, Speaker B: Do I need a password? Because then I need to stop sharing.
05:44:13.524 - 05:44:16.980, Speaker A: I didn't need like Andrew gave me.
05:44:17.012 - 05:44:18.504, Speaker D: I need you by sshk.
05:44:20.484 - 05:44:22.620, Speaker A: Okay, exactly.
05:44:22.772 - 05:44:27.944, Speaker B: I just need the username and Ip address. Can you share that with me?
05:44:28.244 - 05:45:19.904, Speaker A: Yes. Let me fetch it. Where was that? It was a while ago apparently. Yeah, I saw the. So the conversation. Let me see. What's this one? For some reason I can see that the discussion was far, far away in the past.
05:45:24.404 - 05:45:25.824, Speaker B: I'll have a look at both.
05:45:30.144 - 05:49:21.424, Speaker A: It. It. Oh, okay. Hang it.
05:50:21.084 - 05:50:34.384, Speaker B: Okay. I have access then I've built the image. I'm going to start again.
05:50:35.044 - 05:50:35.824, Speaker A: Cool.
05:50:58.384 - 05:51:24.144, Speaker B: Yeah, that's the QCOs most recent one, but I'm not sure I need all of this like proxy command and stuff like that. Can I just. SCP.
05:51:27.004 - 05:51:41.684, Speaker D: SCP should work. I have, I mean, yeah, I have this just for the little page kind of thing that I have. I've added those parameters. Rather than a one line. I can show you what I add to my ssh config and then SCP works.
05:51:42.184 - 05:51:46.444, Speaker B: Okay. Like this doesn't work. Okay.
05:51:47.464 - 05:51:55.044, Speaker D: There's a way to make it into one line, but you almost have to pass the ssh. You have to pass it slightly differently. It's easier if I just show.
05:51:55.684 - 05:52:06.172, Speaker B: Yep. Please. Do you want to share your screen or do you, um. Are you going to paste it in the chat?
05:52:06.188 - 05:52:07.744, Speaker D: I'm going to paste it for you inside.
05:52:08.604 - 05:52:10.380, Speaker B: Can you place it in the chat?
05:52:10.572 - 05:52:12.784, Speaker D: Probably, yeah, I can do that.
05:52:20.504 - 05:52:21.244, Speaker A: It.
05:53:01.564 - 05:53:58.384, Speaker B: Works. That's low. Where's the. Where's the located?
05:54:02.924 - 05:54:23.204, Speaker D: This think California and it's basically locked down, so I don't have any good way to share it except by this page kite outgoing tunnel thing.
05:54:25.184 - 05:54:35.504, Speaker B: Is it from intel or where did you get the. Yeah, from intel, but it's only. How long do you get the access for? A month or how long?
05:54:37.124 - 05:54:42.900, Speaker D: I'm going to do internship project on it, so maybe they'll extend it for me, but don't know yet.
05:54:43.092 - 05:54:51.264, Speaker B: Yeah. Okay. Is that where you going to extend the TDX module to get the ax notify?
05:54:51.764 - 05:54:54.264, Speaker D: Yeah, exactly. That's the main hook part.
05:54:54.644 - 05:54:56.384, Speaker B: This is such a nice project.
05:54:57.144 - 05:54:58.004, Speaker D: Totally.
05:55:09.504 - 05:55:17.964, Speaker A: So you are going to build something similar to VM exit notify. Like VM aware of exiting and re entering.
05:55:19.264 - 05:55:20.336, Speaker D: Yeah, that's the plan.
05:55:20.400 - 05:55:20.600, Speaker B: Yeah.
05:55:20.632 - 05:56:25.294, Speaker D: I mean, yeah, exactly. Like what AEX notify does for SGX, you know, to do TDX notify for the same reason and ideally use AEX notify not just to prevent single stepping like its main uses, but also use it to prevent, you know, you can abort if you can detect a page fault has occurred which would indicate it access oracle being exploited. And so some kind of. But there shouldn't be, there shouldn't be anything distinct about this environment, this SDP environment. So like the Alibaba one, I mean Azure seems to be the odd one out that has their own interlayer where you submit a guest image to them and they take care of the running it for you like, and OVH seem to be closer to this where you have access to the host and it's up to you to run your own Kimu instruction to run your TD.
05:56:28.914 - 05:56:45.210, Speaker B: The problem is with OVH we don't have any kind of cloud attestation, so a TDX server running with an OBH is the same thing, running it in your side channel slab.
05:56:45.402 - 05:56:59.490, Speaker D: I see what you mean. You can't, they don't. I was thinking that, I mean I take what you're saying to me that they don't provide a way that's, you know, streamlined at least, or that, you know, you can tell that you can certify that this is an OVH node.
05:56:59.642 - 05:57:00.314, Speaker B: Yeah.
05:57:00.474 - 05:57:12.304, Speaker D: But I was wondering whether or not there's a way to retrofit one. They might not, you know, try to make it impossible. It's just not a feature that they've added. But maybe there's some plausible ways to give some evidence.
05:57:12.644 - 05:58:14.974, Speaker B: I think this is some, this is a really interesting project to have. Something, I don't know, some kind of way for cloud providers to prove that the TDX VM is actually running within their Rio, that could actually be even be implemented as software as part of the code within the VM. Like if we could, if the, if OVH would run a server that lets you connect and, and you can, from the TDX VM you can connect and you can just check the latency. But again the answer from OVH must be in this in a way that you can verify that it's actually coming from OVH, stuff like that.
05:58:15.394 - 05:58:16.174, Speaker D: Yeah.
05:58:29.054 - 05:58:59.714, Speaker A: But isn't this orthogonal? A little bit regarding the attestation itself? Like if you can attest the VM itself, and this would be one thing, and attesting that this is running on an OVH machine, this is something not part of like it's separate, orthogonal to the attestation process, like, or complementary, I would say. But not really attestation specific, if I'm not wrong.
05:59:00.854 - 05:59:09.634, Speaker B: No, it's, it's complementary. So cloud attestation, it just helps you to verify that it's running on that premise.
05:59:11.014 - 05:59:30.654, Speaker A: Yeah. But in general, this is also a main problem. Like it's not TDX problem, it's also sGx problem. So yeah, if I have a rack here running your sgx, you wouldn't know if it's aws or some rack somewhere.
05:59:47.734 - 06:00:01.114, Speaker B: So just copying over the image, I've removed the r builder and wrath and the flower binary, and it's a little bit more than ten megabytes of size.
06:00:04.494 - 06:00:11.534, Speaker A: That's small, but not uni kernel small.
06:00:11.954 - 06:00:42.664, Speaker B: No. Andrew, do you want to take over from here? I think you have the QMU commands set up and you know how to start it, right?
06:00:44.724 - 06:00:46.172, Speaker D: Yeah, I guess so.
06:00:46.348 - 06:00:47.064, Speaker B: Sure.
06:00:48.884 - 06:00:50.424, Speaker A: The command can be taken.
06:00:56.004 - 06:01:11.774, Speaker D: Because I'll just go copy this and kind of place it where will either rename them or, you know, change how it's run in the script. I think that makes sense.
06:01:12.194 - 06:01:12.974, Speaker A: Yeah.
06:01:16.394 - 06:01:21.454, Speaker B: Do you have a serial console to access when you start the mu?
06:01:23.194 - 06:01:35.394, Speaker D: What do you mean? Well, yeah, when I run it suggests it prints a little message to recommend connecting by ssh. And so.
06:01:36.174 - 06:01:36.622, Speaker B: Yeah.
06:01:36.678 - 06:01:53.514, Speaker D: Yeah, I think you're right. I don't think I have that. Yeah, I'm sure I can figure out how to deal with it. We'll start with, start looking around an image and then do run. So I just want to, I'll just copy over.
06:01:56.074 - 06:02:18.774, Speaker A: I wonder if you need to run this command that created the image because some part of it, it's doing vert customize on the image itself to add the setup files and attestation files and running them and cloud init and so on. Maybe in this case, I don't know. Maybe you don't need to do this. Maybe you can just run it and clone the repository and install.
06:02:19.694 - 06:02:24.234, Speaker B: No, it's a CVM image. It starts.
06:02:26.494 - 06:02:27.794, Speaker D: I see this one.
06:02:29.934 - 06:02:31.434, Speaker A: Yes, this one.
06:02:48.834 - 06:03:29.034, Speaker D: Okay. Are these all right? Are they all plus x? I don't know if that's important. And. Okay, so I was simply going to change it like this.
06:03:49.674 - 06:03:50.494, Speaker B: All right.
06:03:50.954 - 06:03:52.654, Speaker D: That should be the only difference.
06:04:01.854 - 06:04:16.074, Speaker A: It might not work out of the box because of the, of the setup of the image setup. Right. Because it's creating the guests and so on the user. But maybe I'm wrong.
06:04:16.814 - 06:04:33.374, Speaker B: It's probably, it's probably the. It will fail because it's. It will have setting up the networking. Is there a way you can access the console?
06:04:36.194 - 06:04:45.454, Speaker D: Yeah, I mean maybe you can just tell me what to do. I didn't pay close enough attention to the QEMU functions you would be running, but I assume that that's something I can just do through here.
06:04:45.794 - 06:04:52.134, Speaker B: Can you remove the demonize? It's in the behind, no graphic.
06:04:52.894 - 06:05:12.114, Speaker D: I see. I don't know if that's going to work but let's see here. Okay.
06:05:17.694 - 06:05:46.644, Speaker A: What'S this? Discarding ram in private file mapping. Okay, in what way we are discarding ram and private files Frieder?
06:05:47.264 - 06:05:55.364, Speaker B: I don't know. I would like to just see the error again, but.
06:06:01.464 - 06:06:26.704, Speaker A: There it is. No, I'm not sure. This Tempdx guestd log probably is the file that is dumping.
06:06:54.064 - 06:07:00.964, Speaker B: Oh no, it has KVM acceleration enabled.
06:07:14.084 - 06:08:18.104, Speaker A: Just to see if it's working. Andrew, can you go to the run TD sh file again and comment out a couple of lines just to see if it works? Can you go down to the minus object checked TDX this comment if you want to comment this out and also in the line downwards there is this memory encryption equal to the x. If you can also remove it or just comment it out and then run the virtual machine with, because this way you would be running it without TDX aware, like without TDX virtual machine support just to see if it runs. And if it's just regarding visit the TDX problem in general.
06:08:18.584 - 06:08:19.604, Speaker B: That's a good question.
06:08:22.704 - 06:08:29.872, Speaker A: Because if it runs now, it means what happened? Suddenly this error is happening everywhere.
06:08:29.968 - 06:08:36.564, Speaker B: What is GTK? Why is it trying to initialize GTK? Are you, no you're not trying to.
06:08:39.944 - 06:08:56.854, Speaker A: Because I was able to run the mine without the minus object, without that thing and the minus machine and it still worked. I had demonized inside. You can add the demonized now and see if it would work.
06:08:58.434 - 06:09:12.674, Speaker B: No, the demonize won't work because you won't, you won't be able to ssh inside because there's a networking error with the, with the image.
06:09:13.254 - 06:09:30.514, Speaker A: Okay then let me, let's see if it's regarding the changes now it's erroring or regarding something else. I don't know why it's failing. That's weird.
06:09:36.314 - 06:09:42.574, Speaker B: Maybe I don't have the no default. Maybe you can remove that one.
06:09:44.554 - 06:09:45.570, Speaker A: Which one?
06:09:45.722 - 06:09:46.894, Speaker B: No defaults.
06:09:49.114 - 06:09:50.214, Speaker A: I have it.
06:09:56.874 - 06:10:18.084, Speaker B: And then there is, how about like what is the process and debug threads on. Oh.
06:10:19.984 - 06:10:55.084, Speaker A: Wait a second, wait a second. I think I know why. Let me share with you something thing Andrew, the minus machine at the end, this memory back end raml, can you change it to, can you remove it and put hpet equal off and. No no, remove the. Exactly. And then hpet equals off comma. Exactly.
06:10:55.084 - 06:11:28.292, Speaker A: And then. No no, it didn't add hpet equals off like only hpet equals off the memory encryption. You remove it because it's also TDX specific. The memory back end, I think. What's this, this object thingy? Well, I think there is a delay. So just remove the memory backend equals hpEd. This is not necessary.
06:11:28.292 - 06:11:44.024, Speaker A: And the line below it seems wrong. This is all wrong. I would remove it. This whole line. I would remove it. Yes, exactly.
06:11:48.904 - 06:11:52.648, Speaker B: I think you have to re enable the name stuff.
06:11:52.696 - 06:12:15.872, Speaker A: Yeah, yeah. And also there are no defaults. Never mind. Yes. You are too quick for my stream. Still failing.
06:12:16.008 - 06:12:21.204, Speaker B: Okay, so just GTK initialization. What's GTK?
06:12:22.664 - 06:12:27.884, Speaker D: GTK is the graphics toolkit. I'm still baffled that that shows up at all.
06:12:30.144 - 06:12:39.784, Speaker B: Can you add a. No. VGA as a. Yeah, and try.
06:12:45.004 - 06:13:16.296, Speaker A: Okay, I will give you my command in the chat I sent you the command in the chat that you can replace with this in the script completely and try it now instead of this what you have, place it with it and just see if it's gonna make a difference because this, this is what I'm running to run it on my laptop without the DX. Like I made it like a. Just to make it reproducibility.
06:13:16.360 - 06:13:17.296, Speaker D: Here, you just run this anyway.
06:13:17.320 - 06:13:17.472, Speaker B: Yeah.
06:13:17.488 - 06:13:22.124, Speaker D: Okay. So this is a good starting point. Yeah, great.
06:13:22.944 - 06:13:34.504, Speaker A: This one should be working. It's not what's happened? Maybe the indentation or something.
06:13:35.604 - 06:13:38.052, Speaker D: No, it says, I mean, everything says fine.
06:13:38.228 - 06:13:38.944, Speaker A: Yeah.
06:13:41.804 - 06:13:43.824, Speaker D: Is it using the same TD image?
06:13:44.564 - 06:13:45.508, Speaker B: Oh yeah, it is.
06:13:45.596 - 06:13:47.636, Speaker A: Okay. It is. It is.
06:13:47.820 - 06:13:48.704, Speaker D: Okay.
06:13:50.404 - 06:13:52.424, Speaker A: So can you.
06:13:55.464 - 06:13:57.136, Speaker D: Do you think SsH should work?
06:13:57.320 - 06:14:03.764, Speaker A: No, no, you can, you can ssh now and I think it should. If it's running, then it means that.
06:14:04.624 - 06:14:13.164, Speaker B: It'S not going to. It's, it will have difficulty setting up the networking device so you can use demonize.
06:14:13.624 - 06:14:14.504, Speaker A: Ah. So. Okay.
06:14:14.544 - 06:14:14.696, Speaker D: Yeah.
06:14:14.720 - 06:14:16.484, Speaker B: Okay. Yeah.
06:14:18.184 - 06:14:43.628, Speaker A: But if it's now works for some reason, then it would only mean that the coct image is not TDX aware for some reason, and it's not. Some changes should be done in what happened. Now for me, it's kind of frozen. Interesting.
06:14:43.676 - 06:15:01.924, Speaker D: What am I expecting? Maybe it's still stuck on the network. If you think that's.
06:15:07.064 - 06:15:10.324, Speaker A: Could it be the networking stuff breeder?
06:15:12.084 - 06:15:15.984, Speaker B: No, I don't think so.
06:15:17.924 - 06:15:35.464, Speaker A: So it's a different issue. By the way, would you try on your site reader if you can run the image directly with your KMO, like with the normal commands and see if it would work from like by chance.
06:15:35.764 - 06:15:41.000, Speaker B: Yeah. Been doing this the whole time. Running it in queue.
06:15:41.192 - 06:15:46.644, Speaker A: Yeah. But not the QCow two. Right. Different type we were running.
06:15:47.904 - 06:15:55.404, Speaker B: Okay. Do you think it's the imaging of the QCow? I don't know. Moving it, like converting the image to Q cow.
06:15:56.144 - 06:16:00.832, Speaker A: Maybe after we tried, not after, maybe I can just.
06:16:00.968 - 06:16:02.484, Speaker B: Yeah, I mean, I could.
06:16:08.004 - 06:16:12.384, Speaker A: Just to rule out some potential outliers.
06:16:24.004 - 06:16:30.764, Speaker D: When I cancel the script report. Similar trouble, I guess.
06:16:33.704 - 06:16:37.764, Speaker A: I guess it's somewhere looping inside doing some.
06:16:45.744 - 06:16:47.324, Speaker B: No, it boots for me.
06:16:47.984 - 06:16:57.972, Speaker A: It boots for you. Okay, so some of those commands are. Yeah, I see you added, if you.
06:16:57.988 - 06:17:14.424, Speaker B: Check out my, I also pasted the command, which is how I run it in Qemu in the chat. You could try using that, but it introduces some stuff that we might need to change.
06:17:16.164 - 06:17:18.132, Speaker D: You pasted it in the zoom chat?
06:17:18.268 - 06:17:23.764, Speaker B: Yep. It's a, it's, um, it's older, it's above, um.
06:17:25.184 - 06:17:26.764, Speaker D: Oh, okay.
06:17:30.144 - 06:17:36.844, Speaker A: Oh yeah. But you need to change probably some kind of passes there. The file. Oh, ubuntu feeder. Pokey.
06:17:42.344 - 06:17:46.244, Speaker B: You can remove some stuff like, I don't think you need to usb devices.
06:17:50.144 - 06:17:59.240, Speaker A: But then you can run this directly here without changing the script. Andrew, you can run QMO. Run, run QMo and pass these.
06:17:59.312 - 06:18:04.768, Speaker D: Run it. Right? Yeah. No real reason to. Sure. I don't think I picked up the whole thing.
06:18:04.816 - 06:18:05.604, Speaker B: Hold on.
06:18:10.724 - 06:18:17.044, Speaker A: And also there is the file passed to the image. Probably should change, which is your freedr pokey build.
06:18:17.124 - 06:18:22.236, Speaker B: Yeah. There's quite a few things you need to change. I would probably add it, add it to the script.
06:18:22.300 - 06:18:28.744, Speaker D: This looks like it's incomplete. If you meant that you just pasted the arguments that come after the cumulative, that's fine.
06:18:30.204 - 06:18:56.952, Speaker B: Okay. The way it's configured here, it's expecting a network device, a tap device. It's already set up by a different script. So this one you would also remove, I think for beginners. This doesn't matter. We don't need networking.
06:18:57.008 - 06:18:57.924, Speaker D: This will not.
06:18:58.264 - 06:18:59.844, Speaker B: Yeah, you can just remove it.
06:19:01.504 - 06:19:06.564, Speaker D: All right. This. Divert this whole thing then for networking. Yeah. Okay.
06:19:06.724 - 06:19:09.732, Speaker B: I'm not sure if we need the random, random number generator.
06:19:09.748 - 06:19:11.664, Speaker D: That's not good. I want to do cryptography.
06:19:12.164 - 06:19:25.664, Speaker B: Okay. Yeah, that stuff, um, you would probably want to give it a.
06:19:33.704 - 06:19:35.604, Speaker D: All right, that should pick up that one.
06:19:36.144 - 06:19:41.484, Speaker B: No, you need to give it the qcal, not the raw format.
06:19:41.904 - 06:20:02.744, Speaker D: Oh, I'll go fix that in a second. So I hit enter USB tablet, keyboard flash. You have this other one a second one.
06:20:04.044 - 06:20:13.064, Speaker B: Oh, that's the UEFI. And you probably, you have added that as well, but in a different way.
06:20:15.004 - 06:20:25.434, Speaker D: Okay, so that's something also that's in the images file, but I think it just hadn't changed. I'll also go double check that one in a second. Cpu. That stuff. I don't know.
06:20:29.534 - 06:20:30.554, Speaker B: Yeah, I think.
06:20:33.454 - 06:20:35.834, Speaker D: Those. And get wrong files. Okay.
06:20:45.544 - 06:20:51.544, Speaker B: To. And then.
06:20:51.584 - 06:20:59.044, Speaker D: Is there an ovmh or something? I'm not sure what to put for this. Or just remove it, check it.
06:21:00.504 - 06:21:06.404, Speaker B: Run TD script. It mentions an ovH. OVmf.
06:21:10.664 - 06:21:11.684, Speaker A: Or you can.
06:21:15.354 - 06:21:25.934, Speaker B: So that's. Yeah, what, what is in the TDF. TDFV firmware? Um, argument.
06:21:26.514 - 06:21:35.282, Speaker A: This thing I just posted in the chat, the user share ovmf. OVMF file descriptor.
06:21:35.458 - 06:21:46.594, Speaker B: Okay, well, yeah, maybe you can just remove, remove then the drive. Yeah, I mean, maybe you can just add it like that.
06:21:47.694 - 06:22:06.242, Speaker D: Okay, I'll remove the drive and add it like that. And I'll put that name in. What came next?
06:22:06.438 - 06:22:07.534, Speaker B: OvMf.
06:22:07.914 - 06:22:09.014, Speaker C: Ovmf.
06:22:09.874 - 06:22:16.014, Speaker A: No, small, small ovmf. The first one. And now.
06:22:16.834 - 06:22:49.994, Speaker D: Oh yeah, I want tcac snake oil. Was I too clever there that didn't pick this up? Got further.
06:22:53.814 - 06:22:59.094, Speaker B: Complains about a failed five weeks.
06:23:07.954 - 06:23:13.214, Speaker D: How do you break out further than I meant to?
06:23:33.054 - 06:23:34.554, Speaker B: Do you have any idea?
06:23:38.534 - 06:23:38.934, Speaker D: Yeah.
06:23:38.974 - 06:23:56.094, Speaker C: Maybe pass this as a kernel command line. I just paste it in the chat.
06:24:10.754 - 06:24:15.794, Speaker A: A queue is missing at the start from the command.
06:24:21.614 - 06:24:23.074, Speaker C: Okay. No.
06:24:26.174 - 06:24:54.184, Speaker B: Yeah, but I see this command has two serial arguments which were missing in the. And the run TD script. Maybe, maybe these are the ones that will allow us to have a serial console.
06:24:55.844 - 06:25:02.944, Speaker C: No, but now the problem is that the boot device is not there or Kimu thinks that it's not there.
06:25:14.384 - 06:25:19.800, Speaker B: Yeah, because here we have, we're defining a bias. And the other one, it's.
06:25:19.952 - 06:25:33.804, Speaker C: Wait, wait, why? The format is raw. It should be Q cow. So the if, if equals none, blah, blah, blah. And the very end of this is Q cow too.
06:25:35.144 - 06:25:36.124, Speaker A: That's true.
06:25:40.224 - 06:25:43.684, Speaker D: Was the error we saw consistent with it getting stuck there? I could just remove that.
06:25:46.464 - 06:25:47.364, Speaker C: Oh, yeah.
06:25:49.064 - 06:25:49.844, Speaker B: Yeah.
06:26:05.164 - 06:26:31.164, Speaker A: Here we go. Yeah, this is still, by the way, this is without no root. Root login is root and without password. Yeah. This is, however, without TDX parameters for the QMO, I wonder parameter if we make it to the x. Aware if that would be. It would make it run or not.
06:26:31.744 - 06:26:34.444, Speaker B: Yeah, definitely. Let's try it.
06:26:34.744 - 06:26:45.480, Speaker A: So the ones that you commented out earlier, Andrew, from the, from the scripts that the minus object, TDX and so on. If you can add them to this.
06:26:45.512 - 06:26:46.164, Speaker D: Command.
06:26:48.144 - 06:26:58.684, Speaker A: And then minus machine as well. There was for the memory encryption. If you can add them to it, test. Yeah, probably.
06:27:01.384 - 06:27:06.804, Speaker D: Get it from script. This should be good enough for that.
06:27:07.704 - 06:27:09.840, Speaker A: And the format. Traw the format.
06:27:09.872 - 06:27:12.184, Speaker D: What's the best way to kill Kimo?
06:27:12.344 - 06:27:14.004, Speaker B: Roll A and then X.
06:27:19.204 - 06:27:27.144, Speaker C: Great. Can you also remove this CPU IV bridge? Because that's the ancient one. It should copy the host config.
06:27:28.004 - 06:27:28.864, Speaker B: Okay.
06:27:34.204 - 06:27:38.852, Speaker C: And why are we adding this USB tablet and USB keyboard?
06:27:38.988 - 06:27:40.424, Speaker B: Yeah, we can remove it.
06:27:49.104 - 06:27:51.912, Speaker A: The TDX part is missing though. The object.
06:27:51.968 - 06:27:53.164, Speaker D: Yeah, I'll add that next.
06:27:55.544 - 06:27:57.444, Speaker A: No, such a file directory.
06:28:00.144 - 06:28:13.544, Speaker B: I'm wondering, maybe the GTK initialization is something failing before the QMU system command.
06:28:17.524 - 06:28:18.944, Speaker D: I have a great way to.
06:28:21.444 - 06:28:21.860, Speaker B: Sort.
06:28:21.892 - 06:28:34.734, Speaker D: Myself out of this. I can go back to my reference for a second. What do we specifically want to try again to get further? Oh, just adding in the TDX objects.
06:28:35.164 - 06:28:40.864, Speaker A: Yeah, the TDX objects. And in the machine, there was also an extra thing that you can pass for the.
06:28:49.404 - 06:29:09.444, Speaker D: Yeah, the cpu. Make sure that's still good. Okay. And object. TDX guest id. TDX. That's the main one.
06:29:09.824 - 06:29:24.296, Speaker A: And the one in the machine as well, which is. No, not here. No. Up. If you go up to the original memory encryption. Yes. Memory encryption and the memory backend.
06:29:24.296 - 06:29:26.004, Speaker A: These two are.
06:29:30.224 - 06:29:36.764, Speaker D: All right. Well, even before that, I get this was adding in the object TDX.
06:29:37.064 - 06:29:38.284, Speaker A: It's panicking.
06:29:38.944 - 06:29:39.724, Speaker B: Yeah.
06:29:40.344 - 06:29:47.080, Speaker A: So this means the Yocto image is not TDX or we're somehow not configured for TDX.
06:29:47.232 - 06:29:50.936, Speaker B: Are you sure you didn't enable the memory encryption? Maybe that's the reason.
06:29:51.080 - 06:30:13.086, Speaker A: Yeah, let's try. Let's make it fully. That's a good point. The split part is also missing. I see. In this minus machine. How was it again, Colonel?
06:30:13.150 - 06:30:14.350, Speaker D: IRQ chip.
06:30:14.502 - 06:30:15.234, Speaker A: Yes.
06:30:28.394 - 06:30:36.494, Speaker D: All right, so we don't have the definition of the back memory. So we need to do.
06:30:40.634 - 06:30:44.594, Speaker A: The memory backend we had. Okay, interesting.
06:30:44.634 - 06:30:51.754, Speaker D: Okay, so we have a. So we define a memory object. This one's.
06:30:54.334 - 06:31:07.334, Speaker A: I think this is something that you did, Andrew. Right. Because this is not in the main repo. Or am I wrong? At least in my part? I don't have it. Let me check.
06:31:07.494 - 06:31:12.414, Speaker B: Can you add that object, the memory backend Ram? I didn't.
06:31:13.754 - 06:31:14.494, Speaker C: Because.
06:31:18.994 - 06:31:21.374, Speaker B: It'S complaining about dismissing. Right?
06:31:23.074 - 06:31:23.602, Speaker A: I don't know.
06:31:23.618 - 06:31:24.934, Speaker D: It's complaining about that.
06:31:25.914 - 06:31:36.466, Speaker A: Let me share with you here, Andrew. We can maybe. Look. So this is in the main repo of the canonical TDX. And this script. They don't have that completely. This line.
06:31:36.466 - 06:31:51.248, Speaker A: They also, they use Ram one they use. They don't have it at all actually. They use confidential minus guest minus support, equal to the x. This is why I was confused what you had there. The memory encryption is not.
06:31:51.296 - 06:31:52.536, Speaker D: Where did I get that from?
06:31:52.720 - 06:31:57.004, Speaker A: Yeah, exactly. I was confused why you have such a different configuration.
06:31:57.304 - 06:32:13.444, Speaker C: That's because it's coming from the older branch. That was default, maybe before the default branch was 23, Ubuntu 23. And now the default branch is 24 and the startup is different.
06:32:14.424 - 06:32:17.324, Speaker D: That makes sense. Which version?
06:32:17.704 - 06:32:20.044, Speaker B: 2023 or 24.
06:32:20.744 - 06:32:25.764, Speaker C: Let's refer. Let's use 23 as a reference. It's closer to our district.
06:32:30.244 - 06:32:32.144, Speaker A: So let's use this.
06:32:38.284 - 06:32:51.268, Speaker C: Unless you. And reused scripts from 24 branch for configuring the TDX host. I don't think I did.
06:32:51.396 - 06:32:56.544, Speaker D: So I think that this will all be everything I'm on here is the 23 point.
06:33:01.974 - 06:33:06.554, Speaker A: So the memory encryption. I'm not sure if this should be equal to DX.
06:33:11.294 - 06:33:39.644, Speaker D: I mean, I assume this is about whether it's using like private memory backends. I'd expect this with something that we have to configure like that. So we could either defer that for now or try to include it. It wouldn't surprise me. If that has to. You can have meaningful TDX attestation even without using that. So in a way I consider that a good optional one, especially for getting close to attestation working potentially.
06:33:39.644 - 06:34:00.108, Speaker D: And so it is still panicking and only removing the TDX guest object.
06:34:00.156 - 06:34:00.340, Speaker A: Right.
06:34:00.372 - 06:34:01.740, Speaker D: Was making that difference.
06:34:01.932 - 06:34:11.184, Speaker A: Yes. So that's why I wanted to check if it's TDX issue or a normal image issue.
06:34:12.284 - 06:34:23.524, Speaker C: But we didn't add the object, so we only added TDX. Right. But we didn't configure the Ram object, whatever that means.
06:34:24.584 - 06:34:26.164, Speaker A: You mean Ram L object?
06:34:26.464 - 06:34:27.244, Speaker C: Yeah.
06:34:28.024 - 06:34:39.850, Speaker A: I'm not sure if they are. Like if the two are the same time necessary to be, but maybe broken pipe.
06:34:40.022 - 06:34:40.594, Speaker B: Oh man.
06:34:40.634 - 06:34:41.214, Speaker C: Why?
06:34:41.794 - 06:34:42.978, Speaker A: What's happening?
06:34:43.146 - 06:34:48.214, Speaker D: I don't know. Maybe whatever I'm using as a front end is in time.
06:34:53.074 - 06:35:05.686, Speaker C: At least that what, what they do in the 23 branch of the repository, they configure both the memory backend and then the device. Okay.
06:35:05.710 - 06:35:10.870, Speaker A: It seems to be panicking in any way with or without the DX. So something is wrong.
06:35:10.942 - 06:35:11.594, Speaker D: Yeah.
06:35:12.014 - 06:35:12.598, Speaker C: Can we.
06:35:12.646 - 06:35:13.674, Speaker D: Yeah, that's right.
06:35:13.974 - 06:35:24.766, Speaker C: There are two minus m options at least that I see conflicting. What's that minus m? 100?
06:35:24.830 - 06:35:26.074, Speaker D: I say 129.
06:35:29.374 - 06:35:40.164, Speaker B: It's two times you. You can make it smaller second. That's probably too much. Not enough.
06:35:43.304 - 06:35:53.484, Speaker D: Okay, well, this is. Now I'm lost because I know that we did get further before. I have to go see what all has changed. I think we made a couple of changes at a time that actually.
06:36:00.364 - 06:36:00.676, Speaker B: We.
06:36:00.700 - 06:36:02.984, Speaker D: Removed all those USB devices for one.
06:36:04.564 - 06:36:10.464, Speaker B: But that still would work. I think that was the last one that actually worked.
06:36:26.944 - 06:36:29.204, Speaker D: All right, maybe I do need to go debug this.
06:36:40.264 - 06:36:49.404, Speaker A: Maybe change their minus memory from 128 gigs to eight gigs because. But yeah.
06:36:52.524 - 06:37:10.984, Speaker D: Yeah, I might also go and try to make it. I felt more comfortable working from the script now. Although clearly the script does have a lot of shoes. Yeah. Issues in it. But just copy the cumulative script. Also.
06:37:13.244 - 06:37:45.174, Speaker A: Would it be much more troubles if. If we make the machine the host and like make the host of Window 24 and update everything to the up to date canonical ones just in case? Or what do you think about this? Because it seems that run TD sh now is much more seamless like that. They define only one flag that sets. That's set to TDX aware.
06:37:45.994 - 06:37:49.054, Speaker D: Yeah, that's reasonable too. We can go through that.
06:37:51.994 - 06:38:30.884, Speaker A: But yeah, definitely we should check out if this Yokto image is actually TDX aware or not. And if yes, it's perfect. If not that probably we should do much more investigation on how to set up the kernel inside the yocto image, I think. Why? There are two times minus m. Oh yeah, never mind.
06:38:36.124 - 06:38:42.504, Speaker D: I don't remember seeing those serial things present in one of the versions here.
06:39:06.864 - 06:39:10.124, Speaker A: After the object in the second line, you didn't add the slash at the end.
06:39:13.104 - 06:39:13.884, Speaker B: Thanks.
06:39:20.504 - 06:39:22.644, Speaker D: So that's still panic causing.
06:39:33.444 - 06:39:43.824, Speaker A: Could it be that there's an instance of qmos running still from the previous run that you started and not exited correctly and then when you are running it again is basically flashing?
06:39:45.684 - 06:39:54.594, Speaker D: That's quite possible. One of the things that the run TD would do is. So maybe I get that running from that script, but not otherwise.
06:39:54.894 - 06:40:09.274, Speaker A: Yeah. Then maybe we could fetch in the P's if there is some kind of process running and kill it ourselves.
06:40:20.994 - 06:40:22.414, Speaker D: Maybe that just isn't.
06:40:23.274 - 06:40:25.094, Speaker A: Or you can restart the machine.
06:40:27.554 - 06:40:29.734, Speaker D: Yeah. What could I look for?
06:40:30.354 - 06:41:12.504, Speaker A: You can do P's minus aux, I think, and then grep because it's still going to be too much. Grab something regarding QMo. Hmm. Not sure if it turned out to be a zombie process. Tries to see in htop if your memory is being used for something else. So you have, you are using ten gigs of memory for some process.
06:41:13.244 - 06:41:14.024, Speaker D: Yeah.
06:41:17.004 - 06:41:22.476, Speaker A: Could it be the one ethics you're.
06:41:22.500 - 06:41:25.264, Speaker D: Saying that because I've got that much in total that I could be from.
06:41:25.924 - 06:41:30.344, Speaker B: I mean there's so small, small memory.
06:41:33.244 - 06:41:44.784, Speaker D: Well there's quite a line or something. It's pretty mean. It might have if he's doing something with that much.
06:41:51.004 - 06:42:20.844, Speaker B: Can you just remove the random generator? I know you like it, but sure. Yeah. I think the of this too. Where does it stop?
06:42:21.704 - 06:42:27.660, Speaker A: Wait second you ran run TD, not the run two script, right?
06:42:27.732 - 06:42:33.156, Speaker D: Yeah, yeah. I mean just because I wanted to pick up its cleaning filling stuff.
06:42:33.340 - 06:42:34.464, Speaker A: Yes, yes.
06:42:35.884 - 06:42:40.460, Speaker D: Because I'm not running daemonize right now. I really don't think that that's happening.
06:42:40.652 - 06:42:41.384, Speaker A: Yeah.
06:42:44.204 - 06:42:52.184, Speaker D: I think that I'm still just not picking up some. I mean I got one of these to run. We don't know that.
06:42:55.674 - 06:42:56.402, Speaker B: Option that I.
06:42:56.418 - 06:43:28.434, Speaker D: Haven'T picked and record with all these which they were. Yeah, I can start from. Whose was it that I start from? And within two got it to work and login. I think it was copying treaters.
06:43:35.254 - 06:43:38.594, Speaker B: Maybe try the one where USB is still enabled.
06:43:54.434 - 06:44:08.734, Speaker D: I think I have, I think all of those are still present in the last one I tried. Yeah, all the USB was present here. Those are all the same.
06:44:09.654 - 06:44:10.394, Speaker A: It.
06:44:35.394 - 06:45:04.434, Speaker B: Can you, can you give me the sha hash for authentic file? 1 second I need to get it from myself.
06:45:20.374 - 06:45:25.354, Speaker C: Where this machine I 8042 comes from.
06:45:31.074 - 06:45:36.134, Speaker D: Yeah, that was what in, it was in readers when I started copying from it.
06:45:37.234 - 06:45:38.854, Speaker C: Can I try to remove this?
06:45:40.994 - 06:46:06.234, Speaker D: Yeah, let me see if the CPU IV bridge works. That's the only thing I've changed. Okay. Not that obviously I'm in the wrong mess of confusing myself.
06:46:20.594 - 06:46:26.094, Speaker B: Do you have the shot 25256 some of the image?
06:46:26.674 - 06:46:27.050, Speaker A: Yeah.
06:46:27.082 - 06:46:29.174, Speaker D: You want to paste it in the chat?
06:46:31.274 - 06:46:33.974, Speaker B: Yeah, let me paste it in the chat.
06:46:39.114 - 06:46:40.498, Speaker C: Yeah, that's the correct one.
06:46:40.586 - 06:47:09.734, Speaker A: That's the correct one. Yeah, it, it.
06:47:44.214 - 06:47:47.274, Speaker D: Okay, so CPU IV bridge seemed important.
06:47:51.614 - 06:47:56.914, Speaker C: Can you pass cpu host because Cyberbridge.
06:48:00.714 - 06:48:01.654, Speaker D: Yeah sure.
06:48:05.554 - 06:48:11.054, Speaker C: Let me check the actual. Yeah.
06:48:15.634 - 06:48:17.014, Speaker D: Like cpu host.
06:48:19.314 - 06:48:24.214, Speaker A: It will take the host cpu architecture if you do this, I think.
06:48:25.974 - 06:48:28.526, Speaker C: Okay, that's good. And all the features.
06:48:28.710 - 06:48:58.894, Speaker A: Yes, and all the feature of the host. Yeah. Cool. Now if we add the TDX stuff, would it still panic? I think because we removed this. Yeah, I think we removed this iv with, while adding the TDX stuff. That's why. And also the.
06:48:58.894 - 06:49:30.154, Speaker A: Regarding the memory encryption which is up the main one. Right. So it just crashes and throws you out of the machine.
06:49:32.094 - 06:50:25.754, Speaker D: Yeah. I'm certain that this is something happening at my front end proxy thing that I have to. It seems intermittent but I gotta resolve that. Okay, so get the TDX and then also the ram thing.
06:50:28.734 - 06:50:29.514, Speaker B: All right.
06:50:29.854 - 06:50:40.354, Speaker D: That memory backend object. Well, I mean, I was thinking TDX object, and I don't think that you need to use the private Ram.
06:50:43.014 - 06:50:46.914, Speaker A: Okay, we can start with this. Did it start at least?
06:50:51.254 - 06:51:10.134, Speaker D: I think I left some junk. Okay, now it says, warning, host doesn't support requested feature. That looks interesting.
06:51:14.714 - 06:51:17.614, Speaker B: You need to change the machine stuff as well.
06:51:25.434 - 06:51:27.774, Speaker D: Like how so? Like that, that's the only other.
06:51:28.454 - 06:51:32.634, Speaker B: No, no, no, the one you have more, more up. That's the one. You.
06:51:35.014 - 06:51:48.294, Speaker A: Need to take the original one, which was. Yeah, exactly. This line. And also the line two lines below, minus object, memory backend, Ram iD, Ram one, size two.
06:51:48.334 - 06:51:56.484, Speaker D: Yeah, okay, I got that one. I got that one here. But I thought that I could add that second because I think that that's optional. I think you shouldn't need that to have the.
06:51:57.824 - 06:52:11.688, Speaker A: You added it in the wrong line. I think you should add it exactly there. Yeah, exactly. But now if you don't do that line, it will tell you Ram l is not defined. Or.
06:52:11.776 - 06:52:13.272, Speaker D: Why don't I just remove this?
06:52:13.448 - 06:52:16.484, Speaker A: You can, you can, you can. Why not? Let's try it.
06:52:17.384 - 06:52:23.714, Speaker D: Let me, I'll stay here as I think that this is likely, you know, work. But let me first start with.
06:52:26.014 - 06:52:26.542, Speaker B: Without.
06:52:26.638 - 06:52:31.794, Speaker D: Those, and without that, I should be able to add those paths.
06:52:40.294 - 06:52:41.874, Speaker A: Oh, here we go.
06:52:45.934 - 06:52:49.674, Speaker D: See if adding that device, that does it.
06:52:51.134 - 06:53:06.278, Speaker A: I don't recall introducing something else in the original one. I don't recall. You have I 800. Yeah, exactly. This one. Is not there something else you still have?
06:53:06.406 - 06:53:08.954, Speaker B: Maybe there's still a VM running?
06:53:17.994 - 06:53:34.534, Speaker D: Doesn't seem like it. Oh boy. Like I'm missing a.
06:53:46.374 - 06:53:48.834, Speaker B: Now it's exactly as it was before, right?
06:53:49.214 - 06:54:00.834, Speaker D: I think so, yeah. Now what am I missing?
06:54:13.274 - 06:54:15.414, Speaker C: Complaints about GTK again.
06:54:18.074 - 06:54:21.654, Speaker D: Oh, did I still have the object TDX? And maybe, I mean, maybe that's.
06:54:35.214 - 06:54:35.526, Speaker B: Right.
06:54:35.550 - 06:54:46.634, Speaker D: Now I have nothing in there. That's. Yeah, very confused now.
06:55:07.994 - 06:55:12.654, Speaker C: Is it failing because of the chemo command or because of the GTK error?
06:55:13.914 - 06:55:22.114, Speaker B: Yeah, maybe it's something in the script above. Can you add an echo just before the queue it.
06:56:23.934 - 06:56:25.754, Speaker D: No, I've lost it.
06:56:26.294 - 06:56:50.134, Speaker B: I'll show it up. You still have the object TDX. Guest.
06:57:01.314 - 06:57:57.134, Speaker D: Could we have this on video? I can probably look at the recording when I saw the screen where it would have worked. I'm still again this and not seeing anything that's different since the last time that it was working. I removed the USB stuff, but that clearly still worked. After that. Oh, I've been doing that with argument order. That's possible.
06:58:14.994 - 06:58:20.818, Speaker A: Okay. I found the exact moment in the video where it was running.
06:58:20.946 - 06:58:29.654, Speaker D: Let me, you know the problem can't comment outline. I can't comment out lines in the middle of.
06:58:29.954 - 06:58:39.530, Speaker A: Yeah, I asked about this. I asked about this, and I wasn't sure that this is causing the problem, actually, but, yeah, apparently it's weird.
06:58:39.602 - 06:58:40.454, Speaker D: There we go.
06:58:41.274 - 06:58:58.218, Speaker A: Nice. Cool, cool, cool. So now we can continue with the TDX experimentation. So we can add the object and then the machine stuff. Yeah, but, yeah, you are missing the machine stuff, right?
06:58:58.346 - 06:59:25.274, Speaker D: Yeah, I'll add a little at a time. I think. Actually, this. I don't understand what that is. That came in only when I added this.
06:59:31.054 - 06:59:46.094, Speaker A: I think it's when you added the other one. Yes. The minus object memory backend ram. Well, that's weird.
06:59:49.274 - 07:00:02.814, Speaker D: It's complaining about. It sure looks like it's a white space issue, but which white space? It's like one of these tab and not space, and that's not here.
07:00:13.254 - 07:00:14.034, Speaker B: Wow.
07:00:14.454 - 07:00:17.430, Speaker A: Yes. You cannot tap after the slide.
07:00:17.462 - 07:00:24.126, Speaker D: I wouldn't have even known to. I wouldn't have known to worry about that. All right. Okay.
07:00:24.230 - 07:00:28.434, Speaker A: Let's go a little bit more at a time. Let's go.
07:00:37.594 - 07:00:45.374, Speaker D: Okay, great. So added nothing. No memory. Just the TDX thing and it boots. But now we can see if there's.
07:00:55.434 - 07:01:01.184, Speaker A: And with that, we can stop our stream and leave it moment for the next episode.
07:01:01.884 - 07:01:03.144, Speaker B: Small teaser.
07:01:03.564 - 07:01:04.864, Speaker A: Small teaser.
07:01:27.544 - 07:01:39.004, Speaker B: But I don't see it in the part above. T must be TD. It doesn't look like it's here.
07:01:39.464 - 07:01:51.994, Speaker A: Then we can grab it because I don't think it prints everything directly or. No, does. There are not too many. Many. Never mind.
07:01:52.734 - 07:01:54.034, Speaker B: Yeah, it's not there.
07:02:24.474 - 07:02:29.614, Speaker D: Yeah, I don't see that there. That's a good way to.
07:02:33.354 - 07:02:38.334, Speaker B: There's no modules. The guest of the station is part of the kernel itself.
07:02:39.314 - 07:03:15.604, Speaker A: So, Andrew, I think you need, after you log in that machine, you need to pull. You need to clone the repository and do the setup because this Yocto image was created. This yocto image was not created using the create TD VM from within, which does, for you, this cloud init, which does after the first boot install the station and the setup stuff. So probably you need to do this manually in this image in order to have this module enabled.
07:03:16.624 - 07:03:23.280, Speaker D: That makes sense even to. You have to do that even to get the. Yeah, okay. That makes sense.
07:03:23.472 - 07:03:30.164, Speaker A: Yeah. So maybe you can now do git clone of the TD's chronicle and run the scripts manually.
07:03:31.344 - 07:03:44.876, Speaker B: But the scripts, I mean they're, they're just, um. You will, it doesn't have anything inside. We won't be able to clone stuff. Um, but I mean, the scripts, we had a look at this. Um.
07:03:44.980 - 07:03:46.224, Speaker D: I don't even have a git.
07:03:48.044 - 07:03:49.224, Speaker B: You don't even have.
07:03:55.804 - 07:03:59.304, Speaker A: We already started with the productionized version of the.
07:04:05.694 - 07:04:11.446, Speaker B: No. Maybe. Can we get it to run with encrypted memory? I would like to see that.
07:04:11.630 - 07:04:31.094, Speaker D: Okay. Just to see if those options go. Yeah, yeah. Okay. So you can just add the.
07:04:40.074 - 07:04:42.954, Speaker B: And there you missed the machine.
07:04:42.994 - 07:05:10.794, Speaker A: The machines, the machine stuff. Right. It didn't have originally the I 804. Right. So do we need it?
07:05:11.134 - 07:05:32.894, Speaker D: Maybe not. Memory size does not match.
07:05:35.194 - 07:05:41.454, Speaker A: Maybe add background, maybe two gig. Yes, or eight.
07:05:50.054 - 07:05:53.674, Speaker B: What does the default script say about memory?
07:05:55.054 - 07:05:59.394, Speaker A: It was 256 megabyte, if I'm not wrong.
07:06:00.374 - 07:06:11.854, Speaker B: M SMP too. Maybe, maybe. Can we add SMP two into.
07:06:13.554 - 07:06:22.694, Speaker A: I think we have their SMP four even. Yeah. Just the number of threads. Right. Or cores.
07:06:24.914 - 07:06:28.746, Speaker B: It's actually simultaneously multiprocessing.
07:06:28.890 - 07:06:32.414, Speaker A: Yes. So a number of cores that you assign for this image. Right.
07:06:33.914 - 07:06:35.014, Speaker B: Maybe, yeah.
07:06:36.014 - 07:06:37.034, Speaker D: Interesting.
07:06:38.814 - 07:06:45.710, Speaker A: Now it's failing for no such a file or directory, but where are we.
07:06:45.742 - 07:06:52.234, Speaker D: Passing, this is the thing that's, I think, failing. Then it core dumps right there.
07:06:53.614 - 07:07:52.334, Speaker A: Invalid argument. Interesting. It.
07:08:43.784 - 07:08:52.084, Speaker B: On canonical TDX repo, mention any kernel configs for the TDX enablement.
07:08:54.664 - 07:09:01.404, Speaker A: Yes. There are some steps that you have to do on the host side and then on the guest side.
07:09:03.304 - 07:09:06.964, Speaker B: And like actual kernel configurations.
07:09:07.784 - 07:09:08.544, Speaker D: Yeah.
07:09:08.704 - 07:09:12.828, Speaker A: Yes, but for the guests, I think.
07:09:12.876 - 07:09:14.476, Speaker D: Oh, but we've already done them on the host, right?
07:09:14.500 - 07:09:26.744, Speaker A: I mean, yes, the host is already done, but for the guests, I think there should be also some kind of kernel changes that you should do. Let me check.
07:09:28.004 - 07:09:32.064, Speaker D: Okay. These would be certainly things that are part of the setup.
07:09:44.264 - 07:09:51.244, Speaker B: Do we have an oVH machine that can run TDX? Have we figured this out?
07:09:52.264 - 07:09:53.284, Speaker D: I think so.
07:09:57.944 - 07:09:59.044, Speaker B: Who has access?
07:10:01.944 - 07:10:04.794, Speaker D: I feel like I associate that with RTM, but I'm not sure.
07:11:03.454 - 07:11:36.450, Speaker A: So Frieder the setup. TDX guess script and canonical TDX, they install like this is the script that you run within your VM image. They do install the TDX guest modules there that script and execute started. And also they do kind of changes to the grub of the kernel for the next restart. So that's why they tell you run the script and then restart your vm.
07:11:36.642 - 07:11:44.914, Speaker B: Yeah, that's because they're using a default Ubuntu kernel and then they're adding these modules.
07:11:45.074 - 07:11:45.814, Speaker A: Yes.
07:11:48.574 - 07:12:01.554, Speaker B: Before the Yocto image case. I've just configured them to be part of the kernel itself. So the TDX guest driver is not a module, but the kernel part of the kernel itself.
07:12:02.934 - 07:14:44.854, Speaker A: They are installing, however, the TDX modules from ApT installed and they are installing some kind of tools there. Oh, interesting. They are installing the TDX tools guest that you showed me earlier, the one that's supposed to be decommissioned. You're not sure how would we achieve this now in the Yocto setup or what the necessary steps for it to be to the X over that seems to do it.
07:14:48.734 - 07:14:57.354, Speaker D: Yeah, but I'm doing the other. What's the Ubuntu.
07:14:59.214 - 07:15:00.434, Speaker A: I see, yeah.
07:15:14.234 - 07:15:20.334, Speaker D: So that has the object for the memory backend present, just doesn't use it in the machine.
07:15:25.154 - 07:15:35.130, Speaker A: If you do dmessage, would you see the DDX thingy on the startup of the octo image? Like anything, message regarding anything?
07:15:35.162 - 07:15:45.574, Speaker D: I would, but it doesn't, right? No, I mean, I see something about it in the, just that it's the TDX key. Mew something.
07:16:18.054 - 07:16:22.794, Speaker A: Wait second, I think I know the issue. It's saying something regarding.
07:16:58.014 - 07:17:27.424, Speaker D: Okay, so I mean, the memory wasn't working, but I don't know where I got this particular set of memory things from that's also not working in Ubuntu as well as Yocto. Okay, so there's really no indication that that's something wrong. I think I might have just been trying to set up like the encrypted memory in TDX and it's not gone too far to try and.
07:17:38.004 - 07:17:57.106, Speaker A: But now in any way we wouldn't be able to see like even if we make it now run the queue, the Yocto image, we would still not, apparently it needs to be installed if I listed correctly. So what do you think about this reader?
07:17:57.170 - 07:18:06.826, Speaker B: Like, I'm still not convinced that it needs to be installed. What you see in the script is that it actually installs kernel modules.
07:18:07.010 - 07:18:07.774, Speaker A: Yes.
07:18:09.714 - 07:18:23.114, Speaker B: And I'm arguing you don't need to install kernel modules for the Yocto image because like the DDX enablement is already part of the kernel itself.
07:18:23.974 - 07:18:24.754, Speaker A: Yes.
07:18:26.694 - 07:18:39.874, Speaker B: But maybe, maybe I'm wrong here. Maybe we're also not running the right TDX, the right kernel. I don't know.
07:18:40.464 - 07:19:07.734, Speaker A: That would be also interesting to know. Like the image example that you have Andrew with the Ubuntu. Could you run it just could you run to check which Linux image it's having? Yeah, that would be interesting to know if it's 6.6 or newer. Probably newer. 6.15.
07:19:14.754 - 07:19:25.214, Speaker B: But that will not really give us any information because canonical has a huge, like a significant offset.
07:19:46.414 - 07:19:49.394, Speaker A: Oh, so it is actually.
07:19:50.374 - 07:20:00.534, Speaker D: Okay, you know what, they pointed me to the particular kernel sources that that came from.
07:20:03.194 - 07:20:04.066, Speaker A: Yeah, yeah.
07:20:04.130 - 07:20:43.914, Speaker D: There's a repo for it, but it's not the most obvious one. Let me see if I have that. Well, he pasted that for me.
07:20:47.634 - 07:22:23.714, Speaker A: It, it, it. Okay. It doesn't seem to have also TDX in this one either.
07:22:24.374 - 07:22:27.526, Speaker D: Yeah, not in the d message, so.
07:22:27.590 - 07:22:30.114, Speaker A: It'S not the octo issue. Okay.
07:22:42.314 - 07:22:48.994, Speaker B: Is there the TDX guest device available? Doesn't look like it, right?
07:22:49.114 - 07:23:23.706, Speaker D: Oh yeah, yeah, it's got a. Wait, really? I sure was able to. What was that?
07:23:23.890 - 07:23:25.254, Speaker A: What's happening here?
07:23:25.674 - 07:23:31.534, Speaker D: I don't know. Yeah, no idea.
07:23:32.554 - 07:23:34.814, Speaker A: You were kicked out of the image.
07:23:36.114 - 07:25:08.778, Speaker D: Yeah, I think just through bad e commands or something. What did I do for the test? I did the. What was that user attestation thing. Yeah, we were just here and this was the exact same image. That user shared document. Okay, so now it's failing to get the report. So this is meaningful.
07:25:08.778 - 07:25:28.614, Speaker D: We're still making progress then. So somehow between whatever I was doing originally and whatever this script is launching, it is not picking up the TDX device, even in Ubuntu when it was before. So we are down to differences in how we're launching this with Kimu.
07:25:30.804 - 07:25:38.264, Speaker A: Yeah. How are you running your ubuntu? Because this is not the original command, right?
07:25:38.644 - 07:25:39.624, Speaker D: That's right.
07:25:41.004 - 07:25:43.924, Speaker A: So probably we changed something from the original command.
07:25:43.964 - 07:25:50.716, Speaker D: That looks like Excel KVM is missing. I see there's enable KVM, I see.
07:25:50.780 - 07:25:53.824, Speaker A: Some stuff are missing. Not only that.
07:26:10.064 - 07:26:14.244, Speaker B: There'S the no defaults. Maybe this one as well.
07:26:16.384 - 07:26:26.892, Speaker A: No default is missing as well. And cpu host is missing, I think. Oh no, never mind, it's there.
07:26:27.028 - 07:26:32.504, Speaker D: Looks like it was present both. Let me make sure I'm looking at the original one. I guess this is the earlier original one.
07:26:33.364 - 07:26:36.904, Speaker A: Yes, you can just copy it.
07:26:37.524 - 07:26:43.184, Speaker D: Okay. But yeah, cpu is there. Maybe I'll do excel KVM instead of enable KVM, but I don't think that's it.
07:26:43.604 - 07:26:48.684, Speaker A: Demonize is. Demonize is missing, but that shouldn't matter.
07:26:49.104 - 07:28:03.844, Speaker D: It's just good. That won't matter anyway. So as excel KVM, other differences. We could try the no defaults. Try the new graphic.
07:28:03.934 - 07:28:04.564, Speaker B: It.
07:28:34.764 - 07:28:36.904, Speaker D: No vgA, non valid option.
07:28:49.764 - 07:28:53.304, Speaker B: The no vgA. We added that later on. You can ignore that.
07:29:10.024 - 07:29:11.924, Speaker D: Install our TDX guest.
07:29:13.024 - 07:29:16.764, Speaker B: Can you check if the guest module is loaded?
07:29:22.124 - 07:29:23.024, Speaker D: Okay.
07:29:33.164 - 07:29:33.984, Speaker B: Hmm.
07:29:35.804 - 07:30:01.294, Speaker D: It's just not crypto. That's a little weird then, too. I'm using a different one of those, I think. No, I'm not. That was the same one as before. Okay, it's not that.
07:30:28.054 - 07:30:28.874, Speaker A: Differences.
07:30:45.314 - 07:30:56.134, Speaker B: Yeah, I see something. There's the machine part. And that has equals TDX and memory backend equals raml.
07:30:56.474 - 07:31:02.574, Speaker D: Yeah, that one we were ignoring, because that one is not how it originally is in the.
07:31:02.954 - 07:31:04.642, Speaker B: Okay, I see.
07:31:04.738 - 07:31:10.694, Speaker D: Even in even. Well, actually, in the 23 ten, it is like that.
07:31:13.274 - 07:31:20.294, Speaker B: Yeah, but that won't cause the. The error that we didn't know how to fix it. Right.
07:31:25.954 - 07:32:09.674, Speaker D: I guess that's a good point. Maybe. Okay, right. So I was keeping that out because that was a problem for. Yeah, for Yocto. I don't know if that's a problem that I should have been working with Ubuntu, then there were these quote ARG's things. Maybe the.
07:32:09.674 - 07:32:32.234, Speaker D: If the only reason that you even have the TDX devices for attestation, then maybe that is relevant somehow. Actually. I mean, maybe that is exactly what that is. Okay, so that worked with the memory being present in Ubuntu, but still, there's no. Oh, now there's the TDX.
07:32:34.694 - 07:32:35.514, Speaker B: All right.
07:32:36.014 - 07:33:01.254, Speaker D: Okay, so that memory being present helped. Now can we do Yocto then the same way? There you go. GDX, guess. Present.
07:33:02.154 - 07:33:08.050, Speaker B: Okay, so then the answer is there's.
07:33:08.082 - 07:33:10.574, Speaker D: Something wrong with the attestation then, too.
07:33:12.314 - 07:33:13.254, Speaker B: I'm sorry.
07:33:14.314 - 07:33:56.114, Speaker D: I should try adding the attestation. These quote arg's. Should I worry about the pid file? I guess I'm in the pid file.
07:34:01.014 - 07:34:06.594, Speaker B: You're missing a backslash on the TDF firmware after the TDF firm. Thanks.
07:34:20.314 - 07:34:43.654, Speaker D: Okay, so that's fine. We have the TDX device and everything. Oh, maybe somehow I thought this wasn't gonna. Okay. And so I could try to do the. Is there going to be an easiest way to do this? I mean, without git being present? Maybe I should go through the pokey thing or do it this way.
07:34:46.274 - 07:35:05.834, Speaker B: I mean, one way is if that's. If you're compiling a static, static binary, then you can just copy it inside of the vm. If not, then it's going to be a bit more difficult. We'll have to add it at the QMU. Sorry. At the Yocto build stage.
07:35:22.254 - 07:35:39.414, Speaker D: Return, where this was already. Well, it was present in. Okay, I don't know how to find it, and I can go run it.
07:35:52.254 - 07:36:44.234, Speaker A: It. It.
07:37:25.794 - 07:37:45.374, Speaker D: What's the best way to get this it's only present in. I don't really know where to find that sample code that I ran for Ubuntu because it was just packaged into the user share directory of it. I think it's based on this SGx dcap samples, but it doesn't seem like it's exactly that.
07:37:47.034 - 07:37:51.734, Speaker B: Is it maybe part of the canonical TDX?
07:38:02.894 - 07:38:09.354, Speaker A: It says it's under user share doc libtdX test dev examples.
07:38:12.134 - 07:38:36.074, Speaker D: Yeah, but I don't have it. It's not present on the host. I could go run the TD with the Ubuntu, compile it, copy it out to the host, and then copy it back into the other guest signatures. I can't think of anything else. Maybe the only good way, just because I don't know how to, I don't know how to go get that sample lib sgx code and just build it locally.
07:38:37.254 - 07:38:42.834, Speaker A: I think this part should be inside the TD, if I'm not wrong, not the host, right?
07:38:43.214 - 07:38:49.434, Speaker D: That's right, yeah. How do I copy something out of GMU?
07:38:54.554 - 07:38:57.974, Speaker B: SsA, ssh, fcp?
07:38:59.674 - 07:40:11.094, Speaker D: I see. We don't have network set up in this. Okay, so this needs tdxt hook once again some TDX attest library, but that is the only library that needs. So maybe I can just static.
07:41:26.934 - 07:41:27.674, Speaker A: It.
07:42:35.334 - 07:43:27.544, Speaker B: But I mean, one interesting thing that we figured out, that correct TDX configuration on the host side, the hypervisor boots the VM and then the TDX guest device is available, whereas if we're booting it from Azure, it's not available. So this concludes like constellation has mentioned that they can find the TD and can access it. I'm wondering whether they found a different way of getting the TD report. Maybe, maybe Azure has implemented this in a different way.
07:43:29.884 - 07:43:31.104, Speaker D: Yeah, great point.
07:43:46.344 - 07:43:56.920, Speaker A: Could we reach out actually to the constellation team to see how did they reach to the report? Like do they run Ubuntu or Yokto or what kind of image do they have?
07:43:57.072 - 07:44:08.904, Speaker B: They have their own image, which is even better. One thing we could do is figure it out from their source code.
07:44:09.244 - 07:44:10.024, Speaker A: Yes.
07:44:12.364 - 07:44:18.504, Speaker B: And the other thing, of course, get in contact with them, which I did, but I haven't gotten any replay.
07:44:18.884 - 07:44:31.534, Speaker A: Okay, that's also interesting. Okay, cool. Because if they created their own image, it would be much easier, like to transfer that knowledge to apply it on Yocto if possible. Of course.
07:44:31.954 - 07:44:32.774, Speaker B: Yeah.
07:44:35.234 - 07:44:43.014, Speaker A: And do you know by chance if their image is minimal or big as Ubuntu or based on what did they build their image?
07:44:45.514 - 07:44:46.574, Speaker B: Let me check.
07:44:54.934 - 07:44:58.314, Speaker A: I mean, so far the stable ones that I saw, they were ubuntu.
07:45:19.214 - 07:45:22.454, Speaker B: I think it's based on fedora.
07:45:22.834 - 07:45:24.730, Speaker A: On what? Fedora. Okay.
07:45:24.842 - 07:45:33.494, Speaker B: Or coraos, which is fedora. Here you go.
07:46:10.014 - 07:46:22.864, Speaker D: So I think this should result be resolvable. I mean just test TDX a test. All the code for it is just in the DCAP library basically.
07:46:23.324 - 07:46:50.044, Speaker B: Okay. Then I think one last thing we would need to do is get networking working within the yocto image. Can you show me the ESD? Yeah, we're still missing the networking device, right?
07:46:51.144 - 07:46:51.544, Speaker C: Yep.
07:46:51.584 - 07:46:54.884, Speaker D: Yeah, I can add that back in. So here, I just had this.
07:46:55.384 - 07:47:17.984, Speaker B: Yeah, I think that will work. And then as a final step, you would need to copy over an updated image from an updated yocto vm image. I copied it over into my usernames account.
07:47:18.524 - 07:47:20.268, Speaker D: Okay. So I could copy it again from yours.
07:47:20.356 - 07:47:21.024, Speaker B: Yep.
07:47:34.944 - 07:47:36.004, Speaker D: This one? Yeah.
07:47:36.904 - 07:47:42.084, Speaker B: Yeah, it's this the plain one without the date, without the timestamp.
07:47:43.664 - 07:47:44.524, Speaker D: Okay.
07:48:21.864 - 07:48:22.604, Speaker A: It.
07:48:51.804 - 07:48:57.884, Speaker D: Ssh server messages somewhere. Okay. Just said starting. All right.
07:48:58.044 - 07:49:36.604, Speaker B: Can you, can you log in and see if you have access to the Internet? Like ping? Okay. Can you ping Google without DNS? Eight. Eight. No. Okay. What does IP at IPA say? What? It's, it says it's actually a bit without the dash. Just ip a IP and then a, yeah.
07:49:36.604 - 07:49:57.904, Speaker B: Okay. So it has, so maybe can you check if you, can you check if you can ssh into it from the host? Yeah, just maybe it's just not forwarding packages.
07:50:02.844 - 07:50:04.384, Speaker D: Yeah, that's probably right.
07:50:05.384 - 07:50:23.096, Speaker B: Okay cool. You need to give the root as.
07:50:23.160 - 07:50:35.544, Speaker D: You just have to do as root. Yeah. Okay cool. Yeah, that was ssh.
07:50:36.124 - 07:50:42.148, Speaker B: So then with this you can copy the binary over once it's statically built.
07:50:42.196 - 07:50:43.140, Speaker D: Oh, I see what you mean.
07:50:43.212 - 07:50:46.504, Speaker B: Okay, then you can run the attestation.
07:50:47.324 - 07:51:05.162, Speaker D: Okay, got it. All right. So it's got ssh open. That's fine. So that's an easy way to scp to it so it can finish that way. This doesn't have, I mean it, can it do shared libraries at all? Like should the goal be to not have any shared libraries or if, well.
07:51:05.178 - 07:51:19.494, Speaker B: It does have some shared libraries but they're very specific to that build system. So if you want to have something not statically compiled, you would basically add it during the build process of the image.
07:51:23.574 - 07:51:30.034, Speaker D: Wait, I mean, I assume everything that we prepare like that. Yeah. Would be put into the build process of the image.
07:51:47.934 - 07:51:56.854, Speaker B: Okay. So I'm gonna log out soon. Stop.
07:51:56.894 - 07:51:58.554, Speaker D: Here is good for me too, actually.
07:52:05.134 - 07:52:44.176, Speaker B: Pretty, pretty nice hackathon. It was a fun, fun one. I mean what did we achieve? We got the r running in the Yocto image. We verified that the Yocto image has the TDX guest drivers installed. There's some issue with Azure. We need to figure that out. But yeah, I think was a big step forward also.
07:52:44.176 - 07:53:09.994, Speaker B: I don't know about about you but maybe you also learned some stuff about Yocto which would be my goal in the end. Cool. Then let's wrap it up. Mo, do you have any, any, any comments on your side?
07:53:11.454 - 07:53:16.398, Speaker A: Not really. I'm also kind of blocked now. Brain locked.
07:53:16.566 - 07:53:29.634, Speaker B: Okay. All right, cool. Thank you all for joining and maybe, I don't know, maybe we can repeat that maybe a bit smaller. Not that eight hour session but maybe 6 hours I think.
07:53:32.894 - 07:53:37.424, Speaker A: Yeah, definitely it was and learned a lot. Thanks Frieder for hosting it.
07:53:37.764 - 07:53:43.724, Speaker B: Cool. All right. Fabulous, right, see ya.
