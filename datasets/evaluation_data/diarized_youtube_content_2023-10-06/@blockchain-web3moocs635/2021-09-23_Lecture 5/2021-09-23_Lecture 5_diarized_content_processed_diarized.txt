00:00:00.410 - 00:00:33.538, Speaker A: Welcome back. In this lecture, we'll be discussing what affects the transaction propagation. So, as you may know, a blockchain is, or permissionless blockchains are typically built out of permissionless PeerToPeer networks. So any peer can join and leave at any point in time. And we'll be discussing now how this impacts financial transactions in DeFi. So you can think of peer to peer network here as really a global peer to peer network among many peers. And naturally, some of those peers are miners.
00:00:33.538 - 00:01:18.130, Speaker A: So you can see here we have this world map with a set of miners here distributed across the globe. And we can think of this peer here having for example, connections to other peers that are non miners. And so once you create a transaction, it actually propagates in this permissionless network, there's a relatively high amount of churn that's being recorded in these networks. Churn is a technical term for nodes leaving and joining the network at any point in time. Because with permissionless, there's no guarantee that a node that's been there 5 seconds ago is still there in the next minute. So as such, this is really a best effort protocol. There's no guarantee.
00:01:18.130 - 00:01:54.420, Speaker A: So that's what's called an asynchronous network. So there's no guarantee of a transmission delay. So contrary to a synchronous network, we don't know when, like a peer, for example, here in Australia will receive a transaction that's being issued by a node in North America. Now, you can see here that this peer in North America is setting a transaction fee of unit five. So we just keep this as a generic unit. We're not specifying what value that is. Let's just assume this is an absolute value.
00:01:54.420 - 00:03:10.694, Speaker A: So this transaction fee here specifies how much this peer is willing to spend on this particular transaction and the revenue. So the transaction fee is being basically taken by miners once they include this transaction in the block. So naturally, the higher the transaction fee that you pay, the higher your priority of your transaction is of being included in the blockchain by a particular miner. It's basically a form of bribing or a priority bidding, if you would. So if this peer here is now propagating its transaction, eventually it might arrive at a minor node and the miner will then choose to order the transactions that it's mining in its blocks, depending on the fee that's being paid. So for example, if the miner already knows about two transactions here that both pay each ten and one unit of transaction fees, then this transaction with five fees will be likely put into the middle. So it will be squeezed here in between those two transactions.
00:03:10.694 - 00:04:13.438, Speaker A: And if the block has enough space to accommodate three transactions, then a final block of a minor might look as follows. So here you can see that if the execution order in this block, let's assume the execution order is in this direction, then the transaction with the highest fee. So the ten transaction fee transaction will be executed first. Afterwards there will be the next transaction with five and finally the cheapest transaction with respect to its fees, which only pays one transaction fee. Now what's important to note is that this execution is sequential, right? So it's really being performed in this order. So you can imagine that you have like a previous block here and there are a few transactions in there. And by the end of the execution, let's say here is the end of the execution, we will get a blockchain state.
00:04:13.438 - 00:05:16.242, Speaker A: One. Let's assume this is a blockchain state. By state, what I mean is that we have a variety of different peers, we have a variety of different contracts, smart contracts. They're specifying, for example, the balance of a user or the size of a pool, right? I mean, you remember we have these amen pools with x and Y. So x and y here, the quantity of X and Y, for example, is a state. So basically at this point in time, there's a particular state that's being calculated and everybody agrees because that is the current head of the chain. Now, if you want to execute a transaction on top of this very state, then you have to make sure that in occurrence you're at the very front of the next block, which implies that you have to pay the highest gas fee or the highest transaction fee than everybody else.
00:05:16.242 - 00:06:25.010, Speaker A: So I just mentioned gas fee because for example, in EVM based blockchain the transaction fee is referred to as gas as well. So this is basically the idea. If you want to execute on the latest blockchain state, you must front run, so called front run everybody else by putting your transactions here at the very front of this block. If you do not care about a particular position in the block but you still want to make sure that you include it in the block, then you should pay a transaction fee that's at least as high as the likely smallest includable transaction. Because keep in mind you have here limited space in the block, right? In this particular example, we have only space for three transactions. So in bitcoin the space is measured in actually bytes, right, or kilobytes, whereas in Ethereum, for example, the space is measured in gas due to the Turing completeness or pseudo Turing completeness of the smart contracts. So there are different ways of measuring how many transactions or how much computation can fit into a block.
00:06:25.010 - 00:07:35.950, Speaker A: And if you are keen that your transaction is executed swiftly but not necessarily on a specific block state or previous block state, you may want to adapt your strategy of setting your transaction fee. And because all this here is kind of transparent, you should always be aware, right, if there's here like an evil adversary, he may be able to observe what you're propagating in the network. He may even have a faster connection to the miners, right, this adversary. But we will be discussing this further in the security lecture. So summarizing the exchange transaction propagation, or in general blockchain transaction propagations occur on an asynchronous blockchain peer to peer network. There is a best effort propagation so you don't get any guarantees of in what time delay a transaction is received by a particular peer. You have quite significant amount of transparency as the transactions are publicly visible.
00:07:35.950 - 00:09:07.830, Speaker A: You can also try to infer through side channels whether a transaction is originating from a particular peer or particular IP address by having significant number of connections in the peer to peer network. So privacy is, I would say, a major concern. And due to the peer to peer nature, a node with a higher connection number or basically more connections in the network will always have an advantage to peers that are less well connected. So the number of TCP connections in the network matter as well as the up and download bandwidth as well as the latency of your internet connection. I'm aware of various efforts to build dedicated high frequency blockchain clients that depart from the traditional and official, I would say software client software. So you can imagine how various DeFi actors want to optimize their connectivity in order to increase their information asymmetry advantages. Regarding the inclusion of transactions, we mostly are based on an inclusion on a fee auction model and there are two prevalent design mechanisms, which is first, the price gas auction.
00:09:07.830 - 00:09:47.750, Speaker A: So this is what I just mentioned on the public peer to peer network here, this one. And there's also the sealed bit gas auction. So this is for example, a miner. Let's say this is a miner, he is connected to a centralized server. So let's say this is a centralized server and then you have a trader. So the trader is sending a transaction here to the particular centralized server or relayer. And multiple traders actually do this, they send their transactions and then there's a sealed bid auction.
00:09:47.750 - 00:10:34.370, Speaker A: So sealed in a sense it's not public, right? It's a private auction and only the winning bit is then forwarded to the miner, for instance. So this is another method of performing transaction propagation which we discuss more in the security lecture. Thank you very much for your attention. I hope you enjoyed truly this lecture about blockchain peer to peer networks in DeFi and I think it should have given you a really glimpse of why the underlying communication network is so important to any financial applications. On top of consensus lay layers and application layers, like smart contract layers. So if you are building your own high frequency trading bot, make sure to optimize your network layer.
