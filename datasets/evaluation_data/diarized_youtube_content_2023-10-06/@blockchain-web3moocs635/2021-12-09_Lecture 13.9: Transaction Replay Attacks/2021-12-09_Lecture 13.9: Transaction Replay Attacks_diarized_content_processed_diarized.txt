00:00:00.410 - 00:00:37.698, Speaker A: Welcome back. We're going to now discuss transaction replay attack, or more specifically generalized transaction replay attacks. The idea of a replay is really to create kind of a copycat of an existing transaction. So replay is a term, technical term from a traditional network security environment. And the idea is to observe a transaction on the network layer. Then you do replace certain data, you sign it with your own private key and you broadcast the copy. So it's really just a copycat behavior.
00:00:37.698 - 00:01:33.930, Speaker A: So the potential profit that we identified is about 35 million us dollar over 32 months, over a 32 month period. Naturally, what we have ignored here is the possibility that others will front run you or front run your copycat or defend against being a front run. So we have gathered about 188,000 profitable transactions over these 32 months of historical blockchain data. And this represents about 0.2 of the entirety of the Ethereum blockchain transactions that we have seen. We've developed in a real time algorithm which is not very much optimized and which could even be paralyzed. But we basically can replay a transaction in less than 0.2
00:01:33.930 - 00:02:13.954, Speaker A: seconds as we report here. So I'm sure you're quite curious now, and how does this algorithm look like? Well, it's really very simple. So what we have here is we have a potential victim transaction that you can see here. This is being basically injected into this algorithm. And we have here an adversarial address, right? So a victim transaction, adversarial address. And the adversary address is replacing the sender address at the same time in the transaction input. We are searching whether the victim sender address is present anywhere in the input.
00:02:13.954 - 00:03:09.770, Speaker A: And if it is, then we do replace the input with the adversarial transaction. And that's really it. So what we do find is that here on the x axis we have the timeline that we evaluated this on the Ethereum blockchain. And on the y axis we have the accumulative profit in ether. So you can see here that the block top repliable. So for those blocks where if we replay it on the top block, then we can get probably over 50,000 ether within those 32 months period. So naturally the amount of us dollar that I reported earlier is based on the ether price at the time of the measurement.
00:03:09.770 - 00:04:22.138, Speaker A: So what we can basically observe is that the accumulated profit that can be extracted by replay attack is really significant. And the number of replayable transactions remained more or less constant while still being rather volatile. So we can see here there's some coarse grained volatility on the number of replay transactions, but we do observe about 15,000 transactions at most per month that can be replayed. So that's certainly also a common issue in trying to secure DFI protocols. So Sam, for instance, might have told you that ways on how he tries to protect his transactions from being replayed by automated or generalized front running bots. So this particular algorithm here that we show you is really a very simple one. I'm sure there are tons of much more sophisticated algorithms out there, but I just wanted to show you that even with this simple algorithm, if we do evaluate it on past blockchain data, we can find quite some significant value extraction.
00:04:22.138 - 00:04:56.706, Speaker A: Very good. I hope that you enjoyed this replay algorithm. So please be aware if you're issuing a transaction and this might extract some value that others could copycat. Well, try to protect yourself. Right? There are a variety of different ideas on how to do that. You can create a more complicated smart contracts that can't be replaced as simple, as easily as through the algorithm I've shown you. You could have private peering agreements with miners to let them help you to extract the value that you want without being replayed.
00:04:56.706 - 00:05:04.320, Speaker A: But at the same time, you will have to trust the miner not to play you. So it's a tricky game, but it's fun.
