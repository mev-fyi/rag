00:00:00.250 - 00:00:24.586, Speaker A: Let's go over an example of calculating the amount of rewards earned by a user using this equation. Here's the graph of amount of tokens staked over some time period. For this example, we'll say that Alice Stakes 100 token at three second. At five second, Bob Stakes 200. At six, Carol Stakes 100. At nine, Alice withdraws her 100. And at ten, Carol Stakes additional 100 tokens.
00:00:24.586 - 00:01:04.958, Speaker A: At at eleven, Bob Withdrawals is 200. And at 13, Carol withdrawals her 200 tokens every time a user either Addis Bob or Carol Stakes or withdrawals. We'll need to calculate this value. To make our life easier, we'll introduce some variables. We'll define reward per token at time j r zero is equal to zero, and for time greater than zero, we'll say rj is equal to the sum from I equals zero to J minus one. Summing the terms r divided by t of I, where t of I is the total stake that time I. Now, if the total stake that time I is equal to zero, then we'll just say this term is equal to zero.
00:01:04.958 - 00:01:53.470, Speaker A: What we're doing here is defining this part of the equation for each second. However, instead of calculating this formula, we'll use this formula that we have derived in the previous video. And just for a review, when t of I is equal to some constant t, let's say for the duration j of zero to j, then we can write this formula r of j to be equal to r j of zero. So the reward per token evaluated at j of zero plus r divided by t times the duration j minus j zero. Okay, so let's go over an example of calculating rewards earned by each user. On the left, in blue, we'll list the time at which a user either staked or withdrew the tokens. On the right of this white vertical line, we'll calculate rj for each second.
00:01:53.470 - 00:02:34.458, Speaker A: Now, every time a user deposits or withdraws their token, we'll have to keep track of this part of the formula for each user. So we'll keep track of user reward per token pay on the right, and anytime the amount of tokens staked by each user changes, we will calculate the amount of rewards earned by that user. At the very bottom, we'll keep track of amount of rewards earned by each user. Okay, let's get started. At time zero, what is reward per token? By definition, at time zero, the reward per token is equal to r zero. So it will be simply be equal to r zero equals zero. Let's see what happens at 3 seconds.
00:02:34.458 - 00:03:03.430, Speaker A: At 3 seconds, alice stakes 100 token. So let's compute r of j at 3 seconds. Again, instead of using this formula, we will be using this formula r of j at 3 seconds. So that would be r of j at zero. The previous time that reward per token was updated was at r zero. So r j at zero will be equal to r zero. To this, we add r divided by t.
00:03:03.430 - 00:03:38.786, Speaker A: But remember that for the duration from zero to 3 seconds, the total staked was zero. And we said over here that when total staked is equal to zero, we'll just say that this part of the term is equal to zero. So this will be zero times the duration times the duration from zero to 3 seconds. Three minus zero. And this is equal to r zero plus zero times three minus zero. R of zero is equal to zero, and zero times three minus zero is zero. This is equal to zero.
00:03:38.786 - 00:04:02.570, Speaker A: R three is equal to zero. Since I'll stake to 100 tokens, we'll also update user reward per token paid. So this will be equal to R three. Okay, moving on. Let's see what happens at time five at 5 seconds. Bob stakes 200 tokens. So let's compute rbj for five.
00:04:02.570 - 00:04:36.774, Speaker A: So this will be r five. This is equal to the previous reward per token will be r three, r three plus. Now, notice that for the time seconds, three to 5 seconds, the total staked is 100, which is greater than zero. So instead of saying zero, we'll apply this part of the formula. So that will be r divided by the total stake. For the time interval three to 5 seconds will be 100. So I'll divide this by 100.
00:04:36.774 - 00:05:04.730, Speaker A: And what is the duration? The duration is from three to 5 seconds. So this will be five minus three, and this is equal to r three is zero. So zero plus r divided by 100 times the duration, five minus three is equal to two. R five is equal to two. R over 100. Now 5 seconds. This was Bob who staked 200 tokens.
00:05:04.730 - 00:05:38.620, Speaker A: So we also update user reward per token paid for bob to be equal to R five. Okay, let's move on. At 6 seconds, Carol stakes 100 tokens. So let's compute R of J at 6 seconds. R of j at 6 seconds, r six. This is equal to the previous reward per token will be R five plus the reward rate, R over. What is the total staked? Between the time intervals five and six.
00:05:38.620 - 00:06:22.450, Speaker A: Between the intervals five and six, the total staked was 300. So this will be. Total staked will be 300. The duration will be from five to 6 seconds. So this will be six minus five, and this is equal to R five is two r over 100 plus we need to add this term, so plus r over 300 times the duration, six minus five is equal to one. So that will be one, and that is r six. This was Carol who deposited 100 tokens.
00:06:22.450 - 00:07:17.286, Speaker A: So let's update user reward per token page for Carol and we'll say that this is r six. Let's scroll up and see what happens at 9 seconds. At 9 seconds, Alice withdrawals 100 token. Okay, so let's compute rewards per token at 9 seconds, R of nine is equal to the previous reward per token will be r six plus reward rate r over the total staked from time six to nine. The total staked from times six to nine was 400. So the total stake will be 400 and the duration will be from six to 9 seconds. So we'll multiply by the duration nine minus six, and this will be equal to r of six.
00:07:17.286 - 00:08:02.726, Speaker A: Is this value over here r over 400 times the duration nine minus six, which is equal to three. This was Alice who withdrew 100 of her token. So let's update user reward per token pay the new user reward per token pay for Alice is R nine. And we'll cross out the previous user reward per token for Alice being r three. Now, using this equation, let's compute the amount of rewards earned by Alice when she's staked from 3 seconds and then she withdrew at 9 seconds. So I'll scroll down and let's compute the amount of rewards earned by Alice for the time duration from three to 9 seconds. The amount of rewards that Alice staked is 100.
00:08:02.726 - 00:08:34.718, Speaker A: And if I scroll up at this point, the reward per token is nine. So that will be r nine, and user reward per token paid before r nine. That will be this value is r three. So what we need to do over here is r nine minus r three. Let's write this down over here. So we multiply 100 by rb nine. That's the current reward per token, minus the previous reward per token specifically to Alice.
00:08:34.718 - 00:09:10.342, Speaker A: This is user reward per token paid is r three, and this is equal to 100 times what is r of nine. R of nine is this value. So I'll paste it here. And what is r three? R three is equal to zero. So over here we'll say minus r three is zero, and that is the amount of rewards earned by Alice for staking. From three to 9 seconds, Alice has staked 100 tokens. And for the first 2 seconds she was the only one who has staked the tokens.
00:09:10.342 - 00:09:47.362, Speaker A: So we divide by 100 for the next 1 second in total, there was 300 staked, and for the last 3 seconds, there was 400 staked. When we add these up, we get the amount of tokens earned by Alice for staking from three to 9 seconds. Okay, let's scroll up and see what happens at 10 seconds. At 10 seconds, Carol stakes additional 100 token. This means that the amount of tokens staked by Carol from the duration six to ten is a constant of 100. And now she has staked additional 100. So from here on, she'll be staking 200 tokens.
00:09:47.362 - 00:10:48.810, Speaker A: So what we'll do here is we'll compute the amount of rewards earned by Carol from the duration six to 10 seconds, and then update the user reward per token pay that we see over here. Okay, so first, let's compute R of ten. R of ten is equal to the previous reward per token is r of nine, plus the reward rate, r over. What is the total staked from the duration nine to 10 seconds? If I scroll up, we can see that the total staked from the duration nine to 10 seconds is 300. So we divide this R by 300, and the duration will be from nine to 10 seconds, ten minus nine. And this will be equal to the previous reward per token. R of nine is this formula, plus r over 300 for the duration ten minus nine, that will be one, and that will be r of ten.
00:10:48.810 - 00:11:24.998, Speaker A: Let's update user reward per token paid for Carol. So, this will be r ten, and we'll cross out the previous user reward per token paid for Carol. And let's compute the amount of rewards earned by Carol. Again, we'll be using this formula. The current reward per token is r of ten, and the previous user reward per token paid will be this value, and for carol, that will be r of six. So here we'll have to do s. The amount of token staked by Carol from the duration from six to ten is 100, so s will be 100.
00:11:24.998 - 00:12:10.454, Speaker A: The current reward per token will be r ten minus the previous user reward per token paid for carol will be stored as r six. So 100 times r ten minus r six. So, I'll scroll down and we'll calculate the amount of rewards earned by carol. This will be 100 times the current reward per token is r of ten, and the previous user reward per token pay for carol is r six. So here we'll do r ten minus r six. Let's calculate what this value is. So, this will be equal to 100 times r ten will be this value minus r of six.
00:12:10.454 - 00:12:29.674, Speaker A: R of six will be this value. So this is R of six. And we'll need to put a minus. So I'll put a minus here and change the plus to a minus. And let's simplify this equation. I see a two R over 100 here. Minus two r over 100, they cancel out.
00:12:29.674 - 00:13:05.074, Speaker A: I also see one r over 300 canceling out with minus one r over 300. And what are we left with? We're left with 100 times whatever that is left inside. This will be three r over 400 plus one r over 300. And this will be the amount of rewards earned by Carol at time equals to 10 seconds. Okay, let's scroll up and compute arb eleven at 11 seconds. Bob withdraws 200 tokens. So we'll calculate rewards per token at 11 seconds and also calculate the amount of rewards earned by Bob.
00:13:05.074 - 00:13:47.410, Speaker A: Let's start with reward per token at 11 seconds. So r eleven is equal to the previous reward per token will be r ten plus the reward rate r over. What is the total amount of token staked from the duration ten to eleven? Scrolling up from ten to eleven there were 400 state. So this will be 400 further duration from ten to eleven. So eleven minus ten and this will be equal to r ten will be this value to r ten. We add r over 400 from the duration eleven minus ten. So that will be one and that is r eleven.
00:13:47.410 - 00:14:14.202, Speaker A: Now, this was Bob who withdrew his tokens. So let's update. User reward per token paid for bob. The user reward per token paid for bob is r eleven. And I'll cancel out the previous user reward per token paid for bob. Okay, let's calculate the amount of rewards earned by Bob. So far, the amount of tokens staked by Bob was 200 tokens from time five to eleven.
00:14:14.202 - 00:14:52.870, Speaker A: Using this formula, the current reward per token will be stored in r eleven the previous time bob either staked or withdrew. The token is stored at r five, so the amount of rewards earned by Bob will be 200 the amount staked by Bob. The current reward per token, r eleven, minus the previous time Bob either staked or withdrew. The tokens will be stored at five, so that will be r five. So scrolling down, I'll move Carol's calculation further down. And inside the space that we just created, we'll put our calculation for bob. The amount staked by bob is 200 tokens.
00:14:52.870 - 00:15:32.646, Speaker A: If I scroll up, we'll need to minus r eleven from r five. So scroll back down, multiply 200 by r eleven minus r five, and this will be equal to 200 multiplied by r eleven. R eleven is this value over here, minus r five. Scroll up and r five is simply two r over 100. So minus r five being two r over 100. Okay, let's simplify this equation. I see a two r over 100 over here, minus two r over 100.
00:15:32.646 - 00:16:09.182, Speaker A: So the amount of rewards earned by bob is 200 times whatever that is left inside here. So that will be these values, and that is the amount of rewards earned by bob. Okay, let's scroll up. What happens at 13 seconds? At 13 seconds, Carol withdraws 200 token. So again, we'll calculate reward per token at 13 seconds, then minus the last user reward per token for Carol. And that will give us the amount of rewards earned by Carol from the duration ten to 13. So I'll scroll down and let's calculate reward per token at time 13.
00:16:09.182 - 00:16:44.762, Speaker A: R of 13 is equal to previous reward per token plus R over the total stake from the duration eleven to 13. The total stake from duration eleven to 13 is 200. So r over 200 times the duration 13 minus eleven. And this will be equal to r eleven is this value. And to this we add r over 200 for the duration 13. Minus eleven will be two. This was Carol who withdrew her tokens.
00:16:44.762 - 00:17:12.610, Speaker A: So let's update user reward per token for Carol. Scrolling up, we'll say that the latest user reward per token pay for Carol is R 13. And cross out the previous user reward per token pay for Carol. Okay, finally, let's compute the amount of rewards earned by Carol from the duration ten to 13. I'll scroll up. And the amount of tokens staked by Carol from the duration ten to 13. We can count the number of boxes.
00:17:12.610 - 00:17:38.734, Speaker A: And it is 200. So, scrolling back down. So, total staked by Carol from the duration ten to 13 will be equal to the total staked in that duration by Carol. 200 times the current reward per token. That will be R 13 minus the previous user reward per token paid for Carol. And this will be r ten. So I'll scroll down.
00:17:38.734 - 00:18:12.680, Speaker A: And from r 13, we minus r ten, and that is the amount of rewards earned by Carol from the duration ten to 13. Let's calculate what this reward turns out to be. So this will be equal to 200 times. What's r 13? R 13 is this value, minus r ten. Scroll up again. And r ten is this value over here. Scroll down.
00:18:12.680 - 00:18:53.800, Speaker A: We'll need to minus this value from the top. So I'll put a minus here and then replace the plus with a minus for all the terms. The top is r 13 and the bottom is r ten. Okay, let's simplify this equation. I see a two, r over 100, minus two, r over 101, r over 300, minus one, r over 303, r over 400 minus three, r over 401, r over 300, minus one, r over 400. So, simplifying this equation, we get this is equal to 200 times whatever that is. Left inside here is one r over 400 plus two, r over 200.
00:18:53.800 - 00:19:18.410, Speaker A: And that is the final amount of rewards earned by Carol, first, taking 200 tokens from the interval ten to 13 seconds. This completes the example for calculating rewards earned by user using this equation. In the next video, we'll summarize what we just did, and we'll come up with an algorithm for calculating the rewards earned by user using this equation.
