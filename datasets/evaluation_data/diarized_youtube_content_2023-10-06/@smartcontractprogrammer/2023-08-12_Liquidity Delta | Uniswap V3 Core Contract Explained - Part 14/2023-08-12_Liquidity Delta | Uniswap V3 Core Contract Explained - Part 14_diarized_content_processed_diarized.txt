00:00:00.330 - 00:00:56.830, Speaker A: When you add or remove liquidity from uniswap, b three the liquidity changes. This is called liquidity delta, but how is it calculated? So in this video, we'll derive the equation for liquidity delta. We'll say that L zero is liquidity before adding liquidity, and L1 is liquidity after adding liquidity, and delta L will be the difference L1 minus L zero. What we're going to find out is what delta L is equal to in terms of the price ranges p of A, P of b, and the current price p, and the token amounts delta X and delta Y. There are three cases to consider when the current price p is less than or equal to p of A, this is the lower price range. When the current price p is greater than or equal to p of b, the upper price range and finally the case when the current price p is between the price ranges p of a and p of B. Let's start with the case when the current price is less than or equal to p of A.
00:00:56.830 - 00:01:38.362, Speaker A: Let's say that we have some liquidity L zero, and then by adding some liquidity, we get L1. As you can see from the graph, the current price is over here, which is less than or equal to the lower price range P of A. Now, in the previous video, we found out that when the current price P is less than the lower price range, the liquidity will be all in token X. For the price to swing from P of A to P of B, this much amount of token X is needed. We'll call the amount of token X that is needed in this price range X. And the same situation applies when the liquidity is at L1. The current price will be somewhere over here, which is still less than or equal to the lower price range P of A.
00:01:38.362 - 00:02:25.386, Speaker A: And in this case, we can again say that liquidity between P of a to P of B will all be in token. Next, for the price to change from P of A to P of B, this much amount of token X is needed. We'll call this amount of token that is needed X plus delta X. From the last video, we know that liquidity L zero will be equal to X divided by one over the square root of P of A, minus one over the square root of P of B. And the same applies for liquidity l one l one will be equal to x plus delta x over one over the square root of p of a, minus one over the square root of p of b. So in this case, what will be delta L? Well, delta L is simply equal to L1 minus l zero. The denominator for l zero and L1 are the same.
00:02:25.386 - 00:03:10.022, Speaker A: So l one minus l zero. We're simply subtracting x plus delta x minus x from the numerator, and we get delta X over one over the square root of p of a minus one over the square root of p of b. This is the equation for liquidity delta. When the current price p is less than or equal to the lower price range p of a. How about when the current price p is greater than or equal to the upper price range p of b? So, from this graph, you can see that the current price p is greater than or equal to the upper price p of B. What is liquidity delta in this case? Well, for liquidity l zero, we know that for the price to change from p of b to p of a, we need this much amount of token Y. We'll call this y.
00:03:10.022 - 00:03:36.018, Speaker A: And likewise for liquidity l one, the current price will be somewhere over here. The current price is still greater than or equal to the upper price range p of B. So the same situation as L zero applies to L1. The liquidity between p of b and p of a will all be in token Y. We'll call this amount y plus delta Y. The liquidity for l zero is expressed by this equation. We derived this equation in the last video.
00:03:36.018 - 00:04:09.674, Speaker A: For L1. It's almost the same equation, except that the amount of token y will be y plus delta Y. Okay, how about liquidity delta? Liquidity delta again will be L1 minus l zero. Doing the math, the denominators are the same for L1 and l zero, and the numerators will be y plus delta y minus y. So, liquidity delta will be delta Y over the square root of p of b minus the square root of p of A. This is how you calculate liquidity delta. When the current price p is greater than or equal to the upper price p of B.
00:04:09.674 - 00:04:41.590, Speaker A: The last case to consider is when the current price p is between the two price ranges, p of A and p of b. For the price to change from p to P of B, we're going to need this much amount of token x. And for the price to change from p to P of A, we're going to need this much amount of token Y. And the same applies for liquidity L1. For the price to change from p to P of B, we're going to need this much amount of token X. We'll call this X plus delta X. For the price to change from the current price p to p of A, we're going to need this much amount of token Y.
00:04:41.590 - 00:05:39.378, Speaker A: We'll call this Y plus delta Y. The liquidity equation when the current price p is between the price ranges P of A and p of b, is this the liquidity of token x between the current price p and the upper price P of B must be equal to the liquidity of token y between the current price p and p of a? And the same equation applies to L1. Except the amount of tokens changes. The amount of token X will be X plus delta X, and the amount of token Y will be Y plus delta Y. To get liquidity delta, we'll have to do L1 minus L zero. Starting from this side of the equation, if we subtract l one from l zero, we get that the amount of token x that is needed is this and if we subtract this side of the equation l one minus l zero, we will get this equation and the final equation to calculate liquidity delta is this. By using this equation, we'll be able to solve the amount of tokens that is needed when we're adding liquidity.
00:05:39.378 - 00:05:56.060, Speaker A: For example, if we know the amount of token next that we're adding, then solving for delta y, we will figure out the amount of token y that is needed. And the opposite is also true. If we know the amount of token y that we want to add, then we can solve for delta x. To get the amount of token x that is needed.
