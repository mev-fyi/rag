00:00:00.170 - 00:00:37.574, Speaker A: When you add or remove tokens from a unison b two pool, the liquidity changes. So in this video, I'll explain how to derive the liquidity delta. First, let's start with definition. We'll say that liquidity is equal to L, and this is measured by the square root of x times y, where x is the amount of token x in the pool and Y is the amount of token y in the pool. We also say that price P is equal to y divided by x. This will be the price of x in terms of Y when we add liquidity, let's say that we add delta x amount of token X, and delta Y amount of token y, the liquidity before we add token x and token y. We will name it L of zero.
00:00:37.574 - 00:01:28.182, Speaker A: So this will be liquidity before adding delta X and delta Y. And by the definition that we defined over here, l zero will be equal to the square root of x zero times y zero where x zero and y zero are amount of token x and token y before we add liquidity. Likewise, L1 will be equal to liquidity after we added delta X and delta Y. This will be equal to the square root of the amount of token x and amount of token y. The amount of token x will be the amount before we added liquidity plus delta X, and likewise, the amount of token Y will be the amount of token y before we added liquidity plus delta Y. Let's take a look at what this would look like on a graph. On a graph, let's say that there are x zero amount of token x and Y zero amount of token y, and we're trading on this curve l zero.
00:01:28.182 - 00:01:51.934, Speaker A: When we add delta X to token x, we increase the amount of token x. So we will shift this tick over to the right. And likewise, when we add delta Y amount of token y, then we move this tick from y zero over to y zero plus delta Y. Then the resulting curve will shift to the right and to above. And then here we will have the curve L1. Recall that in unison. B two.
00:01:51.934 - 00:02:34.086, Speaker A: When we add liquidity, we cannot change the price. The price is determined by the ratio of token y and token x. And when we add delta Y and delta X, this ratio of y over x cannot change. In other words, the slope that you see over here must be the same after we add liquidity. The new curve after we add liquidity will be somewhere on this straight line. When we increase liquidity from l zero to l one, what is the change? What is the liquidity delta? The liquidity delta is given by this formula, liquidity delta is equal to l one minus l zero, and this will be equal to the change in token x. In this case, the amount of token x that we add times the square root of the price.
00:02:34.086 - 00:03:07.526, Speaker A: Also, this will be equal to delta y the amount of token y that we added over the square root of price p. For the rest of the video, I'll explain how to derive these equations. We'll start with preliminary math. We'll prove that l is equal to x times the square root of p, and this will be also equal to y divided by the square root of p. First, we'll start with the definition. L is equal to the square root of x times y, and the current price p is equal to y divided by x. We can rearrange this equation to say x is equal to y divided by p.
00:03:07.526 - 00:03:43.454, Speaker A: I brought the x over to the left and dividing both side of the equation, brought the p over to the right. Next, let's substitute this equation into this equation. So I'll copy this, paste it here, and we'll replace x with this equation over here. So I'll remove the x and x is equal to y divided by p. So I'll copy this and then bring it inside over here. And we get that l is equal to the square root of y over p times y. Now, inside the square root we have y times y and we're taking the square root.
00:03:43.454 - 00:04:19.166, Speaker A: So this simplifies to simply y, and the denominator will be the square root of p. We have solved the first part of the equation. L is equal to y divided by the square root of p that you see over here. Okay, so let's do the same to derive the equation for l is equal to x times the square root of p. Again, we'll start from this equation and then rewrite it so that y is equal to x times p. From this equation, I multiply both sides by x and bringing the x over here, this will be x times p equals y. In other words, y is equal to x times p.
00:04:19.166 - 00:04:50.246, Speaker A: Next, using this equation, let's replace y inside this equation. So I'll copy this equation, paste it here. And since we have an equation for y, we'll replace y with x times p. So remove the y and then paste x times p inside the square root. So l is equal to the square root of x times x times p. Inside the square root, we have x times x. Square root of x squared will be simply be equal to x.
00:04:50.246 - 00:05:24.978, Speaker A: So, simplifying this equation, we pull out the x out from the square root. So it will be x times a square root of p. And we have solved for the first part of the equation, l is equal to x times a square root of p. And we have derived all of the equations inside this green box. The other math that we're going to need for the rest of the video is that when we add liquidity, the price does not change. So if p zero is the price before adding liquidity, and p one is the price after adding liquidity, then adding liquidity does not change the price. In other words, p zero will be equal to p one.
00:05:24.978 - 00:05:58.014, Speaker A: Okay, so these are the two math that we're going to need for the rest of the video. Let's now derive the equation for liquidity. Delta liquidity. Before adding liquidity, we'll say l zero is equal to the square root of x zero times y zero, where x zero and y zero are amount of tokens inside the pool. Before we added liquidity, the initial amount of tokens inside the pool. Using this equation, let's rewrite l. So first I'll copy this equation and then scroll down and then paste it here.
00:05:58.014 - 00:06:28.742, Speaker A: L zero is equal to the square root of x zero times y zero. And this will be equal to x zero times the square root of price p. And this will be equal to y zero over the square root of p. Now notice that here I'm using p instead of p zero. P zero will be the price before adding liquidity. So the price at l zero. However, since we mentioned over here that p zero is equal to p one, we can simply rewrite this as p instead of writing it as p zero.
00:06:28.742 - 00:06:58.722, Speaker A: We're using the fact that adding liquidity does not change price. Price before adding liquidity must be equal to after adding liquidity. So we can simply relabel everything as p. This is the equation for l zero. Let's derive the equation for l one doing the same technique. L1 is a liquidity after adding delta x and delta y amount of tokens. So by definition, l one will be equal to the square root of x zero plus delta x multiplied by y zero plus delta y.
00:06:58.722 - 00:07:30.730, Speaker A: When we derive the equation for l zero, we use this equation to replace this equation with these forms. So we'll do the same for over here. So first, again, I'll copy these equation and then scroll down and then paste it here. I'll move this over to the side. For now, the amount of token next will be x zero plus delta x. So I'll copy this and then paste it here. And we'll replace this x with x zero plus delta x.
00:07:30.730 - 00:08:09.318, Speaker A: So I'll move this to the side, remove the x, and then bring this over here. And that is one way of writing L1 in terms of x zero, delta x and the price p. Let's do the same for this expression y divided by the square root of p. So I'll bring this over here. When we add liquidity, the amount of y, the amount of token y will be this y zero plus delta y. Copy it, paste it, and then replace this with y over here. So l one will be equal to y zero plus delta y over the square root of price p.
00:08:09.318 - 00:08:31.870, Speaker A: And note here again that we're using the fact that adding liquidity does not change price. So p zero equals p one. So we simply label it as p. Okay, with these two equations, let's now derive the equation for liquidity delta. Liquidity delta is equal to l one minus l zero. And this is equal to l. One will be equal to this equation.
00:08:31.870 - 00:09:12.974, Speaker A: Minus l zero will be equal to this equation. Notice here that we have x zero times square root of p minus x zero times the square root of p. So these cancel out and we are left with. From the first term, I have a square root of x times the square root of p. And the second term x zero times the square root of p cancels out with the first term, x zero times the square root of p. So liquidity delta, we can write it as delta x, the change in the amount of token x inside the pool. In this case, we're adding tokens, so this will be the amount of tokens that we're adding times the square root of price p.
00:09:12.974 - 00:09:50.566, Speaker A: We can do something similar to get liquidity delta in terms of delta y and square root of price p. Again, l one is equal to y zero plus delta y over square root of p. Copy it and then paste it here. Minus l zero minus l zero will be this number over here. Paste it. And again I see y zero over the square root of p. So this one cancels out with this one, and we're simply left with delta y over the square root of p.
00:09:50.566 - 00:10:23.438, Speaker A: And that completes the proof for liquidity delta. Liquidity delta is equal to l one minus del zero. We can rewrite this in terms of the amount of tokens that we added times the square root of p. If you use the amount of token x, then this will be equal to delta x times square root of p. Or if you use token y, then this will be delta y divided by square root of p. In a future video. I'll show you how the liquidity delta for unisoft b, three in the price range from zero to infinity, converges to liquidity Delta for unisoft B two.
00:10:23.438 - 00:10:24.780, Speaker A: The equations that you see over.
