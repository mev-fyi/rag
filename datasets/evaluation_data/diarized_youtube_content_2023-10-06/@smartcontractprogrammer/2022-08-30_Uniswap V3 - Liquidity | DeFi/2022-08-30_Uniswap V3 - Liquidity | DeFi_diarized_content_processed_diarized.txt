00:00:00.250 - 00:00:44.522, Speaker A: Today, we'll derive the equation for the liquidity of a single position in unison b three. In the previous video we derived that if the current curve is x times y equals l square, where l is the liquidity and the current price is p, then the curve for the real reserves between the price range p of a and p of b is given by this equation. We'll be using this equation to derive the equation for liquidity. The equation for the liquidity has three parts. When the current price is less than or equal to p of A, when the current price is greater than or equal to p of b, and also the case when the current price is between p of a and p of b. We'll go over how to derive all of these equation. Let's start with the first case when the current price is less than or equal to p of a.
00:00:44.522 - 00:01:07.506, Speaker A: Let's start with the first case when the current price p is less than or equal to p of a. On the graph it would look like this. The blue curve is the x times y equals l square. This is the curve of the virtual reserves. You can see here that p of A is over here and to the right of it is the current price. When the current price is to the right of p of A. You can see here that the real reserve of token y is equal to zero.
00:01:07.506 - 00:01:34.058, Speaker A: All of the tokens are in token x. So this means that token y, the real reserve for token y, is equal to zero. This means that we can simplify this equation for the real reserves. We know that y of r is equal to zero. So I'll say y of r cancel l and this is equal to zero. Okay, let's simplify this equation. The left part of this multiplication stays the same, and the right part we have l times the square root of p of a.
00:01:34.058 - 00:02:19.218, Speaker A: So I'll copy this, paste it here, and this will be equal to l square. Notice that I have an l here and an l square, so we can cancel out one of the l's. Okay, let's expand this part of the equation so I have xr times the square root of p of a, xr times the square root of p of a plus this term over here. I'll copy and paste it l over the square root of p of b times this square root of p of A, and this will be equal to l. Next, I'll bring this term over to the right. So this equation will be equal to x of r times the square root of p of a is equal to l minus this term over here. Bring it over to the right.
00:02:19.218 - 00:02:44.730, Speaker A: And let's simplify this term. So this will be equal to l times. We pulled out the l from the first term. So the first term will be one minus square root of p of a over square root of p of b. This part of the equation is equal to this equation. So I'll just remove this and then replace it with this. We can further simplify this part of the equation.
00:02:44.730 - 00:03:21.898, Speaker A: So I'll cancel it out and say this part of the equation is equal to square root of p of b minus the square root of p of a over the square root of p of b. Okay, the last step is to solving for L. So first, I'll copy this part of the equation, paste it, and this is equal to l times this term over here. And solving for l, we'll bring this term over to the left. So what we'll do is divide by this term on both side of the equation. When we divide this, we're bringing the square root of p of b minus the square root of p of a to the bottom. Then I'll remove this and then bringing this term up on top.
00:03:21.898 - 00:03:44.818, Speaker A: And we have our final result for the equation of liquidity. L. When the current price is less than or equal to p of a. Okay, let's move on and derive the equation for liquidity. When the current price is greater than or equal to p of b. When the current price p is greater than or equal to p of b, then on the graph it would look like this. Here you have p of b, and to the left you will have the current price p.
00:03:44.818 - 00:04:10.570, Speaker A: Notice that when the current price is above p of b, then the real reserves are all in token y. This means that there are zero token. Next. So x subar is equal to zero. Again, we can simplify the equation for the real reserves. When the current price p is greater than or equal to p of b, then x, sub r is equal to zero. So we can simplify this equation saying x subar is equal to zero.
00:04:10.570 - 00:04:47.366, Speaker A: Okay, let's simplify this equation and solve for l. From the first term, we simply get l over the square root of p of B. The second term remains the same, and this will be equal to L square. Now, notice that we have an L over here and l square over here, so we can cancel them out. Next, let's simplify this equation so for the first term, I have a y of r over the square root of p of b plus L times the square root of p of a over the square root of p of B. And this will be equal to L. Okay, let's bring this term over to the right so that we can solve for L.
00:04:47.366 - 00:05:22.162, Speaker A: So the first term, I'll just bring it down and this will be equal to L minus L times a square root of p of a over square root of p of B. We can further simplify this part of the equation. So I'll pull out the l, so it'll be L times one minus this term. So I'll copy this, paste it, and then close the parentheses. So these two terms are equal. So I'll remove this and then move this over here. Now I can further simplify this part of the equation by multiplying one by square root of p of B over square root of p of B.
00:05:22.162 - 00:05:47.530, Speaker A: And what do we get? This will be equal to square root of p of b minus square root of p of a over the square root of p of b. And now we can finally solve for a liquidity L. First term will be the same. Next, we'll divide both side of the equation by this term. So I'll copy this. Since we're dividing, I'll bring this over to the bottom. And since we're multiplying by this term, I'll bring this over to the top.
00:05:47.530 - 00:06:11.186, Speaker A: Now, notice that I have a square root of p of b and a square root of p of B over here. And they cancel out. Okay, let's clean this equation. So I'll remove this and this and then simply bring this over to the bottom. Okay, so y of R over the square root of p of b minus the square root of p of A. This will be equal to the term on the right. And the term on the right is simply L.
00:06:11.186 - 00:06:55.890, Speaker A: And this will be the equation for liquidity when the current price is greater than or equal to p of b. Okay, the final equation to derive is when the current price is between p of a and p of b. The way we can solve for this case is to restrict that the ideal liquidity. We'll say that the liquidity of token X from the current price p to P of b is equal to L of X. And likewise we'll say that the liquidity of token Y from P of A to the current price P is L Y. And here we're saying that the ideal liquidity of token X and token Y are equal L of x is equal to L of Y. On a graph, if P of A is over here and P of B is over here, and the current price P is somewhere between p of A and P of B.
00:06:55.890 - 00:07:44.894, Speaker A: Then the ideal liquidity means that token X provided between the current price p and p of B that you see in pink over here will be equal to the liquidity of token Y from the current price p to P of a that you see in purple over here. If we can find what L of x and L of Y are, then we can derive the equation for the liquidity L. So first, let's find L of X. Recall that from the previous step, when the current price P is less than or equal to p of A, then we know the equation for liquidity, liquidity L is equal to this equation. Now, we can modify this condition to fit the current price and then apply this equation. So first, I'll copy all of this and then paste it. And then we'll modify the situation for price range between the current price.
00:07:44.894 - 00:08:21.386, Speaker A: So, I'll remove the a from p of A. So, from the current price p to p of b, we replaced p of a with p. So here I'll replace this p of a with also p, and then do the same for this equation, remove the a's, and we get that liquidity for the price range from current price to p of b is given by this equation. All we did was we took this equation and replaced p of a with the current price p. And this is the equation for the liquidity l of x. We can apply the same technique to find L of Y. Okay, so let's find L of Y.
00:08:21.386 - 00:08:56.966, Speaker A: Earlier, we derived that for the price range p of a to p of b. When pob is less than or equal to the current price p, then the liquidity is given by this equation. Let's modify this condition so that it fits the current price. So, I'll take this equation, copy it, paste it, and then we'll replace p of b with the current price p. So from this statement, I'll remove p of B, and also from the equation, I'll remove p of B. All I did over here was to replace p of b with the current price p. And this will be the equation for the liquidity l of Y.
00:08:56.966 - 00:09:24.698, Speaker A: Finally, let's put the two equations that we derived earlier together. When the current price p is between p of A and p of b, on the one hand, we know that L of x is equal to this equation. On the other hand, we also know that L of Y is equal to this equation. And we also mentioned that L of x must be equal to L of Y. So this will be the equation for the liquidity. When the current price is between p of A and p of B. To summarize, the equation for liquidity has three parts.
00:09:24.698 - 00:09:40.850, Speaker A: When the current price is less than or equal to p of A, then it is given by this equation. When the current price is greater than or equal to p of b, then it is given by this equation. And. And finally, when the current price is between p of A and p of b, then it is given by this equation.
