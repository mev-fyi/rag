00:00:00.250 - 00:00:31.126, Speaker A: Today we'll go over how to convert from tick to square root price x 96 and from square root price x 96 back to tick. First, let's start off by reviewing some of the variables. We'll say that P is the price of token zero. In terms of token one, the square root price x 96 is defined to be the square root of p times q 96. Where q 96 is equal to two to the 96. The tick is defined to be number where 1.1 raised to the tick is equal to the price p.
00:00:31.126 - 00:01:00.478, Speaker A: If we take the square root of p, then this is equal to the square root of 1.1 to the tick. It doesn't matter if we raise 1.1 to the tick and then take the square root, or if we take the square root of 1.1 and then raise it to the tick, these two give us back the same numbers from this equation. To get the tick we'll need to take the log of base square root of 1.1 of the square root of p.
00:01:00.478 - 00:01:43.760, Speaker A: Let me show you what I mean by here. So the square root of p is equal to this expression and then to get the tick back we'll need to take the log on both sides. So we'll take the log of square root of p and the base of the log will be the square root of 1.1. Make it clear that this log is the base of the square root of 1.1. I'll put it here, then make it a little bit smaller and then I'll wrap parentheses around the square root of p. So if we take the log of base square root of 1.1 of the square root of p and we do the same on this side, then we get the tick back.
00:01:43.760 - 00:02:28.570, Speaker A: The last equation is the equation that we're going to need to calculate from tick to square root price x 96 and from square root price x 96 back to thick. So let me show you some equations. Let's start off by coming up with an equation from tick to square root price x 96. Our starting point will be this equation. So given that we know the number of the tick, then what we're trying to find is square root price x 96 and this is equal to this equation over here. I'll copy it and then paste it here and that is the number that we're trying to find. We also know that the square root of p is equal to the square root of 1.1
00:02:28.570 - 00:03:13.126, Speaker A: raised to the tick and we're assuming here that we already know the number for the tick. So I'll copy this equation and then also paste it here. And then since we know the tick, this will be our starting point. This will be equal to, this will be equal to the square root of p. To get the square root price x 96 we'll need to multiply the square root of p by q 96. So I'll copy this and then paste it here. Since we're multiplying this side of the equation by q 96, I'll have to do the same on this side of the equation.
00:03:13.126 - 00:03:50.434, Speaker A: Paste q 96 over here as well. And now notice that the square root of 1.1 raised to the tick times q 96 is equal to the square root of p times q 96. And we know that this is equal to this equation. So this equation is equal to the square root price x 96. So I'll move the square root price x 96 over to the left, over to the right and that is our final equation for calculating. Given that we know the tick, we can calculate the square root price x 96 by following this equation.
00:03:50.434 - 00:04:20.400, Speaker A: We can also calculate the other way. If we know the square root price x 96 then we can calculate the tick. So again, let's start with square root price x 96. We know that square root price x 96 is equal to this equation. So I'll copy it, paste it here. And what equation are we going to use to calculate the tick? Well we said that the tick is equal to this equation over here. So I'll copy this and then paste it here.
00:04:20.400 - 00:05:09.230, Speaker A: This equation says that if we know the square root of price p then we can get the tick back here. We're saying that we know what square root price x 96 is. So that means that we can calculate the square root of p. Square root of p will be equal to dividing both side of the equation by q 96. So I'll bring q 96 over here and then we're dividing square root price x 96 by q 96 and that will give us back the square root of p. And once we know what square root of p is we can plug it in here. So I'll replace square root of p with square root price x 96 over q 96 and that is how we get back the tick.
00:05:09.230 - 00:05:44.060, Speaker A: Take the log of base square root 1.1 of the square root price x 96 over q 96 and that will give us back the tick. Let's go through an example. For the first example we'll say that we know what the tick is and we'll try to compute the square root price x 96. Let's say that tick is equal to this number. This number I got from the unison B three USDc e pool contract. So to get the square root price x 96, the formula that we're going to be using is this.
00:05:44.060 - 00:06:25.286, Speaker A: So I'll copy it, paste it here, and I'll move the square root price x 96 to the bottom. And let's compute this equation. We know that the tick is equal to this number over here. Paste it times q 96. Now q 96, this is equal to two raised to the power of 96. And other simplification that we'll make is that the square root of 1.1 raised to this power is the same as dividing this number by two.
00:06:25.286 - 00:07:01.794, Speaker A: So what I mean here is I'll copy this, paste it here, this is the same as dividing the tick by two, and whatever number we get, we take 1.1 raised to that power and this will be equal to the square root price x 96. To compute this number, to get square root price x 96, we will be using Python inside my Python Jupyter notebook. The first thing that I'll do is import the math library. Import math. Next, I'll define what q 96 is. Capital Q 96.
00:07:01.794 - 00:07:53.218, Speaker A: This is equal to two to the 96. Next, we will write a function that given a tick, it will calculate the square root price x 96. So I'll say def tick to sqrt price x 96. This will take in a single input of the tick, and then it will return the square root price x 96. So to do that, we'll say return 1.1 raised to the tick divided by two, and then we'll multiply this result by q 96. And lastly, since Python returns decimals, we'll cast this into a number, an integer by wrapping the whole expression in Int.
00:07:53.218 - 00:08:30.606, Speaker A: Here we're saying raise 1.1 to the tick divided by two, multiply the result by q 96, and then ignore the decimal part and just give me back the number part, the integer part. Let's run through an example. We said that tick is equal to this number. To get square root price x 96. We'll call the function tick to sqrt price x 96 and then pass in the tick. And then I'll execute this script by hitting Ctrl enter and that is the square root price x 96.
00:08:30.606 - 00:09:12.422, Speaker A: I'll copy this and back inside here I'll replace square root price x 96 with the number that we found. So I'll paste it, okay, and that is starting from tick with this number, the square root price x 96 will be this number in pink. Let's go over another example. Let's say that we know what the square root price x 96 is. Let's say that we looked at the contract for uniswap b three USDc weft pool contract and we know what square root price x 96 is. From that, how do we calculate the tick? Let's go through an example. So this big number that I got, I got it from the unison B three USDC e pool contract.
00:09:12.422 - 00:09:55.802, Speaker A: You'll say that square root price x 96 is equal to this number. And what we're going to do here is from this number, compute the tick. To do that, I'll scroll up and the equation that we're going to be using is this equation copy, scroll down and then paste it here. We know what Q 96 is. Q 96 is two raised to the power of 96 and we'll replace square root price x 96 with this number and that will give us back the tick. Copy this number, paste it here, evaluate this equation and this will give us back the tick. So I'll put the tick down here for now.
00:09:55.802 - 00:10:35.878, Speaker A: Now notice that we're taking the log of base square root 1.1. You won't be able to do this calculation on most calculators. So that is why we're using Python to calculate this expression. Back in my Jupyter notebook. Let's write a function to calculate the tick given the square root price x 96. So I'll say def sqrt price x 96 to tick and for the input it's going to take an sqrt price x 96 and it will compute the tick. First we'll compute the base of the log.
00:10:35.878 - 00:11:08.978, Speaker A: The base is equal to math square root of 1.1. Next we'll calculate the square root price. Notice that the input is square root price x 96. This means that this number is the square root of price multiplied by q 96. So to get the square root price, we'll need to divide this by q 96. PE is equal to square root price x 96 divided by q 96. And lastly, we'll need to return the log.
00:11:08.978 - 00:11:46.606, Speaker A: Return math log of the square root price which is Pe, and the base of this log will be the base that we calculated in the first step. And the last step is that we'll return the integer part of this expression. So we'll use math floor here. We're using math floor because math floor will round down whereas int will just ignore the decimal part. To show you this example of this, if we do int of -1.5 this will ignore the 0.5 part and return minus one.
00:11:46.606 - 00:12:09.126, Speaker A: Whereas if we use math floor of -1.5 this will round down. This will round out -1.5 and we'll get back minus two. So that is the difference. Int will ignore the decimal part, whereas math floor will round down. So that is why we're using math floor over here.
00:12:09.126 - 00:12:56.310, Speaker A: Okay, so let's run through an example of this code. So I copy the square root price. From the example, we'll say square root price x 96 is equal to that big number that I just copied. Then we will call the function square root price x 96, two tick, passing in square root price x 96, and then execute the code. And we get that the tick is equal to 204632. Calculating the tick, we get back 204632. So those are examples of calculating from tick to square root price x 96 and from square price x 96.
00:12:56.310 - 00:12:56.740, Speaker A: To take.
