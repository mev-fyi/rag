00:00:00.200 - 00:00:38.574, Speaker A: Known for his original research on market microstructure. He has written many influential papers in this area, including a well known paper with Marco Avallaneda and on optimal market making, and also many interesting papers on limit order books and market microstructure, the behavior of prices intraday time scales. And so today he's going to describe some new work he's done in this area on market microstructure for co integrated assets. Thank you, Sasha, and over to you.
00:00:39.074 - 00:01:31.418, Speaker B: Thank you. Yeah, so before I start, maybe I'll define a few terms, because I had told some of my friends that I was giving a talk at the seminar, and they asked me for the title. When I told them the title, they said, that sounds great, but we don't understand anything. So I'll define a little bit the two main elements that I want to describe in the talk today. One is the market microstructure, which is, I'd like to think of that as what happens when you zoom in into the price. You go beyond the day, the hour, the minute, and you sort of zoom into a single tick and try to see what happens at the second or millisecond timescale. And at this time scale, we know a lot of empirical facts.
00:01:31.418 - 00:02:31.234, Speaker B: In fact, we know that looking at the order book can give you a lot of information about what's going to happen next. So for me, market microstructure is the sort of 1 minute and below timescale. Then there's this other world, which is more the world of statistical arbitrage, or where we know that certain assets are highly linked. So co integration is even, I would say, a stronger concept than correlation, in that we know that there are certain assets that have very similar business models, for example. Or in fact, today we'll look at assets that are contractually linked to each other. So those are assets that are very much co integrated. And essentially, to simplify things, co integrated assets are assets where if you regress one price against the other, they fall nicely on a straight line.
00:02:31.234 - 00:04:12.324, Speaker B: So this is sort of a work that combines signals at the, let's say, 1 minute time scales, two signals that are medium time scales of potentially several minutes or a few hours. This is joint work with a few co authors. Peter de Crem is at Citi in New York City, a city innovation labs, and he's sponsored several projects for our students in financial engineering. And, in fact, Yikai was involved in one of the first projects we did, which involved looking at the 30 year bond and looking at signals that would help you predict the short term price moves for the 30 year bond. After Yikai graduated, the three of us continued working on this, and we sort of hit a wall at some point and had trouble with the, with bonds, but, you know, not only with handling the data, but also with legal issues, you know, getting this proprietary data and making, you know, using it to write a paper. And that we sort of got out of this issue when Ann Chen, who's a fresh new graduate at CFEM at Cornell Financial Engineering, and she sort of helped us build the pipeline from data collection. So the data collection is essentially, we went on interactive brokers.
00:04:12.324 - 00:05:40.604, Speaker B: We created this python code that downloads intraday data, and from there we were able to calibrate our models and pretty much go all the way to the validation of the model, which I'll describe throughout this talk today. And in fact, if you look in the chat, I've included links for this paper, a previous paper on market microstructure that is relevant, and the GitHub repository with the code. So if you'd like to reproduce all the results in this talk, feel free to take a look at this code. And in fact, this code will also allow you to collect more data on interactive brokers if you want to do this kind of research on different assets. So let's start with the story, which is a little introduction on what I call zooming into the micro price. So what you have here is an asset, and the ticker is sh. So if you're not familiar with this, this is the short snp 500 ETF, which is sort of a bearish ETF that gives you exactly the negative returns of the s and p 500.
00:05:40.604 - 00:06:19.828, Speaker B: So if the s and P 500 goes up 1%, this one goes down 1%. So not a good ETF to hold for a long time. So. But here are three timescales. On the left, you have something that may be more familiar to you. These are close prices for sh over the course of one month, and it behaves very much like a stock or an ETF. And that's sort of the realm that we often think about when we model time series.
00:06:19.828 - 00:07:28.460, Speaker B: But what happens when you look at the second plot, which is a single day in the life of sh, you see that suddenly the bid and the ask take an importance and you start seeing that the moves and the prices are a little bit more discreet or chunky. In fact, if you go to the look at the last graph on the right, that's zooming into 30 minutes of prices, you can see that actually the movement of prices is extremely binary. The price will either go up by a tick or go down by a tick. And the look and feel of the price is quite different from the daily timescale or the plot on the left. Now, what I've also plotted on the plot on the right is the weighted mid, which turns out to be an important concept in high frequency trading. And what the weighted mid is. So the mid is the average of the bid and the ask.
00:07:28.460 - 00:08:29.124, Speaker B: The weighted mid is an average that gives more weight to either the bid or the ask, depending on the bid sizes and the ask size sizes. So, for example, if the bid size is much larger than the ask size, the weighted mid will be closer to the ask. And that sort of reflects the supply and demand imbalances. So that is sort of a single asset. And in fact, the first paper that I've included in the link is a paper that sort of, you may think of the weighted mid as a fair price of the asset, but in fact, it is a bit of an arbitrary weight to weight the bid by the imbalance. So the bid size over the bid size plus the ass size. In fact, this paper will argue that maybe the weighting scheme should be different.
00:08:29.124 - 00:09:43.154, Speaker B: Essentially, think of this green line as the fair price, and I'll give you more details soon on how that's computed. Now, on the other hand, here's another story, which is the comparison between the 30 minutes interval of the prices of shit and sds. So, SDS is an asset, that's an ETF. That is the twice leveraged short ETF. So I guess, as you can see from the two pictures, if you squint a little bit, these two prices seem to really move together very much in sync. The only difference seems to be the chunkiness or the, the asset on the right seems to go up more by more steps than the asset on the left. This is, I think, an ideal playground to start studying the microstructure and the role of the bid ask spreads and the bid ask sizes on the relationship between these two assets.
00:09:43.154 - 00:10:42.794, Speaker B: The first story is one of microstructure, and the second one is one which also thinks of more than one asset at a time. And in fact, if you plot the prices of sh here on the x axis, and sds on the y axis, the intraday mid prices. So I'm here, I'm plotting mid price against the mid price. You see that they fall very nicely on a straight line, even though the different colors represent different days. The blue was in November, and then the orange and the green are two consecutive days in December. But you can see that the relationship between these is extremely strong. And in fact, the high tech machine learning technique I'll be using there is linear regression.
00:10:42.794 - 00:11:43.854, Speaker B: There is really no need for anything more complicated than that if you want to understand the relationship of these two assets. So what's the goal? Or where am I heading with this talk? I'm going to define what I'm going to call the microprice, which is a notion of fair price simultaneously for SH and sds. Given the information at the top of the order book, and the information that I'm interested in is going to be the bid prices for SH and sds, the ask prices, the bid sizes, and the ask sizes. So two times four, we're essentially taking eight numbers. And out of these eight numbers, we're going to have a fair price for SH and a fair price of sds. And in some sense, these fair prices will be, these two prices will be aware of each other. SH will know whether it's a bit under or overpriced with respect to SDS.
00:11:43.854 - 00:12:52.344, Speaker B: So, a little outline of the talk today. First, I'm going to explore the data and sort of convince you that there are some very strong relationships here. The first relationship I want to prove is that I'm going to look at the regression residuals between SH and sds, and we're going to see that there's a finite sort of number of buckets in which these regression residuals fall. And we're going to see that depending on where this residual is, it will tell you whether a long short pairs trading strategy will be profitable or not once we look. So that's the co integration side of the story. Then we'll look at the imbalance. And I'm going to again demonstrate to you empirically that the imbalance is a strong predictor of the next price moves individually for SH and then independently for sds.
00:12:52.344 - 00:15:03.824, Speaker B: Then I'll give you a little reminder of what, or rather maybe an introduction of what the microprice in one dimension looks like. And there's also a reference for that paper in the chat. And finally, in this first part, I'll end up putting the two together, and we're going to construct a state of the order book. And this is going to be a finite state, and that state is going to capture all we need to know about Sh and SDs in order to, to define the microprice. So the next step of the talk is going to be more mathematical, and essentially it's going to be a lot of Markov chains and the idea will be, first, I'll generalize the one dimensional microprice idea, and we're going to see that there's a closed form solution for this microprice, and finally, that there are conditions for this microprice to converge. And that turns out not to be just a theoretical result, a sort of existence result, but it's a result that will be practical for training the model, or as we say in finance, calibrating the model, because we'll find that if this condition is not met, and this condition is a symmetry kind of condition, then there will be no micro price, or rather, the micropress will either be infinity or zero, which is not very useful. So in the final part of the talk, I'm going to be focusing on showing you how to compute the microprice, and then I'm going to do a little execution experiment, let's call it, which will demonstrate that computing the microprice can help an execution algorithm save money.
00:15:03.824 - 00:16:29.034, Speaker B: And in fact, we'll show in an experiment that you can roughly save half the bid as spread while trading on both these assets, SH and sds. All right, so let me jump right in and show you just how strongly related this Sh and SDS is. So the, you know, there's a long theory, sort of a lot of papers written about what cointegration is and how we can test it, and there's several tests for co integration. But this is such an extreme case that somehow there is no concern that these two assets are co integrated. So if you do run a simple regression of the mid price of SH against the mid price of sds, and then you plot Sh, and then you, on the same graph, plot alpha plus beta times the price of sds, you see that these prices really overlap very closely. And in fact, the difference between these two prices is typically less than a cent. So this epsilon is very small and very fast mean reverting.
00:16:29.034 - 00:17:51.906, Speaker B: So typically, people who look at cointegrating assets might look at stocks like Coca Cola and PEPC, and you might find that sometimes this epsilon, this residual, is stationary, sometimes it isn't. But in this case, as you'll see, if I plot epsilon, this is over the course of a day, this is a highly mean reverting quantity. And in fact, if you think about it, the definition of epsilon is price of sh minus alpha minus beta times the price of sds. And the negative residual can be interpreted as the expected p and l of a long short position. And the long short position would be long one share of shit short and beta or 0.69 in our case, shares of sds. And one thing you might first notice is of course, beyond this being a highly mean reverting signal, mean reverting around zero, is that even in extreme cases this doesn't, the magnitude is sort of sandwiched between negative one cent and one cent.
00:17:51.906 - 00:18:51.808, Speaker B: So what that means is that in fact SH and SDs are two very liquid ETF's. And what this means is there aren't any strict arbitrage or even statistical arbitrage opportunities for these two assets. Why? Because remember that I'm regressing the mid price of SH against the mid price of sds. Let's say that you think this might be a good time to go long one asset and short the other. You'll find that in order to immediately execute these two trades, you're going to have to pay half a bid as spread, which for these ETF's is 0.005 and on sh, and you'll have to pay 0.005 times these 0.69
00:18:51.808 - 00:20:00.658, Speaker B: shares. And that really amounts to almost $0.01. So there's something a little bit, as I say, tantalizing about this because you think you might make money, but the, the truth is you can't, at least not just by observing these mid prices. So the other thing that you may not have noticed, but I'd like to point out, is that these residuals are actually, if you plot their histogram or if you plot them, they fall into these very discrete, they have these very discrete quantities. So in fact, this is not a continuous sort of normally distributed residual. These are very discrete. And in fact, we found that we can model this quite well with six buckets or sort of six values or the most common values.
00:20:00.658 - 00:20:59.204, Speaker B: And as you can see, when this residual is low, then going long one share of sh and short 0.69 shares of sds, actually on average in five minutes. So this is a medium term timescale, on average makes $0.004. And when the residual is high, this on average loses, or this long short strategy loses 0.004. But that just means that you can expect to make revenue on the opposite of this long short strategy. All right, so this is kind of the first part of the story is the co integration between these two assets. The second important ingredient is the micro price.
00:20:59.204 - 00:21:47.888, Speaker B: And so what I'm going to define here is first the imbalance. So the imbalance is the quantity at the bid divided by the quantity at the bid plus the ask. So think of 900 shares at the bid and 100 shares at the ask, this number will be 0.9. And what this number really does, the imbalance is it indicates that the price is more likely to go up than, than it is to go down. And the mid price is simply the average between the bid and the ask. And now I'm going to start building what I'm going to call the microprice. So this first quantity that I have right here, PI, is the expected mid price at Tau I.
00:21:47.888 - 00:22:54.180, Speaker B: And so Tau I is the time of the ith mid price move. So Tao one would be the expected mid price at the next price move. So it'll either go up by a tick or down by a tick. So you could think of p one as just the average of the probability, the probability of going up times the price if it goes up, plus the probability of going down if the price goes down. And in fact, this is conditioned on the imbalance, because as I've mentioned, the imbalance is actually a strong does predict and influence the future price moves. Now what is going on here is I'm taking the ith mid price move. So rather than just taking the average of these two numbers, you'll find that actually at Tau two, there are three prices at which the mid price could be, and at tau four, there are four prices.
00:22:54.180 - 00:24:18.842, Speaker B: So at time I, I, well, no, at time I, there are I plus one prices where the mid price could be. So what's, what you'll find, or so here's the definition. The micro price is this limit as PI goes to infinity. And what you might intuit is that the p one is sort of an average of two numbers, and it's a very discrete and possibly, how shall I say, a notion that has a lot of microstructure noise in it. And the idea of taking the limit as I goes to infinity is to say this sort of, these finite number of prices that the mid price could take if you push this expectation to infinity, is actually much smoother. And sort of, I think of it as a filter that kind of cleans your price and removes microstructure noise. And in fact, if you see in this paper, in the microprice paper, the one dimensional microprice paper, you'll find that this microprice, under certain conditions is the mid price plus a function of the imbalance.
00:24:18.842 - 00:24:42.664, Speaker B: And this function sort of lives between the sum of the mid price. In this function, g tends to live between the bid and the ask. Although this is not imposed by our model empirically, we find that typically computing the micro price gives you a number between the bid and the ask.
00:24:46.884 - 00:24:52.904, Speaker A: So, Sasha, I understand why you would look at p one. So it's an estimate of the.
00:24:54.644 - 00:24:55.052, Speaker B: Next.
00:24:55.108 - 00:25:05.174, Speaker A: Price move, but why would you send it to infinity? Why would you care about that? That's like a far away horizon, right?
00:25:05.474 - 00:25:58.264, Speaker B: So what happens with p one? Because, you know, this, in fact, this was something we did in a paper you and I wrote about ten years ago, which is the, you know, what is the probability of the price going up versus the probability of it going down? And based, you know, conditional on the order book. But what we find empirically is that when the price ticks up, in fact, there's a sort of bid ask bounce or mean reversion, you could call it, which is that when the price ticks up, it very often ticks right back down. So if you take the expectation of the mid price at tau one, you may overestimate how far the price is going to move.
00:26:00.164 - 00:26:06.944, Speaker A: Okay, so you think if I look at p one, it's. It's biased in one direction.
00:26:07.644 - 00:26:08.316, Speaker B: Right.
00:26:08.460 - 00:26:09.236, Speaker A: Okay.
00:26:09.380 - 00:26:39.058, Speaker B: Yeah. So what we find is that p two is actually, you know, if this function g is actually, if we computed g one, let's call it our first sort of microprice adjustment, we would find, oh, when the imbalance is 0.9, it's way more likely for the price to tick up. But what g two takes into account is that, well, yeah, it'll tick up, but it'll take.
00:26:39.106 - 00:26:58.952, Speaker A: Okay, if I introduce successive micro adjustments, g one, g two, etcetera. You're saying that they have alternating signs? Probably, yeah. And they correct each other. And you hope that this thing converges to something which is devoid of microstructure noise.
00:26:59.128 - 00:27:06.472, Speaker B: Yeah. And hope being the key term here, because there's nothing about.
00:27:06.568 - 00:27:11.256, Speaker A: Why do you call it microprice? It's actually, you get rid of the microstructure.
00:27:11.440 - 00:27:12.248, Speaker B: Yeah.
00:27:12.416 - 00:27:14.724, Speaker A: So should call it a macro price.
00:27:16.024 - 00:28:10.764, Speaker B: Yeah, that's a good point. Well, we can workshop some names if you like. But, yeah, I tend to think of the micro price as a price that is free of microstructure noise. Yeah. But the hope that this converges is, in fact, initially this was sort of a hope which was quite disappointed when in practice, I found that it did not converge. And, you know, the sort of the main result of this paper, I would say the main mathematical result is that there is a condition, in fact, that resembles a martingale condition, that ensures that this limit converges. And if you think about it in terms of training or calibrating your model on past data.
00:28:10.764 - 00:29:36.666, Speaker B: If your past data had an upward trend, and that you estimate this model on a past upward trend, the expected mid price at tau one you might think is a little higher than right now, and at tau two a little bit higher, and tau three, et cetera, higher and higher. If there is any drift in your data, which typically there is, this limit may not exist. And in fact, we'll look at that in a little bit. So what does this look like empirically? Well, again, I'm going to discretize things. And what I have on the x axis here is the imbalance bucket, and on the y axis here's this function g, which tells you by how much I should offset the mid price to get the fair price or micro price. Or rather what I'm plotting here is the expected change in mid price over also a five minute time period. So you can see that when the imbalance is low, you may want to offset the mid price by, let's say, two tenths of a cent.
00:29:36.666 - 00:30:36.378, Speaker B: And if the imbalance is high, you might want to push your fair price up by a little bit. And really these two graphs look quite similar. The left one is for sh and the right one is it for sds. And what I wrote here, as I'm calling this, the cost, or using this, you can estimate a cost of immediately trading, because I think of when you trade, you can't trade at either the mid price or the micro price. You have to trade at the bid or at the ask. So there is sort of a, I think of this distance between the traded price and the micro price as a stochastic transaction cost. For example, if my imbalance here is two in the bucket, number two, and I buy this offset tells me that I'm not paying 0.005
00:30:36.378 - 00:31:05.354, Speaker B: or half a bid as spread. I'm paying 0.005 -0.0020.003 of a cent. But what's going on is a little bit, you'd think, okay, well, let's take my cost of trading, add that to my residual, which is sort of my expected p and l. And in fact, these two things are very much intertwined. And you can't simply add the two.
00:31:05.354 - 00:32:03.364, Speaker B: One of the challenges here is to take two signals at very different frequencies, one at the super short frequency and one at a medium frequency, and combine them. So let's summarize all these empirical facts. And really, these are the two things I really know about finance, is that sometimes assets like in this example, are very closely related. So regressing one asset against the other. And taking this co integration residual does help you predict the p and l of a pairs trading strategy. And as you've seen in this particular case, I found that six states sort of captures that relationship. And secondly, the imbalance is also predictive of price moves.
00:32:03.364 - 00:33:26.884, Speaker B: And I've given three states to each of these, the imbalance of sh and three to the imbalance of sds. So multiply all this together, and essentially we can think of the xt, the Markov state of the order book as these 54 states that, that are bouncing around. All right, so this is, in a way, what I've done here is through this data exploration. As I've said, what is the essential finite game that we're playing here? Or what can I take about these two seemingly free assets that are moving around like brownian motions? And how can I essentially encapsulate all that we need to know? And we found that 54 states sort of does the trick. All right, so let's go into again, my goal is to derive the fair price for both these assets. So I'm going to have to assume, well, I'm assuming Markov dynamics. And the, the state is going to be summarized by this vector, a vector of mid prices, in my case, just two.
00:33:26.884 - 00:34:15.806, Speaker B: And the state of the order book, which is these 54 states that tell you is the imbalance of the first one high, is the imbalance of the second one low. How are the two assets related to each other? So these prices p are all matrices that are two by 54. And I'm going to do the same trick as I did before, which is define the ith expected mid price. And this time Tau I is the ith time of any of the mid prices moving. So we'll see that. And one of the assumptions is that these two prices never move quite simultaneously. There's always one asset moving before the other.
00:34:15.806 - 00:35:03.874, Speaker B: And essentially the definition is very much the same. We take the ith expected mid price at Tau I and take the limit as I goes to infinity. And again, we're going to look for a condition that makes this converge. All right, so here's a little bit of the, the math behind this. So the first thing to do is sort of a classic math finance trick, which is to make this into sort of a sum of increments. So PI is the expected mid price at tau I conditional on the state of the order book. And.
00:35:03.874 - 00:36:22.410, Speaker B: Yeah, so as I mentioned, all these p's, m's and G's are two by 54 matrices. And the G's here are just these increments, the expected difference between the mid price at time Tau I and the mid price at time Tau I minus one. So that's my definition of the micropric approximation. And here's, let's work on the first term g one, which is essentially the first increment conditional on the state of the order book. And because these are Markov chains, and you can think of the price taking up or down as an absorbing state. The way we compute this is we first compute a matrix of transient states. So what does a transient state mean? It means that you start at state xi, and we want to compute the probability that you end up at state xj and that the mid price has not moved.
00:36:22.410 - 00:37:07.298, Speaker B: So those are what I call the transient states. And then there's the absorbing state. So this is a, I believe. Yeah, this is an n by n matrix, 54 by 54. Then there's the absorbing states, which are the four ways in which the mid price can move. So the sh can go up, the sh can go down, sds can go up, sds can go down. And then we have a matrix z here of payoffs, which essentially give you a little reward when the price goes up or down.
00:37:07.298 - 00:38:01.226, Speaker B: And this is a two, nice. Yeah, that's right. A two n by n vector. So this is a four by two vector. So it's a vector that essentially, if you look for, look at the dimensions, you'll see that this is a 54 by two matrix. Okay, so what's the mystery here with this in, with this one minus q inverse? Well, the intuition here is that you see that these times t to t plus one, those are quote times. So those are the time it takes to go from two quotes on those two assets to one of these quotes moving.
00:38:01.226 - 00:38:52.634, Speaker B: And typically think of this as 10 seconds. At least in our data set, the average time it takes for, for, between two quotes was 10 seconds. And this sort of, you know, I'll remind you, this is the, expect the adjustment for the expected next mid price move. And this is essentially telling you the mid price can move in the next quote, or in two quotes, or in three quotes, or in, you know, end quotes. And that this infinite sum of possibilities simplifies to this, this term here. So if you've played with Markov chains before, this will may be familiar. Now, in order to maybe build a little bit of intuition, and I'll show you what these q, r and z matrices look like.
00:38:52.634 - 00:39:40.926, Speaker B: The Q matrix is a 54 by 54 matrix, but it's very sparse and you can see that. It tells you that essentially there's a few off diagonal quantities, but it's a very close to diagonal matrix. These absorbing states, this matrix R is a 54 by four, where the four states are these absorptions. Either sh will go up or sh will go down. Sds will go up or sds will go down. And then when that does happen, it will give you a little payoff. So, as you can see, these, these are, these numbers are $0.01
00:39:40.926 - 00:40:34.244, Speaker B: or minus $0.01 or zeros. So, you know, I'm not sure if this is very, very intuitive, but essentially this shows you that, for example, in these low states where sh is underpriced relative to sds, the absorbing states are either sh goes up or sds goes down. And in these high states over there, these are scenarios where it's the opposite. Sh is overpriced and sds underpriced. And as you can see, there's these absorptions that are encoded here. All right, so what I've shown you here is the 1d, sorry, the g one.
00:40:34.244 - 00:41:57.844, Speaker B: So the first of these terms, now I'm going to go to the more general, the GI term. And in fact, a pretty simple calculation shows you that all you need to do is to compute this g and multiply it by exponents of this matrix b, which is also written in terms of q, the transient state transition matrix, and then this matrix t, which, if you look at it, it's a transition matrix for these absorbing states. So if you start at imbalance or at the state of the order book Xi and end up in XJ after the price has moved. And again, this may not be very intuitive to many of you, but I do find that looking at b ten is interesting. So, as you can see, we're taking successive exponents of b, and we're hoping that this thing converges. It's helpful to think about what multiplying the matrix with itself ten times looks like. And in fact, you can see that all these rows seem to be identical.
00:41:57.844 - 00:42:24.964, Speaker B: And what we have here is the stationary distribution. Oh, it's not very easy to read, but I think that the colors hint that this is the sort of the steady state, let's call it, of the process. And you see that certain states, turns out, were never sort of observed in our data. So they have zeros.
00:42:26.744 - 00:42:29.884, Speaker A: So underlying this is a Markov assumption.
00:42:30.344 - 00:42:35.690, Speaker B: Absolutely, yes. So what is Markov?
00:42:35.832 - 00:42:38.994, Speaker A: So what is exactly the Markov assumption?
00:42:42.014 - 00:42:46.834, Speaker B: So the Markov assumption. Let's see. Do I have it here?
00:42:50.534 - 00:43:01.354, Speaker A: Yes. So let's look at the transition matrix that will show us. So x t is the order, is the, like the cubes or what is.
00:43:01.794 - 00:43:04.694, Speaker B: Oh, xt is the 54 states.
00:43:06.074 - 00:43:13.378, Speaker A: Yes. So can you describe what you mean by the 54 states? What is the 54 states? What's the.
00:43:13.506 - 00:43:27.026, Speaker B: So the 54 states are. There are six states for the co integration, and there are three states for each of the imbalances. So six times three times three.
00:43:27.130 - 00:43:33.866, Speaker A: So what are these states? Can you describe what imbalance is? Zero plus one. Minus one.
00:43:33.890 - 00:43:56.844, Speaker B: Is that. Yeah. So let me zoom, let me kind of zoom forward to the results. What we have is we have states like this. 502 gives you the five, tells you that the co integration signal is high. The zero tells you this, sh has a low imbalance, and the two tells you that SDS has a high imbalance.
00:43:56.964 - 00:44:08.388, Speaker A: So you need. Yeah, this is the code, but I just want to say what it means. So each stock has zero, positive or negative imbalance. That's the three states it has.
00:44:08.436 - 00:44:11.596, Speaker B: Yeah. Zero, one, or, or two.
00:44:11.740 - 00:44:12.116, Speaker A: Okay.
00:44:12.140 - 00:44:12.276, Speaker B: Yeah.
00:44:12.300 - 00:44:17.604, Speaker A: So, and, and then what are the possible states for the state signal?
00:44:17.764 - 00:44:23.784, Speaker B: How many states for the co integration signal has six states. So. 012345.
00:44:24.404 - 00:44:27.028, Speaker A: Okay. And there's a sign incorporated.
00:44:27.116 - 00:44:33.892, Speaker B: I guess it's in that, right? There's no negative. You know, I know that's a quote.
00:44:34.068 - 00:44:40.236, Speaker A: That's a code. But the, the signal can be negative or positive. And you have three degrees on each side.
00:44:40.380 - 00:44:41.060, Speaker B: Exactly.
00:44:41.132 - 00:44:50.776, Speaker A: Okay, fine. I get it. So then the Markov assumption is that, that granularity is enough to give you a Markov process, basically.
00:44:50.840 - 00:44:51.256, Speaker B: Right.
00:44:51.360 - 00:44:54.524, Speaker A: You don't need more. You don't need finer information.
00:44:55.184 - 00:44:55.992, Speaker B: Yes.
00:44:56.168 - 00:44:56.760, Speaker A: Okay.
00:44:56.832 - 00:45:03.484, Speaker B: So there is, so, for example, knowing the trajectory, how I got to a 502 does not matter.
00:45:03.824 - 00:45:15.444, Speaker A: No, I mean, what it, what, what that means is that high imbalance or higher imbalance doesn't matter as long as it's positive. That's the assumption. Okay.
00:45:15.564 - 00:46:32.064, Speaker B: Yeah. Now, so here's the stationary distribution. And I guess this is the main result, which is sort of an existence result, which tells you that the process PI, or this infinite sum converges. If b star, which is the limit of b to the k, which gives you the stationary distribution of this process, times g one, which is the very first payoff, the first micro price adjustment, that product needs to be zero. And so one way to think about this, or rather my intuition for this, is that this is like a martingale condition. And this the way to enforce this, because not every, the definition of b is this. Not every matrix of transient states q will yield this result.
00:46:32.064 - 00:47:28.344, Speaker B: But one way or sufficient condition for this to happen is if we symmetrize the data appropriately. So I'm going to indicate how we do that soon. But I find that one way of understanding this is in terms of if there is a drift in your past data, this will not work. You have to ensure that you remove the drift in some way. And the way we found the most simple to do this is to essentially duplicate the data, flip it around, and tack it on to itself. So that sounds like a bit of a strange procedure, but what we ensure is that for every quote and every observation in our data set, we duplicate the entire data set. And for every time we observe an imbalance of an imbalance.
00:47:28.344 - 00:48:43.890, Speaker B: Oh, and that means for imbalance, for asset one, asset two, a price relationship, which is this co integration signal, and a change in mid price. Then we paste at the end a corresponding symmetric observation, which is the opposite imbalance, the opposite price relationship, and the opposite price move. If you do that, then you ensure that this condition exists or is satisfied, and then you can actually go ahead and compute simply these two matrices. Computations and the micro price adjustment, which is the microprice minus the mid price, can be given by this formula. And in practice, we only really look at this converges after about ten iterations. So, you know, it is supposed to be the price at infinity, but in practice, it's probably the price in 510 minutes. So let me get to the results.
00:48:43.890 - 00:49:34.464, Speaker B: We're ending at the hour, right. Just want to make sure I don't go too much over time. Okay, so what we have here is those are my 52 states, as I mentioned. These are five indicates that sh is somewhat overpriced and that SDS is sort of underpriced. An imbalance of zero for sh indicates that sh is likely to go down. And an imbalance of two for sds implies that SDS is likely to go up. So the state 502 is this most extreme state, where everything is telling me sh should go down, and almost everything is telling me sds should go up.
00:49:34.464 - 00:50:19.794, Speaker B: And again, these numbers are all very close to zero, zero five. And I would hardly call this a, you know, an arbitrage, but this is potentially a little statistical arbitrage. Of course, the caveat is that these states are very rare. 502 and zero 20 may occur once or twice in a day. But those. And what you can see is, because we've symmetrized the data in this particular way, each state has its cousin state that is sort of its symmetric cousin. And these other states are a little bit less extreme.
00:50:19.794 - 00:51:39.614, Speaker B: But you see that essentially these numbers live between zero zero five and negative zero zero five. All right, so now I've shown you what the computation entails, or how we do this. The next step is, so what? What can I do? How can I prove that there's any value here if this is not a pure arbitrage? So I'm going to construct these four execution strategies, these four experiments, which are going to be, you know, an entire day execution. And what I'm going to do is, so think of something similar to Twap or VWaP. You need to, for a client, buy one of these two securities every five minutes. So if the benchmark is a random choice between the two securities, so think of it as every five minutes, you flip a coin, and if it falls on sh, you buy $1,000 worth of sh. And if it's SDS, you buy $500 of SDS because it's twice leveraged.
00:51:39.614 - 00:52:16.786, Speaker B: And that is our benchmark strategy. The second one is, every five minutes, you make a choice of which of the two you should buy, and the choice is based on the weighted mid. So if the imbalance of asset Sh is 0.9 and the imbalance of SDS is 0.7, you will buy sh. And so it's a slightly smarter algorithm. The third one is very similar to two, but now we're computing the micropric.
00:52:16.786 - 00:53:54.024, Speaker B: So we're able to also take into account whether the relative price of sh and SDS indicates that I should buy one rather than the other. And the last one is an algorithm that actually resembles more, what real execution algorithms, you know, how they typically behave. And I don't know if you've ever looked at a sort of a marketing sort of, for execution algorithms, but they tend to have names like sniper or guerrilla or, you know, thunder or ninja, and they tend to be because they claim to be all very opportunistic. And the way, the reason I'm calling it american is because this very much resembles the idea of an american option or an early execution, which means that instead of trading once every five minutes within the five minute time period, you can observe the state of the order book. And if the difference between the two micro price adjustments, sh and SDS, exceeds a certain threshold, then you buy the cheaper of the two. So a typical example is if you observe 502 and you need to buy this, SDS is clearly the one to buy. And the difference between these two numbers is very high.
00:53:54.024 - 00:55:07.592, Speaker B: Those are my experiments. And since I'm sort of running out of time, I'm going to just indicate that I've run this, these four algorithms in sample and out of sample on these training on November 23 and December 2. And I'm doing this for buy algorithm and a sell algorithm, and then taking the average of the two in order to get rid of the drift. That sort of does add a lot of noise here. And as you can see, is progressively these algorithms have sort of a better or less and less transaction cost. All these numbers are negative, but these numbers are less negative than the random algo. And if you look at this, of course, this is trained on November 23, tested on December 2, and if you do this again on subsequent dates, so, trained on December 2 and test it on December 3, you find that even out of sample, this does pretty much as well as in sample.
00:55:07.592 - 00:56:10.598, Speaker B: So this may not have worked as well because there's quite about a week difference between these two data sets. And if you put it all together, just to summarize, the random algo, which we've normalized to 100, basically you pay a certain bid, ask spread cost, and the weighted mid algo sort of saves you, so saves you about 25%. The micropress algo, again, the one that trades every five minutes, saves you even more. And if you have that american optionality, then you can really start to see some savings. All right, so let me conclude. First of all, I've generalized the microprice to multiple order books, and it allows you to, and in fact, you may want to do this even beyond two dimensions. But it was sort of easy for me to illustrate.
00:56:10.598 - 00:57:11.794, Speaker B: And this technique, what it does is it computes the fair price for several assets, while combining microstructure signals with longer co integration signals. And this experiment that we ran sort of showed us that we could save about half the spread in an order execution, the next steps. So, as you've noticed, there was no arbitrage here. And I suspect that it's because these two ETF's assets are highly co integrated and highly liquid, so there won't be a lot of trading opportunities. But I'm interested in exploring less co integrated assets. So highly co integrated, but not quite as highly as the ones here and there. I could imagine that these micro price adjustments sometimes indicate that it is worth crossing the spread.
00:57:11.794 - 00:58:58.034, Speaker B: And of course, this type of sort of methodology could have applications to market making. As you might know, often market making involves posting bids and asks around a notion of fair price, which in a lot of research typically is taken to be the mid price, but I think that there's potential to change that to the micro price. And the last topic is one that has interested me a lot in the last year. And in fact, I've seen that a few speakers at your seminar have recently touched upon that is the realm of reinforcement learning, which actually seems to be quite well adapted for the kind of Markov processes that I've presented today. In fact, reinforcement learning is known to be a great method for winning at games like go. And in fact, I wonder if in a way this method of, you know, encapsulating the price of these two co integrated assets in terms of these 54 states may be similar to sort of writing down the rules of the game of of these two assets. And it would be interesting to unleash some of these, these algorithms to see whether, you know, whether we could do, we could design trading algorithms on these types of simulations.
