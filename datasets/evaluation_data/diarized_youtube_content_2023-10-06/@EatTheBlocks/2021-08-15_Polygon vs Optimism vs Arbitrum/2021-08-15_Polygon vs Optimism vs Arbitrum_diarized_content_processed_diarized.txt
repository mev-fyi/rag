00:00:00.250 - 00:00:39.346, Speaker A: In the second quarter of 2021, Polygon had more daily active users than Ethereum. And beside Polygon, there are many other scaling solutions for Ethereum, and as a developer you have to know about them. But there are so many projects and it's easy to get lost. In this video I will introduce the top three scaling solutions for Ethereum that you absolutely have to know. If you don't know me, I'm Julian and on either blocks I teach blockchain development. It every time the Ethereum blockchain becomes really popular, the network becomes sluggish and the transaction fees becomes very high. This happened when cryptokitties was launched in 2018.
00:00:39.346 - 00:01:12.670, Speaker A: This happened during the DFI summer of 2020, and this happened again in the DFI bull run of 2021. That's why the Ethereum community is working on making Ethereum more scalable. One way to make Ethereum more scalable is with onchain scaling. With onchain scaling, we work directly on the Ethereum protocol itself. The problem with onchain scaling is that we have to make trade offs out of decentralization, security and scalability. We can only have two of them. For example, if we increase the block size, more transactions can fit inside, which makes the blockchain more scalable.
00:01:12.670 - 00:01:53.242, Speaker A: But we also make it harder for miners to mine new blocks, which requires better hardware than few miners can afford, which reduces decentralization. Ethereum 20 is going to make Ethereum scalable without significant tradeoffs. But this is a hard problem to solve, and we still need to wait a few years before it's ready. That's why we need other scaling approaches that will be available faster. And for that we have offchain scaling solutions. With offchain scaling, we make Ethereum scalable by building on top of Ethereum, but without changing the Ethereum protocol itself. There are many approaches for offchain scaling.
00:01:53.242 - 00:02:19.794, Speaker A: Some of them rely on Ethereum for their security. We call them L2. Some other rely mostly on their own consensus algorithm for security. We call them sidechains, and some are hybrids. The first off chain scaling solution that I will introduce is channels. There are two kind of channels, state and payment channels. Payment channels are for scaling payments, and state channels are for scaling any arbitrary smart contract execution.
00:02:19.794 - 00:03:14.342, Speaker A: I'm going to explain how a payment channel works because it's most simple, but for its state channel, it's very similar. In a payment channel, Bob and Alice wants to make a series of payments between themselves. Bob and Alice will first lock an initial balance of ether in a multi six smart contract on Ethereum after Bob and Alice will send some payments to each other by signing messages with their private key. For example, if Bob renders a service to Alice that cost one ether to Alice, Bob will sign a message with the updated balance of each participant of the channel, which means there will be one more ether for him and one less ether for Alice. If Alice agrees, she signs the message. They keep the channel open as long as they want, signing new messages every time there is a new transaction. At any time, they can decide to close the channel by submitting the final state to the multisig smart contract on Ethereum.
00:03:14.342 - 00:03:59.490, Speaker A: This smart contract verifies that the final state was signed by both parties. Then it will wait during a duration that we call the challenge period to see if any parties challenge the final state by submitting a more recent state, also signed by both parties after the challenge period is over. If no parties has challenged the final state, both participants are able to withdraw their money according to the balances of the final state. In terms of pros, it's Allah instant withdrawals. It also allow an externally high throughput. It also allow an extremely high throughput because all the transaction in the channels only need to be processed by the participant of the channel and not by all the nodes of the network. And it also has a very low cost per transaction, which is good for streaming micro payments.
00:03:59.490 - 00:04:48.898, Speaker A: In terms of cons, it can be quite costly to settle a channel because we have to deploy new smart contract for each channel and especially for state channel. The multisig smart contract needs to know the application logic, so this is application specific. In order to ensure the security of your funds, you also need to periodically watch the network and challenge the final state of the multisig smart contract. If you ever spot a fraud, that's what we call the liveliness requirements. You also have to lock up funds to open the channels, and it doesn't support open participation, which means we need to know all the participants at the beginning of the channel. Channels were a good first attempt to scale blockchain, but they are also quite limited and in the meantime we had more modern approaches. A sidechain is a separate blockchain which runs in parallel to Ethereum Mainnet and operates independently.
00:04:48.898 - 00:05:34.786, Speaker A: It has its own consensus algorithm, like proof of authority, delegated proof of stake, et cetera. It's connected to mainnet by a two way bridge which allow you to transfer assets back and forth. What makes a sidechain really exciting is that the chain works the same way as the main ethereum chain because it's based on the EVM. This means that if you want to use your dap on a sidechain, it's just a matter of deploying your code to this side chain and it looks, feels and act just like main net. You write your smart contract in so eT and you interact with the chain using the web3 API. So in terms of pros, side chains are an established technology and it support a general computation of spot contract with EVM compatibility. In terms of cons, this is less decentralized than Ethereum.
00:05:34.786 - 00:06:23.218, Speaker A: It also uses a separate consensus mechanism which is not secure by layer one, and there is a possibility that there will be a quorum of sidechain validators that commit fraud, and it's much easier to reach this quorum on a sidechain than on ethereum l one. So sidechain are a good practical solution to the problem of scalability, but because of the lack of decentralization, it cannot be the ultimate solution for scaling ethereum. Next we have plasma chains. A plasma chain is a separate chain with its own consensus algorithm. This part is similar to sidechains. However, contrary to sidechains, plasma chain posts the root hash of each of their block to ethereum l one. This can be used to submit fraud proof to ethereum l one when someone spots a wrong transaction on the plasma chain.
00:06:23.218 - 00:07:09.490, Speaker A: So you can say that the plasma chain is a child chain of ethereum. That is an call to ethereum l one. In terms of pros, a plasma chain offers a high throughput and a low cost per transaction. It's also good for transactions between arbitrary users. If the user are already established in the plasma chain, they can interact with each other. In terms of cons, it doesn't support general computation, only basic token transfers, swaps, and a few other transaction types that are supported by a logic already pre established. We also have the liveliness requirement, which means each user or a delegate needs to continually watch the network and potentially submit fraud proof if we spot any wrong transaction, that's how we guarantee the security of the plasma chain.
00:07:09.490 - 00:07:47.662, Speaker A: It also relies on one or more operators to store data and serve it upon request. But some operators can decide to withhold data. And finally, when you want to withdraw from the plasma chain to Ethereum l one, you have to wait for the challenge period, which can last up to one week. Plasma was originally thought to be the solution to offchain scaling, but it became soon apparent that it posed some practical problems that couldn't be solved. There is the problem of the challenge period that I just mentioned. Another problem is the liveliness requirement, which means each user has to monitor and verify that his transactions are correct. Most users cannot do that, and it's not easy to delegate this task.
00:07:47.662 - 00:08:33.450, Speaker A: And there is also the problem of the mass exit. If an operator of the plasma chain decides to not publish transaction data, each user needs to individually exit the chain based on the last valid state. And it would create a huge bottleneck of incoming data to Ethereum, which would clog the network and prevent users from exiting. So because of this, Ethereum researcher kept working on other solutions and created something new called rollups. Plasma and channels are full L2 scaling solutions because they move transaction and computation data off chain. Rollups are hybrid L2 scaling solutions because they move computation and state storage off chain, but keep some data per transaction on chain. There are two flavors of rollups, optimistic rollups and zero knowledge rollups.
00:08:33.450 - 00:09:05.222, Speaker A: Let's start with optimistic rollups. In a roll up chain we have a rollup smart contract and sequencers. The first step is when a user deposits some ether or tokens in the rollup chain. For this, the user sends some crypto to the rollup smart contract on Ethereum l one after the user can do some transaction on roll up chain. When a user creates a transaction on roll up chain, his wallet sends a transaction to what is called a sequencer. That's the equivalent of a miner. Anybody can be a sequencer.
00:09:05.222 - 00:09:49.586, Speaker A: The sequencer will execute the transaction as well as other people transaction in what we call a batch. After that, he will update the state of the rollup chain. This means updating ether balances, es 20 balances, storing code of your smart contract deployed, et cetera. But all of this happened outside of Ethereum l one after the sequencer will send a single transaction to the roll up smart contract on Ethereum l one. This transaction will contain all the roll up transactions of the batch, the prestate route, and the poststate route. The roll up transactions are not stored in the blockchain storage of Ethereum L1. They are just part of what we call call data, or in other words, the arguments of a function call in a transaction.
00:09:49.586 - 00:10:19.278, Speaker A: Call data is cheaper than EVM storage, but it cannot be read or modified by the EVM. It can only be read by outside clients. This is required for ensuring the security of the rollup. Technically, the state route is a mercurialized hash of the state of the rollup. Or in more simple terms, this is a digital fingerprint representing the state of the rollup chain. The prestate route represents the state of the rollup chain before all transactions are applied. The poststate route is the hash of the updated state of the rollup.
00:10:19.278 - 00:10:56.906, Speaker A: After the transactions of the latest batch are applied, the updated state route is stored in the EVM storage. That's different from the transaction data. At this point. Roll up smart contract doesn't make any verification, it just assumes that the new state route is valid. And from the sequencer point of view, it represents a commitment that if we apply all these transactions, it will result in the state that was posted after anybody can observe the roll of data that was posted by the sequencer. If anybody finds an error, he or she can challenge the sequencer in a certain time period. For this, you need to submit a fraud proof to the rollup smart contract.
00:10:56.906 - 00:11:45.722, Speaker A: Using the transaction data that is published by each sequencer, it's possible for anybody to replay all transactions and prove that there was an error. The Rob smart contract is able to check the validity of a fraud proof, and if it find that the fraud proof is valid, it will revert the rollup chain to the latest correct state, penalize the batch sequencer by slashing its bone. And that's because each sequencer has to post a bond before being able to post transaction batch. This way, sequencers have an incentive to be honest. So in terms of pros, anything you can do on Ethereum layer one you can also do on optimistic rollup because it's EVM and solidity compatible. And it's also secure and decentralized because all transaction data is stored on the layer one chain. And this way we also avoid the data availability problem of plasma.
00:11:45.722 - 00:12:27.990, Speaker A: In terms of cons, unfortunately, when you want to withdraw your crypto from the rollup chain to Ethereum l one, there are long wait times to allow for potential fraud challenges. And finally, sequencers can influence transaction ordering. Next we are going to talk about the other flavor of rollup zero knowledge rollups. The big difference compared to optimistic rollups is that with zero knowledge rollup, when a sequencer posts transaction data to Ethereum l one, we are sure that the updated state is valid. We have finality on the transaction right away. There is no need for a challenge period after. And that's because the sequencer posts a validity proof that can be verified by the rollup smart contract on Ethereum.
00:12:27.990 - 00:13:39.150, Speaker A: This validity proof is created by the sequencer using a mathematical technique called zero knowledge proofs. With a zero knowledge proof, a prover can prove that he knows some information without revealing the information itself. In terms of pros, the bigger advantage is that it offers a faster finality since the state can be instantly verified once the proof are sent to the main chain, and it's also secure and decentralized since the data that is needed to recover the state is stored on the layer one chain. In terms of cons, some implementation don't support EVM yet. Valet proofs are intense to create, and it's not worth it for applications with little onchain activity. And finally, sequencers can influence transaction ordering. So out of all these scaling solutions, which one is the best? For this? I will quote Vitalik buttering, the creator of Ethereum in general, my own view is that in the short term, optimistic rollups are likely to win out for general purpose EVM computation and zero knowledge roll ups are likely to win out for simple payments, exchange and other application specific use cases, but in the medium to long term zero knowledge rollup will win out in all cases as zero knowledge snack technology improves.
00:13:39.150 - 00:14:19.198, Speaker A: What's also interesting to note is that Vitalik buntering is in favor of making some small changes to Ethereum l one to help for the implementation of rollups. So that's it for the high level overview of the different scaling solution. Next we're going to dive in specific implementations. Polygon, formerly known as Matic, is the most popular scaling solution for Ethereum. The native token of Polygon has a market cap of $8.6 billion and is ranked number 18 on coin market cap if we only consider Ethereum scaling solutions, that's the first market cap. According to the report of DAp data.
00:14:19.198 - 00:15:01.990, Speaker A: Polygon has caught up with Ethereum in terms of daily active user and even surpassed it for a short moment. That's really impressive considering that Polygon is a very recent project. On cryptofees info, we can see a list of blockchain and DeFi projects ranked according to the transaction fees that generated. And you can see that Quickswap, a project of polygon, is pretty high up in the list, not too far from bitcoin and compound, and for transaction fees collected by the Polygon network itself, it's about $30 million per day. On awesomepolygon.com you will find a list of project deployed on Polygon and there are more than 500 projects listed. Most of them are either DFI or NFT projects.
00:15:01.990 - 00:15:55.226, Speaker A: For example, Quickswap is a decentralized exchange, Ave is a decentralized lending platform, and Ave Gochi is an NFT game. Some of these projects are native to Polygon. Like Quickswap, some were originally deployed to Ethereum and later deployed a second time to Polygon like Ave, and some were originally deployed to Ethereum and migrated later to Polygon like Ave. Gotchi on DAP radar you can see another list of projects deploy on polygon with some transaction and usage metrics. The biggest DAP of polygon is Quickswap and in the last 30 days it had more than 200,000 users and a $4 billion of transaction volume. Polygon received several runs of funding, but the latest runs have undisclosed amounts. There were probably big amounts because Polygon launched a fund of 100 million dollar to support DFI project that are launching on Polygon.
00:15:55.226 - 00:16:28.578, Speaker A: This means that as a builder you can get funding for DFI project if you decide to deploy it on Polygon. Next, let's dive into the technical details. Polygon has a block time of 2.4 2nd much faster than the 15 second of Ethereum. On the testnet, it has reached 7200 transaction per second, which is much higher than the 1015 transaction per second of Ethereum. And transaction fees are also much lower, up to 100 times less. Polygon is a side chain, meaning that it has its own consensus algorithm independent from Ethereum.
00:16:28.578 - 00:17:03.838, Speaker A: It also has some elements of the plasma framework. It is connected to Ethereum in two ways. First, the state of polygon is regularly checkpointed on ethereum l one meaning that we store hashes of the state of polygon in Ethereum every five minutes. This can be used to verify the validity of transactions on polygon. Second, anybody can challenge the validity of a transaction on polygon by submitting a fraud proof to a smart contract on Ethereum. The entity that validate block on polygon are called validator. These validators stake some polygon tokens on Ethereum.
00:17:03.838 - 00:17:42.490, Speaker A: If someone can prove that a transaction is wrong, the stake of the validator will be slashed, so validators have an incentive to not be dishonest. For users, using adapt on polygon is very similar to using a Dap on Ethereum. Users just have to configure a new network in metamask and they are ready for polygon. Dapps, where it gets a bit tricky, is for transfer of assets between Ethereum and polygon from Ethereum to polygon. It's fast, but from polygon to ethereum you have to wait seven days. For developers, developing on polygon is almost the same as on Ethereum. Polygon is an EVM blockchain, which means you can use all the development tools of ethereum.
00:17:42.490 - 00:18:17.446, Speaker A: You write your smart contract with solidity. You can use frameworks like truffle, hothat or Open zeppelin and you can use ERC 20 or ERC 721 tokens. Polygon had some public RPC endpoints, but I found them a bit unreliable sometime. And you can also use endpoints for polygon on the free plan of Inferra. What I just described is only the PoS chain of polygon. They are also working on an implementation of optimistic rollup and zero knowledge rollup, but we will have to wait until it's ready to be used. And they are also working on supporting base chains other than Ethereum.
00:18:17.446 - 00:19:09.418, Speaker A: So that's it for polygon. Next we are going to continue with another important project for scaling Ethereum. Optimism is one of the most promising project for L2 scaling on Ethereum. Contrary to Polygon, optimism doesn't have a native token, so you won't find this project on coin market cap on cryptofees info we can see that optimism is ranked 13 over 37 for the top project that collect the most fees in blockchain. It's a top L2 project even before Polygon, and what's really impressive is that they already have all this activity even though they are not fully live. They currently have a permission mainnet deployment which mean only whitelisted projects can sign up. They do this to be as cautious as possible and make sure that when they finally open the main net to everybody, everything works fine.
00:19:09.418 - 00:19:59.078, Speaker A: Normally the public mainnet should be open for this summer, but it was already delayed a couple of times, so it seems like we have to wait a bit for the projects that are already live on the permission mainnet. There are already a few big names in Defi like Uniswap and synthetics. In terms of technology, optimism uses optimistic rollup one of the main challenge of optimistic rollup is to have compatibility with the EVM, or in other words, to be able to run any arbitrary smart contracts. Optimism is the first project that created an EVM compatible implementation for optimistic rollups. That means you can use all the development tools of Ethereum, and it works great. Even though the public testnet is not ready yet, you can already deploy to their testnet. I already deployed smart contract to their testnet and with my knowledge of Ethereum it was really smooth.
00:19:59.078 - 00:20:47.430, Speaker A: The only caveat is that they use a slightly different version of solidity. That's because of some obscure technical detail about optimistic rollups, and there are also a few restrictions about smart contracts on Ethereum. So when you develop on optimism, remember about this custom version of solidity and you can find more details on the truffle box for optimism to deploy to optimism you need an optimism node, but fortunately they have a public endpoint and infra provides one as well. Okay, so that's it for optimism. Next, we're going to continue with another interesting project for L2 on ethereum. Arbitrum is another very promising project for L2, scaling on Ethereum like optimism. It doesn't have a native token like optimism.
00:20:47.430 - 00:21:29.554, Speaker A: Again, they currently have a permission managed deployment which means project need to sign up. They call their manned deployment arbitram one. They have more than 250 project which sign up, including some big names like Uniswap, Sushiswap and chain link. Another big partner is Reddit. Reddit announced they will use arbitrum for their community points. This is really great because Reddit has a ton of users and community points will probably be a very popular feature and soon Arbitrum will open up to any project without requiring to sign up. In terms of technology, arbitram, like optimism, uses optimistic rollup and it also supports the EVM, which means you can use all the development tools of Ethereum.
00:21:29.554 - 00:22:09.122, Speaker A: Like for optimism, Arbitrum has public endpoints and infra provides an endpoint as well, which makes deployment easy. A big difference with optimism is that on arbitrum you don't need to use a different version of solidity to write your smart contract. Small details to note even though you don't need to use a different solidity compiler, there are some small differences in constants and built in function. You can find the details in their documentation. Another big difference between optimism and arbitram is how they handle fraud proofs. Arbitrum fraud proofs try to find the particular point of disagreement in transaction history. The technical terms is multi run fraud proof.
00:22:09.122 - 00:23:06.230, Speaker A: Optimism looks at frauds in a more global way using a technical single run fraudproofs. Without getting into the details, it means arbitram has a higher transaction capacity. Another difference is that optimism uses wrap ether while arbitram has native ethereum support. And a last difference with optimism is that the arbitram node allows not only to run optimistic rollup, but also sidechains and channels. Gives you more flexibility to experiment with other scaling techniques. Now you know the top three scaling solutions for Ethereum. If you build a DAP, should you even bother to deploy your DAP there? Or can you just deploy to Ethereum L1? If your DAP has high value transactions where security is extremely important and your users don't mind to pay high transaction fees, you can just deploy your DAP on Ethereum l one.
00:23:06.230 - 00:23:53.158, Speaker A: That's the case of some wells on some decentralized exchanges. For example, for most, DAP users will be willing to trade some security against cheaper transaction fees, and they don't even have to give up a lot of security. These scaling solutions are in general quite secure, even though they are not as secure as Ethereum. L1 if you decide to use a scaling solution for your DAB, which one should you choose? At the time of releasing this video, the answer is polygon. Polygon is the only scaling solution that is ready for production. They have the biggest DAP activity, the tooling is quite mature, and if you launch a DeFi DAP, you can receive some funding by applying to their 100 million dollar fund. In terms of scaling technology, the most promising solution is zero knowledge rollups because it doesn't have any withdrawal time.
00:23:53.158 - 00:24:10.300, Speaker A: There aren't many projects in production today for zero knowledge rollup, but you can follow a project called zksync because it's making big progress. If you want to start experimenting with polygon and other scaling solutions, you can check out this tutorial where we deploy a smart contract to polygon and optimism. I'll you there.
