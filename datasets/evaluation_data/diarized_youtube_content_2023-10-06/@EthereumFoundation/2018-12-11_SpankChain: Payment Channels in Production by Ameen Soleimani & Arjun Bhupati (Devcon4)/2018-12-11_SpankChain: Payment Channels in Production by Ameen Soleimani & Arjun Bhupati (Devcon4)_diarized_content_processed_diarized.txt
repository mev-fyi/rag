00:00:00.810 - 00:00:28.550, Speaker A: This talk is payment channels in production, and it's myself and Arjun. And we're going to talk about what we've been doing for the last year or so. Little overview of what spank chain is. Show of hands. Who knows what spank chain is? Good branding. All right, we don't have a booth, but we all have pink hair, so just come find us. This is a quick overview.
00:00:28.550 - 00:01:11.460, Speaker A: So today is the 10th anniversary of the bitcoin white paper. Let's see how we're doing. So this is something that Satoshi said in a mailing list. He said, I would be surprised in ten years from now if we're not using electronic currency in some way now that we know a way to do it that won't inevitably get dumbed down when the trusted third party gets cold feet. And Satoshi knew what was up because he knew that micro payments for adult was where the party was going to be. Show of hands, who know how payment channels work. All right, if you don't find the slide later for Devcon four, this is a tale of four payment channel systems that we've made.
00:01:11.460 - 00:01:41.606, Speaker A: Part one, the demo. So this was August 31, 2017. It was pre ICO, started working with Sergey in Russia of Yukostov, of machineomy. And the magic word is Hodl. So this is what it looked like. It was called vinos. This is me doing a video walkthrough where I asked Janice Griffith to spank herself, and she refused until I said the magic word, which was Hodl.
00:01:41.606 - 00:02:08.260, Speaker A: It was not please. It was not pretty please. It was Hodl. So we did this demonstration just to show that our payment channel system worked in advance of actually doing the ICO because we wanted to improve the technology. It took three tries. There was a bunch of bugs. So each of these times we had Janice Griffith there at our Hollywood mansion ready to do this demonstration and then could not get it working.
00:02:08.260 - 00:02:55.886, Speaker A: The second time was actually because Zerox was doing their ICO at the same time and we could not get any of the transactions through. It's very sad. The second system we launched after the ICO, we launched on April 2, which was one day later than our target date of April 1. And it was the simplest possible payment channel implementation looked like this, actually, this is what is still live on our site because we had to revert it, which I'll get to in a minute. But you had a wallet, and you send money to the wallet, and that's like a legitimate Ethereum wallet. And then after that, you clicked load up your spank card and you send the money to the payment channel, as represented by the spank card. And so this was a unidirectional, ether only, custodial payment channel setup.
00:02:55.886 - 00:03:19.930, Speaker A: So the users had payment channels with the hub that we were operating, but the performers did not. They had to click withdraw through a separate interface. And in the time between, they got the money and they hit withdraw. We held the money, and so we had custody. Again, I was working with machineomi libraries and contracts, and we brought on Kyoken. The metaphor for the spend card was a hit. Something that we've learned about payment channels is nobody gives a shit.
00:03:19.930 - 00:03:41.246, Speaker A: It works like a card. So we represented it like a card. Everybody knows how a card works. You put money in, you spend it, and when you're done, you take whatever's left. So now I never need to tell any of the users what payment channels are. Fun things we encountered along the way. So querying infuria was nondeterministic.
00:03:41.246 - 00:04:10.982, Speaker A: We would get a transaction in, and we would see that it had worked, and then we'd query infuria. And infuria is know eventually consistent. So half of infuria is like, yes, this worked. And then the other half is like, I don't know. And so we had that problem. Truffle timeout is 240 seconds. So in production, when you have transactions and you have a variable amounts of gas, sometimes your transactions just time out.
00:04:10.982 - 00:04:30.690, Speaker A: And that sucks. You have to go trace them down. So fast forward to June 6 or June 9. Sorry. We hardened our wallet, and then we shipped our open beta. So this was the same wallet roughly. Actually, this is the wrong picture.
00:04:30.690 - 00:05:18.980, Speaker A: Yeah. So this is when we upgrade later. But anyway, we got hacked. Actually, we never talked about this one. Didn't really seem like a big deal, but we actually got hacked before the most recent hack for a lot less money, because in the process of migrating to a different infrastructure, we let our guest node firewall slip for two minutes, and in the two minutes, within 30 seconds, the $1,500 in ETH that we had on our hot wallet was drained because the geth node was unlocked and somebody just sent a JSON RPC request to send themselves all the money. So then we did an upgrade. We launched that September 1.
00:05:18.980 - 00:05:58.400, Speaker A: Move fast and break things, they said. So the upgrade was a noncustodial wallet. It had Perune style peer to peer virtual channels, which we call threads now, too. The contract had support for ETH and ERC 20. So on September 1, we launched the wallet, which looked like that. So we integrated the wallet and card into just one balance and basically just showed a pending transaction until all of the wallet funds were there. And so we actually took the liberty of when you send the wallet the money, we automatically deposit it into your payment channels because we figured there's no other reason why you're sending this thing money.
00:05:58.400 - 00:06:47.386, Speaker A: And we joined forces with connects to work on the hub. So now I was going to ship payment channels, but then I got hacked. So the hack, we lost $40,000, we got it all back and we made a friend. So this was the post that we published in the aftermath of the hack. So the hack exploited a reentrancy bug and an integer overflow, which allowed the hacker to call back into the withdraw function and basically give themselves all of the money. It wasn't quite the withdrawal function. It was a function that allowed them to exit a channel that had not been joined by the counterparty, but they opened the channel and then exited the channel that had not been joined.
00:06:47.386 - 00:07:36.686, Speaker A: But that function, they called back into it because it only deleted the on chain data about the balances after the transaction had been sent. And in the course of sending the token transfer, the actual token contract was not what we thought it was. It called back into the function and gave the attacker all our money. There was another bug. So when I called the attacker up, I said, I'm Amin Soleimani, CEO of Spankchain, do you know why I'm calling? Said yes, a little bit nervous. So from there I said, congratulations on being the real winner of the ETH SF hackathon. Very impressed with your work.
00:07:36.686 - 00:07:58.366, Speaker A: Can I have all my money back? If you give it back, I'll give you a $5,000 award for your contribution to exposing our vulnerabilities, which we really appreciate. And they said, that seems reasonable. Texted me the private key. And then they said, well, actually there's another bug in your contract and that will allow me to get back the 4000 booty, which is our stablecoin pegged to a dollar.
00:07:58.398 - 00:07:58.706, Speaker B: Get it?
00:07:58.728 - 00:08:26.506, Speaker A: Booty peg, right? So they said, yeah, we'll get you 4000 booty back. And I said, well, if this person can get the booty, then somebody else can get the booty. And my plan involved getting everybody back online. And I was like, okay, fuck it, let's let this person do it. And I said, look, if you can get this back within 24 hours, I will pay you the dollar price, $4,000 for it. And within an hour, actually 65 minutes later, I had my 4000 booty. So I sent them 4000 ETH.
00:08:26.506 - 00:09:03.660, Speaker A: I called them back up, said, hey, pleasure doing business with you. And they were kind enough to do pro bono audits of two of our other contracts, too. They didn't find any vulnerabilities in the spank bank and gave me some notes on the molok dow. So that was cool. So in the aftermath, connect, we worked together. They prepared a transparency report, and we did in depth, full team, line by line audits of the contracts and hub systems every day for several hours, and identified ten total attack vectors and published all of it as part of the transparency report. This is what it means to be in production, guys.
00:09:03.660 - 00:09:37.220, Speaker A: Get ready. So then we did a reboot. We decided to rewrite the contracts from scratch, and we made significant improvements to our UX while we were doing it. And this was a combined team effort of connect, Qken, and Spankchain, all working together for the last two weeks nonstop. We were trying to get it done by Defcon. We figured if we code nonstop between now and Defcon, there's some chance that we'll ship this by Defcon. And then we got pretty far, but we will probably have to ship it next week.
00:09:37.220 - 00:10:15.786, Speaker A: So we did the reboot. A couple things that I want to go over on the reboot because they're really cool. So before we had a payment channel system, right, and payment channel systems. You open a channel, you join a channel. Everybody knows this sort of standard flow, but we reimagined it because we'd been dealing with this for a while and there was a bunch of really annoying user flows. So, for example, when the user wanted to deposit money into the channel, they would have to call the create channel function, and then the hub would wait until it saw that happen. And keeping in mind that we wait several block confirmations, like five block confirmations.
00:10:15.786 - 00:10:46.826, Speaker A: So it's not just like 15 seconds, it's like a minute and a half, right? And then after that, the hub would join the channel, and then they would deposit the money and do an exchange. So it took several minutes of waiting for the user. Right. Another annoying flow was especially more annoying for the performer. When the performer wanted to join a channel, they would also have to call create channel. And the performers don't have any ETH, and they're not supposed to have any ETH. They're the ones getting paid, so they shouldn't have to.
00:10:46.826 - 00:11:34.930, Speaker A: And so we actually ended up writing a little bot that when the performer was about to start a show, we would send them a small amount of ether so that they would then be able to open the channel, and that was crazy. And then we would join it, and then the performer withdrawal was even worse. So when the performers wanted to withdraw, especially in the upgraded version, they earn booty, because we used Finney denominated ETH in production for a while. And then I don't know if you guys have been paying attention. I know we're not supposed to talk about prices and stuff, but everything crashed miserably for the entire year. And so anybody who had any money on spank chain lost a bunch of it, and that sucked. And so we realized stablecoins are actually really helpful.
00:11:34.930 - 00:12:22.822, Speaker A: So performers, we started earning in booty, and then when they cash out, they want to cash out neath, so they can send it to whatever exchange and get it in their bank. But the process of going from booty in your channel to ETH in a wallet was really annoying because you had to either close, there's a couple of ways of doing it. You could close the channel, and then you'd have the booty, and then you would send that to the hub, and the hub would give you back ETH. Or you would wait for the hub to deposit ETH into the channel, and then you would swap in the channel, and then you would close it. But then the next time, you would still have to go through that process of creating the channel and joining the channel again. And it was a mess. And so what we ended up being able to do is get every combination of deposits, withdrawals, and exchange in a single on chain transaction.
00:12:22.822 - 00:13:26.014, Speaker A: So performers, when they want to start a show now, they just sign a thing, and the hub will deposit into their channel directly. One transaction. They don't need any ETH for every operation that is not the user depositing into their own channel to fund it. The hub will be able to do it so long as they have a user signature, and that keeps things in sync, and it's going to be a much better model, and I'm really excited to launch it. So also wanted to announce our decentralized exchange, which will be called comeswap. I'm going to give a demo of this, actually, in a second, and I want to talk about the future, other things that we're building affiliate system with instant payouts and other great use for payment channels. We're very excited to integrate with the Nosisafe multisig wallet, and we're looking for partnerships for fiat off ramps so that performers can earn booty in a channel and then spend it with a card, because then they don't need a bank? Then we is.
00:13:26.014 - 00:14:00.466, Speaker A: I don't know if you guys all saw this, but we're also very interested in entering the crypto teledonics space and using the work that team daddy made in the status hackathon. That is a dildo that he is holding on stage, which is controlled by the ethereum main net. Yeah, it's pretty cool. So let me show you guys something neat. This is going to be our exchange interface. Simplest ever. Exchange interface.
00:14:00.466 - 00:14:32.450, Speaker A: Best ux on earth. You push the button, you get what you want. Here's how it works. As you increase, you can't see them shooting out of the card because the resolution is whack. But normally what you'd see is the little globules would shoot out of the card and then they make this big glob. And then when you hit confirm, it pulsates for a second and then it disappears. I was trying to get it to coagulate and then drip, but we're limited by the technology.
00:14:32.450 - 00:14:41.220, Speaker A: All right, so that's all I got. And now I'd like to invite Arjun up and here's his presentation.
00:14:41.640 - 00:15:00.040, Speaker B: Cool, thank you. Hello. Hello. I'm Arjun. I am the founder of Connect. We worked with Spankchain. We're going to continue to work with Spankchain for obvious reasons.
00:15:00.040 - 00:16:00.460, Speaker B: I'm going to zoom out and give a little bit of context about everything that we're doing and then that way you can see where we are now and where we want to be in the future. One thing that we sort of asked ourselves when we started working in this industry was if in a year or two years, every single thing that we do in scaling becomes obsolete, which it will, what is the point of doing scaling research in the first place, or at least building scaling systems right now? And the truth is that there are a set of problems that can be solved immediately that are associated with the things that you cannot do in the world right now. Spankchain is a great example of this, right? Doing instant peer to peer payments for the adult industry was not really possible. Doing payments for the adult industry was really, really difficult. And now we can do them. So what can't legacy financial systems do? Legacy financial systems can't do very, very small things. Legacy financial systems can't serve high risk users and they can't really do peer to peer.
00:16:00.460 - 00:16:49.724, Speaker B: Anything that you guys can think of that falls under these things. Please come talk to us because we're really interested in figuring out how to help. What is Kinext? A lot of people think that we're like a subset of spankchain. It makes sense because we've been working together so closely for so long. Really what we are is just open source, unappinionated infrastructure for scaling, specifically for scaling micropayments. We want to help the projects that have this problem today and collect data and hopefully money to be able to solve the scaling problems in the future. Jeff Coleman is definitely going to disagree with me on this, but I really do think there is a ton of value in doing experimentation and actually collecting real user data.
00:16:49.724 - 00:17:27.770, Speaker B: This is sort of a view that Amina and I share, and it's a big part of the reason why we're working together. So what did we learn from Spankchain? We partnered up really closely with them and there were some really phenomenal things that came out of it. One of the biggest things was that the adult industry is really, really cool. It's really an awesome space. They are very, very open minded, very willing to learn new things. And most importantly, there are a ton of problems that exist over there that can be solved by crypto and solved by blockchain in general. Highly recommend you guys check it out if you don't already.
00:17:27.770 - 00:18:31.964, Speaker B: The second thing that we learned, and again, I'm sorry, counterfactual guys and all of the other researchers, there is a lot of theory in scaling research, and it's really incredibly valuable to do these exercises and learn what sorts of things are possible within a logical framework. The thing that happens, though, is that when you put this stuff on main net, when you put it in front of real users, almost all of it breaks. We went through, Amin didn't mention this, but we actually also, between implementation three and implementation four, went through three rewrites of the framework that we wanted to work with. And we as connect sort of initially came to spank chain with like, hey, we've already built this whole thing, why don't you guys just integrate it? And none of it would have made sense. Literally none of it. And the reason that that happens is because your users are crazy. They don't really do any of the things that you expect them to do.
00:18:31.964 - 00:19:16.972, Speaker B: They have entirely different needs, and most of the time they don't fully understand your system. And so until you spend a bunch of time working with them, until you spend a bunch of time collecting data from them, you don't really realize that, oh, for instance, users really don't care about paying ten extra cents of gas costs, but they do care about coming back online to sign transactions turns out signing transactions leads to like a huge drop off. Paying gas. Most of them really don't mind that much. The last thing that we learned was actually, I think I covered it. Yeah, never mind. So what's next? We sort of did this thing with spankchain where we worked on figuring out what one node would look like.
00:19:16.972 - 00:19:59.480, Speaker B: How do you solve micro payments for one ecosystem that has a bunch of users clustered around it? Now, the goal is to go from one to n. So basically copy pasting this same framework in a bunch of different places and then connecting all of it into a network. You can see here we have like wallets connected to channel managers, which are contracts connected to hubs. This is how our existing system works. Normally at this point, it's also connected to another wallet, and then two wallets can pay each other. But there's no real reason why you can't take pretty much exactly what we have right now and just keep going with it, adding more and more hubs to the mix until they're not really hubs anymore, they're nodes. And this looks a lot more like lightning or Raiden.
00:19:59.480 - 00:20:39.860, Speaker B: We think that this is really valuable because the user experience that we want to deliver is you wake up in the morning, you put 50 die or something like. Or maybe booty. Actually, you put 50 booty onto your wallet, into a daily spending account, like a checking account or something like that, and then you never pay gas again. You can earn money, you can spend money pretty much anywhere. You never actually have to pay gas until you withdraw your funds at the end of the day. So we actually had two announcements. So I appreciate Ken sort of alluding to them, but we did have two announcements that we're really excited to do.
00:20:39.860 - 00:21:15.520, Speaker B: The second announcement is that we're officially partnering up. This is probably not really surprising to anybody, especially the people who thought that we were the same organization this whole time, but we have partnered up. The way that this partnership works is we've actually done an ownership swap. We now own a certain percentage of spankchain, and Spankchain now owns a certain percentage of us. We both think that this is a really, really cool way to incentivize mutual collaboration in the future. More projects should do this in order to stay aligned. We really want to see Spankchain succeed, and Spankchain really wants to see us succeed.
00:21:15.520 - 00:21:58.536, Speaker B: How does it shake out? Spankchain is going to go and focus on all of the node bits, basically optimizing the user experience, optimizing all of the amazing things that you can do as a single node in our network. And we are going to go build the rest of the network. So optimizing on how we can connect all of the nodes to each other. So you could kind of think of it as like sort of like one hub and then many hubs, and then we're sort of the shit that is in between. We're really incredibly excited to be working on this and incredibly happy to be up here sort of letting you guys know that this is our plan in the future. We're open source, we're free infrastructure. We don't have a token.
00:21:58.536 - 00:22:27.816, Speaker B: We just want to figure out this problem, and we want to figure out this problem and use the data that we get from this problem to figure out many, many other problems in the future. So if you have an, please, please reach out to us. Please go check out Spankchain if you haven't already. They literally have the best user experience in crypto. They're also one of the only companies that has real users and is struggling with the real problems that come with having real users. And I think that that is all I've got. Yeah.
00:22:27.816 - 00:23:07.956, Speaker B: Thank you very much. I'm very curious about. I think there has been many talk about projects like merger or acquisition, takeover, et cetera. How do you guys decide organically? Cross, I guess, ownership evaluation at that point? Yeah, that's a good question. We sort of just kind of met up at Amin's house one day and we're like, we really want to do this, and sort of decided what would be a fair price for both. And one of the great things about doing this kind of a swap is we both want to see each other succeed. So neither of us is really incentivized to screw each other over.
00:23:07.956 - 00:23:14.612, Speaker B: But that was basically what went into it. More deals should be done like that, by the way, just hanging out at someone's house.
00:23:14.746 - 00:23:45.370, Speaker A: In general, yeah, my investment thesis was invest in all the things that use state channels. And so we, as a company, in working together, we can work with the teams that we know are going to deliver, and we know that if they can deliver something for us, then they'll be able to deliver something for everybody else. And regarding the numbers, I mean, it's like any negotiation, you pick a number that makes you both happy and then move on with your lives and.
