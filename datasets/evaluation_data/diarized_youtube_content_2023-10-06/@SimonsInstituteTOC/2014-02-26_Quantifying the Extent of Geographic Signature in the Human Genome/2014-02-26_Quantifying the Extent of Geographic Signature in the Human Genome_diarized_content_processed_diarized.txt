00:00:00.360 - 00:00:28.634, Speaker A: So thank you very much for inviting me. I'd first of all like to thank the organizers, especially Jun, for putting together this program this semester, which is really wonderful. And this workshop has been great. I really, really enjoyed the people and the talks. So I should say my talk today is about a topic that we really haven't worked on so much before in my group. And actually, what I'm going to talk about isn't really actually published yet. In fact, it's not even submitted yet, so.
00:00:28.634 - 00:01:28.766, Speaker A: And in fact, my title is partly designed to not reveal the material of the talk because I wasn't sure it would be done on time, so. But I think we are. And the work is actually done with my students in postdocs. So the idea I'll talk about is sort of, the architect is Nicholas Bray, and he's worked very closely with Breland Brown and Shannon McCurdy. Shannon McCurdy got married to her work while working on this project, and so is currently in her honeymoon in Thailand. But brewing is in the audience and Nick is in the audience, and also other members of my group, Inge Halgram's daughter and Bo Lee, have also helped us and contributed to the ideas that I'll talk about. So what I'd like to talk about, the starting point is, like, a lot of talks we've seen today, actually, is this great figure from Carlos's paper showing PCA of the genotype matrix and reviewing the geography, the geography of the world.
00:01:28.766 - 00:02:15.366, Speaker A: And as Ron just said in his talk, this is a surprising result the first time you see it, and it's quite a beautiful result. I particularly like this paper, not just because it's had a lot of impact and it's been an important result, but because it's actually reproducible, thank God. So I'm not going to end up. Exactly. So if you take another data set, which many, many people do all the time now, this is sort of the standard tool I'm going to show you. If you take 1000 genomes data, which we're going to be talking about in this talk, partly because it forms the data for the Geovattus project, which is really what I want to talk about. So we take another data set here.
00:02:15.366 - 00:02:49.276, Speaker A: They're actually individuals only from a few places. It's not as refined as the map of Europe, but. But you do PCA and you get a nice clustering. Actually, it turns out that direct PCA on this data set doesn't do quite the right thing. If this is Africa, the yellow, or it's actually. Yeah, this yellowish is Finland, purple is Tuscany, and actually Tuscany is between Finland and Great Britain. But I'll tell you later also how you can actually fix this.
00:02:49.276 - 00:03:42.344, Speaker A: But in any case, PCA clusters populations, and this has been a really important result. So maybe I'll just use a computer. So we were curious about a question that I think some people have asked other than us, which is, what about expression data? So my lab works a lot in rna seq, and we were curious, what if you take the expression matrix, do you see the map of the world? And there's a great data set for trying this out. Recently published Gervais data in Thule La Palainen's paper was recently just published, and in it is expression for 462 individuals from lcls with pretty decent coverage. 30 million reads is not great, but reasonable coverage for rna seq for each individual. And this data is a subset of 1000 genomes. So you actually also have genotype data for these people.
00:03:42.344 - 00:04:16.678, Speaker A: And actually, in their paper, they have only one figure where actually the labels appear for where people are from. And it's just showing sort of. This is about what fraction of the expression is due to splicing differences or not. Point being here is that the paper didn't have an actual investigation about population structure in the expression data. So we were interested in this. And so we took the PCA plot and you get this picture, and it's a bit disappointing. You know, it's not really that pretty, right? Like, you don't see Africa and you don't see the world.
00:04:16.678 - 00:04:49.992, Speaker A: And, you know, many people, I think, have actually made this picture. And so given up expression is just messy. But we're sort of looking at this. If you sort of cross your eyes a little bit, you can see Africa, maybe down there. So, I don't know, we wanted this to work, and Nick sort of had the idea that maybe if you rotated your head a little bit in the high dimensional space this data is in, we're looking here at expression data. We have about. In this analysis, we're looking at about 51,000 transcripts.
00:04:49.992 - 00:05:19.184, Speaker A: So maybe just taking PCA doesn't show you the geography, but maybe if you just tilted this a little bit, maybe you would see the geography, right? So I'm going to show you that, in fact, expression contains geography. Okay? That's the point of the talk today. It doesn't mirror geography. You don't see it on the PCA, but it's actually in there. And it's really in there. And it's actually quite interesting. So I'm going to tilt for you slowly your head, and as I'm tilting your head, you're going to see these expression points start to cluster.
00:05:19.184 - 00:06:05.590, Speaker A: And I'm going to get to here, where it's not as pretty as the snips, but you have all the Africans down here, Finns up here, British here, and the Tuscans in the middle. And actually, you could probably tilt your head even a little bit more and really separate this picture out nicely. Okay, so what I'd like to do in today's talk is tell you how you rotate your head in 51,623 dimensions to find this actual geography. And my talk doesn't have a lot of equations, as others have disclosed. And I also don't have a lot of biology, but I have some geometry. So that's what I'm going to offer you. So, to really understand what I'm going to try to explain, I need to start with the very basics and just revisit regression for a second, and we'll go build from there.
00:06:05.590 - 00:07:02.734, Speaker A: So everybody here in the room has taken data and plotted a line through it, plotted a regression line. But the way people sometimes do regression is they just plug into a formula. So there's something with matrices, and you just do it, and you do it in r and you get a line. But it's important for this talk to realize that, and everybody here knows this, but they may not know the generalizations of this, is that regression is actually a sort of statistical thing you're doing. It's not just that you're actually plugging in into this thing, but you're actually doing some statistics. And what you're actually doing is you actually have a model that's this black line, and you believe that your data is a linear function of your x values plus some gaussian noise, and you're actually optimizing within that framework, the likelihood function to find the red line. That's what you're actually really doing.
00:07:02.734 - 00:07:54.800, Speaker A: And the reason I think this is important is that PCA, which everybody's talked about here, has sort of a bad rap, because people, when they use it, they say, well, it's not really statistical, it's sort of like this thing, and you do it and it works, but it turns out it actually is. So PCA, the way it's usually thought of, is sort of a projection of your points to a lower dimension, in this case from two D to one d, to sort of preserve the variance of the points. That's one way to look at it. And that's actually a true statement. But another way to look at it is this way, is that it's actually also finding a line that maximizes some likelihood. And it's exactly like regression, except here the model is that the truth is the black line, X. You know, Y is a function of X, except that there's gaussian noise both in the x axis and in the y axis.
00:07:54.800 - 00:08:28.144, Speaker A: Right? So in regression, you sort of have perfect data on x, and you're measuring noisy data on Y, but in PCA, you're measuring noisy data on x and on y. So what I've shown you here is the regression line where you regress Y versus X, and then blue is x versus Y and green is the PCA. It sort of lies in the middle because you're now allowing for noise in both axes. That's a different way to think about it, but that's sort of a good way to think about PCA. And I didn't come up with this way of thinking about PCA. This actually sort of comes from Sam Roiss. Maybe some of you knew Sam.
00:08:28.144 - 00:09:12.606, Speaker A: Sam and also Martin Bishop have written about probabilistic PCA, and you can sort of show that there's. I won't write it out here, but there's a sort of probabilistic framework where you see the green line as not just this projection from maximizing variance, but it's the statistical way. And I want to say one thing, just a message, is that everybody really should be doing PCA in all of their plots, because every sort of data set we do produce these days actually has error in the x and the y coordinates. So this is me doing the wrong thing. So this is one of my recent papers on rna seq, and we were looking at our expression values on Illumina platform versus solid. This is about fixing bias in rna seq. And we did what everybody does.
00:09:12.606 - 00:09:43.434, Speaker A: We regressed y versus x. It's wrong because there's error in our measurements of expression in x and y. So everybody does this sort of wrong. Everybody should be using PCA in sort of the genomics context, probably for almost every plot. All right, so the point of the probabilistic view of PCA is that it also offers a nice algorithm, and this algorithm is going to generalize nicely to what we want to do. So the algorithm is the EM algorithm. So instead of doing, you know, there's a linear algebra expression for PCA.
00:09:43.434 - 00:10:06.906, Speaker A: You can take the singular values and all this sort of stuff, but there's a very simple algorithm for finding PCA line, which maybe you haven't thought of before. So the algorithm is this. You have some points, maybe they're in high dimensional space. And you pick a plane, in this case a line, any line. And what you do is you run this E and M step. First step is to project your points onto the line. Okay? So that's the projection onto the line.
00:10:06.906 - 00:10:29.710, Speaker A: This is actually the e step. So by this gaussian model, this is your guess where your hidden data really was on this line. Another way you should think about this. There's a red point here which stands at the mean of the x and the y values the mean of the data. And now we're going to, like, the PCR line will go through that pointer. We're going to let it toggle around like a compass, you know, like a needle of a compass. It's going to toggle around.
00:10:29.710 - 00:11:05.044, Speaker A: And what you're going to do is after you projected the points, you're going to rotate this line so that the square distances to the actual points are minimized. But, you know, these points on the line are fixed, but they're tethered to the point that got projected there. And so you're, you know, you no longer have straight lines, everything, you imagine these strings tilting and you're going to find the angle which minimizes that squared error. And now you repeat this, once you have this line, you project back down, and so you're toggling your line back and forth. And that's actually what PCA is. Okay, so that's sort of a really nice way, I think, to think about PCA. And that's sort of Sam Roe Weiss's algorithm.
00:11:05.044 - 00:11:40.858, Speaker A: So there's two problems with this model. This is a nice model for data, but the way I presented it, you can immediately see that there's sort of two issues. One is that there's a gaussian assumption in PCA. You're actually assuming that the error, there's this true plane that your data is coming off of your hidden data, and you added gaussian noise, and maybe your data is not gaussian. In fact, as Iran just discussed, I'll get to this in a second. Genotype data is not gaussian. The second thing is that in this model that I showed here, you're assuming that the gaussian error has the same magnitude in the two axes.
00:11:40.858 - 00:12:06.494, Speaker A: That's the PCA assumption, is that in every coordinate the variance is the same. And that's not true always for data. For example, if you think about genotypes some SNP's have really a lot of variance and some don't. So that's not a good assumption. But there's sort of ways to deal with that. So actually, PCA can be generalized to any member of the exponential family. You don't have to do the gaussian, and secondly, you don't have to allow for equal variance in each coordinate.
00:12:06.494 - 00:12:30.812, Speaker A: If you don't, then you're doing what's called factor analysis. And just the kind of algorithm I showed you generalizes directly. So there's no reason to even have this strict assumption. You can allow for different variants in different coordinates, and you can also allow for a different model other than the Gaussian. So in fact, a really nice paper by that he just spoke about. So that's really perfect. I mean, he just showed us this beautiful movie is in fact doing that.
00:12:30.812 - 00:13:12.396, Speaker A: So it's a model based approach, kind of in the way I would say it is, that it's sort of logistic PCA. So what's actually happened there is that the Gaussian has been replaced by a Bernoulli random variable, and this has allowed implicitly for different variants in each coordinate. So it's sort of like factor analysis. So that's actually, it's logistic PCA, and it's a very good thing. In fact, I wonder why anybody's doing PCA after his paper. Everybody should be at least doing logistic PCA, so it's a better model. So I want to get back to expression and talk about how we found this geography from thinking about these insights.
00:13:12.396 - 00:13:37.130, Speaker A: And actually, that's sort of how the project originated. I taught a class last semester, and we talked a lot about PCA in my class. So we were just thinking deeply about what this is about. And that's what sort of led us to this idea. I just have to say one thing before I get there. All this has to do with expression data. I'm not going to talk about this now, although I'm happy to answer questions later, but just briefly.
00:13:37.130 - 00:14:06.054, Speaker A: So, the Gevattis data, it's got 30 million reads per sample. All of this needs to be quantified. And we happen to do rna seq in my lab. So we've quantified everything with express, which is one of our programs that Adam Roberts wrote. And this gives transcript level, isoform level quantification. So in all the remaining material I'm doing, what we're actually looking at is a big matrix, which is individuals by transcripts, multiple transcripts per gene. And we've got an estimate of expression for each transcript.
00:14:06.054 - 00:14:40.794, Speaker A: And you should probably realize that our model for actually estimating expression includes parameters for errors in the reads, sequence, specific bias, fragment length distribution in the protocol. A lot of stuff that makes rna see complicated. One thing we probably need to do and haven't done yet is investigate how our results depend on how you call expression. I suspect that if you don't do a good job because you're not using my software, you're not going to get as good results. But there's, you know, there's a lot of noise in expression, which I think makes the results all the more amazing, actually, that you actually see geography and expression data.
00:14:41.734 - 00:14:50.430, Speaker B: All right, so we're interested in expression for its own sake. We're not using it instead of genotypes for inferring population history.
00:14:50.582 - 00:14:55.590, Speaker A: No, we're actually going to use it instead of genotypes. We're looking at population structure and it's better.
00:14:55.622 - 00:14:57.102, Speaker B: Or, I mean, you're going to make some argument why.
00:14:57.238 - 00:15:28.230, Speaker A: I'm going to make an argument? Yes. I'm not going to make an argument or better or worse, I'm going to make an argument different and better when done in conjunction with genotype data. Okay, so let me tell you how you might go about doing this. So we have this big expression matrix. I'm going to leave it kind of abstractly as a big blob. And in this data set we have some individuals from some geographic locations. Now, we're not just going to do something canonical like PCA.
00:15:28.230 - 00:16:05.420, Speaker A: I mean, one of the great things about PCA is it exists independent of genotype data. It's just the thing you can do to the matrix. But we tried it and it didn't work. So one thing you could do is you could say, okay, I mean, each of my samples comes from one of these populations, and we actually just use for what I'm about to say, we actually just took latitude longitude coordinates for these things. And you can actually ask for the best projection of your data onto linear space, onto a plane that gives the best correlation with these points. So you have these points in high dimensional space. I mean, we want to now look for geography.
00:16:05.420 - 00:16:36.226, Speaker A: We're not just going to find it. Okay, so you could just take a projection and smack it down so that you best correlate with this. And actually, if you do that, so you take a projection that maximizes the correlation. I should actually say there's a name for this kind of projection. It's called canonical correlation analysis, and it's also got a probabilistic framework like PCA, that's sort of going to be important for us. That was sort of proposed by Francis Bach and Michael Jordan here. But it's sort of a weird thing.
00:16:36.226 - 00:16:59.382, Speaker A: It's a paper that was never published. It's a tech report, and it has some issues. And so it's never been, like, worked out very nicely. But there is a sort of probabilistic sense in which you can maximize this correlation. In any case, if you were to do this starting with the expression matrix, you get this picture. Okay, so there's a lot of individuals. We're actually taking 370 individuals.
00:16:59.382 - 00:17:35.459, Speaker A: Gevattis was 462, but we threw out the ceus because they're all admixed and so on. So we wanted a cleaner picture for now. So if you take all of these big points and you ask for, like, the best projection that shows you the geography, well, guess what? You find the perfect geography. Okay, so why did that happen? Okay, so what you've done is over fit. Okay? So the thing is, right, that the state is in. You know, we have 370 individuals, but they're in 50,000 dimensional space. And we're allowing ourselves to choose any plane onto which to project these individuals to find the geography.
00:17:35.459 - 00:18:29.336, Speaker A: Now, there's a lot of planes in 50,000 dimensional space. So, actually, if you were to shuffle the labels so that the individuals are not really from where you say they are, well, you can still perfectly project them into the geography, which means that, well, what's the point of my talk? So this is the observation, okay, so this is a very bad thing. My talk's gone. So this is the observation that if you take, like, a tetrahedron, right, in three dimensional space, then, you know, and in this simple example for today, there are only four populations, and really three of them form a triangle. And one's in the middle, right? The Tuskens are in the convex hull of the Finns, the Brits, and the Africans. Basically, this is about choosing who is in the middle. And if you think about a tetrahedron with four colors, you can actually choose a plane to put any one of the nodes in the middle.
00:18:29.336 - 00:19:25.784, Speaker A: That's not hard to see. There's just a lot of planes you can sort of. And in fact, if you only have 370 points in 50,000 dimensional space, they form a simplex. So you can easily just choose a plane that gives you the perfect geography. So that's not interesting. Okay, so what is interesting, I'm going to argue to you that what is interesting and that's sort of the idea here is that if instead of just going directly from your matrix into the geography, you instead factor it through a low dimensional projection, let's say using PCA, or even better, Iran's logistic PCA, um, or even better than that, a model that couples the projection maximization, uh, to this low dimensional projection. If you do that, um, then maybe you can actually have an interesting result because what is this doing? Well, this is taking that very high dimensional matrix, putting it in low dimension so as to preserve the variance in the data.
00:19:25.784 - 00:20:04.144, Speaker A: Then it's asking, is there still geography here? Now, if you have 370 points in three dimensions, then it's not clear at all that you can actually find a plane that shows you the geography. Okay? So that's sort of the idea. It's a very simple idea. Okay, so this is the picture. Let me explain now what I was actually showing you. I was showing you the picture where you keep 21 dimensions out of your original 51,000 dimensions. So you project down to only 21 dimensions and then you take that data and you try to correlate it to geography.
00:20:04.144 - 00:20:46.414, Speaker A: Okay? And actually the movie I showed you before was simply increasing this dimension from two, three all the way up to 21. And that's why the picture was getting better. If you go flat out to two dimensions, you know, you sort of throw out the geography, you throw out the baby with the bathwater. But if you want to keep some more pcA, you know, some more PCA dimensions there, then geography is actually in your data, although it's not the predominant signal, that's fine. So to convince you that this is actually meaningful, I'm going to show you what happens if you actually permute the labels here. So if you permute the labels here, you don't see the geography. This is the best correlation of the low dimensional projection to the geographic data.
00:20:46.414 - 00:20:59.862, Speaker A: But after permuting labels, and what that means is basically that there's actually a result here, so it's not a null result. You're actually seeing something untrivial in the data. All right.
00:20:59.998 - 00:21:02.754, Speaker C: How many dimensions do you have to go up before you see a signal?
00:21:03.334 - 00:21:28.654, Speaker A: Well, that's a good question. So I can show you. So we can do the movie again. So now you can look at it again and you can look at the number two and you can judge for yourself. Right? So there's 234567. Now already at seven or eight dimensions, you're seeing the actual geography. Okay, so, oh, the Bermuda data.
00:21:28.654 - 00:21:49.598, Speaker A: That's a very good question. So in the permuted data. You need to be going up to, you know, maybe around 100, you start seeing the geography. Or 200. Yeah, I mean, I can actually. Yeah, it's like, it's much higher. You need to go up to, like, you know, maybe up to two.
00:21:49.598 - 00:22:12.264, Speaker A: At 100, you see a much blurrier picture than this. At 20. I mean, so, yeah, as Breland says, maybe go to 200 to see the geography and the permuted data. Okay, so let me just get back to where I was. Sorry. Okay. I blew up the.
00:22:12.264 - 00:22:30.272, Speaker A: So that's better. All right. Okay, so the thing is, right, that. So there's another interesting thing you can do, which is instead of. So you might argue, well, I mean, that's not so fair. I mean, you took the geography you already knew, and you glued the expression data into that geography. So you found it.
00:22:30.272 - 00:23:08.230, Speaker A: Okay, big deal. But you can actually do other things. So one thing you can do is instead of gluing together the expression data into geography, you can actually glue it into the SNP data directly. Okay, so the model I'm proposing here is that we, we take the genotype matrix, we take the PCA of that, and we find the linear map that provides the best correlation between these two halves. Now, that's kind of getting interesting, because this geographic structure in here, I've just shown you this geographic structure in here, so maybe the structure actually helps. So you have more signal and you can do that. I'm sorry.
00:23:08.230 - 00:23:34.810, Speaker A: My picture is rotated here. So we really are just working on this. So we don't have. So you have to turn your head 90 degrees. But this is the picture for the projection of the expression data in the two dimensions under a map where you've tried to produce the best correlation to a projection of the SNP data. So this picture doesn't even know about geography now. It actually does because we already know that the genotypes know about geography.
00:23:34.810 - 00:24:12.490, Speaker A: Right. It's still kind of cheating, but it's sort of, you know, but it's. Yeah, so that's what it is. And how many dimensions did your zip data. I'm sorry, how many dimensions did you project your SNP data onto? This SNP data is projected onto two dimensions, but actually, it turns out that with SNP data, you're sort of better off, quite a bit better off projecting the three dimensions. So the initial picture I showed, which had the swapped Great Britain, that gets fixed if you look into the third PCA. So, yeah, and again, if you shuffle, so you do the same experiment, snip versus expression.
00:24:12.490 - 00:25:00.492, Speaker A: But shuffling the data, there's nothing. Okay, so you really, you know, there really is geography inside the expression data. Now I want to show you another result, which I think is kind of interesting. So we've now found a tilting of the PCA plane where we have actually found the geography. Okay, now what we thought to do is to check whether, you know, this is sort of generalizable to other data sets, right. And, oh, actually before I get to that, I'm going to show you this. I'm sorry, I have myself, when you have this projection, you can actually ask, what is this projection? You know, what genes determine this projection? And what we found is in the first principle component, the primary contributor is the vitamin D receptor gene.
00:25:00.492 - 00:25:29.294, Speaker A: So we were happy, right, because vitamin D is a good thing. And this I'm not prepared to say in the talk because we really have to investigate this further. But it looks like. So when you look at among all genes, vitamin D has the highest correlation with latitude and none of the SNP's around. Vitamin D actually produce a geographic signature. So we seem to have a sort of independent signature for geography that's sort of really truly expression based. Okay, this is not just the reflection of the SNP affecting the gene, maybe, but we'll have to see.
00:25:29.294 - 00:25:43.022, Speaker A: In any case, vitamin D is the top of the list and we have a whole list. And it's sort of very interesting to look at the genes that are in the first and second principle. Not principle, but CCA components determine or.
00:25:43.038 - 00:25:44.374, Speaker D: Correlate with the axes.
00:25:44.534 - 00:25:52.202, Speaker A: Well, these axes actually lie in expression space. So you just look at what are the contributions to the axis. Yeah, just like you might do in PCs.
00:25:52.318 - 00:25:54.054, Speaker D: I still want to use cux.
00:25:55.114 - 00:26:20.556, Speaker A: We still haven't used your method. Yeah. So there's another result I kind of like. So we did the following experiment. So we took, there's another data set, the HGDP data, which is a much larger data set with a lot of individuals to specifically look for geography. There's a paper by Noah Rosenberg looking at this data, and this is his picture with the pc axes. And we did the same thing.
00:26:20.556 - 00:26:52.582, Speaker A: This is our pc picture. I don't have quite the right colors yet, but it's partly on purpose. So here all the Africans have been colored in red, but they're actually separate populations. And here every population has been given its own color. And you have to, you can really believe me that we're replicating the result because this is sort of an upside down l and this is an inverted l, and if you look at it for a second, you'll see that this is actually african and this is actually Asia. And we're really looking at the same thing. You even see here this double texture thing appearing here.
00:26:52.582 - 00:27:28.246, Speaker A: Okay, so that's the PCA plot for this data. But what we did is we took this plane. So this is the plane for expression data. But we have a, doing expression SNP analysis here gives us a plane also for the SNP data, a plane that's not the PCA plane. And you can actually take that plane that we learned from SNP's and expression together on Geovattus and put it in here. And that's the projection of the genotypes. And you can just see looking at this, right, that you have pulled out these guys, you've pulled out these guys, you have this population now and the whole thing is much more resolved.
00:27:28.246 - 00:28:00.306, Speaker A: So there's sort of a universal projection here, right. We've taken a projection from one data set where we have expression and we've just used the same plane in another data set and you can see more geography. Okay. So I hope that that will be one of the useful results. What we're doing is that, you know, instead of taking each data set up in issue and just doing PCA on it, we should just learn one good projection from lots of data and not just expression and genotype, but other phenotype data and then use that when we're taking new data sets. Yes.
00:28:00.370 - 00:28:01.186, Speaker C: I don't know if this would make.
00:28:01.210 - 00:28:05.672, Speaker A: Sense, but it makes sense if instead of trying to maximize the mapping to.
00:28:05.738 - 00:28:08.460, Speaker C: SNP data, try to minimize the mapping.
00:28:08.492 - 00:28:09.060, Speaker D: To a SNP data.
00:28:09.092 - 00:28:10.924, Speaker C: But you have some other traits, say.
00:28:10.964 - 00:28:30.748, Speaker A: Like redheadedness, that you're trying to maximize your expression to. Great questions. Yeah, so, yeah, so, well, I'm at the end of my talk. Yeah. So then I'm not going to talk about it today. But the entire motivation we have is to do association mapping with this. Right.
00:28:30.748 - 00:28:57.324, Speaker A: And so, yes, so you can use this model to glue together phenotype data and. Exactly. The whole idea is to normalize out the population structure this way. I'll just say part of the motivation for this project was the following observations. So if you look at the recent EQTL papers, they have a very bizarre thing going on. So they're the papers that they're trying to find EQtls and they're trying to normalize out for geographic data. They're trying to deal with the structure.
00:28:57.324 - 00:29:35.466, Speaker A: But in the history of rna seq and expression analysis prior to rna seq microarrays, people would take PCA to remove artifacts out of the experiment, not geography. In association studies, people have been doing PCA for a while and adding it into the regression as a covariate or just subtracting out the residuals. So if you go look at the recent IKTL papers, they come. There's sort of this weird thing about them. Some of them do PCA on the genotype, some of them do PCA on the expression. There's some. This is kind of what drove us towards this unified picture is that somehow you should have a sort of symmetry between what you're doing to the expression and what you're doing to the genotype.
00:29:35.466 - 00:29:50.014, Speaker A: So that's exactly what you're kind of asking about. And that's exactly what we're doing with this. Yeah. So anyway, I think I'm possibly even early, so might be the first person, but it's the first time I've given the talk, so I'll just say thank you. Thanks.
00:29:57.394 - 00:29:58.574, Speaker D: For questions.
00:30:01.074 - 00:30:33.198, Speaker A: Do you have any kind of automated way of actually choosing how many dimensions you project down and telling if it's somehow significant? Yeah, I mean, we don't have a really. We don't have a really. So the way we've been doing it is kind of, you know, we measure the correlation versus the correlation with permutation testing. And this sort of, you know, one's going up, one's going down. We try to find sort of the sweet spot. But I don't think we have a really solid model selection strategy that we really believe in yet. But that's sort of how we've been doing it.
00:30:33.198 - 00:30:45.286, Speaker A: And that's how you got this number 21, because right there you have the maximum differential between the signal and the data and the signal and the performance permutation test. So. Yeah. Yes.
00:30:45.470 - 00:30:48.714, Speaker E: Have you tried some information theoretic criteria?
00:30:52.174 - 00:31:06.998, Speaker A: No, we haven't, but that's, you know, something we definitely need to look at how to do the model selection, but we haven't got. Yes, so I'm a little slow on this. The right way to do eqtl then is to do your projection, do the canonical correlation and then regress on the.
00:31:07.046 - 00:31:09.966, Speaker C: Residuals of that, of the h genotype.
00:31:10.110 - 00:31:51.218, Speaker A: Yeah. So what you get out. So from this picture you're going to get a model for your data that's somehow your null model, and there's many different things you can do with that. So we have different ideas about how to use that to actually find the qTls. Like one thing you can do is if you're looking at a specific snp and expression and you do a regression, you're actually asking, is that regression significant? Well, you can sort of ask under this model, what regression coefficient do you get under this sort of null model that you've learned? So you can use it that way, but you can also take out the residuals just like people do. You can do any of these things with this model? Yes.
00:31:51.306 - 00:32:02.782, Speaker D: Did you try to use partially square instead of your first approach because that you would between geography and expression?
00:32:02.918 - 00:32:22.034, Speaker A: Yeah. So canonical correlation analysis is related to partially squares. And I don't have off the top of my head not to explain exactly the relationship, but I think that what we're doing is somehow like partial least squares, actually. Oh, sorry.
00:32:22.454 - 00:32:46.118, Speaker B: So we've actually generated some rna seq data for the HTTP samples and we do see some PCA clustering of geography, not nearly as well as what you see using the approach. And one of the concerns that we had had was about potentially cell line artifacts and all the differences across the populations. But to the extent you're interested, happy to share that.
00:32:46.206 - 00:32:51.014, Speaker A: Yeah, sure. Thanks. Thanks, Phil. Yeah.
00:32:51.314 - 00:33:21.824, Speaker D: So you mentioned the phenotype world where in denar combinations PCA has been used as variate, one area where it had been used not as noise, but to clean out, but rather as a signal. Are polygenic step scores that have been described as a signal for association. Had you explored any of these in this kind of context?
00:33:21.864 - 00:33:25.364, Speaker A: We haven't explored it, but an interesting thing to do, definitely.
00:33:28.984 - 00:34:17.560, Speaker C: I wanted to just perhaps slightly advertise a paper by August Price in viv Chung. A couple of years ago, I was a minor author where we, we study judge genetics and gene expression in African Americans. And that's particularly interesting because of the varying amounts of admixture. And if you're doing. We were particularly trying to estimate cis and trans effects, and because the CIS effects will depend only on the local ancestry, you can be confident you're not missing. The causal snp is not going to get missed because you're interested in the ancestry components. So I think that's actually, well, we were doing with microarrays and the technology was old, but I think that was sort of interesting.
00:34:17.560 - 00:34:54.744, Speaker C: We were able, at least on that data, the principal component is readily recovered from the expression data. And just commenting on the previous comment, because you're looking at a single admixt population, you're probably eliminating the effect of cell line artifacts. It's wildly unlikely that the cell line artifacts are going to be correlated with the ancestry. If you collect a bunch of African Americans, I think it might be interesting, for example, to do that on Hispanics as well. I think you get a three way mixture in some populations that would be quite affordable.
00:34:55.244 - 00:34:58.104, Speaker A: Agreed. Yes.
00:34:59.024 - 00:35:02.884, Speaker E: Have you ever kind of like sparse cca so you don't have to do.
00:35:05.144 - 00:35:20.964, Speaker A: Yeah, I mean, she's asking whether we've tried sparse PCA and that's a very good question. A sparse ccA. Yeah. Well, there's actually sparse PCA and also sparse CCA. Yeah. So you could do direct sparse ccA off the matrix. That's true.
00:35:20.964 - 00:35:23.764, Speaker A: No, we haven't done that. So.
00:35:26.564 - 00:35:37.676, Speaker E: A fuzzy question. So as you go to your 21 PCs, is it that two of them end up being latitude and longitude, or is that information more dispersed through the variable?
00:35:37.740 - 00:35:49.364, Speaker A: That's a very good question. And I have the answer. Exactly. But, yeah, I don't have it here. But the answer is it's sort of diffuse. It's. The vitamin D receptor is the predominant direction, but it's not.
00:35:49.364 - 00:36:18.042, Speaker A: Yeah, it's not. Not directly contended too. What I will tell you that's sort of very interesting is that you can ask the question how much of the variance is in the pcas to begin with in genotype versus expression? And the thing is that expression data has, if you. For a fixed number of coordinates, there's a lot more variance in expression PCA than in SNP PCA, but only a small fraction of that is geographic, as opposed to in the SNP case, where the majority of the variance that's captured, even though it's less overall, is actually geographic.
00:36:18.138 - 00:36:25.914, Speaker E: Might that be telling us something, that the signal, the geography signal and expression is not just coming from genetic differences, but it's also coming from food differences?
00:36:25.994 - 00:36:48.134, Speaker A: Well, that's what I'm saying about vitamin D three. If you think about it, if you're in Africa versus Europe. Right. The reason you might see different expression of the VDR receptor, a vitamin D receptor, is not because of your SNP, but because of your environment. And that's one thing that's really fascinating about this. We should be able to. I'm speculating now, but, you know, Nick sort of is from Canada and he would like to go do this on people in Toronto.
00:36:48.134 - 00:36:52.874, Speaker A: Right. Where they have different genetic backgrounds but have all moved to the same place. Exactly.
00:36:57.054 - 00:37:05.318, Speaker E: My question was sort of related. Did you look for a window of SNP's around the vitamin D receptor to see if that explains.
00:37:05.446 - 00:37:17.396, Speaker A: Yeah, we've taken SNP's in a window around the vitamin D receptor and there's no signal significant association with latitude compared to random SNP's in the journal in.
00:37:17.420 - 00:37:19.628, Speaker B: That last HGDP plot.
00:37:19.796 - 00:37:20.380, Speaker A: Yes.
00:37:20.492 - 00:37:21.940, Speaker B: That was genetic data, right?
00:37:21.972 - 00:37:22.204, Speaker A: Yes.
00:37:22.244 - 00:37:26.504, Speaker B: So what was the kind of bad parts of the variation that you were getting rid of?
00:37:27.164 - 00:37:35.884, Speaker A: Good question. I don't know. I haven't looked into it. Literally just working on this. So, yeah, honestly, excellent questions. Now we have lots of good ideas. Audience.
00:37:35.884 - 00:37:37.284, Speaker A: Thank you.
00:37:39.624 - 00:37:44.704, Speaker D: Any more questions? Thank you.
