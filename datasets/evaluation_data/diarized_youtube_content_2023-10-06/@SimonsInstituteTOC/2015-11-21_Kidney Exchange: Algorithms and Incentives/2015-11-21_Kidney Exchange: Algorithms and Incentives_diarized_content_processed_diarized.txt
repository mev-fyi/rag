00:00:00.480 - 00:00:52.884, Speaker A: Thank you. It's nice to be here. I'm going to try to review in 40 minutes 15 years of history in the rapidly changing kidney exchange marketplace, with an emphasis on the game theoretic aspects at a high level, that is how the incentives have changed over time, how that has caused people to behave differently, how that has caused us to use different algorithms to try to organize exchanges than we did when we began. Many of you will already be familiar with some of this, so I'm going to move quickly. Santorum is here, who is more expert than I on many of the algorithmic aspects. So again, I'm going to move at a high level today. So the first exchange in the US took place in New England in 2000.
00:00:52.884 - 00:01:23.676, Speaker A: Economists only got involved. Economists and computer scientists only got involved later than that. The question was how to make the market thick. Some of the very first kidney exchanges, and I'll tell you more about those if this is the first day you're hearing the word kidney exchange. Some of the first kidney exchanges were actually arranged by the patient donor payers themselves, meeting in dialysis waiting rooms. So that's not the way to organize a market. So the question was how to organize it to, to have a large scale, thicker marketplace for kidney exchanges.
00:01:23.676 - 00:01:59.796, Speaker A: When we started talking to our surgical colleagues, they said to us that only small scale exchanges could be conducted. And that changed the algorithms that led to the initial startups of the multi hospital kidney exchanges. But since then, we've been able to do larger exchanges and incorporate chains. And as kidney exchange has become a standard form of transplantation in the United States, the game has changed. The players have changed. Instead of dealing with just surgeons and patients and donors, we're now dealing with directors of transplant centers. And directors of transplant centers have different strategy sets.
00:01:59.796 - 00:02:42.874, Speaker A: Turns out one of the things they can do is withhold their easy to match pairs. That means that the multi hospital kidney exchanges are dealing with harder to match pairs, and that changes the algorithms and the, the optimal kinds of exchanges that we're starting to see. So that's the story I want to tell you. And if there's time, I'll tell you a little bit about where we're going now. One of the things I really will try to get into time, I'll skip things if I don't get there, is I do want to let you know that market design isn't just about analytics, that there are other things that go on in implementing markets. So I'll tell you about that, too. So lots of collaborators in this work and lots of different kinds of journals.
00:02:42.874 - 00:03:31.744, Speaker A: Papers on this page all have. The journals all have economics in their name. And some of the breakpoints I'll tell you about have to do with the way incentives changed. But there's also medical collaborators, and the journals on this page all have medicine or transplantation in their name. So market design is an outward facing part of economics and computer science. If we want people to, if we want to help people to do the things they're trying to do, we have to talk to them in their fora, not just talk to ourselves. If I get a chance, and I'm going to definitely try to get a chance to talk to you about some of the non analytic elements of design in some very recent work, and possibly I'll get to talk about where we might be going.
00:03:31.744 - 00:04:14.224, Speaker A: So, to start with, an algorithm that looked initially like it might help us organize kidney exchange. Let me go back to a 1974 paper by Shapley and Scarf. It came out in volume one, number one of the Journal of Mathematical Economics. I like to say that because sometimes people think that theory and application are very distant from each other. But in fact, this was quite an abstract model. And what they said was, they said, let's consider a model where you have n agents, each of whom has an indivisible good, and no money is available to facilitate trade. How could they trade among themselves? And of course, those of you who live in California know that this isn't actually a model of houses.
00:04:14.224 - 00:04:41.368, Speaker A: We use money for houses. But as will quickly become apparent to you, and it slowly became apparent to me, this might start to be a model for kidney exchange. What they said, they introduced an algorithm called top trading cycles that had been proposed to them by David Gale. They said, supposing everyone has a house, here's an algorithm that we could use to trade houses among ourselves. Once we know our preferences for houses. Pick someone in the room at random. Well, pick someone in the room and ask them.
00:04:41.368 - 00:05:04.604, Speaker A: Point to the house you like best. And they point to a house, and to the person who owns the house, and you say to the person being pointed to, point to the house you like best. Because there are only a finite number of houses. Someone will eventually point to a house that has already been pointed to. It might be someone points to his own house. It might be that I point to Chris and she points back to me. It might be that I point to Chris and she points to Eva, and Eva points back to Chris.
00:05:04.604 - 00:05:42.166, Speaker A: So I don't have to be in the cycle that forms, but eventually a cycle will form. What the algorithm says is when that top trading cycle forms have everyone take the house that they're pointing to and leave the market. So those people all got their first choice houses, and they go, and then the people remaining, we say, point to the house you like best among those that remain. At every stage, at least one house has to leave the market. So in a finite number of steps, there's an allocation. And what Shapley and Scarf observed is that that allocation is in the core of the game. That is the, there's no group of people who could have arranged a trade that they would have preferred among themselves.
00:05:42.166 - 00:06:26.738, Speaker A: And the way you can see that is, supposing you were trying to recruit a coalition of people who could trade among themselves and get something they liked better than they were assigned at top trading cycles. Well, as you started to recruit this coalition, you'd notice you couldn't recruit anyone who was in that first cycle because they all got their very first choice house. They can't be made better off. So to make people better off who left in the second cycle, you would have to get one of the houses that left in the first cycle, because everyone who left in the second cycle got their very favorite house among those that remained. But we already saw that you can't recruit the people in the first cycle, and so you can't build a cycle. You can't build a trading group that could do better among themselves. So the outcome is in the core.
00:06:26.738 - 00:07:05.084, Speaker A: It wouldn't cause smaller groups of traders to defect and arrange their own trade. And indeed, when the preferences are strict, there's a unique allocation in the course. So some of the things about the algorithm that I didn't say to you, like, what's the exact order in which we form cycles, turn out not to be important. If we started with a different person and said, point to the house you like best, we might have got a different initial cycle, but we wouldn't have gotten a different allocation of houses to people. And that's because cycles don't intersect with each other. There aren't a lot of choices in cycles. The cycles form themselves.
00:07:05.084 - 00:07:53.836, Speaker A: Now, if you wanted to use an algorithm like this to form a centralized clearinghouse, that would produce outcomes that people couldn't do better on their own to get those outcomes, those core outcomes depend on the preferences. So you would have to have a way of eliciting the preferences. The preferences are always going to be, well, are here going to be private information? There'll be some aspects of the preferences that are private information. It turns out it's safe for people to tell you their preferences if you're going to use those preferences in a top trading cycle algorithm, and I won't prove that for you here. But the issue is, here's Mister I. We've asked him to point to his first choice house and he's done so, but we can see that that isn't going to help him. He's pointing to a cycle that doesn't include him.
00:07:53.836 - 00:08:36.514, Speaker A: So when we run the top trading cycles algorithm, those cycles are going to disappear and he's going to be left pointing without having gotten the house that he pointed to. And so the question is, was it safe for him to tell us that that was his first choice or could he have done better by pointing somewhere else? For instance, if he had pointed here, he could have gotten this house, he would have formed a cycle, a three way cycle with these guys. If he had pointed here, he would have gotten this house. If he had pointed here, he would have gotten his house opportunity set. And what you can see is his opportunity set is never going to shrink. The people who he could have pointed to and formed a cycle will remain until he leaves because they are all pointing directly or indirectly to him. So they will never be part of any cycle until he is.
00:08:36.514 - 00:09:23.388, Speaker A: And therefore it is safe for him to tell us his first choice, although he didn't get his first choice, now that everyone is pointing in the air, everyone's going to have to point to their first choice among those remaining. And this guy might point here or here or here, for instance. And that will add these guys to mister I's opportunity set. So his opportunity set will only grow. And it's a dominant strategy for him to state his true preferences. And so the next thing that came along before any of us were thinking about kidneys was til Abdul Kodorogu and Typhoon Sonmez thought about extending this housing model to a different kind of housing. They said, how about dormitories? And the thing about dormitories in colleges is some rooms are occupied, some rooms have just been vacated by graduating seniors and are unoccupied.
00:09:23.388 - 00:10:14.334, Speaker A: And there are freshmen who have just arrived on campus who need rooms but don't have any. And so there's going to be an analogy in the kidney transplant world to patients who have willing donors and are looking to trade a kidney because their donors are incompatible deceased donors who offer a kidney but have no recipient in mind, and patients on the waiting list for deceased donation who need a kidney and have no donor in mind. And indeed, to tell you about transplantation a little bit. There are a lot of diseases for which transplantation is the best treatment. But kidney disease is special because, first, there's dialysis, so you can stay alive for a while with failed kidneys. And second, healthy people have two kidneys. And therefore, it's possible that you could give a kidney to someone you loved and saved their life.
00:10:14.334 - 00:10:47.982, Speaker A: But there aren't enough kidneys. More than 100,000 people are waiting this morning on the deceased donor waiting list. And in recent years, we do about 11,000 deceased donor transplants a year. So that's not nearly enough. The waiting list is long. You can die while on the waiting list, and thousands of people die each year and deceased donation. Incidentally, if you have a California driver's license, when you went to register for it, they asked you, did you want to be on the deceased donor list? And if you said yes at that time, there's a little dot on your driver's license.
00:10:47.982 - 00:11:21.236, Speaker A: And if you want to say yes now, you can point your browser to something like Donatelife, dot gov dot California and find the registration list there. But they were also living donors. And in the US, we now do more than half as many, roughly living donations as deceased donations. So 11,000 living donations, somewhat more than 5500 deceased living donations. That means there are more living donors than there are deceased donors. Deceased donors donate two kidneys. Living donors only donate one kidney.
00:11:21.236 - 00:11:50.814, Speaker A: Because if you are as healthy as I hope you are, you can donate a kidney and. And save someone's life. But sometimes you're healthy enough to donate a kidney, but you can't give it to the person you love, because kidneys have to fit. They have to be matched medically to the recipient. And this is where exchange comes in. And this is where algorithms like Shapley's and scarf top trading cycles might make sense. Because all of a sudden, there are pairs who have a kidney donor.
00:11:50.814 - 00:12:17.514, Speaker A: One would like to give a kidney to recipient one, but can. So here they are. They have a kidney. Here's another pair in the same situation. And what you see is the blood type a kidney could go to the blood type a patient, and the blood type b kidney could go to the blood type b patient, and we get two transplants that we wouldn't otherwise get. So exchange is possible. And this is a simple trading cycle of the sort that we started to think about in more generality a moment ago.
00:12:17.514 - 00:13:21.194, Speaker A: Now, when we started, as I said, the players were the patients and the donors and their surgeons. And it looked to us at the time, and it was indeed for a few years, ten years ago, it looked to us like the patients and donors we were going to see were going to be pretty much randomly sampled from the general population of patients and donors. Okay, that has changed over time, and I'll tell you about that. But if it were the case that patients and donors were being randomly sampled, then I'll show you some results that suggest that we should be able to do kidney exchange just with small exchanges. That is, the cycles that we find in top trading cycles wouldn't have to be very long. Many of them might be short like this, but that turns out not to be the case, or it hasn't turned out to be the case. So our original proposal, before we understood any of this, before we had really talked to our surgical colleagues, was to do top trading cycles for kidneys.
00:13:21.194 - 00:14:28.292, Speaker A: And I won't talk about that too much, except to say that we had an ambitious proposal that involved both the living, the incompatible patient donor pairs, and the deceased donor pool. There are big regulatory differences between how deceased donors and living donors are handled in the United States, and so we're still working on the politics associated with integrating the deceased donor pool into kidney exchange. So let me not say too much more about that, except that you can prove nice theorems about all the transplants you could do with top trading cycles. But it turns out there are logistical problems to doing large cycles. So here's a picture that is in Cincinnati, Ohio, in around 2006, and I'm the man in the yellow gown, keeping my hands out of the way. And in the bucket, there is a kidney. And behind me, not in this picture on the right, but behind me in the picture on the left, just steps away, is another operating room where the nephrectomy that takes that kidney has just been performed, and that kidney is going into this guy in Cincinnati, Ohio.
00:14:28.292 - 00:15:29.046, Speaker A: And at the same time, in Toledo, Ohio, the donor who loves this guy and the patient who is loved by the lady who donated this kidney are undergoing the same pair of surgeries in Toledo, Ohio. And when I say at the same time, I mean literally at the same time, because the american law that prevents you from buying a kidney makes it a felony to buy a kidney for transplantation, actually says you can't give valuable consideration for an organ for transplant. What that means is you can't write a contract on a kidney. So in particular, you can't write a contract that says, we'll give you a kidney today and you give us a kidney tomorrow. So to make sure that no gaps happen, in this cycle, the surgeons get on their phones from the operating room, they anesthetize the patients, they perform the nephrectomy, and in this case, the donors had traveled. I'm sorry. They get on their, they anesthetize the patients, they make the initial incisions, then they get on their phones and they say, we're ready in Cincinnati.
00:15:29.046 - 00:16:09.980, Speaker A: Are you ready in Toledo? And the surgeons involved here, this is Steve Woodle in Cincinnati. And on the other end is Mike Reese in Toledo. And when Mike answers his phone and says, we're ready to go here, then the nephrectomy takes place and the transplants go on. And what that means, the reason I'm telling you this bit of detail, what that means, is to do this simple exchange between two pairs requires four simultaneous operating rooms and four simultaneous surgical teams. So there's some logistics in just getting a two way exchange going. And you could imagine that if you wanted to do a three way exchange, you'd need six operating rooms. If you wanted to do a ten way exchange, you'd need 20 operating rooms and 20 surgical teams.
00:16:09.980 - 00:17:15.024, Speaker A: And so very early on, when we started talking to our surgical colleagues, this is in early two thousands, they said, you know, this is hard enough. If you want to help us organize kidney exchange, help us organize kidney exchange between two pairs. So if you can only do two pairs at a time, you're not going to get as many transplants as you might with big assemblies of bigger cycles and chains. But you can tap into some very old, very elegant graph theory that many of you will know about. In particular, if we're only going to do two way exchanges, we can model the possible exchanges as an undirected graph in which the vertices are the patient donor pairs and two nodes. Two vertices are connected to each other if they have the double coincidence of wants, if they can each use the kidney that the other one has. And in that case, when we have that kind of set of vertices and edges, a matching is just going to be a collection of edges that touches each vertex only once.
00:17:15.024 - 00:17:55.404, Speaker A: Each pair will only engage in one exchange. And the nice property that the set of matchable vertices has is that it's a matroid, so that all the maximal cardinality matchings are the same size. And you can use greedy algorithms. So in particular, if you have high priority patients, you can have an algorithm that says, let's take our highest priority patient and see if there's any exchange that, that he can benefit from. And if so, we put him in the group that will be matched. Then we look at our second highest priority patient. This is actually very similar to the way that for many organs, deceased donor organs are allocated.
00:17:55.404 - 00:18:49.156, Speaker A: So this was a familiar kind of process and it allows you to say that all that, not to worry about the size of the maximal matching. Greedy algorithms work and it's a dominant strategy for all the pairs to reveal the information that goes into that compatibility graph. And in those days among the information that had to be revealed were results of blood tests. Today we do many of the blood tests centrally in some of the big kidney exchanges, but still not in others. But also you can see that no matter how the technology changes for gathering the information in the compatibility graph, some information will always remain private. Supposing, God forbid, you go to the doctor and find out you're going to need a kidney transplant in the future. So you go home to thanksgiving and you say to your family, bad news, I'm going to need a kidney transplant.
00:18:49.156 - 00:19:44.042, Speaker A: But your family loves you. So your brother and your sister and your cousin and your aunt all say, I'd be willing to give you a kidney and they're all tested and they're all incompatible. But you now have a bunch of potential donors and they could go into the graph with you, giving you lots of edges. Now that would be good for you and it would be good for the whole system. A denser graph will allow more matchings. But you could imagine that we could do something silly like saying people who have only a single donor should have higher priority than people who have multiple donors, because people who have multiple donors are already advantaged in so many ways. And if we did that, then in that case you would say to your, over the Thanksgiving table, you would say to your mother and your brother and your cousin and your aunt, you would say, you know, my surgeon tells me that it's not wise to come with many donors.
00:19:44.042 - 00:20:35.806, Speaker A: I should come with only one donor and then we wouldn't see all the possibilities of exchange. So if we. So a big part of market design is choosing algorithms, choosing the priorities in this case in ways that make it incentive compatible for people to give us the information that we depend on them to give us that we need to make efficient matchings. Okay? So without anything to do about kidneys, if you have a maximal matching in an undirected graph, you can decompose it into under demanded and over demanded and perfectly matched pairs. And the underdemanded pairs are the pairs that will get matched at some maximal matchings but not at others. And the over demanded pairs are their neighbors, who get matched at every maximal matching. So now I'd like to populate this graph for you with actual kidney stories and tell you who's in it.
00:20:35.806 - 00:20:51.554, Speaker A: This has nothing to do with kidneys. This is a graph theory theorem. And to do that, we'll have to. I'll talk about it. Not just in two way matching. I'll have to tell you a little bit about compatibility. Basically, there are two things going on about whether you can take.
00:20:51.554 - 00:21:25.884, Speaker A: The first is blood type. There are two blood components called a and b, and your blood type is which of them you have. So, if you have just a, your blood type a, if you have both your blood type ab, and if you have none of them, in English, we say you have blood type o. In many languages, they say blood type zero, which indicates that you don't have any of the blood components. And the rule is, you can't easily take a kidney from someone who has a blood component that you don't have. So o patients can only take from o donors, but o donors can give to everyone.
00:21:26.544 - 00:21:27.240, Speaker B: Okay?
00:21:27.352 - 00:22:21.580, Speaker A: Now, mostly with some significant important exceptions, like Methodist hospital in San Antonio, most kidney exchanges only enroll incompatible patient donor payers. If you show up with your sister who wants to give you a kidney, and she can, then, without further ado, most transplant centers will say to you, that's great. How about we all meet 530 Tuesday morning in the operating room, and you'll get your sister's kidney. That's not necessarily the best thing for them to do for you or for the world, but that's the story. So if blood type compatibility were the only issue, we would never see any blood type o donors, because blood type o donors are always blood type compatible with the people they want to give a kidney to. But there's another kind of incompatibility that has to do with your immune system. And the sicker you've been, the more blood transfusions you've got.
00:22:21.580 - 00:22:50.214, Speaker A: If you've had a kidney that you've rejected in the past, the more antibodies you have to human proteins. Those live on chromosome six. And if you have antibodies to a lot of proteins, then you become hard to match. And we talk about your percent of reactive antibodies. If you have a high number, that's bad for you. If your number is 80, we start to call you highly sensitized, or we used to. Now the highly sensitized numbers are much higher.
00:22:50.214 - 00:23:18.214, Speaker A: That means that you can't take 80% of the kidneys that are blood type compatible. And so the reason we get o donors in kidney exchange, even among incompatible patient donor pairs, is that many, many patients are highly sensitized. Okay, so we're going to talk about compatibility graphs now that are directed. So there's a pair. An arrow goes from one pair to another. If the. If the kidney can go from the donor in that pair to the patient in the next.
00:23:18.214 - 00:24:37.194, Speaker A: And one way to imagine what kidney exchange would have looked like if we were getting a random selection of patients is to look at random graphs of an erdoshreni sort and say, let's let the market get large and the graph get dense, because even if people are pretty highly sensitized, which means they can only take a small percentage of the kidneys that might look like they would otherwise be compatible. If there are enough patients and donors in the pool, then there'll be enough kidneys for everyone. Being able to take 1% of a large number of kidneys still gives you a lot of kidneys. And so, in an erdos or any kind of graph, we're going to let the, the number of nodes grow, and there'll be some probability p that the two nodes are connected. When we specialize this to kidneys, the nodes will consist of patient donor pairs that will have two blood types associated with them, one for the patient and one for the donor. So we'll have to be a little careful in how we bring Roshani kind of tools into the result. But when you look at the giant connected components that result in the erdosureni world, what you see is I can now fulfill the promise I made a moment ago when I showed you the Goliath Edmonds decomposition.
00:24:37.194 - 00:25:13.972, Speaker A: I can show you in this nice world, which would be the over demanded and the underdemanded pairs. And the over demanded pairs are going to be patient donor pairs, where the patient, for instance, has blood type a and the donor has blood type o. This is a very desirable donor he can give to everyone. The patient is not demanding such a desirable kidney. He can take an a kidney as well as an O kidney. So this whole shaded area, these pairs are going to be used up in a large enough market, in any efficient matching, in any maximal matching. Whereas the kind of pairs will be left over are the o patients who are offering an A kidney.
00:25:13.972 - 00:25:41.656, Speaker A: Right. An o patient is hard to match. He needs an O kidney. And o kidneys are going to be in short supply because they're in high demand and because they're often compatible with their own donors, and he's only offering an a kidney. So, loosely speaking, when we match in the giant connected set. We'll be able to take good care of all of these pairs, but we'll always have pairs of this sort left over. In particular, O patients will be in excess supply.
00:25:41.656 - 00:26:26.650, Speaker A: AB donors will be hard to give away, right, because they can only give to ab patients. So we'd also like to talk about chains. So chains we have. Actually, the data aren't so clear, but we've had about 1500 clear non directed donors in the United States so far. And a non directed donor is a donor who doesn't have a particular patient in mind, wants to give a kidney. About a third of the non directed donors in the United States come from faith based based organizations, from religious organizations. And so in addition to talking about, you know, two way exchanges and three way exchanges, we might also talk about a chain which could possibly end on a patient who's on the waiting list for a deceased donor.
00:26:26.650 - 00:27:25.814, Speaker A: That is, it could start with a donor who doesn't have a particular patient in mind, and it could end with a patient who doesn't have a particular donor dedicated to them. What we used to do when non directed donors showed up, you go through lots of medical screens and psychological screens, and we used to be particularly tough on non directed donors. But when you pass through all those screens, you were invited to give to someone on the waiting list. But once the kidney exchange marketplace became thick and we had databases of patient donor pairs, you could offer non directed donors a more enticing possibility, which is you could spark a chain of transplants. You could give to a recipient who was waiting for exchange and who has an incompatible donor, who will give to a different recipient, whose incompatible donor will give to someone on the waiting list. So that instead of facilitating one transplant, you'll facilitate three. And when you look at a picture like that, it has.
00:27:25.814 - 00:28:15.010, Speaker A: This is a picture from such a chain that was organized in 2006. It has six people in the picture, and one question is, how come only six? And one answer is logistics. In 2006, what we could handle, and it's still close to what we can handle, is three transplants and three nephrectomies at the same time. So when you do all these simultaneously, you need to mobilize six surgical teams and six operating rooms at the same time. And we were doing this in the New England program for kidney exchange, which is in New England. There are 14 transplant centers in New England and two opos, two procurement organizations. Well, but another reason why there might only be six people in the picture is that after we've done a maximal exchange.
00:28:15.010 - 00:28:42.400, Speaker A: In this ideal world, this is going to turn out not to be the actual kidney exchange world, but bear with me. All of these guys are gone. All the over demanded pairs have been exhausted. So we only have these guys. So supposing our non directed donor is blood type o. The blood type o donor could give to this blood type o patient who has a blood type a donor who could give this to this blood type a patient who is a blood type AB donor. Now, there are no more AB patients up here.
00:28:42.400 - 00:28:59.686, Speaker A: They're all in the over demanded set. It's easy to match them. They were easy to match pairs. But there's 100,000 people on the waiting list. 4% of Americans have blood type AB. So there's always plenty of AB patients here. So we could do this three transplant, six person chain.
00:28:59.686 - 00:29:55.244, Speaker A: So that's another reason why there might be only six people. Maybe that's all you can get, but it turns out that's not all you can get. And the reason is, as the hospitals have become the players, the game has changed, right? It used to be that kidney exchange was, was very unusual, and you had to deal with the kidney exchange networks that knew how to do it. But now every big transplant center in the United States has done some kidney exchange. And the people we're now dealing with are directors of transplant centers who have different strategy sets than surgeons and patients and donors. Because directors of transplant centers don't see individual patients and donors, they see sets of patients and donors, and so they can decide which subset of the patients and donors they see to show to the multi hospital kidney exchange. And there are good reasons that we haven't yet been able to overcome in the kidney exchange algorithms that they might hesitate to show us their easy to match pairs.
00:29:55.244 - 00:30:35.214, Speaker A: They're also logistical reasons. But, for example, think of this little compatibility graph where all the guys named a, a one, a two, a three. They come from transplant center a. So you're the director of Transplant center a. And you look at this graph, and you say, look at that. I can get three of my patients transplanted by having them exchanged with each other at my hospital. Alternatively, I could show them to one of the big kidney exchanges, okay, to the national Kidney registry, to the alliance for paired donation to UNOS, and they'll see some compatibility graph, and maybe they'll look at this compatibility graph and they'll say, you know, we can get six transplants, okay, we can do these two three way exchanges.
00:30:35.214 - 00:31:31.980, Speaker A: But of course, hospital a will only get two of those transplants. One of its patients will be left out. So right now, we think we know how to fix this problem, but it would involve prioritizing patients, partly in terms of which hospitals they come from, which has not been a politically feasible thing to do yet. So for various reasons, among them having to do with direct incentive reasons, hospitals sometimes withhold their easy to match pairs. And what that means is when we look at the sensitivity of the patients I showed you, in the general patient population, only 10% of the patients have pra or immuno sensitivities higher than 85% or than 80%. We're seeing a big mode, very, very highly sensitized patients. And when I blow that up, they are really highly sensitized that, you know, a lot of these guys have 100% pra.
00:31:31.980 - 00:32:11.304, Speaker A: That means when we enter them into the system, at the moment we enter them into the system, there are no kidneys that they could take even as a one way. There's no arrow going into them, into their node. Okay? So they're going to be very hard to match. And here's a little bit of data from such a compatibility graph. Remember, each node is a patient donor pair or a patient and her donors. An arrow goes from one node to another only if the kidney can go from the donor in the first pair to the patient in the second pair. And everybody in this picture, just for expository purposes, everybody has blood type a, right? All the patients and all the donors have blood type a.
00:32:11.304 - 00:33:08.354, Speaker A: So the sparsity comes entirely from the fact that these patients are very highly sensitized. There's only eight pairs that have a lot of incoming arrows, and all the rest have very few. And what that means is you can't do a lot of short cycles, a lot of two way exchanges with these highly sensitized patients. And this is why you're going to need chains. And to model the graph that you're getting, the random graph, it's not going to be densely connected, but there'll be some low sensitized patient donor pairs who are densely connected, but the best use of them will be to form chains in the highly sensitized group, supposing each of us is a patient donor pair, and we're all, as patients, we're all very highly sensitized. That means the chance that I can give one of you a kidney is very small, but if the room is big enough, the chance that I can give someone a kidney isn't so small. Now, if I'm highly sensitized, the chance you can give a kidney back is very, very small.
00:33:08.354 - 00:34:08.644, Speaker A: But if the room is big enough, the chance you can give a kidney to someone else isn't so small. So we could start making a chain, and that chain would go among the highly sensitized patients until you couldn't get any further. And then you could bounce it back up to the easy to match pairs, because they're easy to match, they can take kidneys, and then you could continue. And it turns out that rather than saying that all the exchanges could be done in small cycles, what it says here is if you increase by one the size of a cycle, you're allowing from two to three, from three to four, you can get a linear number of extra transplants. And similarly, if you bring in a non directed donor now the cycle doesn't have to close, you're going to get a linear number of extra transplants. So chains are going to be pretty important. And we have to figure out how to do chains, because if we can only do six people at a time, and if we can only do six people, because we have to do all the surgeries simultaneously, be able to do it.
00:34:08.644 - 00:34:43.383, Speaker A: So we figured out that we could do non simultaneous chains. Let me not tell you about that too much, but the first chain, that was Apple doesn't like some of my slides. The first chain was published in a paper in the New England Journal of Medicine, in which Mike Weiss was the first author. And they were economists and computer scientists. Thomas was one of them. When it was published, it had 20 people in the picture. The last lady on the chain was blood type AB, which we try not to do that anymore.
00:34:43.383 - 00:35:16.812, Speaker A: If the chain ended today, this way we would ask her to donate to someone on the deceased donor list. So it took three years to find a suitable match for her, because AB patients who were in the kidney exchange pool tend to be very, very highly sensitized. Otherwise they could have taken their donor's kidney. But after three years, another twelve people were added to this picture. And she was, Elena McKinney was the lady who waited three years. We don't ask anyone to do that anymore. Okay, so chains are important because there are so many highly sensitized patients that can only be reached through chains.
00:35:16.812 - 00:35:42.170, Speaker A: They can't be reached through short cycles. And some of the chains have gotten very long. When this one went through in 2011 and twelve, it was at that time the longest chain. There are 60 people in the picture, 30 transplants and 30 nephrectomies. It's no longer the longest one. It's still an unusually long one. The average chain at the NKR and the APD is about five people.
00:35:42.170 - 00:36:09.434, Speaker A: So many chains are shorter. Sometimes donors have deadlines and have to go home quickly, things like that. But the average chain length is five people. So we get a lot of transplants from non directed donors. Some computational notes. Finding two way exchanges is computationally easy. You know, when you see that nice structure in the Goliath Edmonds decomposition, you know that Edmonds algorithm is going to be a fast one.
00:36:09.434 - 00:36:39.610, Speaker A: Finding maximal two way and three way exchanges is computationally complex. Finding top trading cycles is easy. You know, exchanges of any size. But restricting them is tough. And when you have lots of chains, it gives CPLEX memory problems. Right? I mean, you can really generate a lot of constraints because chains are intersecting. An eight person chain is a subset of a nine person chain, and it could also be, there could be seven person chains instead of the eight person chains.
00:36:39.610 - 00:37:16.264, Speaker A: And chains can branch, so there can really be a lot of chains. Integer programs that we use to solve these things are therefore difficult to deal with. Thomas and his colleagues look at column generating methods. My colleagues and I have looked at row generating methods. Apple computer doesn't like my typefaces, but these are np complete problems that are, however, solvable in practice. Not that there aren't difficult instances. So it's not one of these cases, like the simplex method, where you never run into a hard problem.
00:37:16.264 - 00:37:50.280, Speaker A: We run into hard problems, but so far, they seem to be solvable. So there are certainly open questions about that. Let me close up by telling you about operational changes. So, so far, I've been telling you, the game changed, the behavior changed, so the kind of exchanges changed. We went from two way exchanges to. To two and three way exchanges, to two and three way exchanges and short chains. And now we're mostly optimizing over two and three way exchanges and sometimes very long, non simultaneous chains.
00:37:50.280 - 00:38:18.448, Speaker A: But that's not the only thing that's going on. It turns out when we started to produce these optimal solutions, we were getting very few transplants. And a lot of what happened was, what do I mean, we're getting few transplants. We'd propose a matching. So a three way exchange, a two way exchange, two small chains, something like that. That's a matching. Each part of that matching is what I'll call an offer.
00:38:18.448 - 00:39:00.560, Speaker A: That is, we are saying to some hospital, we have a kidney that might work for your patient. Do you want it? Only 15%. In 2007, only 15% of those offers resulted in transplant. Now, they weren't all being rejected if part of our optimal exchange is this three way exchange, and if the surgeon for the patient in pair three rejects this kidney, then all of these offers fail. We can't do the exchange. So the question was, what was going on with that 15% rejection rate? Some of it was mechanical, was the blood tests weren't all of the same, same high quality at all the hospitals. So we centralized the blood testing.
00:39:00.560 - 00:39:32.588, Speaker A: Now, I'm speaking about the alliance repair donation, but a lot of it had to do with elements of surgeons preferences for kidneys that are hard to elicit. And they're hard to elicit because they depend on combinatorial properties of the donor kidney. Of the donor. So today we have gotten it up to about 50%, and we do we make match offers much more quickly so that we also get. Of the offers result in transplant. So, no. So this is three offers.
00:39:32.588 - 00:40:02.334, Speaker A: So I'm just counting in the whole thing. So we get about 50%, which means that all three of these would be. Would fail now, but instead of. But fewer of them fail, one thing that's going on is we do more change. Notice that when a cycle fails, everything fails. If I propose to you a chain of length seven and the surgeon for surgery four rejects it, we still have a three surgery chain, and we might be able to repair it. Someone else might take that kidney.
00:40:02.334 - 00:40:35.358, Speaker A: Okay, so what were we seeing? A lot of these rejections are what are called medical reasons. So the kidney is compatible. It's not a mistake to think it's compatible. It passes what's called the positive cross match test, but the surgeon doesn't want it. So what we started to do is what we tried to do, but failed, is we tried pushing the compatibility graph to the surgeons and saying to them, look at this graph. Look at all the kidneys that could come to your patients. These are the ones we think are compatible.
00:40:35.358 - 00:40:58.426, Speaker A: If some of them are going to be unacceptable to you, please tell us now. We will delete those edges from the graph, and then we won't have to do. Make so many offers to get some transplants. Turns out you just couldn't get surgeons to do that. Loosely speaking. The problem was we were showing them many kidneys that they would never get offered. And it takes some work to decide whether you would take a kidney or not.
00:40:58.426 - 00:41:41.510, Speaker A: And it was too much work. They're busy. They basically didn't respond. So what we then started to do and continue to do is we offered them a threshold language. We said, for your patient at this time, tell us, what's the oldest donor, you would accept a kidney from what's the highest body mass index? How heavy can he be? How high blood pressure can the donor have? Give us some thresholds like that. Now, that helps a lot, but we still get lots of medical rejections, because if you're my surgeon, you would like to be offered many kidneys on my behalf so that you can look at them and maybe one will be good for me and you would like to take it. So you put a pretty high age as your maximum age.
00:41:41.510 - 00:42:19.660, Speaker A: You put a pretty high weight as your maximum weight. You put a pretty high blood pressure as your maximum blood pressure. So then we show you a kidney that meets all your thresholds, and you reject it. And what's going on? Well, when you said you would take a kidney from a 55 year old man, you were thinking of a 55 year old former Olympic athlete in perfect health. When you said you would take a kidney from someone who was somewhat overweight, you were thinking of someone who was 25 years old, and so forth. So, when we show you a kidney from a 55 year old man who's somewhat overweight and has marginally high blood pressure, you look at your patient and you say, my patient is doing pretty well today. We don't need to take this kidney.
00:42:19.660 - 00:42:32.696, Speaker A: Now. Let's wait. So we still. We're getting lots of rejections. What we've started to do is we run. When you run one of these optimizations, whatever it is you're optimizing, it's not always just number of. Of transplants.
00:42:32.696 - 00:43:05.740, Speaker A: You get multiple optimal solutions. And one of the reasons you get multiple optimal solutions, you can already see this, is, remember, there's always blood type O patients going to be left over. So there's always a choice when you're allocating a blood type O kidney about to whom it will go. So you can get multiple optimal solutions. And now we can show, we can publish the day ahead to the transplant centers. We can say, here are several kidneys that could be offered to you at the next match tomorrow. If there are any that you wouldn't take, let us know now.
00:43:05.740 - 00:43:27.134, Speaker A: And these are typically kidneys that will go to different patients in your transplant center. So there aren't deep incentive issues with you trying to just take the best ones. But if there are some you won't take, you tell us. And that's helped. And that's one of the reasons why we're now at 50%. And, of course, the rate of rejection isn't the important thing. What's important is how many transplants you get.
00:43:27.134 - 00:43:48.630, Speaker A: So we're also re optimizing more quickly. When people say, no, we. Well, one of the big exchanges immediately cancels everything it says. We sent out a match this morning. Not all parts of it were accepted, so forget it. Here's a new optimization. Other programs, depending how they work, some parts may go ahead while other parts get reoptimized.
00:43:48.630 - 00:44:15.354, Speaker A: So that's where we are now in thinking about the incentives eliciting information and the kind of algorithms and matches that will do. And I'd better stop here. Yes. Well, the chains obviously will not have the simultaneous surgeries, not the long chains. Right.
00:44:15.474 - 00:44:16.546, Speaker B: How does that.
00:44:16.690 - 00:44:52.644, Speaker A: The politics or regulation. Good question. So Steve is an eminent economist, and so maybe what he's worried about is how come people who are left hanging at the end of a chain, your sister got a kidney yesterday, and you're supposed to continue the chain tomorrow. How reliable is that? Turns out we have about a 2% renege rate. So that's a complicated thing, but it's well worth it. That's why we still get five transplants per. It was a long time convincing people to do it in New England.
00:44:52.644 - 00:45:30.354, Speaker A: We couldn't get it to go ahead, but Mike Reese at the alliance repair donation did the first non simultaneous chain. People are pretty. First of all, people are nicer than we sometimes give them credit for. So if your sister got a kidney yesterday, you might feel like tomorrow you should go ahead and give the kidney you had promised. But also think about last Thanksgiving when your sister came home and announced that she needed a kidney, and you stepped forward and said that you loved her and would give her a kidney, and you turned out to be incompatible, but you went through kidney exchange with her. When you guys go to Thanksgiving this month later, everyone in your family is going to tell that story. It's going to be a great story.
00:45:30.354 - 00:46:06.094, Speaker A: It would be a harder story to tell if you had not gone ahead and given your kidney. So people are complex in lots of ways, it turns out, when you have to nominate, when you have to be nominated to be one of the parts of the chain that will be delayed and have to wait, the nurse, social workers have to like you. They don't nominate everyone. So when we do these non simultaneous chains, they were little simultaneous bursts of three transplants, typically, and then a delay, and some nurse social worker has to say, he's committed, he'll do it before you get nominated for being part of the delay.
00:46:07.594 - 00:46:10.730, Speaker B: So can you not do that even with the cycles?
00:46:10.882 - 00:46:41.068, Speaker A: So we don't do it with the cycles. And part of the reason is supposing you and your sister are supposed to exchange a kidney with me and my brother, and we decide to do it non simultaneously. And on day one, you give us a kidney, and on day two, for whatever reason, we fail to give you a kidney. It could be moral turpitude, but it could also be that something bad happens to the donor in between or something like that. Well, not only. It's not just disappointing, it's really tragic. You guys have given a kidney and gotten nothing in return.
00:46:41.068 - 00:47:11.974, Speaker A: And next week, when we run another kidney exchange, you won't be able to participate because you don't have a kidney anymore. So we never let that happen. But in a non simultaneous chain, we organize them so that the pairs always get a kidney before they give one. If the link breaks, which it sometimes does, that's disappointing. But tomorrow, when we run another kidney exchange, we'll look for a kidney for you. Yes. You mentioned that one hospital was not withholding kidneys.
00:47:12.394 - 00:47:14.054, Speaker B: Towards the beginning of your talk.
00:47:14.714 - 00:47:39.486, Speaker A: You mentioned at the beginning of your talk that there was some exceptional hospital that wasn't withholding. Oh, well, there's. Yes, well, there's Methodist hospital in San Antonio. They're one of my favorite hospitals. The surgeon there is named Adam Bingaman, and he runs a very successful one hospital exchange. And a big part of his success is he enrolls compatible pairs. So he enrolls lots of easy to match pairs, including compatible pairs.
00:47:39.486 - 00:48:36.730, Speaker A: So supposing I needed a kidney, the people who love me enough to give me a kidney are mostly about my age. So there's my wife and my brother and my wife's brother, and my brother in law's kidney would save my life. But what he would say to me if we came to his hospital is he'd say, you know, there might be some people you could help, and in return, you could get a better kidney than your brother in law's kidney. And so if one of the young people here needed a kidney and has a donor who's an Olympic athlete and in great health, but who can't give her a kidney, my brother in law's kidney would save her life. And the Olympic athlete, 25 year old Olympic athlete's kidney would be better for me. By and large, what makes a kidney good for you is its nephron mass, sort of how big and how young it is. And having us there, remember that graph that had low sensitized eye sensors? So he gets a lot of low sensitized, easy to match pairs, and that helps him do chains and exchanges.
00:48:36.730 - 00:49:16.418, Speaker A: So we'd like to see more of that. One reason we don't is because I haven't talked to you at all about the financial engineering that's going on here right now. When I showed you those first pictures, donors traveled. But that doesn't happen very much anymore. Now it's mostly that kidneys get shipped and that means that hospitals ship each other kidneys and then have to try to recover the cost for their nephrectomies, which can be very different. Hospitals in the United States, with which I've had some indirect dealings have nephrectomy costs going anywhere from twenty five thousand dollars to one hundred five thousand dollars. So if we send you a kidney and say, and please send us $25,000, of course we're not happy when you say, sure, here's a kidney and please send us $100,000.
00:49:16.418 - 00:49:53.038, Speaker A: So one of the. So there are, so there are lots of reasons why hospitals like to put compatible pairs together, because they're paid simply from the insurance of the patient or from Medicare, whereas everything else involves financial negotiations. One of the big advances in kidney exchange that's underway now is what is developing what's called a standard acquisition charge for this. This is something that Mike Rieson and a number of colleagues are doing, and it's looking like we can simplify the financial flows and that, that might also make it easier. Yes.
00:49:53.206 - 00:50:05.164, Speaker B: Some of your results involved random graph models. Yeah, I was wondering, what is the right model and how much analyzing a random graph informs the practice of?
00:50:05.784 - 00:50:51.724, Speaker A: So, remember I showed you two lists of papers, one in economics journals and one in surgery journals. The surgery journals like simulations with clinical data, they don't like random graphs. But to understand what we're looking for, we like, you know, we, the analytical types like random graphs, but we have trouble. For those of you who like random graphs, let me suggest some, some help we could use when you're dealing with erdoschreny kind of random graphs. The big feature of the graph is how does the probability of two nodes being matched evolve as the size of the graph increases? And if it's over a certain limit, log n over n. You're going to get these very densely connected graphs. Well, as a physical fact, the chance that you can take my kidney doesn't depend on how many people are in the room.
00:50:51.724 - 00:51:41.086, Speaker A: So it would be very tempting to model that as a constant. And then, of course, as the room gets big, we have a densely connected graph and we don't need long chains, but we do need long chains, and we are seeing sparse graphs. So you can look at orders for any kind of random graphs and lower the probability of connection, which is an unrealistic assumption, but which allows you to get limit theorems about sparse graphs. So if you say that you'll have a constant degree as the graph gets large, for instance, you get things that look very much like the graphs that we see, but that's not a great way to study them because it's a limit. We're looking at finite graphs. We really need better tools to study sparse graphs, so we don't use random graphs in deciding on matching. We always have particular patients, we have particular graphs that are random to try to understand their general properties.
00:51:41.086 - 00:51:48.484, Speaker A: We would be glad to have some random graph tools that are more up to date than the 1950s ones of erdos and Rennie.
00:51:49.624 - 00:52:11.584, Speaker B: Yes, I have a question that's a little bit troubling, I guess, because it involves, everything here involves people's lives. But have you ever considered situations where, for example, a very rare donor shows up and you'd like to delay using him in a chain, because later he might save many any more lives than he does now? Yep.
00:52:11.664 - 00:52:43.610, Speaker A: Yep. I mean, rare and not so rare, so o donors have more prospects. There's also, what makes you a powerful donor is so the immune. The people with high pra, the people who are really highly sensitized, can hardly take anyone's kidney. They have antibodies that target these six locations on your chromosome. What makes you. What can make you a powerful donor? You get in the six locations, you get three proteins from your mom and three from your dad, and each of them is a target for my antibodies.
00:52:43.610 - 00:53:16.810, Speaker A: What makes you a powerful donor is that you should be homozygous. In rare hlas, you should have, some of the six should be the same, so that there's fewer targets, and they should be rare hlas, the kind of antibodies I have, I get antibodies from having had blood transfusions, things like that. And if you have rare hlas, then the chance that I have antibodies to yours are rare. So indeed, there are powerful donors. On the other hand, the donors own their kidney, and they come to us. If they're non directed, we have some chance of being able to postpone them. If they're directed.
00:53:16.810 - 00:53:57.704, Speaker A: It's a much trickier question, because, of course, there's a patient that they have in mind. But that's one of the reasons why it's a shame when hospitals withhold their easy to match pairs, because sometimes, if we could see those in the large compatibility graph, we could make much better use of them. The question of delay, of how often to do exchanges and how to end the current exchange, that is, you're going to deplete your current pool and then it's going to have some continuation value as you continue. Those are all open to question now. Yes.
00:53:58.724 - 00:54:06.492, Speaker B: So you mentioned that the surgeon might reject an offered kidney. So I was wondering about the timescale of the acceptance of rejection. Yeah.
00:54:06.548 - 00:55:06.118, Speaker A: So a guy named Garrett Hill, who runs the most prolific of these at National Kidney registry, he wants you to say yes or no in a day and he harasses you if you take a whole day, I mean, he expects fast answers. Alliance prepared donation gives people a little more time and is a little slower. I think UNos gives people still more time and is still slower. And this interacts with how far along other things get. So the APD and KR, they used to have, everyone did their own blood tests and transferred blood. So you would only slowly find out that some exchanges couldn't go through during which preparations had gone ahead for other exchanges. So that involves you with a different kind of optimization because you're getting, you're not in fact optimizing against your original pool, because some things go ahead and then you have to re optimize with what's left compared to if you get really fast answers.
00:55:06.118 - 00:55:23.154, Speaker A: You can say, everybody, forget what we said this morning, that turned out not to work. We're going to re optimize with our same compatibility pool. So how fast you can get answers does partly influence how many transplants you can do? Yes.
00:55:23.314 - 00:55:32.414, Speaker B: So over the 15 years, over the last 15 years, what's the performance is increasing the number of transplants.
00:55:32.794 - 00:55:48.506, Speaker A: Let's see. So we're still small, this is just through 2013, but chains started to become important around here. And in these figures, we're getting the majority of the transplants through chains.
00:55:48.570 - 00:55:53.682, Speaker B: I mean, the total number of kidney transplants. So how much it has contributed?
00:55:53.818 - 00:55:57.614, Speaker A: Well, so in 2013 we had 590 through exchange.
00:55:58.834 - 00:56:00.666, Speaker B: That was the total number of transplants in the United.
00:56:00.730 - 00:56:06.726, Speaker A: No, no, that was the total number. So it's about 5700 living donor transplants, 10% of which were through exchange.
00:56:06.870 - 00:56:08.278, Speaker B: I see, right.
00:56:08.366 - 00:56:52.090, Speaker A: And it's growing around the world, but slowly, mostly in the developed world. One of the ways we would like to grow it is when you look worldwide, what you see, I mean, here's the United States. We have a bunch of deceased donor and a bunch of living donor transplants. But there are places in the world where there's hardly any. We've started to explore the possibility of bringing filipino patients to the United States and engaging them in american kidney exchange to be financed by the savings that we get whenever you transplant an American. Because either Medicare. Medicare saves around a quarter of a million dollars in the first five years after an American is transplanted.
00:56:52.090 - 00:57:29.726, Speaker A: Because dialysis is so much more expensive than transplantation, the finances are very complicated. You guys all probably have fine private insurance. Unusually, kidney disease has the following story. Your private insurance would only be responsible for you for the first 33 months, after which Medicare would take over. Even if you're young, you know, kidney disease is one of the entry pathways into Medicare, but they pay about twice the rates of Medicare. So private insurance, even though they only have you for 33 months, can save even more money. Saves about half a million dollars every time an early patient is transplanted.
00:57:29.726 - 00:58:24.220, Speaker A: So we could start thinking about doing exchanges with the developing world, where one of the incompatibilities is that you live in the Philippines, where the national health insurance only gets you 46 dialysis sessions, which is nothing. It means that kidney disease is a death sentence. But there are people with willing donors, and of course, lots of questions would have to be answered before you can do that in a regular sort of way. The first pair we organized without solving the financial engineering, they were organized in a philanthropy sort of way. And the big challenge would be to figure out how to move the savings to where the new costs are. Right. The savings are in Medicare and insurance, and the new costs are in surgical costs in the United States and then post transplant care in the home country.
00:58:24.220 - 00:58:42.824, Speaker A: So these guys took part in an american chain, and it, you know, it can save a lot of money. But so far, we haven't figured out how to move the money from where it's saved to where it needs to be spent. But I think that this is an area where we might be able to grow kidney exchange around the world.
00:58:44.204 - 00:58:47.114, Speaker B: Okay, let's take further questions offline. Thanks.
