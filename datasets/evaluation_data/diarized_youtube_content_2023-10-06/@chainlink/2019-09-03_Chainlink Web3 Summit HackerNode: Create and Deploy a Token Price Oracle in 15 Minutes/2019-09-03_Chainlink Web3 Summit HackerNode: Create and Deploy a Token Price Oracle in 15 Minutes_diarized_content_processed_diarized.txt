00:00:04.730 - 00:00:56.720, Speaker A: Hello everyone, my name is Robert. I'm working with Kyco and I have quite some overlap with what Trevor is presenting, but you kind of laid the ground. So I'm going to elaborate a little bit on Excel on one small demo that extends on a bit of what you're doing. And I'm also going to talk a little bit about nuances of what is actually behind the prices, like how is an exchange price actually constructed and how that can affect DeFi applications. And yeah, I'll introduce us, make a small demo and then talk about these possible complications. So Kaiko is also a provider of market data, just like Amber data. We have more of a focus on the institutional space so far.
00:00:56.720 - 00:02:00.850, Speaker A: So most of our data is pure market data. We've been doing this since 2014, providing data since 15 based in Paris, and right now we're covering a little bit more than 70 changes. And our main product is a subscription with a license where you get a data field of historical data pushed to cloud storage. We have an HTTP rest like API and a stream of websockets. And since recently we're also on Chainlink where you can do microtransactions for a single point. And yeah, we're very keen about Defi in general, so we're going to keep an eye on the space and evaluate different things and see where we're going. So we're both a data provider and we run our own node and you have access to basically our full query API.
00:02:00.850 - 00:02:53.122, Speaker A: So you can check out our documentation to see what's available on Mainet. On Robston we have for free or for Robson, which you can get for free. You can get price data only for Ethereum, euro and anything to link tokens. So yeah, jump into demo mode maybe. First off, I'll just show you our docs. You have like a general idea of what's available. You can check it out yourself later, but we have so what's of interest.
00:02:53.122 - 00:03:34.362, Speaker A: If you're going to use your chain link, you want to look at the market data API. So any endpoint here except for order book snapshots, which doesn't really make sense, I think for a chaining contract right now are available. So you have raw trades, different varieties of price data. So you have like spot prices, direct exchange rates. Exchange rates. I'll go through a little bit what that actually means. Also to use the WAF showed like the first thing you showed was an easy way to make price oracle for any token.
00:03:34.362 - 00:04:31.860, Speaker A: Right? So if we have this. So here, I have a similar thing to what you were showing, but with integrating with our API hard code a bit here. So you can see here, this is just a hard coded URL that you could use to get stuff from our market API. So I'm getting the East Europrice here. And if we have this, let's say we have some service, like we want to sell tickets to some blockchain conference or something, and we want people to be able to pay these, but we want to price it in euros because prices can fluctuate quite a bit. And we want to have some kind of stable predictions of how much revenue we're getting from our tickets. Now, we can use this contract to charge people a price based on the euro price.
00:04:31.860 - 00:05:09.146, Speaker A: So you can see, like, this thing's pretty simple. Here's our chainlink job Id, which you can find if you go to the chainlink doc site. You click through to find the Kaika stuff. Everything's listed there. So yeah, €8, blah, blah, blah. This is just a super simple, just to show how this can be done. So I have a service provider, I call this here contract, where I have here a reference to this is also hard coded.
00:05:09.146 - 00:06:12.094, Speaker A: Just like you can see the cooking shelf. Like, I've already prepared my dishes here, so I've already deployed the europrice consumer oracle here. So you can see if I click now, the current price is like €169 point €34. We can try to get some more recent price. I guess it works, whatever. And while we wait for that, we can see here. So I have orders and I have just a view function in the contract that will, in this case, I'm pricing it in €50 for the tickets.
00:06:12.094 - 00:06:48.702, Speaker A: And since the price here is in Eurocent, it's 55,000. You kind of have to choose what precision you want, and that kind of affects what value you put here. And then you have to accommodate for that here. And then I'm dividing that by the consumer price. So this is supposed to represent somebody making the payment for their order. And the argument here is the hash of their order ID. So it's super simple.
00:06:48.702 - 00:08:05.190, Speaker A: I'm just like making a guard here asserting that, okay, the ETH attached here has to be at least the current price, and then we push an order and we're good. And I think this is just for the sake of illustration, but I think this gets a lot more useful when you think about ERC 20 transactions, because then you can set an allowance to a wallet, because here, as a user of this or a smart contract, they have to kind of like know, they have to call this and say like, oh, what's the price right now? And then have to send that exact amount here, which is kind of annoying. But you could use the allowance. So you could allow this contract to withdraw up to a certain amount from your wallet and then you could have this function withdraw the exact amount that it needs, which is kind of neat I think, but yeah, let's see if the price updated. Yes it is. So we can then here try to make a payment of some arbitrary credits and we can call the current price of get service price. This looks very expensive.
00:08:05.190 - 00:08:36.740, Speaker A: Yeah, this is not really right. I think I messed up the map here somehow. Was there a decimal point there somewhere? No. Okay. I think I must have hit the finger, but I think you get the point here. And by the way, if you have any questions, if anything I see is unclear during the presentation, please feel free to interrupt me. We're a small group so I think that works fine.
00:08:36.740 - 00:09:48.822, Speaker A: But yeah, that's the gist of that, I guess. Everything here so far. Cool. So this kind of works for like a proof of concept, but you kind of want this to update regularly, right? You don't want to have to manually keep calling this all the time. So one way that you could do this is you have this consumer contract that I just showed you and then you have the Chainlink Oracle contract that's already deployed, that's already on the network that you want to deploy on. Have your search right here and then you can set your own upchain like a cron job or some kind of trigger that regularly triggers this update price function to update it. And if you specifically want for some simple DAP usage, specifically like the EQC price or the BTC USD price, I know that Chainlink is currently deploying oracles on Mainnet that are there for the public to use, that draws in data from several data providers, among them.
00:09:48.822 - 00:10:41.320, Speaker A: So you get some kind of decentralized aggregated pool price that's there for the community to use. So you don't have to do this in the first place because Chainlink is and also kind of doing it for you. And now we're going to talk a little, so that was the demo part and now we're going to talk a little bit about prices. When we're looking at how much is bitcoin today. Where does that number actually come from? Right. And this is pretty basic stuff in finance, but I think it's easy to kind of just assume that you always have a price and that you can kind of agree on it. And it's important, especially when you start building defi application, it's important to realize that there's no consensus around.
00:10:41.320 - 00:11:39.014, Speaker A: How do we define the price? Because it's actually subjective, and relative to your use cases, we can see how that works out in practice. So, first off, I think it's important to distinguish between price discovery and valuation. So valuation is like, okay, how much is this ether I'm holding worth? So that's like an intrinsic perceived value. So that's like up to me, right? Whereas price discovery is about what's the market price of an asset, what's it trading on? On markets. And that differs from exchange to exchange, right? You've seen in the past how you can have overextended time price differences between different countries, right? Like bitcoin was trading at like 25% higher in Korea than everywhere else in the world. So what's the price of bitcoin there? Right? So. So how do you figure out the current market price? And if you're just on a single exchange, it's pretty trivial.
00:11:39.014 - 00:12:04.706, Speaker A: So the raw data that everything comes from only consists of two things. It's orders that license order books. So people will put limit orders. I'm sure you've all used exchanges. You know how this works, right? Like, you put a market or a limit order, the market orders end up in the limit orders end up in an order book. And if you have a buy order and a sell order that overlaps across each other, they get matched up, and it results in a trade. And trades are the second class of business.
00:12:04.706 - 00:12:53.730, Speaker A: And generally you will construct prices from trades and a building block in. This is a simple abbreviation called the volume weighted average price, or the V one. So you just take some time period. Generally, it would be somewhere between 1 minute, up to a week, and you will take the sum of each individual trade during that. During that period, multiply it by the volume, sum it together, and then you divide it by the total of the volume during the period, and then you get some price. And I think that's a fair representation for the price on an individual market. But it gets a bit different when you start to say, what's the global price of something? Because now you have one VWAP per exchange.
00:12:53.730 - 00:13:45.826, Speaker A: And are they really assets to assets? Because you can have exchanges with different trading. So if you have an exchange that has zero bids, you would have a lot more high frequency trading. And is that volume really like if you wouldn't do a bill wax? Of bill wax, which you could do, are the exchanges with zero biz volume really worth count as much as the exchanges that have high bids and more higher barrier venturing. And this is subjective. This depends on how you judge things. And I'm sure many of you have heard about wash trading, and can you really trust the volume numbers from exchanges? And we don't really make a judgment on if the volume that we provide is legit or not. We're basically just a proxy for data.
00:13:45.826 - 00:14:53.560, Speaker A: So you have to kind of decide, do I trust the volumes reported from each exchange or not? So, yeah, if you do a VWAps and VWAps, suddenly you have to think about which exchanges do I want to include in this, and do I want to weigh them differently? And when you start to talk about global reference rates, there are a lot, there's like an infinite amount of different models with different levels of complexity that you can use. A simple one for me to take is just a median. Like you take all the markets, line them up, and then you take the median, and you say, this is the price that works for a lot of use cases, actually. And when you look at how this can work out in practice and the complications this can have, like this happened with coin market cap in 2018. It was like pretty big deal in the news without communicating things. They removed the south korean exchanges from their rifle list, and this made the price look like it was dropping, like nothing had actually changed in what prices people were trading at. But because they reweighed their index, the graph looked like this.
00:14:53.560 - 00:15:29.460, Speaker A: And then people panicked because, oh my God, ripple is crashing and they start selling and then price actually drops. And this is not one instant thing like this. This has happened every now and then. So it's kind of interesting to see how, at least historically, coin market cap is really like a driver of price. They affect the markets. It's like an interesting feedback loop going. And similarly, we had on GDEX Coinbase Pro, we had a crash on.
00:15:29.460 - 00:16:12.286, Speaker A: So what happened there is that you had one large market sell order that pushed the price down a bit, and this triggered market limit orders, right? And then you have these market orders called stop losses, which is like an advanced order type. So it's an order that don't make it to the order book. But you tell the exchange that if the price goes down to here, I want to sell. So it's something that a lot of traders used to hedge. So they don't want to fit bag holding when it goes down to zero. So 82 goes down to some limit, you sell. So these things got triggered which drove the price down further.
00:16:12.286 - 00:16:44.300, Speaker A: And then this became a chain reaction, like a nuclear fission kind of. So in one single tick, like less than 1 second, the price went from $319 to 0.1, like in a single blip. And as an effect of this coinbase frozen trading for 3 hours to figure out what was going on. And they later made some compensations for margin traders that got liquidated because they didn't think was fair. You can see how this works here. There's a little gif here.
00:16:44.300 - 00:17:25.594, Speaker A: You can see everything's working fine and the order book is like empty here. So some lucky people had put buy orders here and they were super happy, of course, because then the price went up again. Things like this happen all the time. Like this is an example from Polonia. Like you had an 18% drop over like 1 minute, I think, and recovered again. And this has complications because Bitmex has indexes that back their derivatives, like the XTC USD derivative is based on the poloniax price. So when this happened, you had a lot of people getting liquidation just because there was like a bliss here.
00:17:25.594 - 00:18:18.662, Speaker A: So then you can start asking yourself like, is this reasonable or not? Well, it depends on your definitions and preferences. Of course, you can't really say that this is objectively wrong of bitcoin at all. It depends on how you construct your indexes and weight. So yeah, there are a lot of things that can cause what's called leakage that we saw here. And you have market manipulation, low liquidity, you can get hacked, rumors can spread, but affect the price to get volatile. You've also seen, I think it was about this a bit yesterday. Like many aggregators and construct indexes, they will just like based indexes also on stable prices, and just assume that a DAi is always worth a dollar and a USDT is always worth a dollar.
00:18:18.662 - 00:19:15.390, Speaker A: And yeah, this might not actually be the case. So this can cause noise and inaccuracies and it gets these interesting loops. Like how do you figure out what Tesla is worth? Well, the biggest markets are bitcoin to tether, so then you have to know the bitcoin price. So how do you get the bitcoin price? Well, you have to have the tether price, so you get this interesting cycle when you try to resolve that graph. Oh yeah, I already went through this. Oh yeah. So if you think about what price do you want to use? So what we provide today, we're going to give different alternatives for users, because different use cases, for different use cases, it makes sense with different aggregations.
00:19:15.390 - 00:20:44.410, Speaker A: So let's say you have a defi insurance contract that will trigger a payout in the event of a flash crash. Then you probably want to query the lowest price during some time period. Then you want to see not over a daily average, you want to actually get the lowest price, or else you will have no idea that a cash crash even happened, or you have a very small time window during which to aggregation. Similarly, if you build something like what I showed in the demo, like you want to price something, then you probably want a more stable price, because depending on when you happen to query things, if that happened during the GDEX flash crash, suddenly the user would you get a number like it's on the screen here, like maybe there was a flash crash right then, and suddenly it looks like I have to pay the equivalent of a million dollars just because the market happened to look like that at that exact unfortunate moment. So I don't think you can use a single source of truth of a price for an asset that can be used for all kinds of defi contracts. You have to consider the new assets and that will affect the aggregations that make sense for you. So we strive to allow for people to do this kind of customization and make educated choices.
00:20:44.410 - 00:21:20.920, Speaker A: So we have a direct exchange rate which is constructed of VWAP to VWAP. Very simple. But then you can only get assets that are directly trading to each other. Like if you have some token that only trades on DExs, you cannot get actually used this price of that because that token is not traded to actually use this. So then you have to use other models. So we have something called exchange rates, where we do some different model. Not going to go into that right now, but I'm happy to talk about it with you after my talk.
00:21:20.920 - 00:22:26.186, Speaker A: You can choose your intervals, you can choose which exchanges you want to exclude or exclude from your values. We also have something called a spot price, which is defined as the last trade for any trading pair, the most recent price. And then you also have the VWEB, which is exchange specific, and ox, which is what people call candles, open, high, local. And I think for us in this space, we're very like, it's a common mantra, like don't trust, verify, and we want to allow people to verify things. So I'm going to show how this can look what we do to try to accommodate for this in our API. So here you can see I'm requesting the soft direct exchange rate from link to USD, the most recent one over one day here. Or actually, let's take some assets that trades against more on more exchanges because assets are more interesting to look at.
00:22:26.186 - 00:23:18.410, Speaker A: So, like it uses. And this will just give us a single price point. So, yeah, we can see here, this is the volume and this is the price over today. And here are the instruments on the different exchanges that were included to create this. But if you want to have more details on exactly how this value was derived, you can put source is true. And then for each price point, you will have metadata here that shows like this, like you saw the list of entrance before. Then it will show the exact volume and price at the moment that this was calculated.
00:23:18.410 - 00:23:48.340, Speaker A: And if you have access to our trade data, you can, from the trade data, reconstruct and verify everything up to the price level. And this is something that we think is very important because transparency is key, especially for institutionals. They're happy for us to construct models and they trust our data, but they always want to be able to verify stuff on their end. And, yeah, that's what I had to tell you. Thank you.
